<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç®¡ç†å¾Œå° - å¸•é‡‘æ£®å”æœƒ</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Noto Sans TC', -apple-system, BlinkMacSystemFont, sans-serif;
      background: #f5f7fa;
      display: flex;
      min-height: 100vh;
    }
    
    .sidebar {
      width: 250px;
      background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
      color: white;
      position: fixed;
      height: 100vh;
      overflow-y: auto;
      z-index: 1000;
      transition: all 0.3s;
    }
    
    .sidebar.collapsed {
      width: 60px;
    }
    
    .sidebar-header {
      padding: 20px;
      border-bottom: 1px solid rgba(255,255,255,0.1);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    
    .sidebar-title {
      font-size: 18px;
      font-weight: 600;
    }
    
    .sidebar.collapsed .sidebar-title {
      display: none;
    }
    
    .toggle-btn {
      background: none;
      border: none;
      color: white;
      font-size: 20px;
      cursor: pointer;
      padding: 5px;
    }
    
    .sidebar-menu {
      padding: 20px 0;
    }
    
    .menu-item {
      display: flex;
      align-items: center;
      padding: 15px 20px;
      color: rgba(255,255,255,0.8);
      text-decoration: none;
      transition: all 0.3s;
      cursor: pointer;
    }
    
    .menu-item:hover, .menu-item.active {
      background: rgba(255,255,255,0.1);
      color: white;
    }
    
    .menu-item .icon {
      margin-right: 15px;
      font-size: 18px;
      width: 20px;
      text-align: center;
    }
    
    .sidebar.collapsed .menu-item .text {
      display: none;
    }
    
    .main-content {
      flex: 1;
      margin-left: 250px;
      transition: all 0.3s;
    }
    
    .sidebar.collapsed + .main-content {
      margin-left: 60px;
    }
    
    .top-bar {
      background: white;
      padding: 15px 25px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .page-title {
      font-size: 24px;
      font-weight: 600;
      color: #2c3e50;
    }
    
    .user-info {
      display: flex;
      align-items: center;
      gap: 15px;
    }
    
    .user-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: #3498db;
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
    }
    
    .logout-btn {
      background: #e74c3c;
      color: white;
      border: none;
      padding: 8px 15px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.3s;
    }
    
    .logout-btn:hover {
      background: #c0392b;
    }
    
    .content {
      padding: 25px;
    }
    
    .content-section {
      display: none;
    }
    
    .content-section.active {
      display: block;
    }
    
    .card {
      background: white;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      margin-bottom: 25px;
    }
    
    .card-header {
      padding: 20px 25px;
      border-bottom: 1px solid #ecf0f1;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .card-title {
      font-size: 18px;
      font-weight: 600;
      color: #2c3e50;
    }
    
    .card-body {
      padding: 25px;
    }
    
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    
    .stat-card {
      background: white;
      padding: 25px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      text-align: center;
      position: relative;
      overflow: hidden;
    }
    
    .stat-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #3498db, #2ecc71);
    }
    
    .stat-icon {
      font-size: 32px;
      margin-bottom: 15px;
    }
    
    .stat-value {
      font-size: 32px;
      font-weight: 700;
      color: #2c3e50;
      margin-bottom: 10px;
    }
    
    .stat-label {
      color: #7f8c8d;
      font-size: 14px;
      font-weight: 500;
    }
    
    .btn {
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      transition: all 0.3s;
      text-decoration: none;
      display: inline-block;
      text-align: center;
    }
    
    .btn-primary {
      background: #3498db;
      color: white;
    }
    
    .btn-primary:hover {
      background: #2980b9;
    }
    
    .btn-success {
      background: #27ae60;
      color: white;
    }
    
    .btn-success:hover {
      background: #229954;
    }
    
    .btn-warning {
      background: #f39c12;
      color: white;
    }
    
    .btn-warning:hover {
      background: #e67e22;
    }
    
    .btn-danger {
      background: #e74c3c;
      color: white;
    }
    
    .btn-danger:hover {
      background: #c0392b;
    }
    
    .btn-small {
      padding: 6px 12px;
      font-size: 12px;
    }
    
    .table-container {
      overflow-x: auto;
    }
    
    .data-table {
      width: 100%;
      border-collapse: collapse;
      background: white;
    }
    
    .data-table th {
      background: #f8f9fa;
      padding: 15px;
      text-align: left;
      font-weight: 600;
      color: #2c3e50;
      border-bottom: 2px solid #ecf0f1;
    }
    
    .data-table td {
      padding: 15px;
      border-bottom: 1px solid #ecf0f1;
      vertical-align: middle;
    }
    
    .data-table tr:hover {
      background: #f8f9fa;
    }
    
    .badge {
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 500;
    }
    
    .badge-success {
      background: #d4edda;
      color: #155724;
    }
    
    .badge-warning {
      background: #fff3cd;
      color: #856404;
    }
    
    .badge-danger {
      background: #f8d7da;
      color: #721c24;
    }
    
    .badge-info {
      background: #d1ecf1;
      color: #0c5460;
    }
    
    .badge-secondary {
      background: #e2e3e5;
      color: #383d41;
    }
    
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      z-index: 2000;
      align-items: center;
      justify-content: center;
    }
    
    .modal.show {
      display: flex;
    }
    
    .modal-content {
      background: white;
      border-radius: 12px;
      padding: 30px;
      max-width: 600px;
      width: 90%;
      max-height: 90vh;
      overflow-y: auto;
    }
    
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 25px;
      padding-bottom: 15px;
      border-bottom: 2px solid #ecf0f1;
    }
    
    .modal-title {
      font-size: 20px;
      font-weight: 600;
      color: #2c3e50;
    }
    
    .close-btn {
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: #95a5a6;
      padding: 5px;
      line-height: 1;
    }
    
    .form-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 25px;
    }
    
    .form-group {
      margin-bottom: 20px;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 8px;
      color: #2c3e50;
      font-weight: 500;
      font-size: 14px;
    }
    
    .form-group input,
    .form-group select,
    .form-group textarea {
      width: 100%;
      padding: 12px 15px;
      border: 2px solid #ecf0f1;
      border-radius: 8px;
      font-size: 14px;
      transition: all 0.3s;
    }
    
    .form-group input:focus,
    .form-group select:focus,
    .form-group textarea:focus {
      outline: none;
      border-color: #3498db;
      box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
    }
    
    .search-bar {
      display: flex;
      gap: 15px;
      margin-bottom: 25px;
      align-items: center;
      flex-wrap: wrap;
    }
    
    .search-input {
      flex: 1;
      min-width: 200px;
      padding: 12px 15px;
      border: 2px solid #ecf0f1;
      border-radius: 8px;
      font-size: 14px;
    }
    
    .filter-select {
      padding: 12px 15px;
      border: 2px solid #ecf0f1;
      border-radius: 8px;
      font-size: 14px;
      min-width: 150px;
    }
    
    .pagination {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
      margin-top: 25px;
    }
    
    .pagination button {
      padding: 8px 12px;
      border: 2px solid #ecf0f1;
      background: white;
      color: #2c3e50;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s;
    }
    
    .pagination button:hover {
      border-color: #3498db;
      color: #3498db;
    }
    
    .pagination button.active {
      background: #3498db;
      color: white;
      border-color: #3498db;
    }
    
    .pagination button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    
    .loading {
      display: none;
      text-align: center;
      padding: 40px;
    }
    
    .loading.show {
      display: block;
    }
    
    .spinner {
      border: 3px solid #ecf0f1;
      border-top: 3px solid #3498db;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 0 auto 15px;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    .alert {
      padding: 15px 20px;
      border-radius: 8px;
      margin-bottom: 25px;
      display: none;
      align-items: center;
      gap: 10px;
    }
    
    .alert.show {
      display: flex;
      animation: slideDown 0.3s ease-out;
    }
    
    .alert.success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }
    
    .alert.error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }
    
    .alert.warning {
      background: #fff3cd;
      color: #856404;
      border: 1px solid #ffeaa7;
    }
    
    .alert.info {
      background: #d1ecf1;
      color: #0c5460;
      border: 1px solid #bee5eb;
    }
    
    @keyframes slideDown {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .chart-container {
      height: 400px;
      background: #f8f9fa;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #7f8c8d;
      margin: 20px 0;
    }
    
    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: #7f8c8d;
    }
    
    .empty-state .icon {
      font-size: 48px;
      margin-bottom: 20px;
      opacity: 0.5;
    }
    
    .empty-state h3 {
      font-size: 18px;
      margin-bottom: 10px;
      color: #95a5a6;
    }
    
    .empty-state p {
      font-size: 14px;
      line-height: 1.6;
    }
    
    @media (max-width: 768px) {
      .sidebar {
        width: 60px;
      }
      
      .sidebar .sidebar-title,
      .sidebar .menu-item .text {
        display: none;
      }
      
      .main-content {
        margin-left: 60px;
      }
      
      .stats-grid {
        grid-template-columns: 1fr;
      }
      
      .search-bar {
        flex-direction: column;
        align-items: stretch;
      }
      
      .table-container {
        font-size: 12px;
      }
      
      .data-table th,
      .data-table td {
        padding: 10px 8px;
      }
    }
  </style>
</head>
<body>
  <!-- å´é‚Šæ¬„ -->
  <div class="sidebar" id="sidebar">
    <div class="sidebar-header">
      <div class="sidebar-title">ğŸŒŸ ç®¡ç†å¾Œå°</div>
      <button class="toggle-btn" onclick="toggleSidebar()">â˜°</button>
    </div>
    <nav class="sidebar-menu">
      <a class="menu-item active" onclick="showSection('dashboard')">
        <span class="icon">ğŸ“Š</span>
        <span class="text">ç¸½è¦½</span>
      </a>
      <a class="menu-item" onclick="showSection('members')">
        <span class="icon">ğŸ‘¥</span>
        <span class="text">æœƒå“¡ç®¡ç†</span>
      </a>
      <a class="menu-item" onclick="showSection('events')">
        <span class="icon">ğŸ¯</span>
        <span class="text">æ´»å‹•ç®¡ç†</span>
      </a>
      <a class="menu-item" onclick="showSection('health')">
        <span class="icon">ğŸ“‹</span>
        <span class="text">å¥åº·è¨˜éŒ„</span>
      </a>
      <a class="menu-item" onclick="showSection('donations')">
        <span class="icon">ğŸ’°</span>
        <span class="text">ææ¬¾ç®¡ç†</span>
      </a>
      <a class="menu-item" onclick="showSection('reports')">
        <span class="icon">ğŸ“ˆ</span>
        <span class="text">çµ±è¨ˆå ±è¡¨</span>
      </a>
      <a class="menu-item" onclick="showSection('settings')">
        <span class="icon">âš™ï¸</span>
        <span class="text">ç³»çµ±è¨­å®š</span>
      </a>
    </nav>
  </div>
  
  <!-- ä¸»è¦å…§å®¹ -->
  <div class="main-content">
    <div class="top-bar">
      <h1 class="page-title" id="page-title">ç³»çµ±ç¸½è¦½</h1>
      <div class="user-info">
        <div class="user-avatar" id="admin-avatar">A</div>
        <span id="admin-name">ç®¡ç†å“¡</span>
        <button class="logout-btn" onclick="logout()">ç™»å‡º</button>
      </div>
    </div>
    
    <div class="content">
      <div id="alert" class="alert"></div>
      <div id="loading" class="loading">
        <div class="spinner"></div>
        <p>è¼‰å…¥ä¸­...</p>
      </div>
      
      <!-- ç¸½è¦½é é¢ -->
      <div id="dashboard-section" class="content-section active">
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-icon">ğŸ‘¥</div>
            <div class="stat-value" id="total-members">-</div>
            <div class="stat-label">ç¸½æœƒå“¡æ•¸</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon">âœ…</div>
            <div class="stat-value" id="active-members">-</div>
            <div class="stat-label">æ´»èºæœƒå“¡</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon">ğŸ¯</div>
            <div class="stat-value" id="total-events">-</div>
            <div class="stat-label">ç¸½æ´»å‹•æ•¸</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon">ğŸ’°</div>
            <div class="stat-value" id="total-donations">-</div>
            <div class="stat-label">ç¸½ææ¬¾é‡‘é¡</div>
          </div>
        </div>
        
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">ğŸ“ˆ æ•¸æ“šè¶¨å‹¢</h3>
          </div>
          <div class="card-body">
            <div class="chart-container">
              æœƒå“¡å¢é•·è¶¨å‹¢åœ–è¡¨ (éœ€è¦åœ–è¡¨åº«æ”¯æ´)
            </div>
          </div>
        </div>
        
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">ğŸ”” æœ€æ–°å‹•æ…‹</h3>
          </div>
          <div class="card-body">
            <div id="recent-activities">
              <div class="loading show">
                <div class="spinner"></div>
                <p>è¼‰å…¥æœ€æ–°å‹•æ…‹...</p>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- æœƒå“¡ç®¡ç† -->
      <div id="members-section" class="content-section">
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">ğŸ‘¥ æœƒå“¡ç®¡ç†</h3>
            <button class="btn btn-primary" onclick="showAddMemberModal()">æ–°å¢æœƒå“¡</button>
          </div>
          <div class="card-body">
            <div class="search-bar">
              <input type="text" class="search-input" id="member-search" placeholder="æœå°‹æœƒå“¡å§“åã€Email æˆ–é›»è©±...">
              <select class="filter-select" id="member-status-filter">
                <option value="">æ‰€æœ‰ç‹€æ…‹</option>
                <option value="å·²å¯©æ ¸">å·²å¯©æ ¸</option>
                <option value="å¾…å¯©æ ¸">å¾…å¯©æ ¸</option>
                <option value="å·²åœç”¨">å·²åœç”¨</option>
              </select>
              <button class="btn btn-primary" onclick="searchMembers()">æœå°‹</button>
              <button class="btn btn-warning" onclick="exportMembers()">åŒ¯å‡º</button>
            </div>
            
            <div class="table-container">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>æœƒå“¡ç·¨è™Ÿ</th>
                    <th>å§“å</th>
                    <th>Email</th>
                    <th>é›»è©±</th>
                    <th>è¨»å†Šæ—¥æœŸ</th>
                    <th>ç‹€æ…‹</th>
                    <th>æ“ä½œ</th>
                  </tr>
                </thead>
                <tbody id="members-tbody">
                  <tr>
                    <td colspan="7">
                      <div class="loading show">
                        <div class="spinner"></div>
                        <p>è¼‰å…¥æœƒå“¡è³‡æ–™...</p>
                      </div>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            
            <div class="pagination" id="members-pagination"></div>
          </div>
        </div>
      </div>
      
      <!-- æ´»å‹•ç®¡ç† -->
      <div id="events-section" class="content-section">
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">ğŸ¯ æ´»å‹•ç®¡ç†</h3>
            <button class="btn btn-primary" onclick="showAddEventModal()">æ–°å¢æ´»å‹•</button>
          </div>
          <div class="card-body">
            <div class="search-bar">
              <input type="text" class="search-input" id="event-search" placeholder="æœå°‹æ´»å‹•åç¨±...">
              <select class="filter-select" id="event-status-filter">
                <option value="">æ‰€æœ‰ç‹€æ…‹</option>
                <option value="å ±åä¸­">å ±åä¸­</option>
                <option value="å·²é¡æ»¿">å·²é¡æ»¿</option>
                <option value="å·²çµæŸ">å·²çµæŸ</option>
                <option value="å·²å–æ¶ˆ">å·²å–æ¶ˆ</option>
              </select>
              <button class="btn btn-primary" onclick="searchEvents()">æœå°‹</button>
            </div>
            
            <div class="table-container">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>æ´»å‹•åç¨±</th>
                    <th>æ—¥æœŸæ™‚é–“</th>
                    <th>åœ°é»</th>
                    <th>å ±åäººæ•¸</th>
                    <th>ç‹€æ…‹</th>
                    <th>æ“ä½œ</th>
                  </tr>
                </thead>
                <tbody id="events-tbody">
                  <tr>
                    <td colspan="6">
                      <div class="loading show">
                        <div class="spinner"></div>
                        <p>è¼‰å…¥æ´»å‹•è³‡æ–™...</p>
                      </div>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            
            <div class="pagination" id="events-pagination"></div>
          </div>
        </div>
      </div>
      
      <!-- å¥åº·è¨˜éŒ„ -->
      <div id="health-section" class="content-section">
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">ğŸ“‹ å¥åº·è¨˜éŒ„ç®¡ç†</h3>
          </div>
          <div class="card-body">
            <div class="search-bar">
              <input type="text" class="search-input" id="health-search" placeholder="æœå°‹æœƒå“¡å§“å...">
              <input type="date" class="filter-select" id="health-date-from">
              <input type="date" class="filter-select" id="health-date-to">
              <button class="btn btn-primary" onclick="searchHealthRecords()">æœå°‹</button>
              <button class="btn btn-warning" onclick="exportHealthData()">åŒ¯å‡ºæ•¸æ“š</button>
            </div>
            
            <div class="table-container">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>æœƒå“¡å§“å</th>
                    <th>è¨˜éŒ„æ—¥æœŸ</th>
                    <th>éœ‡é¡«</th>
                    <th>åƒµç¡¬</th>
                    <th>å‹•ä½œé²ç·©</th>
                    <th>å¹³è¡¡å•é¡Œ</th>
                    <th>å‚™è¨»</th>
                    <th>æ“ä½œ</th>
                  </tr>
                </thead>
                <tbody id="health-tbody">
                  <tr>
                    <td colspan="8">
                      <div class="loading show">
                        <div class="spinner"></div>
                        <p>è¼‰å…¥å¥åº·è¨˜éŒ„...</p>
                      </div>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            
            <div class="pagination" id="health-pagination"></div>
          </div>
        </div>
      </div>
      
      <!-- ææ¬¾ç®¡ç† -->
      <div id="donations-section" class="content-section">
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">ğŸ’° ææ¬¾ç®¡ç†</h3>
            <button class="btn btn-primary" onclick="showAddDonationModal()">æ–°å¢ææ¬¾è¨˜éŒ„</button>
          </div>
          <div class="card-body">
            <div class="search-bar">
              <input type="text" class="search-input" id="donation-search" placeholder="æœå°‹ææ¬¾äººå§“å...">
              <select class="filter-select" id="donation-type-filter">
                <option value="">æ‰€æœ‰é¡å‹</option>
                <option value="ä¸€èˆ¬ææ¬¾">ä¸€èˆ¬ææ¬¾</option>
                <option value="å®šæœŸææ¬¾">å®šæœŸææ¬¾</option>
                <option value="æŒ‡å®šç”¨é€”">æŒ‡å®šç”¨é€”</option>
              </select>
              <input type="date" class="filter-select" id="donation-date-from">
              <input type="date" class="filter-select" id="donation-date-to">
              <button class="btn btn-primary" onclick="searchDonations()">æœå°‹</button>
              <button class="btn btn-warning" onclick="exportDonations()">åŒ¯å‡º</button>
            </div>
            
            <div class="table-container">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>ææ¬¾äºº</th>
                    <th>é‡‘é¡</th>
                    <th>é¡å‹</th>
                    <th>ææ¬¾æ—¥æœŸ</th>
                    <th>ä»˜æ¬¾æ–¹å¼</th>
                    <th>ç‹€æ…‹</th>
                  <th>æ“ä½œ</th>
                </tr>
              </thead>
              <tbody id="donations-tbody">
                <tr>
                  <td colspan="7">
                    <div class="loading show">
                      <div class="spinner"></div>
                      <p>è¼‰å…¥ææ¬¾è¨˜éŒ„...</p>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          
          <div class="pagination" id="donations-pagination"></div>
        </div>
      </div>
    </div>
    
    <!-- çµ±è¨ˆå ±è¡¨ -->
    <div id="reports-section" class="content-section">
      <div class="card">
        <div class="card-header">
          <h3 class="card-title">ğŸ“ˆ çµ±è¨ˆå ±è¡¨</h3>
          <button class="btn btn-warning" onclick="exportAllReports()">åŒ¯å‡ºå…¨éƒ¨å ±è¡¨</button>
        </div>
        <div class="card-body">
          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-icon">ğŸ“Š</div>
              <div class="stat-value" id="monthly-new-members">-</div>
              <div class="stat-label">æœ¬æœˆæ–°å¢æœƒå“¡</div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">ğŸ¯</div>
              <div class="stat-value" id="monthly-events">-</div>
              <div class="stat-label">æœ¬æœˆæ´»å‹•æ•¸</div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">ğŸ’°</div>
              <div class="stat-value" id="monthly-donations">-</div>
              <div class="stat-label">æœ¬æœˆææ¬¾ç¸½é¡</div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">ğŸ“</div>
              <div class="stat-value" id="monthly-health-records">-</div>
              <div class="stat-label">æœ¬æœˆå¥åº·è¨˜éŒ„</div>
            </div>
          </div>
          
          <div class="card">
            <div class="card-header">
              <h3 class="card-title">ğŸ“ˆ å¹´åº¦è¶¨å‹¢åˆ†æ</h3>
            </div>
            <div class="card-body">
              <div class="chart-container">
                å¹´åº¦æ•¸æ“šè¶¨å‹¢åœ–è¡¨ (éœ€è¦åœ–è¡¨åº«æ”¯æ´)
              </div>
            </div>
          </div>
          
          <div class="card">
            <div class="card-header">
              <h3 class="card-title">ğŸ¯ æ´»å‹•åƒèˆ‡çµ±è¨ˆ</h3>
            </div>
            <div class="card-body">
              <div class="chart-container">
                æ´»å‹•åƒèˆ‡åº¦åˆ†æåœ–è¡¨
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- ç³»çµ±è¨­å®š -->
    <div id="settings-section" class="content-section">
      <div class="card">
        <div class="card-header">
          <h3 class="card-title">âš™ï¸ ç³»çµ±è¨­å®š</h3>
        </div>
        <div class="card-body">
          <div class="form-grid">
            <div class="form-group">
              <label>API ç¶²å€</label>
              <input type="url" id="api-url" placeholder="https://example.com/api">
            </div>
            <div class="form-group">
              <label>ç³»çµ±æ¨™é¡Œ</label>
              <input type="text" id="system-title" value="å¸•é‡‘æ£®å”æœƒç®¡ç†ç³»çµ±">
            </div>
            <div class="form-group">
              <label>æ¯é é¡¯ç¤ºç­†æ•¸</label>
              <select id="page-size">
                <option value="10">10</option>
                <option value="20" selected>20</option>
                <option value="50">50</option>
                <option value="100">100</option>
              </select>
            </div>
            <div class="form-group">
              <label>è‡ªå‹•å‚™ä»½é–“éš” (å°æ™‚)</label>
              <input type="number" id="backup-interval" value="24" min="1" max="168">
            </div>
          </div>
          
          <div class="form-group">
            <label>ç³»çµ±å…¬å‘Š</label>
            <textarea id="system-announcement" rows="4" placeholder="è¼¸å…¥ç³»çµ±å…¬å‘Šå…§å®¹..."></textarea>
          </div>
          
          <div style="display: flex; gap: 15px; margin-top: 25px;">
            <button class="btn btn-primary" onclick="saveSettings()">å„²å­˜è¨­å®š</button>
            <button class="btn btn-warning" onclick="exportData()">åŒ¯å‡ºè³‡æ–™</button>
            <button class="btn btn-success" onclick="backupData()">ç«‹å³å‚™ä»½</button>
            <button class="btn btn-danger" onclick="clearCache()">æ¸…é™¤å¿«å–</button>
          </div>
        </div>
      </div>
      
      <div class="card">
        <div class="card-header">
          <h3 class="card-title">ğŸ” ç®¡ç†å“¡å¸³è™Ÿ</h3>
        </div>
        <div class="card-body">
          <div class="table-container">
            <table class="data-table">
              <thead>
                <tr>
                  <th>ç®¡ç†å“¡åç¨±</th>
                  <th>Email</th>
                  <th>æ¬Šé™ç­‰ç´š</th>
                  <th>æœ€å¾Œç™»å…¥</th>
                  <th>ç‹€æ…‹</th>
                  <th>æ“ä½œ</th>
                </tr>
              </thead>
              <tbody id="admins-tbody">
                <tr>
                  <td>ç³»çµ±ç®¡ç†å“¡</td>
                  <td>admin@parkinson.org.tw</td>
                  <td><span class="badge badge-danger">è¶…ç´šç®¡ç†å“¡</span></td>
                  <td>2024-01-15 14:30</td>
                  <td><span class="badge badge-success">å·²å•Ÿç”¨</span></td>
                  <td>
                    <button class="btn btn-small btn-warning" onclick="editAdmin('admin1')">ç·¨è¼¯</button>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          <button class="btn btn-primary" onclick="showAddAdminModal()" style="margin-top: 15px;">æ–°å¢ç®¡ç†å“¡</button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- æ–°å¢æœƒå“¡å½ˆçª— -->
<div id="add-member-modal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3 class="modal-title">æ–°å¢æœƒå“¡</h3>
      <button class="close-btn" onclick="closeModal('add-member-modal')">&times;</button>
    </div>
    <form onsubmit="saveMember(event)">
      <div class="form-grid">
        <div class="form-group">
          <label>å§“å *</label>
          <input type="text" id="member-name" required>
        </div>
        <div class="form-group">
          <label>æœƒå“¡ç·¨è™Ÿ</label>
          <input type="text" id="member-no" placeholder="ç³»çµ±è‡ªå‹•ç”¢ç”Ÿ">
        </div>
        <div class="form-group">
          <label>Email *</label>
          <input type="email" id="member-email" required>
        </div>
        <div class="form-group">
          <label>é›»è©±</label>
          <input type="tel" id="member-phone">
        </div>
        <div class="form-group">
          <label>æ€§åˆ¥</label>
          <select id="member-gender">
            <option value="">è«‹é¸æ“‡</option>
            <option value="ç”·">ç”·</option>
            <option value="å¥³">å¥³</option>
            <option value="å…¶ä»–">å…¶ä»–</option>
          </select>
        </div>
        <div class="form-group">
          <label>ç”Ÿæ—¥</label>
          <input type="date" id="member-birthday">
        </div>
      </div>
      
      <div class="form-group">
        <label>åœ°å€</label>
        <textarea id="member-address" rows="2" placeholder="å®Œæ•´åœ°å€"></textarea>
      </div>
      
      <div class="form-group">
        <label>å‚™è¨»</label>
        <textarea id="member-notes" rows="3" placeholder="ç‰¹æ®Šéœ€æ±‚æˆ–æ³¨æ„äº‹é …"></textarea>
      </div>
      
      <button type="submit" class="btn btn-primary" style="width: 100%;">æ–°å¢æœƒå“¡</button>
    </form>
  </div>
</div>

<!-- æ–°å¢æ´»å‹•å½ˆçª— -->
<div id="add-event-modal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3 class="modal-title">æ–°å¢æ´»å‹•</h3>
      <button class="close-btn" onclick="closeModal('add-event-modal')">&times;</button>
    </div>
    <form onsubmit="saveEvent(event)">
      <div class="form-grid">
        <div class="form-group">
          <label>æ´»å‹•åç¨± *</label>
          <input type="text" id="event-name" required>
        </div>
        <div class="form-group">
          <label>æ´»å‹•é¡å‹</label>
          <select id="event-type">
            <option value="å¥åº·è¬›åº§">å¥åº·è¬›åº§</option>
            <option value="å¾©å¥èª²ç¨‹">å¾©å¥èª²ç¨‹</option>
            <option value="äº’åŠ©èšæœƒ">äº’åŠ©èšæœƒ</option>
            <option value="å¿—å·¥æ´»å‹•">å¿—å·¥æ´»å‹•</option>
            <option value="å…¶ä»–">å…¶ä»–</option>
          </select>
        </div>
        <div class="form-group">
          <label>æ´»å‹•æ—¥æœŸ *</label>
          <input type="date" id="event-date" required>
        </div>
        <div class="form-group">
          <label>é–‹å§‹æ™‚é–“ *</label>
          <input type="time" id="event-start-time" required>
        </div>
        <div class="form-group">
          <label>çµæŸæ™‚é–“ *</label>
          <input type="time" id="event-end-time" required>
        </div>
        <div class="form-group">
          <label>å ±åä¸Šé™</label>
          <input type="number" id="event-max-participants" min="1" value="30">
        </div>
      </div>
      
      <div class="form-group">
        <label>æ´»å‹•åœ°é» *</label>
        <input type="text" id="event-location" required placeholder="æ´»å‹•èˆ‰è¾¦åœ°é»">
      </div>
      
      <div class="form-group">
        <label>æ´»å‹•æè¿°</label>
        <textarea id="event-description" rows="4" placeholder="è©³ç´°æ´»å‹•å…§å®¹ã€æ³¨æ„äº‹é …ç­‰"></textarea>
      </div>
      
      <div class="form-group">
        <label>å ±åè²»ç”¨ (å…ƒ)</label>
        <input type="number" id="event-fee" min="0" value="0">
      </div>
      
      <button type="submit" class="btn btn-primary" style="width: 100%;">æ–°å¢æ´»å‹•</button>
    </form>
  </div>
</div>

<!-- æ–°å¢ææ¬¾è¨˜éŒ„å½ˆçª— -->
<div id="add-donation-modal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3 class="modal-title">æ–°å¢ææ¬¾è¨˜éŒ„</h3>
      <button class="close-btn" onclick="closeModal('add-donation-modal')">&times;</button>
    </div>
    <form onsubmit="saveDonation(event)">
      <div class="form-grid">
        <div class="form-group">
          <label>ææ¬¾äººå§“å *</label>
          <input type="text" id="donation-donor-name" required>
        </div>
        <div class="form-group">
          <label>ææ¬¾é‡‘é¡ *</label>
          <input type="number" id="donation-amount" required min="1">
        </div>
        <div class="form-group">
          <label>ææ¬¾é¡å‹</label>
          <select id="donation-type">
            <option value="ä¸€èˆ¬ææ¬¾">ä¸€èˆ¬ææ¬¾</option>
            <option value="å®šæœŸææ¬¾">å®šæœŸææ¬¾</option>
            <option value="æŒ‡å®šç”¨é€”">æŒ‡å®šç”¨é€”</option>
          </select>
        </div>
        <div class="form-group">
          <label>ææ¬¾æ—¥æœŸ *</label>
          <input type="date" id="donation-date" required>
        </div>
        <div class="form-group">
          <label>ä»˜æ¬¾æ–¹å¼</label>
          <select id="donation-payment-method">
            <option value="éŠ€è¡Œè½‰å¸³">éŠ€è¡Œè½‰å¸³</option>
            <option value="ä¿¡ç”¨å¡">ä¿¡ç”¨å¡</option>
            <option value="ç¾é‡‘">ç¾é‡‘</option>
            <option value="æ”¯ç¥¨">æ”¯ç¥¨</option>
          </select>
        </div>
        <div class="form-group">
          <label>è¯çµ¡é›»è©±</label>
          <input type="tel" id="donation-phone">
        </div>
      </div>
      
      <div class="form-group">
        <label>ææ¬¾ç”¨é€”èªªæ˜</label>
        <textarea id="donation-purpose" rows="3" placeholder="æŒ‡å®šç”¨é€”æˆ–å‚™è¨»"></textarea>
      </div>
      
      <button type="submit" class="btn btn-primary" style="width: 100%;">æ–°å¢è¨˜éŒ„</button>
    </form>
  </div>
</div>

<!-- æ–°å¢ç®¡ç†å“¡å½ˆçª— -->
<div id="add-admin-modal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3 class="modal-title">æ–°å¢ç®¡ç†å“¡</h3>
      <button class="close-btn" onclick="closeModal('add-admin-modal')">&times;</button>
    </div>
    <form onsubmit="saveAdmin(event)">
      <div class="form-grid">
        <div class="form-group">
          <label>ç®¡ç†å“¡å§“å *</label>
          <input type="text" id="admin-name-input" required>
        </div>
        <div class="form-group">
          <label>Email *</label>
          <input type="email" id="admin-email" required>
        </div>
        <div class="form-group">
          <label>å¯†ç¢¼ *</label>
          <input type="password" id="admin-password" required minlength="6">
        </div>
        <div class="form-group">
          <label>ç¢ºèªå¯†ç¢¼ *</label>
          <input type="password" id="admin-password-confirm" required minlength="6">
        </div>
        <div class="form-group">
          <label>æ¬Šé™ç­‰ç´š</label>
          <select id="admin-role">
            <option value="ä¸€èˆ¬ç®¡ç†å“¡">ä¸€èˆ¬ç®¡ç†å“¡</option>
            <option value="é«˜ç´šç®¡ç†å“¡">é«˜ç´šç®¡ç†å“¡</option>
          </select>
        </div>
        <div class="form-group">
          <label>è¯çµ¡é›»è©±</label>
          <input type="tel" id="admin-phone">
        </div>
      </div>
      
      <button type="submit" class="btn btn-primary" style="width: 100%;">æ–°å¢ç®¡ç†å“¡</button>
    </form>
  </div>
</div>

<script>
  // ========== å…¨åŸŸè®Šæ•¸ ==========
  let API_URL = localStorage.getItem('admin_API_URL') || '';
  let currentPage = 1;
  let pageSize = 20;
  let currentSection = 'dashboard';
  
  // ========== åˆå§‹åŒ– ==========
  window.onload = function() {
    checkAuthStatus();
    loadDashboardData();
    loadSettings();
  };
  
  function checkAuthStatus() {
    const adminInfo = localStorage.getItem('adminInfo');
    if (!adminInfo) {
      alert('è«‹å…ˆç™»å…¥ç®¡ç†å¾Œå°');
      window.location.href = 'admin-login.html';
      return;
    }
    
    const admin = JSON.parse(adminInfo);
    document.getElementById('admin-name').textContent = admin.name || 'ç®¡ç†å“¡';
    document.getElementById('admin-avatar').textContent = (admin.name || 'A').charAt(0);
  }
  
  // ========== å´é‚Šæ¬„æ§åˆ¶ ==========
  function toggleSidebar() {
    document.getElementById('sidebar').classList.toggle('collapsed');
  }
  
  function showSection(section) {
    // éš±è—æ‰€æœ‰é é¢
    document.querySelectorAll('.content-section').forEach(s => {
      s.classList.remove('active');
    });
    
    // ç§»é™¤æ‰€æœ‰é¸å–®é …ç›®çš„ active
    document.querySelectorAll('.menu-item').forEach(item => {
      item.classList.remove('active');
    });
    
    // é¡¯ç¤ºæŒ‡å®šé é¢
    document.getElementById(section + '-section').classList.add('active');
    
    // è¨­å®šé¸å–®é …ç›®ç‚º active
    event.currentTarget.classList.add('active');
    
    // æ›´æ–°é é¢æ¨™é¡Œ
    const titles = {
      'dashboard': 'ç³»çµ±ç¸½è¦½',
      'members': 'æœƒå“¡ç®¡ç†',
      'events': 'æ´»å‹•ç®¡ç†', 
      'health': 'å¥åº·è¨˜éŒ„',
      'donations': 'ææ¬¾ç®¡ç†',
      'reports': 'çµ±è¨ˆå ±è¡¨',
      'settings': 'ç³»çµ±è¨­å®š'
    };
    
    document.getElementById('page-title').textContent = titles[section];
    currentSection = section;
    
    // è¼‰å…¥å°æ‡‰è³‡æ–™
    switch(section) {
      case 'dashboard':
        loadDashboardData();
        break;
      case 'members':
        loadMembersData();
        break;
      case 'events':
        loadEventsData();
        break;
      case 'health':
        loadHealthData();
        break;
      case 'donations':
        loadDonationsData();
        break;
      case 'reports':
        loadReportsData();
        break;
      case 'settings':
        loadSettings();
        break;
    }
  }
  
  // ========== API å‘¼å« ==========
  async function callAPI(data) {
    if (!API_URL) {
      showAlert('è«‹å…ˆåœ¨ç³»çµ±è¨­å®šä¸­è¨­å®š API ç¶²å€', 'error');
      return { success: false, message: 'æœªè¨­å®š API ç¶²å€' };
    }
    
    try {
      showLoading(true);
      
      const params = new URLSearchParams();
      for (let key in data) {
        params.append(key, typeof data[key] === 'object' ? JSON.stringify(data[key]) : data[key]);
      }
      
      const response = await fetch(API_URL + '?' + params.toString(), {
        method: 'GET',
        redirect: 'follow',
        mode: 'cors'
      });
      
      if (!response.ok) {
        throw new Error('HTTP ' + response.status);
      }
      
      const text = await response.text();
      return JSON.parse(text);
      
    } catch (error) {
      console.error('API éŒ¯èª¤:', error);
      showAlert('API å‘¼å«å¤±æ•—: ' + error.message, 'error');
      return { success: false, message: error.message };
    } finally {
      showLoading(false);
    }
  }
  
  // ========== è¼‰å…¥è³‡æ–™åŠŸèƒ½ ==========
  async function loadDashboardData() {
    try {
      const [
        membersResult,
        eventsResult, 
        donationsResult,
        activitiesResult
      ] = await Promise.all([
        callAPI({ action: 'getStats', type: 'members' }),
        callAPI({ action: 'getStats', type: 'events' }),
        callAPI({ action: 'getStats', type: 'donations' }),
        callAPI({ action: 'getRecentActivities' })
      ]);
      
      // æ›´æ–°çµ±è¨ˆæ•¸æ“š
      if (membersResult.success) {
        document.getElementById('total-members').textContent = membersResult.data.total || 0;
        document.getElementById('active-members').textContent = membersResult.data.active || 0;
      }
      
      if (eventsResult.success) {
        document.getElementById('total-events').textContent = eventsResult.data.total || 0;
      }
      
      if (donationsResult.success) {
        const total = donationsResult.data.total || 0;
        document.getElementById('total-donations').textContent = 'NT$ ' + total.toLocaleString();
      }
      
      // è¼‰å…¥æœ€æ–°å‹•æ…‹
      const activitiesContainer = document.getElementById('recent-activities');
      if (activitiesResult.success && activitiesResult.data.length > 0) {
        activitiesContainer.innerHTML = activitiesResult.data.map(activity => `
          <div style="padding: 15px; border-bottom: 1px solid #ecf0f1;">
            <div style="display: flex; justify-content: space-between; align-items: center;">
              <div>
                <strong>${activity.type}</strong>
                <p style="margin: 5px 0; color: #7f8c8d;">${activity.description}</p>
              </div>
              <small style="color: #95a5a6;">${activity.timestamp}</small>
            </div>
          </div>
        `).join('');
      } else {
        activitiesContainer.innerHTML = '<div class="empty-state"><div class="icon">ğŸ“</div><p>æš«ç„¡å‹•æ…‹è¨˜éŒ„</p></div>';
      }
      
    } catch (error) {
      console.error('è¼‰å…¥ç¸½è¦½è³‡æ–™å¤±æ•—:', error);
      showAlert('è¼‰å…¥ç¸½è¦½è³‡æ–™å¤±æ•—', 'error');
    }
  }
  
  async function loadMembersData(page = 1) {
    const tbody = document.getElementById('members-tbody');
    tbody.innerHTML = '<tr><td colspan="7"><div class="loading show"><div class="spinner"></div><p>è¼‰å…¥æœƒå“¡è³‡æ–™...</p></div></td></tr>';
    
    try {
      const searchTerm = document.getElementById('member-search')?.value || '';
      const statusFilter = document.getElementById('member-status-filter')?.value || '';
      
      const result = await callAPI({
        action: 'getMembers',
        page: page,
        pageSize: pageSize,
        search: searchTerm,
        status: statusFilter
      });
      
      if (result.success && result.data.length > 0) {
        tbody.innerHTML = result.data.map(member => `
          <tr>
            <td>${member.memberNo}</td>
            <td>${member.name}</td>
            <td>${member.email}</td>
            <td>${member.phone || '-'}</td>
            <td>${member.registerDate}</td>
            <td><span class="badge badge-${getStatusClass(member.status)}">${member.status}</span></td>
            <td>
              <button class="btn btn-small btn-primary" onclick="viewMember('${member.memberId}')">æŸ¥çœ‹</button>
              <button class="btn btn-small btn-warning" onclick="editMember('${member.memberId}')">ç·¨è¼¯</button>
              <button class="btn btn-small btn-danger" onclick="deleteMember('${member.memberId}')">åˆªé™¤</button>
            </td>
          </tr>
        `).join('');
        
        // æ›´æ–°åˆ†é 
        updatePagination('members', result.totalPages, page);
      } else {
        tbody.innerHTML = '<tr><td colspan="7"><div class="empty-state"><div class="icon">ğŸ‘¥</div><p>æ²’æœ‰æ‰¾åˆ°æœƒå“¡è³‡æ–™</p></div></td></tr>';
      }
      
    } catch (error) {
      tbody.innerHTML = '<tr><td colspan="7"><div class="empty-state"><div class="icon">âŒ</div><p>è¼‰å…¥å¤±æ•—</p></div></td></tr>';
    }
  }
  
  async function loadEventsData(page = 1) {
    const tbody = document.getElementById('events-tbody');
    tbody.innerHTML = '<tr><td colspan="6"><div class="loading show"><div class="spinner"></div><p>è¼‰å…¥æ´»å‹•è³‡æ–™...</p></div></td></tr>';
    
    try {
      const searchTerm = document.getElementById('event-search')?.value || '';
      const statusFilter = document.getElementById('event-status-filter')?.value || '';
      
      const result = await callAPI({
        action: 'getEvents',
        page: page,
        pageSize: pageSize,
        search: searchTerm,
        status: statusFilter
      });
      
      if (result.success && result.data.length > 0) {
        tbody.innerHTML = result.data.map(event => `
          <tr>
            <td>${event.eventName}</td>
            <td>${event.eventDate} ${event.startTime}</td>
            <td>${event.location}</td>
            <td>${event.registrationCount}/${event.maxParticipants}</td>
            <td><span class="badge badge-${getStatusClass(event.status)}">${event.status}</span></td>
            <td>
              <button class="btn btn-small btn-primary" onclick="viewEvent('${event.eventId}')">æŸ¥çœ‹</button>
              <button class="btn btn-small btn-warning" onclick="editEvent('${event.eventId}')">ç·¨è¼¯</button>
              <button class="btn btn-small btn-danger" onclick="deleteEvent('${event.eventId}')">åˆªé™¤</button>
            </td>
          </tr>
        `).join('');
        
        updatePagination('events', result.totalPages, page);
      } else {
        tbody.innerHTML = '<tr><td colspan="6"><div class="empty-state"><div class="icon">ğŸ¯</div><p>æ²’æœ‰æ‰¾åˆ°æ´»å‹•è³‡æ–™</p></div></td></tr>';
      }
      
    } catch (error) {
      tbody.innerHTML = '<tr><td colspan="6"><div class="empty-state"><div class="icon">âŒ</div><p>è¼‰å…¥å¤±æ•—</p></div></td></tr>';
    }
  }
  
  async function loadHealthData(page = 1) {
    const tbody = document.getElementById('health-tbody');
    tbody.innerHTML = '<tr><td colspan="8"><div class="loading show"><div class="spinner"></div><p>è¼‰å…¥å¥åº·è¨˜éŒ„...</p></div></td></tr>';
    
    try {
      const searchTerm = document.getElementById('health-search')?.value || '';
      const dateFrom = document.getElementById('health-date-from')?.value || '';
      const dateTo = document.getElementById('health-date-to')?.value || '';
      
      const result = await callAPI({
        action: 'getAllHealthRecords',
        page: page,
        pageSize: pageSize,
        search: searchTerm,
        dateFrom: dateFrom,
        dateTo: dateTo
      });
      
      if (result.success && result.data.length > 0) {
        tbody.innerHTML = result.data.map(record => `
          <tr>
            <td>${record.memberName}</td>
            <td>${record.recordDate}</td>
            <td>${record.tremorLevel}</td>
            <td>${record.rigidityLevel}</td>
            <td>${record.bradykinesiaLevel}</td>
            <td>${record.balanceLevel}</td>
            <td>${record.notes || '-'}</td>
            <td>
              <button class="btn btn-small btn-primary" onclick="viewHealthRecord('${record.recordId}')">æŸ¥çœ‹</button>
              <button class="btn btn-small btn-danger" onclick="deleteHealthRecord('${record.recordId}')">åˆªé™¤</button>
            </td>
          </tr>
        `).join('');
        
        updatePagination('health', result.totalPages, page);
      } else {
        tbody.innerHTML = '<tr><td colspan="8"><div class="empty-state"><div class="icon">ğŸ“‹</div><p>æ²’æœ‰æ‰¾åˆ°å¥åº·è¨˜éŒ„</p></div></td></tr>';
      }
      
    } catch (error) {
      tbody.innerHTML = '<tr><td colspan="8"><div class="empty-state"><div class="icon">âŒ</div><p>è¼‰å…¥å¤±æ•—</p></div></td></tr>';
    }
  }
  
  async function loadDonationsData(page = 1) {
    const tbody = document.getElementById('donations-tbody');
    tbody.innerHTML = '<tr><td colspan="7"><div class="loading show"><div class="spinner"></div><p>è¼‰å…¥ææ¬¾è¨˜éŒ„...</p></div></td></tr>';
    
    try {
      const searchTerm = document.getElementById('donation-search')?.value || '';
      const typeFilter = document.getElementById('donation-type-filter')?.value || '';
      const dateFrom = document.getElementById('donation-date-from')?.value || '';
      const dateTo = document.getElementById('donation-date-to')?.value || '';
      
      const result = await callAPI({
        action: 'getDonations',
        page: page,
        pageSize: pageSize,
        search: searchTerm,
        type: typeFilter,
        dateFrom: dateFrom,
        dateTo: dateTo
      });
      
      if (result.success && result.data.length > 0) {
        tbody.innerHTML = result.data.map(donation => `
          <tr>
            <td>${donation.donorName}</td>
            <td>NT$ ${donation.amount.toLocaleString()}</td>
            <td>${donation.donationType}</td>
            <td>${donation.donationDate}</td>
            <td>${donation.paymentMethod}</td>
            <td><span class="badge badge-${getStatusClass(donation.status)}">${donation.status}</span></td>
            <td>
              <button class="btn btn-small btn-primary" onclick="viewDonation('${donation.donationId}')">æŸ¥çœ‹</button>
              <button class="btn btn-small btn-warning" onclick="editDonation('${donation.donationId}')">ç·¨è¼¯</button>
              <button class="btn btn-small btn-danger" onclick="deleteDonation('${donation.donationId}')">åˆªé™¤</button>
            </td>
          </tr>
        `).join('');
        
        updatePagination('donations', result.totalPages, page);
      } else {
        tbody.innerHTML = '<tr><td colspan="7"><div class="empty-state"><div class="icon">ğŸ’°</div><p>æ²’æœ‰æ‰¾åˆ°ææ¬¾è¨˜éŒ„</p></div></td></tr>';
      }
      
    } catch (error) {
      tbody.innerHTML = '<tr><td colspan="7"><div class="empty-state"><div class="icon">âŒ</div><p>è¼‰å…¥å¤±æ•—</p></div></td></tr>';
    }
  }
  
  async function loadReportsData() {
    try {
      const [
        monthlyStatsResult,
        yearlyTrendsResult
      ] = await Promise.all([
        callAPI({ action: 'getMonthlyStats' }),
        callAPI({ action: 'getYearlyTrends' })
      ]);
      
      // æ›´æ–°æœˆçµ±è¨ˆ
      if (monthlyStatsResult.success) {
        const data = monthlyStatsResult.data;
        document.getElementById('monthly-new-members').textContent = data.newMembers || 0;
        document.getElementById('monthly-events').textContent = data.events || 0;
        document.getElementById('monthly-donations').textContent = 'NT$ ' + (data.donations || 0).toLocaleString();
        document.getElementById('monthly-health-records').textContent = data.healthRecords || 0;
      }
      
    } catch (error) {
      console.error('è¼‰å…¥å ±è¡¨è³‡æ–™å¤±æ•—:', error);
      showAlert('è¼‰å…¥å ±è¡¨è³‡æ–™å¤±æ•—', 'error');
    }
  }
  
  // ========== å·¥å…·å‡½æ•¸ ==========
  function getStatusClass(status) {
    const statusMap = {
      'å·²å¯©æ ¸': 'success',
      'å¾…å¯©æ ¸': 'warning', 
      'å·²åœç”¨': 'danger',
      'å ±åä¸­': 'info',
      'å·²é¡æ»¿': 'warning',
      'å·²çµæŸ': 'secondary',
      'å·²å–æ¶ˆ': 'danger',
      'å·²å®Œæˆ': 'success',
      'è™•ç†ä¸­': 'warning',
      'å·²å•Ÿç”¨': 'success'
    };
    return statusMap[status] || 'secondary';
  }
  
  function showLoading(show) {
    const loading = document.getElementById('loading');
    if (show) {
      loading.classList.add('show');
    } else {
      loading.classList.remove('show');
    }
  }
  
  function showAlert(message, type = 'info') {
    const alert = document.getElementById('alert');
    alert.className = `alert ${type} show`;
    alert.innerHTML = `
      <span>ğŸ“¢</span>
      <span>${message}</span>
      <button style="margin-left: auto; background: none; border: none; font-size: 18px; cursor: pointer;" onclick="hideAlert()">&times;</button>
    `;
    
    // è‡ªå‹•éš±è—
    setTimeout(() => {
      hideAlert();
    }, 5000);
  }
  
  function hideAlert() {
    document.getElementById('alert').classList.remove('show');
  }
  
  function updatePagination(section, totalPages, currentPage) {
    const paginationContainer = document.getElementById(section + '-pagination');
    if (!paginationContainer) return;
    
    let html = '';
    
    // ä¸Šä¸€é 
    html += `<button ${currentPage <= 1 ? 'disabled' : ''} onclick="loadPage${section.charAt(0).toUpperCase() + section.slice(1)}Data(${currentPage - 1})">ä¸Šä¸€é </button>`;
    
    // é ç¢¼
    const startPage = Math.max(1, currentPage - 2);
    const endPage = Math.min(totalPages, currentPage + 2);
    
    for (let i = startPage; i <= endPage; i++) {
      html += `<button class="${i === currentPage ? 'active' : ''}" onclick="loadPage${section.charAt(0).toUpperCase() + section.slice(1)}Data(${i})">${i}</button>`;
    }
    
    // ä¸‹ä¸€é 
    html += `<button ${currentPage >= totalPages ? 'disabled' : ''} onclick="loadPage${section.charAt(0).toUpperCase() + section.slice(1)}Data(${currentPage + 1})">ä¸‹ä¸€é </button>`;
    
    paginationContainer.innerHTML = html;
  }
  
  // åˆ†é è¼‰å…¥å‡½æ•¸åˆ¥å
  function loadPageMembersData(page) { loadMembersData(page); }
  function loadPageEventsData(page) { loadEventsData(page); }
  function loadPageHealthData(page) { loadHealthData(page); }
  function loadPageDonationsData(page) { loadDonationsData(page); }
  
  // ========== å½ˆçª—æ§åˆ¶ ==========
  function showAddMemberModal() {
    document.getElementById('add-member-modal').classList.add('show');
    // æ¸…ç©ºè¡¨å–®
    document.getElementById('add-member-modal').querySelectorAll('input, select, textarea').forEach(input => {
      input.value = '';
    });
  }
  
  function showAddEventModal() {
    document.getElementById('add-event-modal').classList.add('show');
    // æ¸…ç©ºè¡¨å–®ä¸¦è¨­å®šé è¨­å€¼
    document.getElementById('add-event-modal').querySelectorAll('input, select, textarea').forEach(input => {
      if (input.type === 'date') {
        input.value = new Date().toISOString().split('T')[0];
      } else if (input.id === 'event-max-participants') {
        input.value = '30';
      } else if (input.id === 'event-fee') {
        input.value = '0';
      } else {
        input.value = '';
      }
    });
  }
  
  function showAddDonationModal() {
    document.getElementById('add-donation-modal').classList.add('show');
    // æ¸…ç©ºè¡¨å–®ä¸¦è¨­å®šä»Šæ—¥æ—¥æœŸ
    document.getElementById('add-donation-modal').querySelectorAll('input, select, textarea').forEach(input => {
      if (input.type === 'date') {
        input.value = new Date().toISOString().split('T')[0];
      } else {
        input.value = '';
      }
    });
  }
  
  function showAddAdminModal() {
    document.getElementById('add-admin-modal').classList.add('show');
    // æ¸…ç©ºè¡¨å–®
    document.getElementById('add-admin-modal').querySelectorAll('input, select').forEach(input => {
      input.value = '';
    });
  }
  
  function closeModal(modalId) {
    document.getElementById(modalId).classList.remove('show');
  }
  
  // é»æ“Šå½ˆçª—èƒŒæ™¯é—œé–‰
  document.addEventListener('click', function(e) {
    if (e.target.classList.contains('modal')) {
      e.target.classList.remove('show');
    }
  });
  
  // ========== è¡¨å–®æäº¤ ==========
  async function saveMember(event) {
    event.preventDefault();
    
    const memberData = {
      action: 'addMember',
      name: document.getElementById('member-name').value,
      memberNo: document.getElementById('member-no').value,
      email: document.getElementById('member-email').value,
      phone: document.getElementById('member-phone').value,
      gender: document.getElementById('member-gender').value,
      birthday: document.getElementById('member-birthday').value,
      address: document.getElementById('member-address').value,
      notes: document.getElementById('member-notes').value
    };
    
    const result = await callAPI(memberData);
    
    if (result.success) {
      showAlert('æœƒå“¡æ–°å¢æˆåŠŸï¼', 'success');
      closeModal('add-member-modal');
      loadMembersData(); // é‡æ–°è¼‰å…¥æœƒå“¡åˆ—è¡¨
    } else {
      showAlert('æ–°å¢å¤±æ•—ï¼š' + result.message, 'error');
    }
  }
  
  async function saveEvent(event) {
    event.preventDefault();
    
    const eventData = {
      action: 'addEvent',
      eventName: document.getElementById('event-name').value,
      eventType: document.getElementById('event-type').value,
      eventDate: document.getElementById('event-date').value,
      startTime: document.getElementById('event-start-time').value,
      endTime: document.getElementById('event-end-time').value,
      location: document.getElementById('event-location').value,
      description: document.getElementById('event-description').value,
      maxParticipants: document.getElementById('event-max-participants').value,
      fee: document.getElementById('event-fee').value
    };
    
    const result = await callAPI(eventData);
    
    if (result.success) {
      showAlert('æ´»å‹•æ–°å¢æˆåŠŸï¼', 'success');
      closeModal('add-event-modal');
      loadEventsData(); // é‡æ–°è¼‰å…¥æ´»å‹•åˆ—è¡¨
    } else {
      showAlert('æ–°å¢å¤±æ•—ï¼š' + result.message, 'error');
    }
  }
  
  async function saveDonation(event) {
    event.preventDefault();
    
    const donationData = {
      action: 'addDonation',
      donorName: document.getElementById('donation-donor-name').value,
      amount: document.getElementById('donation-amount').value,
      donationType: document.getElementById('donation-type').value,
      donationDate: document.getElementById('donation-date').value,
      paymentMethod: document.getElementById('donation-payment-method').value,
      phone: document.getElementById('donation-phone').value,
      purpose: document.getElementById('donation-purpose').value
    };
    
    const result = await callAPI(donationData);
    
    if (result.success) {
      showAlert('ææ¬¾è¨˜éŒ„æ–°å¢æˆåŠŸï¼', 'success');
      closeModal('add-donation-modal');
      loadDonationsData(); // é‡æ–°è¼‰å…¥ææ¬¾åˆ—è¡¨
    } else {
      showAlert('æ–°å¢å¤±æ•—ï¼š' + result.message, 'error');
    }
  }
  
  async function saveAdmin(event) {
    event.preventDefault();
    
    const password = document.getElementById('admin-password').value;
    const confirmPassword = document.getElementById('admin-password-confirm').value;
    
    if (password !== confirmPassword) {
      showAlert('å¯†ç¢¼èˆ‡ç¢ºèªå¯†ç¢¼ä¸ç¬¦ï¼', 'error');
      return;
    }
    
    const adminData = {
      action: 'addAdmin',
      name: document.getElementById('admin-name-input').value,
      email: document.getElementById('admin-email').value,
      password: password,
      role: document.getElementById('admin-role').value,
      phone: document.getElementById('admin-phone').value
    };
    
    const result = await callAPI(adminData);
    
    if (result.success) {
      showAlert('ç®¡ç†å“¡æ–°å¢æˆåŠŸï¼', 'success');
      closeModal('add-admin-modal');
      loadSettings(); // é‡æ–°è¼‰å…¥è¨­å®šé é¢
    } else {
      showAlert('æ–°å¢å¤±æ•—ï¼š' + result.message, 'error');
    }
  }
  
  // ========== æœå°‹åŠŸèƒ½ ==========
  function searchMembers() {
    loadMembersData(1);
  }
  
  function searchEvents() {
    loadEventsData(1);
  }
  
  function searchHealthRecords() {
    loadHealthData(1);
  }
  
  function searchDonations() {
    loadDonationsData(1);
  }
  
  // ========== å€‹åˆ¥æ“ä½œ ==========
  async function viewMember(memberId) {
    showAlert('æŸ¥çœ‹æœƒå“¡åŠŸèƒ½é–‹ç™¼ä¸­...', 'info');
  }
  
  async function editMember(memberId) {
    showAlert('ç·¨è¼¯æœƒå“¡åŠŸèƒ½é–‹ç™¼ä¸­...', 'info');
  }
  
  async function deleteMember(memberId) {
    if (!confirm('ç¢ºå®šè¦åˆªé™¤æ­¤æœƒå“¡å—ï¼Ÿæ­¤æ“ä½œç„¡æ³•å¾©åŸã€‚')) return;
    
    const result = await callAPI({
      action: 'deleteMember',
      memberId: memberId
    });
    
    if (result.success) {
      showAlert('æœƒå“¡åˆªé™¤æˆåŠŸï¼', 'success');
      loadMembersData();
    } else {
      showAlert('åˆªé™¤å¤±æ•—ï¼š' + result.message, 'error');
    }
  }
  
  async function viewEvent(eventId) {
    showAlert('æŸ¥çœ‹æ´»å‹•åŠŸèƒ½é–‹ç™¼ä¸­...', 'info');
  }
  
  async function editEvent(eventId) {
    showAlert('ç·¨è¼¯æ´»å‹•åŠŸèƒ½é–‹ç™¼ä¸­...', 'info');
  }
  
  async function deleteEvent(eventId) {
    if (!confirm('ç¢ºå®šè¦åˆªé™¤æ­¤æ´»å‹•å—ï¼Ÿæ­¤æ“ä½œç„¡æ³•å¾©åŸã€‚')) return;
    
    const result = await callAPI({
      action: 'deleteEvent',
      eventId: eventId
    });
    
    if (result.success) {
      showAlert('æ´»å‹•åˆªé™¤æˆåŠŸï¼', 'success');
      loadEventsData();
    } else {
      showAlert('åˆªé™¤å¤±æ•—ï¼š' + result.message, 'error');
    }
  }
  
  async function viewHealthRecord(recordId) {
    showAlert('æŸ¥çœ‹å¥åº·è¨˜éŒ„åŠŸèƒ½é–‹ç™¼ä¸­...', 'info');
  }
  
  async function deleteHealthRecord(recordId) {
    if (!confirm('ç¢ºå®šè¦åˆªé™¤æ­¤å¥åº·è¨˜éŒ„å—ï¼Ÿæ­¤æ“ä½œç„¡æ³•å¾©åŸã€‚')) return;
    
    const result = await callAPI({
      action: 'deleteHealthRecord',
      recordId: recordId
    });
    
    if (result.success) {
      showAlert('å¥åº·è¨˜éŒ„åˆªé™¤æˆåŠŸï¼', 'success');
      loadHealthData();
    } else {
      showAlert('åˆªé™¤å¤±æ•—ï¼š' + result.message, 'error');
    }
  }
  
  async function viewDonation(donationId) {
    showAlert('æŸ¥çœ‹ææ¬¾è¨˜éŒ„åŠŸèƒ½é–‹ç™¼ä¸­...', 'info');
  }
  
  async function editDonation(donationId) {
    showAlert('ç·¨è¼¯ææ¬¾è¨˜éŒ„åŠŸèƒ½é–‹ç™¼ä¸­...', 'info');
  }
  
  async function deleteDonation(donationId) {
    if (!confirm('ç¢ºå®šè¦åˆªé™¤æ­¤ææ¬¾è¨˜éŒ„å—ï¼Ÿæ­¤æ“ä½œç„¡æ³•å¾©åŸã€‚')) return;
    
    const result = await callAPI({
      action: 'deleteDonation',
      donationId: donationId
    });
    
    if (result.success) {
      showAlert('ææ¬¾è¨˜éŒ„åˆªé™¤æˆåŠŸï¼', 'success');
      loadDonationsData();
    } else {
      showAlert('åˆªé™¤å¤±æ•—ï¼š' + result.message, 'error');
    }
  }
  
  async function editAdmin(adminId) {
    showAlert('ç·¨è¼¯ç®¡ç†å“¡åŠŸèƒ½é–‹ç™¼ä¸­...', 'info');
  }
  
  // ========== åŒ¯å‡ºåŠŸèƒ½ ==========
  async function exportMembers() {
    try {
      showLoading(true);
      const result = await callAPI({ action: 'exportMembers' });
      
      if (result.success) {
        // å‰µå»ºä¸‹è¼‰é€£çµ
        const blob = new Blob([result.data], { type: 'text/csv;charset=utf-8;' });
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        link.download = `æœƒå“¡è³‡æ–™_${new Date().toISOString().split('T')[0]}.csv`;
        link.click();
        
        showAlert('æœƒå“¡è³‡æ–™åŒ¯å‡ºæˆåŠŸï¼', 'success');
      } else {
        showAlert('åŒ¯å‡ºå¤±æ•—ï¼š' + result.message, 'error');
      }
    } catch (error) {
      showAlert('åŒ¯å‡ºå¤±æ•—ï¼š' + error.message, 'error');
    } finally {
      showLoading(false);
    }
  }
  
  async function exportHealthData() {
    try {
      showLoading(true);
      const result = await callAPI({ action: 'exportHealthData' });
      
      if (result.success) {
        const blob = new Blob([result.data], { type: 'text/csv;charset=utf-8;' });
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        link.download = `å¥åº·è¨˜éŒ„_${new Date().toISOString().split('T')[0]}.csv`;
        link.click();
        
        showAlert('å¥åº·è¨˜éŒ„åŒ¯å‡ºæˆåŠŸï¼', 'success');
      } else {
        showAlert('åŒ¯å‡ºå¤±æ•—ï¼š' + result.message, 'error');
      }
    } catch (error) {
      showAlert('åŒ¯å‡ºå¤±æ•—ï¼š' + error.message, 'error');
    } finally {
      showLoading(false);
    }
  }
  
  async function exportDonations() {
    try {
      showLoading(true);
      const result = await callAPI({ action: 'exportDonations' });
      
      if (result.success) {
        const blob = new Blob([result.data], { type: 'text/csv;charset=utf-8;' });
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        link.download = `ææ¬¾è¨˜éŒ„_${new Date().toISOString().split('T')[0]}.csv`;
        link.click();
        
        showAlert('ææ¬¾è¨˜éŒ„åŒ¯å‡ºæˆåŠŸï¼', 'success');
      } else {
        showAlert('åŒ¯å‡ºå¤±æ•—ï¼š' + result.message, 'error');
      }
    } catch (error) {
      showAlert('åŒ¯å‡ºå¤±æ•—ï¼š' + error.message, 'error');
    } finally {
      showLoading(false);
    }
  }
  
  async function exportAllReports() {
    try {
      showLoading(true);
      const result = await callAPI({ action: 'exportAllReports' });
      
      if (result.success) {
        const blob = new Blob([result.data], { type: 'application/zip' });
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        link.download = `çµ±è¨ˆå ±è¡¨_${new Date().toISOString().split('T')[0]}.zip`;
        link.click();
        
        showAlert('çµ±è¨ˆå ±è¡¨åŒ¯å‡ºæˆåŠŸï¼', 'success');
      } else {
        showAlert('åŒ¯å‡ºå¤±æ•—ï¼š' + result.message, 'error');
      }
    } catch (error) {
      showAlert('åŒ¯å‡ºå¤±æ•—ï¼š' + error.message, 'error');
    } finally {
      showLoading(false);
    }
  }
  
  // ========== ç³»çµ±è¨­å®š ==========
  function loadSettings() {
    // è¼‰å…¥å„²å­˜çš„è¨­å®š
    document.getElementById('api-url').value = localStorage.getItem('admin_API_URL') || '';
    document.getElementById('system-title').value = localStorage.getItem('admin_system_title') || 'å¸•é‡‘æ£®å”æœƒç®¡ç†ç³»çµ±';
    document.getElementById('page-size').value = localStorage.getItem('admin_page_size') || '20';
    document.getElementById('backup-interval').value = localStorage.getItem('admin_backup_interval') || '24';
    document.getElementById('system-announcement').value = localStorage.getItem('admin_system_announcement') || '';
  }
  
  function saveSettings() {
    // å„²å­˜è¨­å®šåˆ° localStorage
    const apiUrl = document.getElementById('api-url').value;
    const systemTitle = document.getElementById('system-title').value;
    const pageSizeValue = document.getElementById('page-size').value;
    const backupInterval = document.getElementById('backup-interval').value;
    const systemAnnouncement = document.getElementById('system-announcement').value;
    
    localStorage.setItem('admin_API_URL', apiUrl);
    localStorage.setItem('admin_system_title', systemTitle);
    localStorage.setItem('admin_page_size', pageSizeValue);
    localStorage.setItem('admin_backup_interval', backupInterval);
    localStorage.setItem('admin_system_announcement', systemAnnouncement);
    
    // æ›´æ–°å…¨åŸŸè®Šæ•¸
    API_URL = apiUrl;
    pageSize = parseInt(pageSizeValue);
    
    showAlert('è¨­å®šå„²å­˜æˆåŠŸï¼', 'success');
  }
  
  async function exportData() {
    try {
      showLoading(true);
      const result = await callAPI({ action: 'exportAllData' });
      
      if (result.success) {
        const blob = new Blob([result.data], { type: 'application/json' });
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        link.download = `ç³»çµ±è³‡æ–™å‚™ä»½_${new Date().toISOString().split('T')[0]}.json`;
        link.click();
        
        showAlert('è³‡æ–™åŒ¯å‡ºæˆåŠŸï¼', 'success');
      } else {
        showAlert('åŒ¯å‡ºå¤±æ•—ï¼š' + result.message, 'error');
      }
    } catch (error) {
      showAlert('åŒ¯å‡ºå¤±æ•—ï¼š' + error.message, 'error');
    } finally {
      showLoading(false);
    }
  }
  
  async function backupData() {
    try {
      showLoading(true);
      const result = await callAPI({ action: 'backupData' });
      
      if (result.success) {
        showAlert('è³‡æ–™å‚™ä»½æˆåŠŸï¼', 'success');
      } else {
        showAlert('å‚™ä»½å¤±æ•—ï¼š' + result.message, 'error');
      }
    } catch (error) {
      showAlert('å‚™ä»½å¤±æ•—ï¼š' + error.message, 'error');
    } finally {
      showLoading(false);
    }
  }
  
  function clearCache() {
    if (!confirm('ç¢ºå®šè¦æ¸…é™¤æ‰€æœ‰å¿«å–å—ï¼Ÿæ­¤æ“ä½œæœƒæ¸…é™¤å·²å„²å­˜çš„è¨­å®šã€‚')) return;
    
    // ä¿ç•™å¿…è¦çš„ç™»å…¥è³‡è¨Š
    const adminInfo = localStorage.getItem('adminInfo');
    
    // æ¸…é™¤æ‰€æœ‰ localStorage
    localStorage.clear();
    
    // æ¢å¾©ç™»å…¥è³‡è¨Š
    if (adminInfo) {
      localStorage.setItem('adminInfo', adminInfo);
    }
    
    showAlert('å¿«å–æ¸…é™¤æˆåŠŸï¼è«‹é‡æ–°è¨­å®šç³»çµ±åƒæ•¸ã€‚', 'success');
    
    // é‡æ–°è¼‰å…¥è¨­å®š
    loadSettings();
  }
  
  // ========== ç™»å‡ºåŠŸèƒ½ ==========
  function logout() {
    if (!confirm('ç¢ºå®šè¦ç™»å‡ºå—ï¼Ÿ')) return;
    
    // æ¸…é™¤ç™»å…¥è³‡è¨Š
    localStorage.removeItem('adminInfo');
    
    // è·³è½‰åˆ°ç™»å…¥é é¢
    alert('å·²æˆåŠŸç™»å‡ºï¼');
    window.location.href = 'admin-login.html';
  }
  
  // ========== éµç›¤å¿«æ·éµ ==========
  document.addEventListener('keydown', function(e) {
    // ESC é—œé–‰å½ˆçª—
    if (e.key === 'Escape') {
      document.querySelectorAll('.modal.show').forEach(modal => {
        modal.classList.remove('show');
      });
    }
    
    // Ctrl+S å„²å­˜è¨­å®š (åœ¨è¨­å®šé é¢)
    if (e.ctrlKey && e.key === 's' && currentSection === 'settings') {
      e.preventDefault();
      saveSettings();
    }
  });
  
  // ========== è‡ªå‹•é‡æ–°æ•´ç† ==========
  setInterval(() => {
    // æ¯ 5 åˆ†é˜è‡ªå‹•é‡æ–°è¼‰å…¥ç•¶å‰é é¢è³‡æ–™
    if (currentSection === 'dashboard') {
      loadDashboardData();
    }
  }, 5 * 60 * 1000);
  
  // ========== éŒ¯èª¤è™•ç† ==========
  window.addEventListener('error', function(e) {
    console.error('å…¨åŸŸéŒ¯èª¤:', e.error);
    showAlert('ç³»çµ±ç™¼ç”ŸéŒ¯èª¤ï¼Œè«‹é‡æ–°æ•´ç†é é¢', 'error');
  });
  
  window.addEventListener('unhandledrejection', function(e) {
    console.error('æœªè™•ç†çš„ Promise éŒ¯èª¤:', e.reason);
    showAlert('ç³»çµ±ç™¼ç”ŸéŒ¯èª¤ï¼Œè«‹æª¢æŸ¥ç¶²è·¯é€£ç·š', 'error');
  });
</script>
</body>
</html>
