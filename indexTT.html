<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kæ­Œå ±åç³»çµ±</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Microsoft JhengHei', Arial, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }
    
    .page {
      display: none;
    }
    
    .page.active {
      display: block;
    }
    
    .container {
      max-width: 1400px;
      margin: 0 auto;
      background: white;
      border-radius: 15px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      overflow: hidden;
      animation: fadeIn 0.5s;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .header {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      color: white;
      padding: 40px;
      text-align: center;
    }
    
    .header h1 {
      font-size: 2.5em;
      margin-bottom: 10px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
    }
    
    .header p {
      font-size: 1.2em;
      opacity: 0.95;
    }
    
    .nav-buttons {
      display: flex;
      justify-content: center;
      gap: 15px;
      flex-wrap: wrap;
      margin-top: 20px;
    }
    
    .nav-btn {
      padding: 12px 30px;
      background: white;
      color: #667eea;
      border: none;
      border-radius: 25px;
      cursor: pointer;
      font-weight: 600;
      font-size: 1em;
      transition: all 0.3s;
    }
    
    .nav-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    }
    
    .content {
      padding: 40px;
    }
    
    /* é¦–é æ¨£å¼ */
    .event-banner {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 30px;
      border-radius: 15px;
      margin-bottom: 40px;
    }
    
    .event-banner h2 {
      font-size: 2em;
      margin-bottom: 20px;
    }
    
    .event-details {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }
    
    .detail-item {
      background: rgba(255,255,255,0.2);
      padding: 20px;
      border-radius: 10px;
      backdrop-filter: blur(10px);
    }
    
    .detail-item .icon {
      font-size: 2em;
      margin-bottom: 10px;
    }
    
    .detail-item strong {
      display: block;
      margin-bottom: 5px;
      opacity: 0.9;
    }
    
    .detail-item .value {
      font-size: 1.3em;
      font-weight: bold;
    }
    
    .action-cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 30px;
      margin-top: 40px;
    }
    
    .action-card {
      background: white;
      border-radius: 15px;
      padding: 40px;
      text-align: center;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
      transition: transform 0.3s, box-shadow 0.3s;
      cursor: pointer;
    }
    
    .action-card:hover {
      transform: translateY(-10px);
      box-shadow: 0 20px 40px rgba(0,0,0,0.2);
    }
    
    .action-card .icon {
      font-size: 4em;
      margin-bottom: 20px;
    }
    
    .action-card h3 {
      color: #333;
      margin-bottom: 15px;
      font-size: 1.5em;
    }
    
    .action-card p {
      color: #666;
      margin-bottom: 25px;
      line-height: 1.6;
    }
    
    .action-card .btn {
      display: inline-block;
      padding: 12px 30px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border-radius: 25px;
      font-weight: 600;
    }
    
    /* è¡¨å–®æ¨£å¼ */
    .form-group {
      margin-bottom: 25px;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: #333;
    }
    
    .form-group .required {
      color: #f5576c;
    }
    
    .form-group input,
    .form-group select,
    .form-group textarea {
      width: 100%;
      padding: 12px 15px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 1em;
      transition: border-color 0.3s;
      font-family: inherit;
    }
    
    .form-group input:focus,
    .form-group select:focus,
    .form-group textarea:focus {
      outline: none;
      border-color: #667eea;
    }
    
    .form-group textarea {
      resize: vertical;
      min-height: 80px;
    }
    
    .radio-group {
      display: flex;
      gap: 20px;
    }
    
    .radio-group label {
      display: flex;
      align-items: center;
      font-weight: normal;
      cursor: pointer;
    }
    
    .radio-group input[type="radio"] {
      width: auto;
      margin-right: 8px;
    }
    
    .song-section {
      background: #f8f9fa;
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 20px;
    }
    
    .song-section h3 {
      color: #667eea;
      margin-bottom: 15px;
    }
    
    .submit-btn {
      width: 100%;
      padding: 15px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 10px;
      font-size: 1.2em;
      font-weight: 600;
      cursor: pointer;
      transition: transform 0.3s, box-shadow 0.3s;
    }
    
    .submit-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 20px rgba(102, 126, 234, 0.4);
    }
    
    .submit-btn:disabled {
      background: #ccc;
      cursor: not-allowed;
      transform: none;
    }
    
    .note {
      background: #fff3e0;
      padding: 15px;
      border-left: 4px solid #ff9800;
      margin-bottom: 20px;
      border-radius: 5px;
    }
    
    .note strong {
      color: #e65100;
    }
    
    .alert {
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 20px;
      display: none;
    }
    
    .alert.success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
      display: block;
    }
    
    .alert.error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
      display: block;
    }
    
    .loading {
      display: none;
      text-align: center;
      padding: 20px;
    }
    
    .loading.active {
      display: block;
    }
    
    .spinner {
      border: 4px solid #f3f3f3;
      border-top: 4px solid #667eea;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 0 auto;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    /* å ±åæˆåŠŸé é¢æ¨£å¼ */
    .success-container {
      text-align: center;
      padding: 40px 20px;
    }
    
    .success-icon {
      font-size: 5em;
      margin-bottom: 20px;
      animation: bounceIn 0.8s;
    }
    
    @keyframes bounceIn {
      0% { transform: scale(0); opacity: 0; }
      50% { transform: scale(1.2); }
      100% { transform: scale(1); opacity: 1; }
    }
    
    .success-message {
      font-size: 2em;
      color: #4caf50;
      font-weight: bold;
      margin-bottom: 10px;
    }
    
    .success-subtitle {
      font-size: 1.2em;
      color: #666;
      margin-bottom: 40px;
    }
    
    .registration-summary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 30px;
      border-radius: 15px;
      margin-bottom: 40px;
      text-align: left;
    }
    
    .registration-summary h3 {
      font-size: 1.8em;
      margin-bottom: 20px;
      text-align: center;
    }
    
    .summary-item {
      background: rgba(255,255,255,0.2);
      padding: 15px;
      border-radius: 10px;
      margin-bottom: 15px;
      backdrop-filter: blur(10px);
    }
    
    .summary-item strong {
      display: block;
      margin-bottom: 5px;
      font-size: 0.9em;
      opacity: 0.9;
    }
    
    .summary-item .value {
      font-size: 1.2em;
      font-weight: bold;
    }
    
    .registration-cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 25px;
      margin-bottom: 40px;
    }
    
    .reg-card {
      background: white;
      border-radius: 15px;
      padding: 25px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
      transition: transform 0.3s, box-shadow 0.3s;
      animation: slideInUp 0.5s ease-out;
      animation-fill-mode: both;
    }
    
    .reg-card:nth-child(1) { animation-delay: 0.1s; }
    .reg-card:nth-child(2) { animation-delay: 0.2s; }
    .reg-card:nth-child(3) { animation-delay: 0.3s; }
    .reg-card:nth-child(4) { animation-delay: 0.4s; }
    
    @keyframes slideInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    .reg-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 40px rgba(0,0,0,0.15);
    }
    
    .reg-card-header {
      display: flex;
      align-items: center;
      margin-bottom: 15px;
      padding-bottom: 15px;
      border-bottom: 2px solid #f0f0f0;
    }
    
    .reg-card-icon {
      font-size: 2.5em;
      margin-right: 15px;
    }
    
    .reg-card-title {
      flex: 1;
    }
    
    .reg-card-title h4 {
      color: #333;
      font-size: 1.3em;
      margin-bottom: 5px;
    }
    
    .reg-card-title .subtitle {
      color: #999;
      font-size: 0.9em;
    }
    
    .reg-card-body {
      color: #666;
      line-height: 1.8;
    }
    
    .reg-card-body .info-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 10px;
    }
    
    .reg-card-body .label {
      color: #999;
    }
    
    .reg-card-body .value {
      font-weight: 600;
      color: #333;
    }
    
    .song-list {
      background: #f8f9fa;
      padding: 15px;
      border-radius: 10px;
      margin-top: 15px;
    }
    
    .song-list h5 {
      color: #667eea;
      margin-bottom: 10px;
      font-size: 1.1em;
    }
    
    .song-list ol {
      margin-left: 20px;
    }
    
    .song-list li {
      margin-bottom: 8px;
      color: #555;
    }
    
    .all-registrations {
      margin-top: 50px;
    }
    
    .all-registrations h3 {
      color: #667eea;
      font-size: 2em;
      margin-bottom: 30px;
      text-align: center;
    }
    
    .registrants-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    
    .registrant-card {
      background: white;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.08);
      transition: all 0.3s;
      border-left: 4px solid #667eea;
      animation: fadeInCard 0.5s ease-out;
      animation-fill-mode: both;
    }
    
    .registrant-card:nth-child(1) { animation-delay: 0.1s; }
    .registrant-card:nth-child(2) { animation-delay: 0.2s; }
    .registrant-card:nth-child(3) { animation-delay: 0.3s; }
    .registrant-card:nth-child(4) { animation-delay: 0.4s; }
    .registrant-card:nth-child(5) { animation-delay: 0.5s; }
    .registrant-card:nth-child(6) { animation-delay: 0.6s; }
    
    @keyframes fadeInCard {
      from {
        opacity: 0;
        transform: translateX(-20px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }
    
    .registrant-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.12);
    }
    
    .registrant-header {
      display: flex;
      align-items: center;
      margin-bottom: 12px;
    }
    
    .registrant-number {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      width: 35px;
      height: 35px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      margin-right: 12px;
      font-size: 0.9em;
    }
    
    .registrant-name {
      font-size: 1.2em;
      font-weight: bold;
      color: #333;
    }
    
    .registrant-info {
      font-size: 0.9em;
      color: #666;
      line-height: 1.6;
    }
    
    .registrant-info div {
      margin-bottom: 5px;
    }
    
    .gender-badge {
      display: inline-block;
      padding: 3px 10px;
      border-radius: 12px;
      font-size: 0.85em;
      font-weight: 600;
      margin-left: 5px;
    }
    
    .gender-male {
      background: #e3f2fd;
      color: #1976d2;
    }
    
    .gender-female {
      background: #fce4ec;
      color: #c2185b;
    }
    
    .lunch-badge {
      display: inline-block;
      padding: 3px 10px;
      border-radius: 12px;
      font-size: 0.85em;
      font-weight: 600;
      background: #fff3e0;
      color: #e65100;
    }
    
    /* è¡¨æ ¼æ¨£å¼ */
    .table-container {
      overflow-x: auto;
      margin-top: 20px;
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
      background: white;
    }
    
    thead {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }
    
    th {
      padding: 15px;
      text-align: left;
      font-weight: 600;
    }
    
    td {
      padding: 12px 15px;
      border-bottom: 1px solid #f0f0f0;
    }
    
    tbody tr:hover {
      background: #f8f9ff;
    }
    
    .badge {
      display: inline-block;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 0.85em;
      font-weight: 600;
    }
    
    .badge-male {
      background: #e3f2fd;
      color: #1976d2;
    }
    
    .badge-female {
      background: #fce4ec;
      color: #c2185b;
    }
    
    .badge-duet {
      background: #f3e5f5;
      color: #7b1fa2;
    }
    
    .badge-live {
      background: #fff3e0;
      color: #e65100;
    }
    
    .singer-tag {
      background: #e8eaf6;
      color: #3f51b5;
      padding: 4px 10px;
      border-radius: 5px;
      font-weight: 600;
    }
    
    .controls {
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
      margin-bottom: 20px;
    }
    
    .controls input,
    .controls select {
      flex: 1;
      min-width: 200px;
      padding: 10px 15px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 1em;
    }
    
    .controls button {
      padding: 10px 20px;
      background: #667eea;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1em;
      transition: background 0.3s;
    }
    
    .controls button:hover {
      background: #5568d3;
    }
    
    .stats-bar {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    
    .stat-card {
      background: white;
      padding: 20px;
      border-radius: 10px;
      text-align: center;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
    
    .stat-card .number {
      font-size: 2.5em;
      font-weight: bold;
      color: #667eea;
      margin-bottom: 5px;
    }
    
    .stat-card .label {
      color: #666;
      font-size: 0.95em;
    }
    
    .no-results {
      text-align: center;
      padding: 50px;
      color: #999;
      font-size: 1.2em;
    }
    
    .youtube-link {
      color: #667eea;
      text-decoration: none;
      font-weight: 600;
    }
    
    .youtube-link:hover {
      text-decoration: underline;
    }
    
    /* ç®¡ç†å¾Œå°æ¨£å¼ */
    .tabs {
      display: flex;
      background: #f8f9fa;
      border-bottom: 2px solid #e0e0e0;
    }
    
    .tab {
      flex: 1;
      padding: 20px;
      text-align: center;
      cursor: pointer;
      font-weight: 600;
      color: #666;
      transition: all 0.3s;
      border-bottom: 3px solid transparent;
    }
    
    .tab:hover {
      background: #e8eaf6;
      color: #667eea;
    }
    
    .tab.active {
      background: white;
      color: #667eea;
      border-bottom-color: #667eea;
    }
    
    .tab-content {
      display: none;
      padding: 30px;
    }
    
    .tab-content.active {
      display: block;
    }
    
    .dashboard-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    
    .dashboard-card {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 30px;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    }
    
    .dashboard-card .icon {
      font-size: 2.5em;
      margin-bottom: 15px;
    }
    
    .dashboard-card .number {
      font-size: 2.5em;
      font-weight: bold;
      margin-bottom: 10px;
    }
    
    .dashboard-card .label {
      font-size: 1em;
      opacity: 0.9;
    }
    
    .action-buttons {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-bottom: 30px;
    }
    
    .action-btn {
      padding: 15px 20px;
      background: #667eea;
      color: white;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      font-weight: 600;
      font-size: 1em;
      transition: all 0.3s;
    }
    
    .action-btn:hover {
      background: #5568d3;
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
    }
    
    .action-btn.success {
      background: #4caf50;
    }
    
    .action-btn.success:hover {
      background: #45a049;
    }
    
    .progress-bar {
      background: #e0e0e0;
      border-radius: 10px;
      overflow: hidden;
      height: 30px;
      margin: 10px 0;
    }
    
    .progress-fill {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 600;
      transition: width 0.5s;
    }
    
    @media (max-width: 768px) {
      .header h1 {
        font-size: 1.8em;
      }
      
      .content {
        padding: 20px;
      }
      
      .action-cards {
        grid-template-columns: 1fr;
      }
      
      .registration-cards {
        grid-template-columns: 1fr;
      }
      
      .registrants-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <!-- é¦–é  -->
  <div id="homePage" class="page active">
    <div class="container">
      <div class="header">
        <h1>ğŸ¤ è¡—é ­Kæ­Œå ±åç³»çµ±</h1>
        <p>æ­¡è¿ä¾†åˆ°æœ€å°ˆæ¥­çš„Kæ­Œæ´»å‹•ç®¡ç†å¹³å°</p>
      </div>
      
      <div class="content">
        <div class="event-banner">
          <h2>ğŸ“… å³å°‡èˆ‰è¡Œçš„æ´»å‹•</h2>
          <div class="event-details">
            <div class="detail-item">
              <div class="icon">ğŸ“…</div>
              <strong>æ´»å‹•æ—¥æœŸ</strong>
              <div class="value" id="homeEventDate">è¼‰å…¥ä¸­...</div>
            </div>
            <div class="detail-item">
              <div class="icon">â°</div>
              <strong>æ´»å‹•æ™‚é–“</strong>
              <div class="value" id="homeEventTime">è¼‰å…¥ä¸­...</div>
            </div>
            <div class="detail-item">
              <div class="icon">ğŸ“</div>
              <strong>æ´»å‹•åœ°é»</strong>
              <div class="value" id="homeEventLocation">è¼‰å…¥ä¸­...</div>
            </div>
            <div class="detail-item">
              <div class="icon">ğŸ‘¥</div>
              <strong>å ±åç‹€æ…‹</strong>
              <div class="value" id="homeEventStatus">è¼‰å…¥ä¸­...</div>
            </div>
          </div>
        </div>
        
        <div class="action-cards">
          <div class="action-card" onclick="showPage('register')">
            <div class="icon">ğŸ“</div>
            <h3>æˆ‘è¦å ±å</h3>
            <p>ç«‹å³å ±ååƒåŠ Kæ­Œæ´»å‹•ï¼Œå±•ç¾ä½ çš„æ­Œå–‰ï¼Œèˆ‡æœ‹å‹å€‘ä¸€èµ·äº«å—éŸ³æ¨‚çš„æ¨‚è¶£ï¼</p>
            <span class="btn">ç«‹å³å ±å</span>
          </div>
          
          <div class="action-card" onclick="showPage('view')">
            <div class="icon">ğŸµ</div>
            <h3>æŸ¥çœ‹æ­Œå–®</h3>
            <p>ç€è¦½å®Œæ•´çš„æ¼”å”±æ­Œå–®ï¼ŒæŸ¥çœ‹æ‰€æœ‰åƒèˆ‡æ­Œæ‰‹çš„æ›²ç›®å®‰æ’ã€‚</p>
            <span class="btn">æŸ¥çœ‹æ­Œå–®</span>
          </div>
          
          <div class="action-card" onclick="showPage('admin')">
            <div class="icon">âš™ï¸</div>
            <h3>ç®¡ç†å¾Œå°</h3>
            <p>ç®¡ç†å“¡å°ˆç”¨å…¥å£ï¼Œç®¡ç†å ±åè³‡æ–™ã€ç·¨è¼¯æ­Œå–®ã€ç™¼é€é€šçŸ¥ã€‚</p>
            <span class="btn">é€²å…¥å¾Œå°</span>
          </div>
        </div>
        
        <div class="stats-bar" style="margin-top: 40px;">
          <div class="stat-card">
            <div class="number" id="homeTotalReg">0</div>
            <div class="label">ç¸½å ±åäººæ•¸</div>
          </div>
          <div class="stat-card">
            <div class="number" id="homeTotalSongs">0</div>
            <div class="label">æ¼”å”±æ­Œæ›²æ•¸</div>
          </div>
          <div class="stat-card">
            <div class="number" id="homeLunchCount">0</div>
            <div class="label">åˆé¤é è¨‚</div>
          </div>
          <div class="stat-card">
            <div class="number" id="homeLiveCount">0</div>
            <div class="label">ç¾å ´ä¼´å¥</div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- å ±åé é¢ -->
  <div id="registerPage" class="page">
    <div class="container">
      <div class="header">
        <h1>ğŸ¤ Kæ­Œå ±åç³»çµ±</h1>
        <p>æ­¡è¿å ±ååƒåŠ è¡—é ­Kæ­Œæ´»å‹•</p>
        <div class="nav-buttons">
          <button class="nav-btn" onclick="showPage('home')">ğŸ  è¿”å›é¦–é </button>
          <button class="nav-btn" onclick="showPage('view')">ğŸµ æŸ¥çœ‹æ­Œå–®</button>
        </div>
      </div>
      
      <div class="content">
        <div id="regAlertBox" class="alert"></div>
        
        <form id="registrationForm">
          <div class="note">
            <strong>ğŸ“Œ å ±åé ˆçŸ¥ï¼š</strong>
            <ul style="margin: 10px 0 0 20px;">
              <li>æ¯äººå¯æ¼”å”± 3-4 é¦–æ­Œæ›²ï¼ˆå«ä¸€é¦–åˆå”±ï¼‰</li>
              <li>è«‹æä¾›æ­£ç¢ºçš„è¯çµ¡è³‡è¨Šä»¥ä¾¿æ¥æ”¶é€šçŸ¥</li>
              <li>å ±åå¾Œå°‡æ”¶åˆ°ç¢ºèªéƒµä»¶</li>
            </ul>
          </div>
          
          <h3 style="color: #667eea; margin-bottom: 20px;">ğŸ‘¤ åŸºæœ¬è³‡æ–™</h3>
          
          <div class="form-group">
            <label>å§“å <span class="required">*</span></label>
            <input type="text" name="name" required placeholder="è«‹è¼¸å…¥æ‚¨çš„å§“å">
          </div>
          
          <div class="form-group">
            <label>è¯çµ¡é›»è©± <span class="required">*</span></label>
            <input type="tel" name="phone" required placeholder="0912-345-678">
          </div>
          
          <div class="form-group">
            <label>Email <span class="required">*</span></label>
            <input type="email" name="email" required placeholder="example@email.com">
          </div>
          
          <div class="form-group">
            <label>æ€§åˆ¥ <span class="required">*</span></label>
            <div class="radio-group">
              <label>
                <input type="radio" name="gender" value="ç”·" required> ç”·
              </label>
              <label>
                <input type="radio" name="gender" value="å¥³" required> å¥³
              </label>
            </div>
          </div>
          
          <div class="song-section">
            <h3>ğŸµ æ­Œæ›²æ¸…å–®</h3>
            
            <div class="form-group">
              <label>æ­Œæ›² 1 <span class="required">*</span></label>
              <input type="text" name="song1" required placeholder="è«‹è¼¸å…¥æ­Œæ›²åç¨±">
            </div>
            
            <div class="form-group">
              <label>æ­Œæ›² 2 <span class="required">*</span></label>
              <input type="text" name="song2" required placeholder="è«‹è¼¸å…¥æ­Œæ›²åç¨±">
            </div>
            
            <div class="form-group">
              <label>æ­Œæ›² 3 <span class="required">*</span></label>
              <input type="text" name="song3" required placeholder="è«‹è¼¸å…¥æ­Œæ›²åç¨±">
            </div>
            
            <div class="form-group">
              <label>æ­Œæ›² 4ï¼ˆé¸å¡«ï¼‰</label>
              <input type="text" name="song4" placeholder="è«‹è¼¸å…¥æ­Œæ›²åç¨±">
            </div>
            
            <div class="form-group">
              <label>åˆå”±å°è±¡ï¼ˆé¸å¡«ï¼‰</label>
              <input type="text" name="duetPartner" placeholder="è«‹è¼¸å…¥åˆå”±å°è±¡å§“å">
            </div>
            
            <div class="form-group">
              <label>YouTube ä¼´å¥é€£çµï¼ˆé¸å¡«ï¼‰</label>
              <input type="url" name="youtubeLink" placeholder="https://youtube.com/...">
            </div>
          </div>
          
          <div class="form-group">
            <label>æ˜¯å¦éœ€è¦åˆé¤ï¼Ÿ <span class="required">*</span></label>
            <div class="radio-group">
              <label>
                <input type="radio" name="lunch" value="æ˜¯" required> æ˜¯ï¼ˆ$600 å«åˆé¤+æ‰“è³ï¼‰
              </label>
              <label>
                <input type="radio" name="lunch" value="å¦" required> å¦ï¼ˆ$200 åƒ…æ‰“è³ï¼‰
              </label>
            </div>
          </div>
          
          <div class="form-group">
            <label>ç‰¹æ®Šéœ€æ±‚ï¼ˆé¸å¡«ï¼‰</label>
            <textarea name="specialRequest" placeholder="å¦‚ï¼šç´ é£Ÿã€éœ€è¦ç¾å ´ä¼´å¥ã€èª¿æ•´keyç­‰"></textarea>
          </div>
          
          <div class="loading" id="regLoading">
            <div class="spinner"></div>
            <p style="margin-top: 10px;">æäº¤ä¸­ï¼Œè«‹ç¨å€™...</p>
          </div>
          
          <button type="submit" class="submit-btn" id="submitBtn">
            ğŸ¤ ç¢ºèªå ±å
          </button>
        </form>
      </div>
    </div>
  </div>
  
  <!-- å ±åæˆåŠŸé é¢ -->
  <div id="successPage" class="page">
    <div class="container">
      <div class="header">
        <h1>ğŸ¤ å ±åæˆåŠŸ</h1>
        <p>æ„Ÿè¬æ‚¨çš„å ±åï¼</p>
        <div class="nav-buttons">
          <button class="nav-btn" onclick="showPage('home')">ğŸ  è¿”å›é¦–é </button>
          <button class="nav-btn" onclick="showPage('view')">ğŸµ æŸ¥çœ‹æ­Œå–®</button>
        </div>
      </div>
      
      <div class="content">
        <div class="success-container">
          <div class="success-icon">ğŸ‰</div>
          <div class="success-message">å ±åæˆåŠŸï¼</div>
          <div class="success-subtitle">æ‚¨å·²æˆåŠŸå ±ååƒåŠ Kæ­Œæ´»å‹•</div>
          
          <div class="registration-summary" id="userRegistrationSummary">
            <!-- å°‡ç”± JavaScript å‹•æ…‹å¡«å…¥ -->
          </div>
          
          <div class="registration-cards" id="registrationCards">
            <!-- å°‡ç”± JavaScript å‹•æ…‹å¡«å…¥ -->
          </div>
          
          <div class="all-registrations">
            <h3>ğŸ“‹ ç›®å‰æ‰€æœ‰å ±åè€…</h3>
            <div class="registrants-grid" id="registrantsGrid">
              <!-- å°‡ç”± JavaScript å‹•æ…‹å¡«å…¥ -->
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- æ­Œå–®æŸ¥è©¢é é¢ -->
  <div id="viewPage" class="page">
    <div class="container">
      <div class="header">
        <h1>ğŸµ æ¼”å”±æ­Œå–®</h1>
        <div class="nav-buttons">
          <button class="nav-btn" onclick="showPage('home')">ğŸ  è¿”å›é¦–é </button>
          <button class="nav-btn" onclick="showPage('register')">ğŸ“ æˆ‘è¦å ±å</button>
          <button class="nav-btn" onclick="refreshSongList()">ğŸ”„ é‡æ–°æ•´ç†</button>
        </div>
      </div>
      
      <div class="content">
        <div class="stats-bar">
          <div class="stat-card">
            <div class="number" id="viewTotalSongs">-</div>
            <div class="label">ç¸½æ­Œæ›²æ•¸</div>
          </div>
          <div class="stat-card">
            <div class="number" id="viewTotalSingers">-</div>
            <div class="label">åƒèˆ‡æ­Œæ‰‹</div>
          </div>
          <div class="stat-card">
            <div class="number" id="viewDuetCount">-</div>
            <div class="label">åˆå”±æ­Œæ›²</div>
          </div>
          <div class="stat-card">
            <div class="number" id="viewLiveCount">-</div>
            <div class="label">ç¾å ´ä¼´å¥</div>
          </div>
        </div>
        
        <div class="controls">
          <input type="text" id="searchInput" placeholder="ğŸ” æœå°‹æ­Œæ‰‹ã€æ­Œæ›²åç¨±...">
          <select id="filterGender">
            <option value="">å…¨éƒ¨æ€§åˆ¥</option>
            <option value="ç”·">ç”·</option>
            <option value="å¥³">å¥³</option>
            <option value="ç”·å¥³">ç”·å¥³åˆå”±</option>
          </select>
          <select id="filterLive">
            <option value="">å…¨éƒ¨</option>
            <option value="true">åƒ…ç¾å ´ä¼´å¥</option>
          </select>
          <button onclick="resetFilters()">é‡ç½®ç¯©é¸</button>
        </div>
        
        <div id="viewLoading" class="loading active">
          <div class="spinner"></div>
          <p>è¼‰å…¥ä¸­ï¼Œè«‹ç¨å€™...</p>
        </div>
        
        <div class="table-container">
          <table id="songTable" style="display: none;">
            <thead>
              <tr>
                <th style="width: 60px;">ID</th>
                <th style="width: 120px;">æ­Œæ‰‹</th>
                <th>æ­Œæ›²åç¨±</th>
                <th style="width: 100px;">æ€§åˆ¥</th>
                <th style="width: 120px;">ç¾å ´ä¼´å¥</th>
                <th style="width: 150px;">YouTube</th>
                <th style="width: 150px;">å‚™è¨»</th>
              </tr>
            </thead>
            <tbody id="songTableBody">
            </tbody>
          </table>
          
          <div id="noResults" class="no-results" style="display: none;">
            ğŸ˜” æ‰¾ä¸åˆ°ç¬¦åˆæ¢ä»¶çš„æ­Œæ›²
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- ç®¡ç†å¾Œå°é é¢ -->
  <div id="adminPage" class="page">
    <div class="container">
      <div class="header">
        <h1>âš™ï¸ ç®¡ç†å¾Œå°</h1>
        <div class="nav-buttons">
          <button class="nav-btn" onclick="showPage('home')">ğŸ  è¿”å›é¦–é </button>
        </div>
      </div>
      
      <div class="tabs">
        <div class="tab active" onclick="switchAdminTab('dashboard')">ğŸ“Š å„€è¡¨æ¿</div>
        <div class="tab" onclick="switchAdminTab('registrations')">ğŸ‘¥ å ±åç®¡ç†</div>
        <div class="tab" onclick="switchAdminTab('songs')">ğŸµ æ­Œå–®ç®¡ç†</div>
        <div class="tab" onclick="switchAdminTab('notifications')">ğŸ“§ é€šçŸ¥ç®¡ç†</div>
      </div>
      
      <!-- å„€è¡¨æ¿ -->
      <div id="adminDashboard" class="tab-content active">
        <div class="dashboard-grid">
          <div class="dashboard-card">
            <div class="icon">ğŸ‘¥</div>
            <div class="number" id="dashTotalReg">0</div>
            <div class="label">ç¸½å ±åäººæ•¸</div>
          </div>
          
          <div class="dashboard-card">
            <div class="icon">ğŸµ</div>
            <div class="number" id="dashTotalSongs">0</div>
            <div class="label">æ¼”å”±æ­Œæ›²æ•¸</div>
          </div>
          
          <div class="dashboard-card">
            <div class="icon">ğŸ‘¨</div>
            <div class="number" id="dashMaleCount">0</div>
            <div class="label">ç”·æ€§æ­Œæ‰‹</div>
          </div>
          
          <div class="dashboard-card">
            <div class="icon">ğŸ‘©</div>
            <div class="number" id="dashFemaleCount">0</div>
            <div class="label">å¥³æ€§æ­Œæ‰‹</div>
          </div>
          
          <div class="dashboard-card">
            <div class="icon">ğŸ½ï¸</div>
            <div class="number" id="dashLunchCount">0</div>
            <div class="label">åˆé¤é è¨‚</div>
          </div>
          
          <div class="dashboard-card">
            <div class="icon">ğŸ¸</div>
            <div class="number" id="dashLiveCount">0</div>
            <div class="label">ç¾å ´ä¼´å¥</div>
          </div>
        </div>
        
        <div style="background: white; padding: 30px; border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); margin-bottom: 30px;">
          <h3 style="color: #667eea; margin-bottom: 20px;">ğŸ“ˆ å ±åé€²åº¦</h3>
          <div class="progress-bar">
            <div class="progress-fill" id="progressBar" style="width: 0%">0%</div>
          </div>
          <p style="margin-top: 10px; color: #666;">
            å·²å ±å <strong id="currentCount">0</strong> äººï¼Œ
            å‰©é¤˜ <strong id="remainingCount">0</strong> å€‹åé¡
          </p>
        </div>
        
        <div class="action-buttons">
          <button class="action-btn" onclick="refreshAllData()">
            ğŸ”„ é‡æ–°æ•´ç†æ•¸æ“š
          </button>
          <button class="action-btn success" onclick="alert('åŒ¯å‡ºåŠŸèƒ½é–‹ç™¼ä¸­...')">
            ğŸ“Š åŒ¯å‡ºå®Œæ•´å ±è¡¨
          </button>
          <button class="action-btn" onclick="alert('æ¸¬è©¦éƒµä»¶åŠŸèƒ½é–‹ç™¼ä¸­...')">
            ğŸ“§ æ¸¬è©¦éƒµä»¶ç™¼é€
          </button>
          <button class="action-btn" onclick="alert('è‡ªå‹•æé†’åŠŸèƒ½é–‹ç™¼ä¸­...')">
            â° è¨­å®šè‡ªå‹•æé†’
          </button>
        </div>
      </div>
      
      <!-- å ±åç®¡ç† -->
      <div id="adminRegistrations" class="tab-content">
        <div class="action-buttons">
          <button class="action-btn" onclick="loadAdminRegistrations()">
            ğŸ”„ é‡æ–°è¼‰å…¥
          </button>
          <button class="action-btn success" onclick="alert('åŒ¯å‡ºåŠŸèƒ½é–‹ç™¼ä¸­...')">
            ğŸ“¥ åŒ¯å‡ºå ±åè³‡æ–™
          </button>
        </div>
        
        <div id="adminRegLoading" class="loading active">
          <div class="spinner"></div>
          <p>è¼‰å…¥ä¸­...</p>
        </div>
        
        <div class="table-container">
          <table id="adminRegTable" style="display: none;">
            <thead>
              <tr>
                <th>å ±åæ™‚é–“</th>
                <th>å§“å</th>
                <th>é›»è©±</th>
                <th>Email</th>
                <th>æ€§åˆ¥</th>
                <th>åˆé¤</th>
                <th>ç‹€æ…‹</th>
              </tr>
            </thead>
            <tbody id="adminRegTableBody">
            </tbody>
          </table>
        </div>
      </div>
      
      <!-- æ­Œå–®ç®¡ç† -->
      <div id="adminSongs" class="tab-content">
        <div class="action-buttons">
          <button class="action-btn" onclick="loadAdminSongs()">
            ğŸ”„ é‡æ–°è¼‰å…¥
          </button>
          <button class="action-btn success" onclick="alert('åŒ¯å‡ºPDFåŠŸèƒ½é–‹ç™¼ä¸­...')">
            ğŸ“„ åŒ¯å‡ºæ­Œå–®PDF
          </button>
        </div>
        
        <div id="adminSongLoading" class="loading active">
          <div class="spinner"></div>
          <p>è¼‰å…¥ä¸­...</p>
        </div>
        
        <div class="table-container">
          <table id="adminSongTable" style="display: none;">
            <thead>
              <tr>
                <th>ID</th>
                <th>æ­Œæ‰‹</th>
                <th>æ­Œæ›²åç¨±</th>
                <th>æ€§åˆ¥</th>
                <th>ç¾å ´ä¼´å¥</th>
                <th>å‚™è¨»</th>
              </tr>
            </thead>
            <tbody id="adminSongTableBody">
            </tbody>
          </table>
        </div>
      </div>
      
      <!-- é€šçŸ¥ç®¡ç† -->
      <div id="adminNotifications" class="tab-content">
        <div style="background: white; padding: 30px; border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); margin-bottom: 30px;">
          <h3 style="color: #667eea; margin-bottom: 20px;">ğŸ“§ éƒµä»¶é€šçŸ¥åŠŸèƒ½</h3>
          <p style="color: #666; margin-bottom: 20px;">
            ç³»çµ±æœƒåœ¨ä»¥ä¸‹æƒ…æ³è‡ªå‹•ç™¼é€éƒµä»¶é€šçŸ¥ï¼š
          </p>
          <ul style="color: #666; line-height: 2; margin-left: 20px;">
            <li>âœ… å ±åæˆåŠŸæ™‚ç™¼é€ç¢ºèªéƒµä»¶çµ¦å ±åè€…</li>
            <li>âœ… æ–°å ±åæ™‚é€šçŸ¥ç®¡ç†å“¡</li>
            <li>âœ… æ´»å‹•å‰3å¤©è‡ªå‹•ç™¼é€æé†’éƒµä»¶</li>
          </ul>
        </div>
        
        <div class="action-buttons">
          <button class="action-btn success" onclick="alert('ç™¼é€æé†’åŠŸèƒ½é–‹ç™¼ä¸­...')">
            ğŸ“§ ç™¼é€æé†’çµ¦æ‰€æœ‰äºº
          </button>
          <button class="action-btn" onclick="alert('æ¸¬è©¦é€šçŸ¥åŠŸèƒ½é–‹ç™¼ä¸­...')">
            ğŸ§ª æ¸¬è©¦é€šçŸ¥åŠŸèƒ½
          </button>
          <button class="action-btn" onclick="alert('éƒµä»¶è¨˜éŒ„åŠŸèƒ½é–‹ç™¼ä¸­...')">
            ğŸ“‹ æŸ¥çœ‹éƒµä»¶è¨˜éŒ„
          </button>
        </div>
      </div>
    </div>
  </div>
  
  <script>
    // å…¨åŸŸè®Šæ•¸
    let allSongs = [];
    let currentPage = 'home';
    let currentUserData = null;
    
    // é é¢åˆ‡æ›
    function showPage(pageName) {
      document.querySelectorAll('.page').forEach(page => {
        page.classList.remove('active');
      });
      
      document.getElementById(pageName + 'Page').classList.add('active');
      currentPage = pageName;
      
      if (pageName === 'home') {
        loadHomePage();
      } else if (pageName === 'view') {
        loadViewPage();
      } else if (pageName === 'admin') {
        loadAdminPage();
      } else if (pageName === 'success') {
        loadSuccessPage();
      }
      
      window.scrollTo(0, 0);
    }
    
    // ==================== é¦–é åŠŸèƒ½ ====================
    function loadHomePage() {
      if (typeof google !== 'undefined' && google.script) {
        google.script.run
          .withSuccessHandler(displayHomeEventInfo)
          .withFailureHandler(handleError)
          .getEventInfo();
        
        google.script.run
          .withSuccessHandler(displayHomeStats)
          .withFailureHandler(handleError)
          .getStatistics();
      } else {
        displayHomeEventInfo({
          'æ´»å‹•æ—¥æœŸ': '2026-02-22',
          'æ´»å‹•æ™‚é–“': '14:00-18:00',
          'æ´»å‹•åœ°é»': 'æ°¸å’Œä»æ„›å…¬åœ’',
          'æœ€å¤§äººæ•¸': 15,
          currentCount: 3,
          remainingSlots: 12,
          isFull: false
        });
        
        displayHomeStats({
          totalRegistrations: 3,
          totalSongs: 10,
          lunchCount: 2,
          liveAccompanimentCount: 3
        });
      }
    }
    
    function displayHomeEventInfo(info) {
      document.getElementById('homeEventDate').textContent = info['æ´»å‹•æ—¥æœŸ'] || '-';
      document.getElementById('homeEventTime').textContent = info['æ´»å‹•æ™‚é–“'] || '-';
      document.getElementById('homeEventLocation').textContent = info['æ´»å‹•åœ°é»'] || '-';
      
      const status = info.isFull ? 
        `âŒ å·²é¡æ»¿ (${info.currentCount}/${info['æœ€å¤§äººæ•¸']})` : 
        `âœ… é–‹æ”¾å ±å (${info.currentCount}/${info['æœ€å¤§äººæ•¸']})`;
      
      document.getElementById('homeEventStatus').textContent = status;
    }
    
    function displayHomeStats(stats) {
      document.getElementById('homeTotalReg').textContent = stats.totalRegistrations || 0;
      document.getElementById('homeTotalSongs').textContent = stats.totalSongs || 0;
      document.getElementById('homeLunchCount').textContent = stats.lunchCount || 0;
      document.getElementById('homeLiveCount').textContent = stats.liveAccompanimentCount || 0;
    }
    
    // ==================== å ±åé é¢åŠŸèƒ½ ====================
    document.getElementById('registrationForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const formData = {
        name: this.name.value,
        phone: this.phone.value,
        email: this.email.value,
        gender: this.gender.value,
        song1: this.song1.value,
        song2: this.song2.value,
        song3: this.song3.value,
        song4: this.song4.value,
        duetPartner: this.duetPartner.value,
        youtubeLink: this.youtubeLink.value,
        lunch: this.lunch.value,
        specialRequest: this.specialRequest.value
      };
      
      currentUserData = formData;
      
      document.getElementById('regLoading').classList.add('active');
      document.getElementById('submitBtn').disabled = true;
      
      if (typeof google !== 'undefined' && google.script) {
        google.script.run
          .withSuccessHandler(handleSubmitSuccess)
          .withFailureHandler(handleSubmitError)
          .submitRegistration(formData);
      } else {
        setTimeout(() => {
          handleSubmitSuccess({
            success: true,
            message: 'å ±åæˆåŠŸï¼ï¼ˆæ¸¬è©¦æ¨¡å¼ï¼‰',
            registrationNumber: 3
          });
        }, 1500);
      }
    });
    
    function handleSubmitSuccess(result) {
      document.getElementById('regLoading').classList.remove('active');
      document.getElementById('submitBtn').disabled = false;
      
      if (result.success) {
        document.getElementById('registrationForm').reset();
        showPage('success');
      } else {
        showAlert(result.message, 'error', 'regAlertBox');
      }
    }
    
    function handleSubmitError(error) {
      document.getElementById('regLoading').classList.remove('active');
      document.getElementById('submitBtn').disabled = false;
      showAlert('ç³»çµ±éŒ¯èª¤ï¼š' + error.message, 'error', 'regAlertBox');
    }
    
    // ==================== å ±åæˆåŠŸé é¢åŠŸèƒ½ ====================
    function loadSuccessPage() {
      if (typeof google !== 'undefined' && google.script) {
        google.script.run
          .withSuccessHandler(displaySuccessPage)
          .withFailureHandler(handleError)
          .getEventInfo();
        
        google.script.run
          .withSuccessHandler(displayAllRegistrants)
          .withFailureHandler(handleError)
          .getAllRegistrations();
      } else {
        displaySuccessPage({
          'æ´»å‹•åç¨±': 'é€±æœ«èšé¤+è¡—é ­Kæ­Œ',
          'æ´»å‹•æ—¥æœŸ': '2026-02-22',
          'æ´»å‹•æ™‚é–“': '14:00-18:00',
          'æ´»å‹•åœ°é»': 'æ°¸å’Œä»æ„›å…¬åœ’',
          currentCount: 3
        });
        
        displayAllRegistrants([
          {
            'å§“å': 'å¼µä¸‰',
            'æ€§åˆ¥': 'ç”·',
            'åˆé¤': 'æ˜¯',
            'æ™‚é–“æˆ³è¨˜': new Date()
          },
          {
            'å§“å': 'æå››',
            'æ€§åˆ¥': 'å¥³',
            'åˆé¤': 'å¦',
            'æ™‚é–“æˆ³è¨˜': new Date()
          },
          {
            'å§“å': currentUserData ? currentUserData.name : 'ç‹äº”',
            'æ€§åˆ¥': currentUserData ? currentUserData.gender : 'ç”·',
            'åˆé¤': currentUserData ? currentUserData.lunch : 'æ˜¯',
            'æ™‚é–“æˆ³è¨˜': new Date()
          }
        ]);
      }
    }
    
    function displaySuccessPage(eventInfo) {
      if (!currentUserData) return;
      
      const summaryHTML = `
        <h3>ğŸ“‹ æ‚¨çš„å ±åè³‡è¨Š</h3>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-top: 20px;">
          <div class="summary-item">
            <strong>å§“å</strong>
            <div class="value">${currentUserData.name}</div>
          </div>
          <div class="summary-item">
            <strong>æ€§åˆ¥</strong>
            <div class="value">${currentUserData.gender}</div>
          </div>
          <div class="summary-item">
            <strong>è¯çµ¡é›»è©±</strong>
            <div class="value">${currentUserData.phone}</div>
          </div>
          <div class="summary-item">
            <strong>Email</strong>
            <div class="value">${currentUserData.email}</div>
          </div>
          <div class="summary-item">
            <strong>åˆé¤</strong>
            <div class="value">${currentUserData.lunch}</div>
          </div>
          <div class="summary-item">
            <strong>è²»ç”¨</strong>
            <div class="value">${currentUserData.lunch === 'æ˜¯' ? '$600' : '$200'}</div>
          </div>
        </div>
      `;
      
      document.getElementById('userRegistrationSummary').innerHTML = summaryHTML;
      
      const cardsHTML = `
        <div class="reg-card">
          <div class="reg-card-header">
            <div class="reg-card-icon">ğŸµ</div>
            <div class="reg-card-title">
              <h4>æ¼”å”±æ­Œæ›²</h4>
              <div class="subtitle">æ‚¨é¸æ“‡çš„æ­Œæ›²æ¸…å–®</div>
            </div>
          </div>
          <div class="reg-card-body">
            <div class="song-list">
              <ol>
                <li>${currentUserData.song1}</li>
                <li>${currentUserData.song2}</li>
                <li>${currentUserData.song3}</li>
                ${currentUserData.song4 ? `<li>${currentUserData.song4}</li>` : ''}
              </ol>
            </div>
          </div>
        </div>
        
        <div class="reg-card">
          <div class="reg-card-header">
            <div class="reg-card-icon">ğŸ“…</div>
            <div class="reg-card-title">
              <h4>æ´»å‹•è³‡è¨Š</h4>
              <div class="subtitle">è«‹æº–æ™‚åƒåŠ </div>
            </div>
          </div>
          <div class="reg-card-body">
            <div class="info-row">
              <span class="label">æ´»å‹•åç¨±</span>
              <span class="value">${eventInfo['æ´»å‹•åç¨±']}</span>
            </div>
            <div class="info-row">
              <span class="label">æ´»å‹•æ—¥æœŸ</span>
              <span class="value">${eventInfo['æ´»å‹•æ—¥æœŸ']}</span>
            </div>
            <div class="info-row">
              <span class="label">æ´»å‹•æ™‚é–“</span>
              <span class="value">${eventInfo['æ´»å‹•æ™‚é–“']}</span>
            </div>
            <div class="info-row">
              <span class="label">æ´»å‹•åœ°é»</span>
              <span class="value">${eventInfo['æ´»å‹•åœ°é»']}</span>
            </div>
          </div>
        </div>
        
        ${currentUserData.duetPartner ? `
        <div class="reg-card">
          <div class="reg-card-header">
            <div class="reg-card-icon">ğŸ‘¥</div>
            <div class="reg-card-title">
              <h4>åˆå”±è³‡è¨Š</h4>
              <div class="subtitle">èˆ‡æœ‹å‹ä¸€èµ·æ¼”å”±</div>
            </div>
          </div>
          <div class="reg-card-body">
            <div class="info-row">
              <span class="label">åˆå”±å°è±¡</span>
              <span class="value">${currentUserData.duetPartner}</span>
            </div>
          </div>
        </div>
        ` : ''}
        
        ${currentUserData.specialRequest ? `
        <div class="reg-card">
          <div class="reg-card-header">
            <div class="reg-card-icon">ğŸ“</div>
            <div class="reg-card-title">
              <h4>ç‰¹æ®Šéœ€æ±‚</h4>
              <div class="subtitle">æˆ‘å€‘æœƒç‰¹åˆ¥æ³¨æ„</div>
            </div>
          </div>
          <div class="reg-card-body">
                      <p>${currentUserData.specialRequest}</p>
          </div>
        </div>
        ` : ''}
        
        <div class="reg-card">
          <div class="reg-card-header">
            <div class="reg-card-icon">ğŸ“§</div>
            <div class="reg-card-title">
              <h4>ç¢ºèªéƒµä»¶</h4>
              <div class="subtitle">å·²ç™¼é€è‡³æ‚¨çš„ä¿¡ç®±</div>
            </div>
          </div>
          <div class="reg-card-body">
            <p>ç¢ºèªéƒµä»¶å·²ç™¼é€è‡³ <strong>${currentUserData.email}</strong></p>
            <p style="margin-top: 10px; color: #999; font-size: 0.9em;">è«‹æª¢æŸ¥æ‚¨çš„æ”¶ä»¶åŒ£ï¼ˆæˆ–åƒåœ¾éƒµä»¶ï¼‰</p>
          </div>
        </div>
      `;
      
      document.getElementById('registrationCards').innerHTML = cardsHTML;
    }
    
    function displayAllRegistrants(registrations) {
      const gridHTML = registrations.map((reg, index) => `
        <div class="registrant-card">
          <div class="registrant-header">
            <div class="registrant-number">${index + 1}</div>
            <div class="registrant-name">${reg['å§“å']}</div>
          </div>
          <div class="registrant-info">
            <div>
              æ€§åˆ¥ï¼š<span class="gender-badge ${reg['æ€§åˆ¥'] === 'ç”·' ? 'gender-male' : 'gender-female'}">${reg['æ€§åˆ¥']}</span>
            </div>
            <div>
              åˆé¤ï¼š${reg['åˆé¤'] === 'æ˜¯' ? '<span class="lunch-badge">å·²é è¨‚</span>' : 'å¦'}
            </div>
            <div style="color: #999; font-size: 0.85em; margin-top: 5px;">
              ${formatDate(reg['æ™‚é–“æˆ³è¨˜'])}
            </div>
          </div>
        </div>
      `).join('');
      
      document.getElementById('registrantsGrid').innerHTML = gridHTML;
    }
    
    // ==================== æ­Œå–®æŸ¥è©¢é é¢åŠŸèƒ½ ====================
    function loadViewPage() {
      if (typeof google !== 'undefined' && google.script) {
        google.script.run
          .withSuccessHandler(displaySongList)
          .withFailureHandler(handleError)
          .getSongList();
        
        google.script.run
          .withSuccessHandler(displayViewStats)
          .withFailureHandler(handleError)
          .getStatistics();
      } else {
        const testSongs = [
          {ID: 1, 'æ­Œæ‰‹': 'å¼µä¸‰', 'æ­Œæ›²åç¨±': 'æœˆäº®ä»£è¡¨æˆ‘çš„å¿ƒ', 'æ€§åˆ¥': 'ç”·', 'ç¾å ´ä¼´å¥': true, 'YouTubeé€£çµ': '', 'å‚™è¨»': ''},
          {ID: 2, 'æ­Œæ‰‹': 'å¼µä¸‰', 'æ­Œæ›²åç¨±': 'ç«¥è©±', 'æ€§åˆ¥': 'ç”·', 'ç¾å ´ä¼´å¥': false, 'YouTubeé€£çµ': 'https://youtube.com', 'å‚™è¨»': ''},
          {ID: 3, 'æ­Œæ‰‹': 'æå››', 'æ­Œæ›²åç¨±': 'å°å¹¸é‹', 'æ€§åˆ¥': 'å¥³', 'ç¾å ´ä¼´å¥': false, 'YouTubeé€£çµ': '', 'å‚™è¨»': ''}
        ];
        displaySongList(testSongs);
        displayViewStats({totalSongs: 3, duetCount: 0, liveAccompanimentCount: 1});
      }
    }
    
    function displaySongList(songs) {
      allSongs = songs;
      
      document.getElementById('viewLoading').classList.remove('active');
      document.getElementById('songTable').style.display = 'table';
      
      renderSongTable(songs);
    }
    
    function renderSongTable(songs) {
      const tbody = document.getElementById('songTableBody');
      const noResults = document.getElementById('noResults');
      
      if (songs.length === 0) {
        tbody.innerHTML = '';
        document.getElementById('songTable').style.display = 'none';
        noResults.style.display = 'block';
        return;
      }
      
      noResults.style.display = 'none';
      document.getElementById('songTable').style.display = 'table';
      
      tbody.innerHTML = songs.map(song => `
        <tr>
          <td><strong>#${song.ID || '-'}</strong></td>
          <td><span class="singer-tag">${song['æ­Œæ‰‹'] || '-'}</span></td>
          <td>${song['æ­Œæ›²åç¨±'] || '-'}</td>
          <td>
            <span class="badge ${getGenderBadgeClass(song['æ€§åˆ¥'])}">
              ${song['æ€§åˆ¥'] || '-'}
            </span>
          </td>
          <td>
            ${song['ç¾å ´ä¼´å¥'] ? '<span class="badge badge-live">ğŸ¸ ç¾å ´ä¼´å¥</span>' : '-'}
          </td>
          <td>
            ${song['YouTubeé€£çµ'] ? 
              `<a href="${song['YouTubeé€£çµ']}" target="_blank" class="youtube-link">ğŸ¬ è§€çœ‹</a>` : 
              '-'}
          </td>
          <td>${song['å‚™è¨»'] || '-'}</td>
        </tr>
      `).join('');
    }
    
    function getGenderBadgeClass(gender) {
      if (gender && (gender.includes('ç”·å¥³') || gender.includes('å¥³å¥³'))) {
        return 'badge-duet';
      } else if (gender === 'ç”·') {
        return 'badge-male';
      } else if (gender === 'å¥³') {
        return 'badge-female';
      }
      return '';
    }
    
    function displayViewStats(stats) {
      document.getElementById('viewTotalSongs').textContent = stats.totalSongs || 0;
      
      const uniqueSingers = new Set(allSongs.map(s => s['æ­Œæ‰‹'])).size;
      document.getElementById('viewTotalSingers').textContent = uniqueSingers;
      
      document.getElementById('viewDuetCount').textContent = stats.duetCount || 0;
      document.getElementById('viewLiveCount').textContent = stats.liveAccompanimentCount || 0;
    }
    
    function filterSongs() {
      const searchTerm = document.getElementById('searchInput').value.toLowerCase();
      const genderFilter = document.getElementById('filterGender').value;
      const liveFilter = document.getElementById('filterLive').value;
      
      let filtered = allSongs.filter(song => {
        const matchSearch = 
          (song['æ­Œæ‰‹'] || '').toLowerCase().includes(searchTerm) || 
          (song['æ­Œæ›²åç¨±'] || '').toLowerCase().includes(searchTerm);
        
        const matchGender = !genderFilter || song['æ€§åˆ¥'] === genderFilter;
        const matchLive = !liveFilter || (liveFilter === 'true' && song['ç¾å ´ä¼´å¥']);
        
        return matchSearch && matchGender && matchLive;
      });
      
      renderSongTable(filtered);
    }
    
    function resetFilters() {
      document.getElementById('searchInput').value = '';
      document.getElementById('filterGender').value = '';
      document.getElementById('filterLive').value = '';
      renderSongTable(allSongs);
    }
    
    function refreshSongList() {
      document.getElementById('viewLoading').classList.add('active');
      document.getElementById('songTable').style.display = 'none';
      loadViewPage();
    }
    
    document.getElementById('searchInput').addEventListener('input', filterSongs);
    document.getElementById('filterGender').addEventListener('change', filterSongs);
    document.getElementById('filterLive').addEventListener('change', filterSongs);
    
    // ==================== ç®¡ç†å¾Œå°åŠŸèƒ½ ====================
    function loadAdminPage() {
      loadAdminDashboard();
    }
    
    function switchAdminTab(tabName) {
      document.querySelectorAll('.tab').forEach(tab => {
        tab.classList.remove('active');
      });
      
      document.querySelectorAll('.tab-content').forEach(content => {
        content.classList.remove('active');
      });
      
      event.target.classList.add('active');
      document.getElementById('admin' + tabName.charAt(0).toUpperCase() + tabName.slice(1)).classList.add('active');
      
      if (tabName === 'registrations') {
        loadAdminRegistrations();
      } else if (tabName === 'songs') {
        loadAdminSongs();
      }
    }
    
    function loadAdminDashboard() {
      if (typeof google !== 'undefined' && google.script) {
        google.script.run
          .withSuccessHandler(displayAdminDashboard)
          .withFailureHandler(handleError)
          .getStatistics();
        
        google.script.run
          .withSuccessHandler(displayAdminProgress)
          .withFailureHandler(handleError)
          .getEventInfo();
      } else {
        displayAdminDashboard({
          totalRegistrations: 3,
          totalSongs: 10,
          maleCount: 2,
          femaleCount: 1,
          lunchCount: 2,
          liveAccompanimentCount: 3
        });
        
        displayAdminProgress({
          currentCount: 3,
          'æœ€å¤§äººæ•¸': 15,
          remainingSlots: 12
        });
      }
    }
    
    function displayAdminDashboard(stats) {
      document.getElementById('dashTotalReg').textContent = stats.totalRegistrations || 0;
      document.getElementById('dashTotalSongs').textContent = stats.totalSongs || 0;
      document.getElementById('dashMaleCount').textContent = stats.maleCount || 0;
      document.getElementById('dashFemaleCount').textContent = stats.femaleCount || 0;
      document.getElementById('dashLunchCount').textContent = stats.lunchCount || 0;
      document.getElementById('dashLiveCount').textContent = stats.liveAccompanimentCount || 0;
    }
    
    function displayAdminProgress(info) {
      const percentage = (info.currentCount / info['æœ€å¤§äººæ•¸'] * 100).toFixed(0);
      document.getElementById('progressBar').style.width = percentage + '%';
      document.getElementById('progressBar').textContent = percentage + '%';
      document.getElementById('currentCount').textContent = info.currentCount;
      document.getElementById('remainingCount').textContent = info.remainingSlots;
    }
    
    function loadAdminRegistrations() {
      document.getElementById('adminRegLoading').style.display = 'block';
      document.getElementById('adminRegTable').style.display = 'none';
      
      if (typeof google !== 'undefined' && google.script) {
        google.script.run
          .withSuccessHandler(displayAdminRegistrations)
          .withFailureHandler(handleError)
          .getAllRegistrations();
      } else {
        setTimeout(() => {
          displayAdminRegistrations([
            {'æ™‚é–“æˆ³è¨˜': new Date(), 'å§“å': 'å¼µä¸‰', 'è¯çµ¡é›»è©±': '0912345678', 'Email': 'test@test.com', 'æ€§åˆ¥': 'ç”·', 'åˆé¤': 'æ˜¯', 'ç‹€æ…‹': 'å·²ç¢ºèª'}
          ]);
        }, 500);
      }
    }
    
    function displayAdminRegistrations(registrations) {
      document.getElementById('adminRegLoading').style.display = 'none';
      document.getElementById('adminRegTable').style.display = 'table';
      
      const tbody = document.getElementById('adminRegTableBody');
      tbody.innerHTML = registrations.map(reg => `
        <tr>
          <td>${formatDate(reg['æ™‚é–“æˆ³è¨˜'])}</td>
          <td><strong>${reg['å§“å']}</strong></td>
          <td>${reg['è¯çµ¡é›»è©±']}</td>
          <td>${reg['Email']}</td>
          <td>${reg['æ€§åˆ¥']}</td>
          <td>${reg['åˆé¤']}</td>
          <td><span class="badge" style="background: #d4edda; color: #155724;">${reg['ç‹€æ…‹']}</span></td>
        </tr>
      `).join('');
    }
    
    function loadAdminSongs() {
      document.getElementById('adminSongLoading').style.display = 'block';
      document.getElementById('adminSongTable').style.display = 'none';
      
      if (typeof google !== 'undefined' && google.script) {
        google.script.run
          .withSuccessHandler(displayAdminSongs)
          .withFailureHandler(handleError)
          .getSongList();
      } else {
        setTimeout(() => {
          displayAdminSongs([
            {ID: 1, 'æ­Œæ‰‹': 'å¼µä¸‰', 'æ­Œæ›²åç¨±': 'æœˆäº®ä»£è¡¨æˆ‘çš„å¿ƒ', 'æ€§åˆ¥': 'ç”·', 'ç¾å ´ä¼´å¥': true, 'å‚™è¨»': ''}
          ]);
        }, 500);
      }
    }
    
    function displayAdminSongs(songs) {
      document.getElementById('adminSongLoading').style.display = 'none';
      document.getElementById('adminSongTable').style.display = 'table';
      
      const tbody = document.getElementById('adminSongTableBody');
      tbody.innerHTML = songs.map(song => `
        <tr>
          <td><strong>#${song.ID}</strong></td>
          <td>${song['æ­Œæ‰‹']}</td>
          <td>${song['æ­Œæ›²åç¨±']}</td>
          <td>${song['æ€§åˆ¥']}</td>
          <td>${song['ç¾å ´ä¼´å¥'] ? 'âœ…' : '-'}</td>
          <td>${song['å‚™è¨»'] || '-'}</td>
        </tr>
      `).join('');
    }
    
    function refreshAllData() {
      loadAdminDashboard();
      alert('æ•¸æ“šå·²é‡æ–°æ•´ç†ï¼');
    }
    
    // ==================== é€šç”¨åŠŸèƒ½ ====================
    function showAlert(message, type, elementId) {
      const alertBox = document.getElementById(elementId);
      alertBox.textContent = message;
      alertBox.className = 'alert ' + type;
      alertBox.scrollIntoView({ behavior: 'smooth', block: 'center' });
      
      if (type === 'success') {
        setTimeout(() => {
          alertBox.className = 'alert';
        }, 5000);
      }
    }
    
    function handleError(error) {
      console.error('éŒ¯èª¤:', error);
      alert('ç™¼ç”ŸéŒ¯èª¤ï¼š' + (error.message || error));
    }
    
    function formatDate(date) {
      if (!date) return '-';
      const d = new Date(date);
      return d.toLocaleString('zh-TW');
    }
    
    // é é¢è¼‰å…¥æ™‚åŸ·è¡Œ
    window.onload = function() {
      loadHomePage();
    };
  </script>
</body>
</html>
            
