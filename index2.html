<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>帕金森病友權益促進會</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --primary-color: #4285f4;
      --secondary-color: #34a853;
      --danger-color: #ea4335;
      --success-color: #34a853;
      --warning-color: #fbbc04;
      --dark-color: #333;
      --light-color: #f8f9fa;
      --sidebar-width: 260px;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      line-height: 1.6;
      color: var(--dark-color);
      background: var(--light-color);
    }

    /* Loading Spinner */
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(255,255,255,0.9);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 9999;
    }

    .loading-overlay.active {
      display: flex;
    }

    .spinner {
      width: 50px;
      height: 50px;
      border: 5px solid var(--light-color);
      border-top: 5px solid var(--primary-color);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Page Container */
    .page-container {
      display: none;
    }

    .page-container.active {
      display: block;
    }

    /* Common Styles */
    .btn {
      padding: 12px 24px;
      border: none;
      border-radius: 8px;
      font-size: 0.95rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      justify-content: center;
    }

    .btn-primary {
      background: var(--primary-color);
      color: white;
    }

    .btn-primary:hover {
      background: #3367d6;
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(66, 133, 244, 0.3);
    }

    .btn-secondary {
      background: white;
      color: var(--primary-color);
      border: 2px solid var(--primary-color);
    }

    .btn-secondary:hover {
      background: var(--primary-color);
      color: white;
    }

    .btn-success {
      background: var(--secondary-color);
      color: white;
    }

    .btn-danger {
      background: var(--danger-color);
      color: white;
    }

    .btn-sm {
      padding: 6px 12px;
      font-size: 0.85rem;
    }

    /* Modal */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      z-index: 10000;
      justify-content: center;
      align-items: center;
      overflow-y: auto;
      padding: 20px;
    }

    .modal.active {
      display: flex;
    }

    .modal-content {
      background: white;
      padding: 2rem;
      border-radius: 15px;
      max-width: 500px;
      width: 100%;
      max-height: 90vh;
      overflow-y: auto;
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
      padding-bottom: 1rem;
      border-bottom: 2px solid var(--light-color);
    }

    .modal-header h2 {
      color: var(--primary-color);
    }

    .close-modal {
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      color: #999;
    }

    .close-modal:hover {
      color: var(--danger-color);
    }

    .form-group {
      margin-bottom: 1.5rem;
    }

    .form-group label {
      display: block;
      margin-bottom: 0.5rem;
      color: var(--dark-color);
      font-weight: 500;
    }

    .form-group input,
    .form-group select,
    .form-group textarea {
      width: 100%;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 1rem;
      transition: border-color 0.3s ease;
    }

    .form-group input:focus,
    .form-group select:focus,
    .form-group textarea:focus {
      outline: none;
      border-color: var(--primary-color);
    }

    /* Alert */
    .alert {
      padding: 1rem;
      border-radius: 8px;
      margin-bottom: 1rem;
    }

    .alert-success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }

    .alert-error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }

    .alert-info {
      background: #d1ecf1;
      color: #0c5460;
      border: 1px solid #bee5eb;
    }

    /* Responsive */
    @media (max-width: 768px) {
      .btn {
        width: 100%;
      }
    }
  </style>
</head>
<body>
  <!-- Loading Overlay -->
  <div class="loading-overlay" id="loadingOverlay">
    <div class="spinner"></div>
  </div>

  <!-- Page Containers -->
  <div id="homePage" class="page-container active"></div>
  <div id="registerPage" class="page-container"></div>
  <div id="loginPage" class="page-container"></div>
  <div id="dashboardPage" class="page-container"></div>
  <div id="adminPage" class="page-container"></div>

  <!-- Login Modal -->
  <div class="modal" id="loginModal">
    <div class="modal-content">
      <div class="modal-header">
        <h2><i class="fas fa-sign-in-alt"></i> 會員登入</h2>
        <button class="close-modal" onclick="AppRouter.closeModal('loginModal')">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <form onsubmit="AuthService.handleLogin(event)">
        <div class="form-group">
          <label>電子郵件</label>
          <input type="email" id="loginEmail" required placeholder="example@email.com">
        </div>
        <div class="form-group">
          <label>密碼</label>
          <input type="password" id="loginPassword" required placeholder="請輸入密碼">
        </div>
        <div style="margin-bottom: 1rem; display: flex; justify-content: space-between; align-items: center;">
          <label style="display: flex; align-items: center; gap: 5px;">
            <input type="checkbox"> 記住我
          </label>
          <a href="javascript:void(0)" style="color: var(--primary-color); text-decoration: none;">忘記密碼？</a>
        </div>
        <button type="submit" class="btn btn-primary" style="width: 100%; margin-bottom: 1rem;">登入</button>
        <p style="text-align: center; color: #666;">
          還不是會員？ <a href="javascript:void(0)" onclick="AppRouter.closeModal('loginModal'); AppRouter.navigate('register');" style="color: var(--primary-color); text-decoration: none;">立即註冊</a>
        </p>
      </form>
    </div>
  </div>

  <script>
    // ==================== 資料儲存服務 ====================
    class StorageService {
      static setItem(key, value) {
        localStorage.setItem(key, JSON.stringify(value));
      }

      static getItem(key) {
        const item = localStorage.getItem(key);
        return item ? JSON.parse(item) : null;
      }

      static removeItem(key) {
        localStorage.removeItem(key);
      }

      static clear() {
        localStorage.clear();
      }
    }

    // ==================== 認證服務 ====================
    class AuthService {
      static currentUser = null;

      static init() {
        const user = StorageService.getItem('currentUser');
        if (user) {
          this.currentUser = user;
        }
      }

      static async handleLogin(event) {
        event.preventDefault();
        AppRouter.showLoading();

        const email = document.getElementById('loginEmail').value;
        const password = document.getElementById('loginPassword').value;

        // 模擬 API 呼叫
        setTimeout(() => {
          // 檢查是否為管理員
          if (email === 'admin@parkinsons.org' && password === 'admin123') {
            const adminUser = {
              id: 'admin001',
              name: '系統管理員',
              email: email,
              role: 'admin',
              loginTime: new Date().toISOString()
            };
            this.currentUser = adminUser;
            StorageService.setItem('currentUser', adminUser);
            AppRouter.hideLoading();
            AppRouter.closeModal('loginModal');
            AppRouter.navigate('admin');
            AppRouter.showAlert('登入成功！歡迎回來，管理員', 'success');
          } 
          // 一般會員登入
          else if (email && password) {
            const user = {
              id: 'M2024001',
              name: '王小明',
              email: email,
              role: 'member',
              phone: '0912-345-678',
              joinDate: '2024-01-01',
              loginTime: new Date().toISOString()
            };
            this.currentUser = user;
            StorageService.setItem('currentUser', user);
            AppRouter.hideLoading();
            AppRouter.closeModal('loginModal');
            AppRouter.navigate('dashboard');
            AppRouter.showAlert('登入成功！歡迎回來', 'success');
          } else {
            AppRouter.hideLoading();
            AppRouter.showAlert('帳號或密碼錯誤', 'error');
          }
        }, 1500);
      }

      static logout() {
        if (confirm('確定要登出嗎？')) {
          this.currentUser = null;
          StorageService.removeItem('currentUser');
          AppRouter.navigate('home');
          AppRouter.showAlert('已成功登出', 'info');
        }
      }

      static isAuthenticated() {
        return this.currentUser !== null;
      }

      static isAdmin() {
        return this.currentUser && this.currentUser.role === 'admin';
      }

      static requireAuth(callback) {
        if (!this.isAuthenticated()) {
          AppRouter.showModal('loginModal');
          return false;
        }
        if (callback) callback();
        return true;
      }

      static requireAdmin(callback) {
        if (!this.isAuthenticated()) {
          AppRouter.showModal('loginModal');
          return false;
        }
        if (!this.isAdmin()) {
          AppRouter.showAlert('您沒有權限訪問此頁面', 'error');
          AppRouter.navigate('dashboard');
          return false;
        }
        if (callback) callback();
        return true;
      }
    }

    // ==================== 路由服務 ====================
    class AppRouter {
      static currentPage = 'home';

      static init() {
        // 從 URL 獲取路徑
        const urlParams = new URLSearchParams(window.location.search);
        const path = urlParams.get('path') || 'home';
        
        // 載入頁面內容
        this.loadPageContent();
        
        // 導航到指定頁面
        this.navigate(path);

        // 監聽瀏覽器返回按鈕
        window.addEventListener('popstate', () => {
          const urlParams = new URLSearchParams(window.location.search);
          const path = urlParams.get('path') || 'home';
          this.navigate(path, false);
        });
      }

      static navigate(page, updateHistory = true) {
        // 檢查權限
        if (page === 'dashboard' && !AuthService.isAuthenticated()) {
          this.showModal('loginModal');
          return;
        }

        if (page === 'admin' && !AuthService.requireAdmin()) {
          return;
        }

        // 隱藏所有頁面
        document.querySelectorAll('.page-container').forEach(container => {
          container.classList.remove('active');
        });

        // 顯示目標頁面
        const targetPage = document.getElementById(page + 'Page');
        if (targetPage) {
          targetPage.classList.add('active');
          this.currentPage = page;

          // 更新 URL
          if (updateHistory) {
            const newUrl = `?path=${page}`;
            window.history.pushState({ path: page }, '', newUrl);
          }

          // 載入頁面資料
          this.loadPageData(page);

          // 滾動到頂部
          window.scrollTo({ top: 0, behavior: 'smooth' });
        }
      }

      static loadPageContent() {
        // 載入首頁內容
        this.loadHomePage();
        // 載入註冊頁面內容
        this.loadRegisterPage();
        // 載入登入頁面內容
        this.loadLoginPage();
        // 載入會員中心內容
        this.loadDashboardPage();
        // 載入管理後台內容
        this.loadAdminPage();
      }

      static loadPageData(page) {
        switch(page) {
          case 'home':
            DataService.loadHomeData();
            break;
          case 'dashboard':
            DataService.loadDashboardData();
            break;
          case 'admin':
            DataService.loadAdminData();
            break;
        }
      }

      static showLoading() {
        document.getElementById('loadingOverlay').classList.add('active');
      }

      static hideLoading() {
        document.getElementById('loadingOverlay').classList.remove('active');
      }

      static showModal(modalId) {
        document.getElementById(modalId).classList.add('active');
      }

      static closeModal(modalId) {
        document.getElementById(modalId).classList.remove('active');
      }

      static showAlert(message, type = 'info') {
        const alertDiv = document.createElement('div');
        alertDiv.className = `alert alert-${type}`;
        alertDiv.innerHTML = `
          <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'info-circle'}"></i>
          ${message}
        `;
        alertDiv.style.position = 'fixed';
        alertDiv.style.top = '20px';
        alertDiv.style.right = '20px';
        alertDiv.style.zIndex = '10001';
        alertDiv.style.minWidth = '300px';
        alertDiv.style.animation = 'slideIn 0.3s ease';

        document.body.appendChild(alertDiv);

        setTimeout(() => {
          alertDiv.style.animation = 'slideOut 0.3s ease';
          setTimeout(() => alertDiv.remove(), 300);
        }, 3000);
      }

      // 載入各頁面的 HTML 內容
      static loadHomePage() {
        document.getElementById('homePage').innerHTML = `
          ${this.getHomePageHTML()}
        `;
      }

      static loadRegisterPage() {
        document.getElementById('registerPage').innerHTML = `
          ${this.getRegisterPageHTML()}
        `;
      }

      static loadLoginPage() {
        document.getElementById('loginPage').innerHTML = `
          ${this.getLoginPageHTML()}
        `;
      }

      static loadDashboardPage() {
        document.getElementById('dashboardPage').innerHTML = `
          ${this.getDashboardPageHTML()}
        `;
      }

      static loadAdminPage() {
        document.getElementById('adminPage').innerHTML = `
          ${this.getAdminPageHTML()}
        `;
      }

      // 獲取首頁 HTML
      static getHomePageHTML() {
        return `
          <style>
            .home-header {
              background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
              color: white;
              padding: 1rem 0;
              box-shadow: 0 2px 10px rgba(0,0,0,0.1);
              position: sticky;
              top: 0;
              z-index: 1000;
            }

            .home-header-content {
              max-width: 1200px;
              margin: 0 auto;
              padding: 0 20px;
              display: flex;
              justify-content: space-between;
              align-items: center;
            }

            .home-logo {
              display: flex;
              align-items: center;
              gap: 15px;
              font-size: 1.5rem;
              font-weight: 700;
            }

            .home-nav {
              display: flex;
              gap: 20px;
              list-style: none;
            }

            .home-nav a {
              color: white;
              text-decoration: none;
              padding: 10px 20px;
              border-radius: 8px;
              transition: all 0.3s;
              font-weight: 500;
            }

            .home-nav a:hover {
              background: rgba(255,255,255,0.2);
            }

            .hero-section {
              background: white;
              padding: 4rem 20px;
              text-align: center;
            }

            .hero-content h1 {
              font-size: 3rem;
              color: var(--primary-color);
              margin-bottom: 1rem;
            }

            .hero-content p {
              font-size: 1.3rem;
              color: #666;
              margin-bottom: 2rem;
            }

            .cta-buttons {
              display: flex;
              gap: 20px;
              justify-content: center;
              flex-wrap: wrap;
            }

            .stats-section {
              background: var(--light-color);
              padding: 4rem 20px;
            }

            .stats-container {
              max-width: 1200px;
              margin: 0 auto;
            }

            .stats-grid {
              display: grid;
              grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
              gap: 30px;
              margin-top: 2rem;
            }

            .stat-card {
              background: white;
              padding: 2rem;
              border-radius: 10px;
              text-align: center;
              box-shadow: 0 2px 10px rgba(0,0,0,0.05);
              transition: transform 0.3s;
            }

            .stat-card:hover {
              transform: translateY(-5px);
            }

            .stat-icon {
              font-size: 3rem;
              color: var(--primary-color);
              margin-bottom: 1rem;
            }

            .stat-number {
              font-size: 2.5rem;
              font-weight: bold;
              color: var(--primary-color);
              margin-bottom: 0.5rem;
            }

            .stat-label {
              font-size: 1.1rem;
              color: #666;
            }

            .footer {
              background: var(--dark-color);
              color: white;
              padding: 2rem 20px;
              text-align: center;
            }

            @media (max-width: 768px) {
              .home-nav {
                display: none;
              }
              .hero-content h1 {
                font-size: 2rem;
              }
            }
          </style>

          <header class="home-header">
            <div class="home-header-content">
              <div class="home-logo">
                <i class="fas fa-heartbeat"></i>
                <span>帕金森病友權益促進會</span>
              </div>
              <nav>
                <ul class="home-nav">
                  <li><a href="javascript:void(0)" onclick="AppRouter.navigate('home')"><i class="fas fa-home"></i> 首頁</a></li>
                  <li><a href="javascript:void(0)" onclick="AppRouter.showModal('loginModal')"><i class="fas fa-sign-in-alt"></i> 登入</a></li>
                  <li><a href="javascript:void(0)" onclick="AppRouter.navigate('register')"><i class="fas fa-user-plus"></i> 註冊</a></li>
                </ul>
              </nav>
            </div>
          </header>

          <section class="hero-section">
            <div class="hero-content">
              <h1>攜手同行，溫暖相伴</h1>
              <p>為帕金森病友提供全方位支持與關懷服務</p>
              <div class="cta-buttons">
                <button class="btn btn-primary" onclick="AppRouter.navigate('register')">
                  <i class="fas fa-user-plus"></i> 立即加入
                </button>
                <button class="btn btn-secondary" onclick="AppRouter.showModal('loginModal')">
                  <i class="fas fa-sign-in-alt"></i> 會員登入
                </button>
              </div>
            </div>
          </section>

          <section class="stats-section">
            <div class="stats-container">
              <h2 style="text-align: center; font-size: 2.5rem; color: var(--primary-color); margin-bottom: 1rem;">我們的成果</h2>
              <div class="stats-grid">
                <div class="stat-card">
                  <div class="stat-icon"><i class="fas fa-users"></i></div>
                  <div class="stat-number">1,250</div>
                  <div class="stat-label">會員總數</div>
                </div>
                <div class="stat-card">
                  <div class="stat-icon"><i class="fas fa-calendar-check"></i></div>
                  <div class="stat-number">156</div>
                  <div class="stat-label">舉辦活動</div>
                </div>
                <div class="stat-card">
                  <div class="stat-icon"><i class="fas fa-user-friends"></i></div>
                  <div class="stat-number">3,420</div>
                  <div class="stat-label">參與人次</div>
                </div>
                <div class="stat-card">
                  <div class="stat-icon"><i class="fas fa-heart"></i></div>
                  <div class="stat-number">98%</div>
                  <div class="stat-label">滿意度</div>
                </div>
              </div>
            </div>
          </section>

          <footer class="footer">
            <p>&copy; 2024 帕金森病友權益促進會. All rights reserved.</p>
            <p style="margin-top: 1rem;">
              <a href="javascript:void(0)" onclick="AppRouter.navigate('admin')" style="color: white; text-decoration: none; opacity: 0.7;">管理後台</a>
            </p>
          </footer>
        `;
      }

      // 獲取註冊頁面 HTML
      static getRegisterPageHTML() {
        return `
          <style>
            .register-container {
              background: white;
              border-radius: 20px;
              box-shadow: 0 20px 60px rgba(0,0,0,0.3);
              max-width: 600px;
              width: 90%;
              margin: 2rem auto;
              overflow: hidden;
            }

            .register-header {
              background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
              color: white;
              padding: 2rem;
              text-align: center;
            }

            .register-body {
              padding: 2rem;
            }

            .form-row {
              display: grid;
              grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
              gap: 1rem;
            }
          </style>

          <div class="register-container">
            <div class="register-header">
              <h1><i class="fas fa-user-plus"></i> 會員註冊</h1>
              <p>加入我們的大家庭，一起互相支持</p>
            </div>

            <div class="register-body">
              <form onsubmit="DataService.handleRegister(event)">
                <div class="form-group">
                  <label>姓名 <span style="color: var(--danger-color);">*</span></label>
                  <input type="text" id="regName" required placeholder="請輸入您的姓名">
                </div>

                <div class="form-row">
                  <div class="form-group">
                    <label>性別 <span style="color: var(--danger-color);">*</span></label>
                    <select id="regGender" required>
                      <option value="">請選擇</option>
                      <option value="male">男性</option>
                      <option value="female">女性</option>
                      <option value="other">其他</option>
                    </select>
                  </div>

                  <div class="form-group">
                    <label>出生日期 <span style="color: var(--danger-color);">*</span></label>
                    <input type="date" id="regBirthDate" required>
                  </div>
                </div>

                <div class="form-group">
                  <label>電子郵件 <span style="color: var(--danger-color);">*</span></label>
                  <input type="email" id="regEmail" required placeholder="example@email.com">
                </div>

                <div class="form-group">
                  <label>手機號碼 <span style="color: var(--danger-color);">*</span></label>
                  <input type="tel" id="regPhone" required placeholder="0912345678" pattern="09[0-9]{8}">
                </div>

                <div class="form-group">
                  <label>密碼 <span style="color: var(--danger-color);">*</span></label>
                  <input type="password" id="regPassword" required placeholder="請輸入密碼" minlength="6">
                </div>

                <div class="form-group">
                  <label>
                    <input type="checkbox" required>
                    我已閱讀並同意隱私權政策 <span style="color: var(--danger-color);">*</span>
                  </label>
                </div>

                <div style="display: flex; gap: 1rem; margin-top: 2rem;">
                  <button type="button" class="btn btn-secondary" onclick="AppRouter.navigate('home')">
                    <i class="fas fa-arrow-left"></i> 返回
                  </button>
                  <button type="submit" class="btn btn-primary" style="flex: 1;">
                    <i class="fas fa-check"></i> 送出註冊
                  </button>
                </div>

                <p style="text-align: center; margin-top: 1rem; color: #666;">
                  已經是會員？ <a href="javascript:void(0)" onclick="AppRouter.showModal('loginModal')" style="color: var(--primary-color); text-decoration: none;">立即登入</a>
                </p>
              </form>
            </div>
          </div>
        `;
      }

      // 獲取登入頁面 HTML（備用）
      static getLoginPageHTML() {
        return `<div style="padding: 2rem; text-align: center;">
          <p>請使用登入彈窗進行登入</p>
          <button class="btn btn-primary" onclick="AppRouter.showModal('loginModal')">開啟登入視窗</button>
        </div>`;
      }

      // 獲取會員中心 HTML
      static getDashboardPageHTML() {
        return `
          <style>
            .dashboard-header {
              background: white;
              border-bottom: 1px solid #e0e0e0;
              padding: 1rem 2rem;
              display: flex;
              justify-content: space-between;
              align-items: center;
              position: sticky;
              top: 0;
              z-index: 1000;
            }

            .dashboard-logo {
              display: flex;
              align-items: center;
              gap: 10px;
              font-size: 1.2rem;
              font-weight: 600;
              color: var(--primary-color);
            }

            .dashboard-user {
              display: flex;
              align-items: center;
              gap: 15px;
            }

            .user-avatar {
              width: 40px;
              height: 40px;
              border-radius: 50%;
              background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
              color: white;
              display: flex;
              align-items: center;
              justify-content: center;
              font-weight: 600;
            }

            .dashboard-content {
              max-width: 1200px;
              margin: 0 auto;
              padding: 2rem;
            }

            .welcome-section {
              background: white;
              padding: 2rem;
              border-radius: 15px;
              margin-bottom: 2rem;
              box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            }

            .stats-grid {
              display: grid;
              grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
              gap: 1.5rem;
              margin-bottom: 2rem;
            }

            .stat-card {
              background: white;
              padding: 1.5rem;
              border-radius: 12px;
              box-shadow: 0 2px 10px rgba(0,0,0,0.05);
              display: flex;
              align-items: center;
              gap: 1rem;
            }

            .stat-icon {
              width: 60px;
              height: 60px;
              border-radius: 12px;
              display: flex;
              align-items: center;
              justify-content: center;
              font-size: 1.5rem;
              color: white;
              background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            }

            .stat-content h3 {
              font-size: 1.8rem;
              color: var(--dark-color);
              margin-bottom: 0.3rem;
            }

            .stat-content p {
              color: #666;
              font-size: 0.9rem;
            }

            .section {
              background: white;
              border-radius: 12px;
              padding: 1.5rem;
              margin-bottom: 2rem;
              box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            }

            .section h2 {
              color: var(--dark-color);
              margin-bottom: 1.5rem;
              padding-bottom: 1rem;
              border-bottom: 2px solid var(--light-color);
            }
          </style>

          <header class="dashboard-header">
            <div class="dashboard-logo">
              <i class="fas fa-heartbeat"></i>
              <span>會員中心</span>
            </div>
            <div class="dashboard-user">
              <span id="dashboardUserName">載入中...</span>
              <div class="user-avatar" id="dashboardUserAvatar">?</div>
              <button class="btn btn-secondary btn-sm" onclick="AuthService.logout()">
                <i class="fas fa-sign-out-alt"></i> 登出
              </button>
            </div>
          </header>

          <div class="dashboard-content">
            <div class="welcome-section">
              <h1>👋 歡迎回來，<span id="welcomeUserName">會員</span></h1>
              <p>今天是 <span id="currentDate"></span></p>
            </div>

            <div class="stats-grid">
              <div class="stat-card">
                <div class="stat-icon">
                  <i class="fas fa-calendar-check"></i>
                </div>
                <div class="stat-content">
                  <h3>3</h3>
                  <p>即將參加的活動</p>
                </div>
              </div>

              <div class="stat-card">
                <div class="stat-icon">
                  <i class="fas fa-check-circle"></i>
                </div>
                <div class="stat-content">
                  <h3>12</h3>
                  <p>已參加活動</p>
                </div>
              </div>

              <div class="stat-card">
                <div class="stat-icon">
                  <i class="fas fa-bell"></i>
                </div>
                <div class="stat-content">
                  <h3>5</h3>
                  <p>未讀通知</p>
                </div>
              </div>

              <div class="stat-card">
                <div class="stat-icon">
                  <i class="fas fa-calendar-day"></i>
                </div>
                <div class="stat-content">
                  <h3 id="memberDays">0</h3>
                  <p>會員天數</p>
                </div>
              </div>
            </div>

            <div class="section">
              <h2><i class="fas fa-user"></i> 個人資料</h2>
              <div id="memberProfile">載入中...</div>
            </div>

            <div class="section">
              <h2><i class="fas fa-calendar-alt"></i> 我的活動</h2>
              <div id="memberActivities">載入中...</div>
            </div>
          </div>
        `;
      }

      // 獲取管理後台 HTML
      static getAdminPageHTML() {
        return `
          <style>
            .admin-layout {
              display: flex;
              min-height: 100vh;
            }

            .admin-sidebar {
              width: 260px;
              background: white;
              border-right: 1px solid #e0e0e0;
              padding: 1.5rem 0;
            }

            .admin-sidebar h3 {
              padding: 0 1.5rem;
              color: #999;
              font-size: 0.75rem;
              text-transform: uppercase;
              margin-bottom: 0.5rem;
            }

            .admin-menu {
              list-style: none;
            }

            .admin-menu a {
              display: flex;
              align-items: center;
              gap: 12px;
              padding: 0.8rem 1.5rem;
              color: var(--dark-color);
              text-decoration: none;
              transition: all 0.3s;
              border-left: 3px solid transparent;
            }

            .admin-menu a:hover,
            .admin-menu a.active {
              background: var(--light-color);
              border-left-color: var(--primary-color);
              color: var(--primary-color);
            }

            .admin-content {
              flex: 1;
              padding: 2rem;
              background: var(--light-color);
            }

            .admin-header {
              background: white;
              padding: 1rem 2rem;
              border-bottom: 1px solid #e0e0e0;
              display: flex;
              justify-content: space-between;
              align-items: center;
              position: sticky;
              top: 0;
              z-index: 1000;
            }

            .page-header h1 {
              font-size: 2rem;
              color: var(--dark-color);
              margin-bottom: 0.5rem;
            }

            .stats-grid {
              display: grid;
              grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
              gap: 1.5rem;
              margin-bottom: 2rem;
            }

            .stat-card {
              background: white;
              padding: 1.5rem;
              border-radius: 12px;
              box-shadow: 0 2px 10px rgba(0,0,0,0.05);
              display: flex;
              align-items: center;
              gap: 1rem;
            }

            .stat-icon {
              width: 60px;
              height: 60px;
              border-radius: 12px;
              display: flex;
              align-items: center;
              justify-content: center;
              font-size: 1.5rem;
              color: white;
            }

            .stat-icon.blue {
              background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            }

            .stat-icon.green {
              background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            }

            .stat-icon.orange {
              background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            }

            .stat-icon.red {
              background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            }

            .stat-content h3 {
              font-size: 1.8rem;
              color: var(--dark-color);
            }

            .stat-content p {
              color: #666;
              font-size: 0.9rem;
            }

            .section {
              background: white;
              border-radius: 12px;
              padding: 1.5rem;
              margin-bottom: 2rem;
              box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            }

            .section h2 {
              color: var(--dark-color);
              margin-bottom: 1.5rem;
              padding-bottom: 1rem;
              border-bottom: 2px solid var(--light-color);
            }

            table {
              width: 100%;
              border-collapse: collapse;
            }

            table th {
              padding: 1rem;
              text-align: left;
              background: var(--light-color);
              font-weight: 600;
              color: var(--dark-color);
            }

            table td {
              padding: 1rem;
              border-bottom: 1px solid #eee;
            }

            table tr:hover {
              background: var(--light-color);
            }

            .status-badge {
              display: inline-block;
              padding: 4px 12px;
              border-radius: 20px;
              font-size: 0.8rem;
              font-weight: 600;
            }

            .status-badge.active {
              background: #e8f5e9;
              color: #2e7d32;
            }

            .status-badge.inactive {
              background: #ffebee;
              color: #c62828;
            }
          </style>

          <div class="admin-layout">
            <aside class="admin-sidebar">
              <h3>主要功能</h3>
              <ul class="admin-menu">
                <li><a href="javascript:void(0)" onclick="AdminService.showAdminSection('dashboard')" class="active">
                  <i class="fas fa-home"></i> 儀表板
                </a></li>
                <li><a href="javascript:void(0)" onclick="AdminService.showAdminSection('members')">
                  <i class="fas fa-users"></i> 會員管理
                </a></li>
                <li><a href="javascript:void(0)" onclick="AdminService.showAdminSection('activities')">
                  <i class="fas fa-calendar-alt"></i> 活動管理
                </a></li>
                <li><a href="javascript:void(0)" onclick="AdminService.showAdminSection('finance')">
                  <i class="fas fa-dollar-sign"></i> 財務管理
                </a></li>
                <li><a href="javascript:void(0)" onclick="AdminService.showAdminSection('settings')">
                  <i class="fas fa-cog"></i> 系統設定
                </a></li>
              </ul>
            </aside>

            <div style="flex: 1;">
              <header class="admin-header">
                <div style="display: flex; align-items: center; gap: 10px;">
                  <i class="fas fa-heartbeat" style="font-size: 1.5rem; color: var(--primary-color);"></i>
                  <span style="font-size: 1.2rem; font-weight: 600;">管理後台</span>
                </div>
                <div style="display: flex; align-items: center; gap: 15px;">
                  <span id="adminUserName">管理員</span>
                  <button class="btn btn-secondary btn-sm" onclick="AuthService.logout()">
                    <i class="fas fa-sign-out-alt"></i> 登出
                  </button>
                </div>
              </header>

              <div class="admin-content">
                <div id="adminDashboard" class="admin-section">
                  <div class="page-header">
                    <h1>📊 儀表板總覽</h1>
                  </div>

                  <div class="stats-grid">
                    <div class="stat-card">
                      <div class="stat-icon blue">
                        <i class="fas fa-users"></i>
                      </div>
                      <div class="stat-content">
                        <h3>1,250</h3>
                        <p>總會員數</p>
                      </div>
                    </div>

                    <div class="stat-card">
                      <div class="stat-icon green">
                        <i class="fas fa-calendar-check"></i>
                      </div>
                      <div class="stat-content">
                        <h3>156</h3>
                        <p>舉辦活動</p>
                      </div>
                    </div>

                    <div class="stat-card">
                      <div class="stat-icon orange">
                        <i class="fas fa-user-friends"></i>
                      </div>
                      <div class="stat-content">
                        <h3>3,420</h3>
                        <p>參與人次</p>
                      </div>
                    </div>

                    <div class="stat-card">
                      <div class="stat-icon red">
                        <i class="fas fa-dollar-sign"></i>
                      </div>
                      <div class="stat-content">
                        <h3>$2.5M</h3>
                        <p>總收入</p>
                      </div>
                    </div>
                  </div>

                  <div class="section">
                    <h2><i class="fas fa-user-plus"></i> 最新加入會員</h2>
                    <table id="adminRecentMembers">
                      <thead>
                        <tr>
                          <th>會員編號</th>
                          <th>姓名</th>
                          <th>電子郵件</th>
                          <th>加入日期</th>
                          <th>狀態</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr><td colspan="5" style="text-align: center;">載入中...</td></tr>
                      </tbody>
                    </table>
                  </div>
                </div>

                <div id="adminMembers" class="admin-section" style="display: none;">
                  <div class="page-header">
                    <h1>👥 會員管理</h1>
                  </div>
                  <div class="section">
                    <h2>會員列表</h2>
                    <div id="adminMembersList">載入中...</div>
                  </div>
                </div>

                <div id="adminActivities" class="admin-section" style="display: none;">
                  <div class="page-header">
                    <h1>📅 活動管理</h1>
                  </div>
                  <div class="section">
                    <h2>活動列表</h2>
                    <div id="adminActivitiesList">載入中...</div>
                  </div>
                </div>

                <div id="adminFinance" class="admin-section" style="display: none;">
                  <div class="page-header">
                    <h1>💰 財務管理</h1>
                  </div>
                  <div class="section">
                    <h2>財務總覽</h2>
                    <p>財務管理功能開發中...</p>
                  </div>
                </div>

                <div id="adminSettings" class="admin-section" style="display: none;">
                  <div class="page-header">
                    <h1>⚙️ 系統設定</h1>
                  </div>
                  <div class="section">
                    <h2>系統設定</h2>
                    <p>系統設定功能開發中...</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        `;
      }
    }

    // ==================== 資料服務 ====================
    class DataService {
      static loadHomeData() {
        // 首頁資料已在 HTML 中
      }

      static loadDashboardData() {
        if (!AuthService.currentUser) return;

        // 更新使用者資訊
        const userName = AuthService.currentUser.name;
        const userAvatar = userName.charAt(0);

        document.getElementById('dashboardUserName').textContent = userName;
        document.getElementById('dashboardUserAvatar').textContent = userAvatar;
        document.getElementById('welcomeUserName').textContent = userName;

        // 更新當前日期
        const now = new Date();
        const options = { year: 'numeric', month: 'long', day: 'numeric', weekday: 'long' };
        document.getElementById('currentDate').textContent = now.toLocaleDateString('zh-TW', options);

        // 計算會員天數
        const joinDate = new Date(AuthService.currentUser.joinDate);
        const today = new Date();
        const daysDiff = Math.floor((today - joinDate) / (1000 * 60 * 60 * 24));
        document.getElementById('memberDays').textContent = daysDiff;

        // 載入個人資料
        document.getElementById('memberProfile').innerHTML = `
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
            <div><strong>會員編號：</strong>${AuthService.currentUser.id}</div>
            <div><strong>姓名：</strong>${AuthService.currentUser.name}</div>
            <div><strong>電子郵件：</strong>${AuthService.currentUser.email}</div>
            <div><strong>電話：</strong>${AuthService.currentUser.phone}</div>
            <div><strong>加入日期：</strong>${AuthService.currentUser.joinDate}</div>
            <div><strong>會員狀態：</strong><span class="status-badge active">正常</span></div>
          </div>
        `;

        // 載入活動列表
        document.getElementById('memberActivities').innerHTML = `
          <p>您目前沒有報名任何活動</p>
          <button class="btn btn-primary" onclick="AppRouter.showAlert('活動報名功能開發中', 'info')">
            <i class="fas fa-calendar-plus"></i> 瀏覽活動
          </button>
        `;
      }

      static loadAdminData() {
        if (!AuthService.currentUser) return;

        // 更新管理員名稱
        document.getElementById('adminUserName').textContent = AuthService.currentUser.name;

        // 載入最新會員
        setTimeout(() => {
          const members = [
            { id: 'M2024050', name: '王小明', email: 'wang@example.com', date: '2024-11-01', status: 'active' },
            { id: 'M2024049', name: '李小華', email: 'lee@example.com', date: '2024-10-28', status: 'active' },
            { id: 'M2024048', name: '陳大同', email: 'chen@example.com', date: '2024-10-25', status: 'active' },
            { id: 'M2024047', name: '林美玲', email: 'lin@example.com', date: '2024-10-22', status: 'active' },
            { id: 'M2024046', name: '張志明', email: 'chang@example.com', date: '2024-10-20', status: 'active' }
          ];

          const tbody = document.querySelector('#adminRecentMembers tbody');
          tbody.innerHTML = members.map(member => `
            <tr>
              <td>${member.id}</td>
              <td>${member.name}</td>
              <td>${member.email}</td>
              <td>${member.date}</td>
              <td><span class="status-badge ${member.status}">正常</span></td>
            </tr>
          `).join('');
        }, 500);
      }

      static handleRegister(event) {
        event.preventDefault();
        AppRouter.showLoading();

        const formData = {
          name: document.getElementById('regName').value,
          gender: document.getElementById('regGender').value,
          birthDate: document.getElementById('regBirthDate').value,
          email: document.getElementById('regEmail').value,
          phone: document.getElementById('regPhone').value,
          password: document.getElementById('regPassword').value
        };

        // 模擬 API 呼叫
        setTimeout(() => {
          AppRouter.hideLoading();
          AppRouter.showAlert('註冊成功！請登入', 'success');
          AppRouter.navigate('home');
          setTimeout(() => {
            AppRouter.showModal('loginModal');
          }, 1000);
        }, 2000);
      }
    }

    // ==================== 管理後台服務 ====================
    class AdminService {
      static showAdminSection(section) {
        // 隱藏所有區塊
        document.querySelectorAll('.admin-section').forEach(el => {
          el.style.display = 'none';
        });

        // 顯示目標區塊
        const targetSection = document.getElementById('admin' + section.charAt(0).toUpperCase() + section.slice(1));
        if (targetSection) {
          targetSection.style.display = 'block';
        }

        // 更新選單狀態
        document.querySelectorAll('.admin-menu a').forEach(link => {
          link.classList.remove('active');
        });
        event.target.closest('a').classList.add('active');

        // 載入區塊資料
        this.loadSectionData(section);
      }

      static loadSectionData(section) {
        switch(section) {
          case 'members':
            this.loadMembersData();
            break;
          case 'activities':
            this.loadActivitiesData();
            break;
        }
      }

      static loadMembersData() {
        const container = document.getElementById('adminMembersList');
        container.innerHTML = '<p>載入中...</p>';

        setTimeout(() => {
          container.innerHTML = `
            <table>
              <thead>
                <tr>
                  <th>會員編號</th>
                  <th>姓名</th>
                  <th>電子郵件</th>
                  <th>電話</th>
                  <th>加入日期</th>
                  <th>狀態</th>
                  <th>操作</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>M2024050</td>
                  <td>王小明</td>
                  <td>wang@example.com</td>
                  <td>0912-345-678</td>
                  <td>2024-11-01</td>
                  <td><span class="status-badge active">正常</span></td>
                  <td>
                    <button class="btn btn-primary btn-sm" onclick="AppRouter.showAlert('查看會員詳情', 'info')">
                      <i class="fas fa-eye"></i>
                    </button>
                  </td>
                </tr>
                <tr>
                  <td>M2024049</td>
                  <td>李小華</td>
                  <td>lee@example.com</td>
                  <td>0923-456-789</td>
                  <td>2024-10-28</td>
                  <td><span class="status-badge active">正常</span></td>
                  <td>
                    <button class="btn btn-primary btn-sm" onclick="AppRouter.showAlert('查看會員詳情', 'info')">
                      <i class="fas fa-eye"></i>
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>
          `;
        }, 500);
      }

      static loadActivitiesData() {
        const container = document.getElementById('adminActivitiesList');
        container.innerHTML = '<p>載入中...</p>';

        setTimeout(() => {
          container.innerHTML = `
            <table>
              <thead>
                <tr>
                  <th>活動編號</th>
                  <th>活動名稱</th>
                  <th>日期</th>
                  <th>地點</th>
                  <th>報名人數</th>
                  <th>狀態</th>
                  <th>操作</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>A2024015</td>
                  <td>帕金森病友健康講座</td>
                  <td>2024-11-15</td>
                  <td>台北市中正區</td>
                  <td>35/50</td>
                  <td><span class="status-badge active">報名中</span></td>
                  <td>
                    <button class="btn btn-primary btn-sm" onclick="AppRouter.showAlert('查看活動詳情', 'info')">
                      <i class="fas fa-eye"></i>
                    </button>
                  </td>
                </tr>
                <tr>
                  <td>A2024014</td>
                  <td>復健運動課程</td>
                  <td>2024-11-20</td>
                  <td>新北市板橋區</td>
                  <td>18/20</td>
                  <td><span class="status-badge active">報名中</span></td>
                  <td>
                    <button class="btn btn-primary btn-sm" onclick="AppRouter.showAlert('查看活動詳情', 'info')">
                      <i class="fas fa-eye"></i>
                    </button>
                  </td>
                </tr>
              </tbody>
            </table>
          `;
        }, 500);
      }
    }

    // ==================== 初始化應用程式 ====================
    document.addEventListener('DOMContentLoaded', function() {
      // 初始化認證服務
      AuthService.init();
      
      // 初始化路由
      AppRouter.init();

      // 添加動畫樣式
      const style = document.createElement('style');
      style.textContent = `
        @keyframes slideIn {
          from {
            transform: translateX(100%);
            opacity: 0;
          }
          to {
            transform: translateX(0);
            opacity: 1;
          }
        }

        @keyframes slideOut {
          from {
            transform: translateX(0);
            opacity: 1;
          }
          to {
            transform: translateX(100%);
            opacity: 0;
          }
        }
      `;
      document.head.appendChild(style);

      // 關閉 modal 當點擊外部
      document.querySelectorAll('.modal').forEach(modal => {
        modal.addEventListener('click', function(e) {
          if (e.target === this) {
            this.classList.remove('active');
          }
        });
      });

      console.log('🎉 帕金森病友權益促進會系統已啟動');
      console.log('📝 測試帳號：');
      console.log('   管理員 - admin@parkinsons.org / admin123');
      console.log('   會員 - 任意信箱 / 任意密碼');
    });
  </script>
</body>
</html>
