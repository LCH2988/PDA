<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#667eea">
  <title>æœƒå“¡å¤§æœƒå ±å</title>
  <style>
      * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
          -webkit-tap-highlight-color: transparent;
      }
      
      :root {
          --primary-color: #667eea;
          --secondary-color: #764ba2;
          --success-color: #4caf50;
          --error-color: #f44336;
          --text-dark: #222;
          --text-light: #555;
          --bg-light: #f8f9ff;
          --border-color: #d0d0d0;
      }
      
      body {
          font-family: -apple-system, BlinkMacSystemFont, 'Microsoft JhengHei', 'Segoe UI', 'Arial', sans-serif;
          background: #f5f5f5;
          color: var(--text-dark);
          overflow-x: hidden;
          -webkit-font-smoothing: antialiased;
          font-size: 18px;
          line-height: 1.8;
      }
      
      /* é ‚éƒ¨æ¨™é¡Œæ¬„ */
      .app-header {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          height: 60px;
          background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
          color: white;
          display: flex;
          align-items: center;
          justify-content: center;
          padding: 0 20px;
          box-shadow: 0 2px 10px rgba(0,0,0,0.15);
          z-index: 1000;
      }
      
      .app-title {
          font-size: 22px;
          font-weight: bold;
          letter-spacing: 1px;
      }
      
      /* åº•éƒ¨å°èˆªæ¬„ */
      .bottom-nav {
          position: fixed;
          bottom: 0;
          left: 0;
          right: 0;
          height: 75px;
          background: white;
          display: flex;
          justify-content: space-around;
          align-items: center;
          box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
          z-index: 1000;
          padding-bottom: env(safe-area-inset-bottom);
      }
      
      .nav-item {
          flex: 1;
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          padding: 8px;
          cursor: pointer;
          transition: all 0.3s;
          color: #999;
      }
      
      .nav-item.active {
          color: var(--primary-color);
      }
      
      .nav-icon {
          font-size: 28px;
          margin-bottom: 4px;
      }
      
      .nav-label {
          font-size: 15px;
          font-weight: 600;
      }
      
      /* ä¸»è¦å…§å®¹å€ */
      .app-content {
          margin-top: 60px;
          padding-bottom: 90px;
          min-height: calc(100vh - 135px);
      }
      
      /* é é¢åˆ‡æ› */
      .page {
          display: none;
          animation: fadeIn 0.3s ease-in-out;
      }
      
      .page.active {
          display: block;
      }
      
      @keyframes fadeIn {
          from {
              opacity: 0;
              transform: translateY(10px);
          }
          to {
              opacity: 1;
              transform: translateY(0);
          }
      }
      
      /* æ´»å‹•è³‡è¨Šé é¢ */
      .event-banner {
          background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
          color: white;
          padding: 40px 24px;
          text-align: center;
      }
      
      .event-banner h1 {
          font-size: 32px;
          margin-bottom: 12px;
          line-height: 1.4;
          font-weight: bold;
      }
      
      .event-banner .subtitle {
          font-size: 19px;
          opacity: 0.95;
          line-height: 1.6;
      }
      
      .event-date {
          background: white;
          margin: -25px 20px 0;
          padding: 28px;
          border-radius: 16px;
          box-shadow: 0 4px 16px rgba(0,0,0,0.12);
          text-align: center;
      }
      
      .event-date .year {
          color: var(--text-light);
          font-size: 18px;
          margin-bottom: 8px;
          font-weight: 600;
      }
      
      .event-date .date {
          color: var(--primary-color);
          font-size: 38px;
          font-weight: bold;
          letter-spacing: 2px;
      }
      
      .info-card {
          background: white;
          margin: 20px;
          padding: 28px;
          border-radius: 16px;
          box-shadow: 0 2px 12px rgba(0,0,0,0.08);
      }
      
      .info-card-title {
          font-size: 24px;
          font-weight: bold;
          color: var(--primary-color);
          margin-bottom: 24px;
          display: flex;
          align-items: center;
          gap: 10px;
          line-height: 1.4;
      }
      
      .info-item {
          padding: 18px 0;
          border-bottom: 2px solid var(--border-color);
      }
      
      .info-item:last-child {
          border-bottom: none;
      }
      
      .info-label {
          font-size: 17px;
          color: var(--text-light);
          margin-bottom: 8px;
          font-weight: 600;
      }
      
      .info-value {
          font-size: 20px;
          font-weight: 700;
          color: var(--text-dark);
          line-height: 1.6;
      }
      
      .fee-item {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 18px 0;
          border-bottom: 2px solid var(--border-color);
      }
      
      .fee-item:last-child {
          border-bottom: none;
      }
      
      .fee-label {
          font-size: 19px;
          color: var(--text-dark);
          font-weight: 600;
          line-height: 1.5;
      }
      
      .fee-amount {
          font-size: 21px;
          font-weight: bold;
          color: var(--primary-color);
          white-space: nowrap;
          margin-left: 16px;
      }
      
      .bank-info {
          background: var(--bg-light);
          padding: 24px;
          border-radius: 12px;
          margin-top: 16px;
          border: 2px solid var(--primary-color);
      }
      
      .bank-row {
          display: flex;
          margin-bottom: 16px;
          line-height: 1.6;
      }
      
      .bank-row:last-child {
          margin-bottom: 0;
      }
      
      .bank-label {
          width: 100px;
          color: var(--text-light);
          font-size: 18px;
          font-weight: 600;
          flex-shrink: 0;
      }
      
      .bank-value {
          flex: 1;
          font-weight: 700;
          font-size: 18px;
          color: var(--text-dark);
      }
      
      .account-number {
          color: var(--primary-color);
          font-size: 24px;
          letter-spacing: 2px;
          font-weight: bold;
      }
      
      .link-button {
          display: block;
          background: var(--primary-color);
          color: white;
          padding: 18px;
          border-radius: 12px;
          text-align: center;
          text-decoration: none;
          font-weight: bold;
          font-size: 19px;
          margin-top: 16px;
          box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
      }
      
      .link-button:active {
          transform: scale(0.98);
      }
      
      /* å ±åè¡¨å–®é é¢ */
      .form-container {
          padding: 20px;
      }
      
      .form-card {
          background: white;
          padding: 28px;
          border-radius: 16px;
          box-shadow: 0 2px 12px rgba(0,0,0,0.08);
          margin-bottom: 20px;
      }
      
      .form-group {
          margin-bottom: 28px;
      }
      
      .form-group:last-child {
          margin-bottom: 0;
      }
      
      .form-group label {
          display: block;
          font-size: 20px;
          font-weight: bold;
          color: var(--text-dark);
          margin-bottom: 12px;
          line-height: 1.5;
      }
      
      .required {
          color: var(--error-color);
          font-size: 22px;
      }
      
      .form-control {
          width: 100%;
          padding: 18px;
          font-size: 20px;
          border: 3px solid var(--border-color);
          border-radius: 12px;
          font-family: inherit;
          transition: border-color 0.3s;
          background: white;
          font-weight: 500;
      }
      
      .form-control:focus {
          outline: none;
          border-color: var(--primary-color);
          box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
      }
      
      .form-control::placeholder {
          color: #aaa;
          font-size: 18px;
      }
      
      textarea.form-control {
          resize: vertical;
          min-height: 120px;
          line-height: 1.6;
      }
      
      .radio-group {
          display: flex;
          flex-direction: column;
          gap: 14px;
      }
      
      .radio-option {
          position: relative;
          display: flex;
          align-items: center;
          padding: 22px 20px;
          background: var(--bg-light);
          border: 3px solid transparent;
          border-radius: 12px;
          cursor: pointer;
          transition: all 0.3s;
      }
      
      .radio-option:active {
          transform: scale(0.98);
      }
      
      .radio-option input[type="radio"] {
          position: absolute;
          opacity: 0;
      }
      
      .radio-option input[type="radio"]:checked + .radio-label {
          font-weight: bold;
      }
      
      .radio-option input[type="radio"]:checked ~ .radio-check {
          background: var(--primary-color);
          border-color: var(--primary-color);
      }
      
      .radio-option input[type="radio"]:checked ~ .radio-check::after {
          opacity: 1;
          transform: scale(1);
      }
      
      .radio-option.checked {
          background: white;
          border-color: var(--primary-color);
          box-shadow: 0 2px 8px rgba(102, 126, 234, 0.2);
      }
      
      .radio-label {
          flex: 1;
          font-size: 19px;
          color: var(--text-dark);
          padding-left: 16px;
          line-height: 1.6;
          font-weight: 600;
      }
      
      .radio-label small {
          display: block;
          font-size: 16px;
          color: var(--text-light);
          margin-top: 4px;
          font-weight: 500;
      }
      
      .radio-check {
          width: 28px;
          height: 28px;
          border: 3px solid var(--border-color);
          border-radius: 50%;
          position: relative;
          transition: all 0.3s;
          flex-shrink: 0;
      }
      
      .radio-check::after {
          content: '';
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%) scale(0);
          width: 12px;
          height: 12px;
          background: white;
          border-radius: 50%;
          opacity: 0;
          transition: all 0.3s;
      }
      
      /* è‘·ç´ é¸é …æ¨£å¼ */
      .diet-group {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 14px;
      }
      
      .diet-option {
          position: relative;
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          padding: 24px 16px;
          background: var(--bg-light);
          border: 3px solid transparent;
          border-radius: 12px;
          cursor: pointer;
          transition: all 0.3s;
          min-height: 120px;
      }
      
      .diet-option:active {
          transform: scale(0.98);
      }
      
      .diet-option input[type="radio"] {
          position: absolute;
          opacity: 0;
      }
      
      .diet-option.checked {
          background: white;
          border-color: var(--primary-color);
          box-shadow: 0 2px 8px rgba(102, 126, 234, 0.2);
      }
      
      .diet-icon {
          font-size: 40px;
          margin-bottom: 12px;
      }
      
      .diet-label {
          font-size: 20px;
          font-weight: bold;
          color: var(--text-dark);
      }
      
      /* ç¹³è²»æ–¹å¼é¸é …æ¨£å¼ */
      .payment-group {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 14px;
      }
      
      .payment-option {
          position: relative;
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          padding: 24px 16px;
          background: var(--bg-light);
          border: 3px solid transparent;
          border-radius: 12px;
          cursor: pointer;
          transition: all 0.3s;
          min-height: 120px;
      }
      
      .payment-option:active {
          transform: scale(0.98);
      }
      
      .payment-option input[type="radio"] {
          position: absolute;
          opacity: 0;
      }
      
      .payment-option.checked {
          background: white;
          border-color: var(--primary-color);
          box-shadow: 0 2px 8px rgba(102, 126, 234, 0.2);
      }
      
      .payment-icon {
          font-size: 40px;
          margin-bottom: 12px;
      }
      
      .payment-label {
          font-size: 20px;
          font-weight: bold;
          color: var(--text-dark);
      }
      
      /* è½‰å¸³å¾Œ5ç¢¼è¼¸å…¥æ¡† */
      .transfer-code-group {
          display: none;
          margin-top: 16px;
          padding: 20px;
          background: #fff8e1;
          border-radius: 12px;
          border: 2px solid #ffc107;
      }
      
      .transfer-code-group.show {
          display: block;
          animation: slideDown 0.3s ease-out;
      }
      
      @keyframes slideDown {
          from {
              opacity: 0;
              transform: translateY(-10px);
          }
          to {
              opacity: 1;
              transform: translateY(0);
          }
      }
      
      .transfer-hint {
          font-size: 17px;
          color: #f57c00;
          margin-bottom: 12px;
          font-weight: 600;
          line-height: 1.6;
      }
      
      .fee-display {
          background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
          color: white;
          padding: 32px;
          border-radius: 16px;
          text-align: center;
          margin: 24px 0;
          box-shadow: 0 4px 16px rgba(102, 126, 234, 0.3);
      }
      
      .fee-display .label {
          font-size: 19px;
          opacity: 0.95;
          margin-bottom: 12px;
          font-weight: 600;
      }
      
      .fee-display .amount {
          font-size: 48px;
          font-weight: bold;
          letter-spacing: 2px;
      }
      
      .submit-btn {
          width: 100%;
          padding: 22px;
          font-size: 22px;
          font-weight: bold;
          color: white;
          background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
          border: none;
          border-radius: 16px;
          cursor: pointer;
          transition: all 0.3s;
          box-shadow: 0 6px 16px rgba(102, 126, 234, 0.4);
          letter-spacing: 2px;
      }
      
      .submit-btn:active {
          transform: scale(0.98);
      }
      
      .submit-btn:disabled {
          opacity: 0.6;
          transform: none;
      }
      
      /* çµ±è¨ˆé é¢ */
      .stats-container {
          padding: 20px;
      }
      
      .stats-grid {
          display: grid;
          grid-template-columns: repeat(2, 1fr);
          gap: 16px;
          margin-bottom: 20px;
      }
      
      .stat-card {
          background: white;
          padding: 28px 20px;
          border-radius: 16px;
          text-align: center;
          box-shadow: 0 2px 12px rgba(0,0,0,0.08);
      }
      
      .stat-icon {
          font-size: 42px;
          margin-bottom: 12px;
      }
      
      .stat-label {
          font-size: 17px;
          color: var(--text-light);
          margin-bottom: 12px;
          font-weight: 600;
      }
      
      .stat-number {
          font-size: 42px;
          font-weight: bold;
          color: var(--primary-color);
      }
      
      .registration-list {
          background: white;
          border-radius: 16px;
          padding: 24px;
          box-shadow: 0 2px 12px rgba(0,0,0,0.08);
      }
      
      .list-title {
          font-size: 24px;
          font-weight: bold;
          color: var(--text-dark);
          margin-bottom: 20px;
      }
      
      .registration-item {
          background: var(--bg-light);
          padding: 22px;
          border-radius: 12px;
          margin-bottom: 16px;
          border-left: 5px solid var(--primary-color);
      }
      
      .registration-item:last-child {
          margin-bottom: 0;
      }
      
      .item-name {
          font-size: 22px;
          font-weight: bold;
          color: var(--text-dark);
          margin-bottom: 12px;
      }
      
      .item-details {
          font-size: 18px;
          color: var(--text-light);
          line-height: 1.8;
          font-weight: 500;
      }
      
      .item-fee {
          font-size: 20px;
          font-weight: bold;
          color: var(--primary-color);
          margin-top: 12px;
      }
      
      .empty-state {
          text-align: center;
          padding: 80px 20px;
          color: var(--text-light);
      }
      
      .empty-icon {
          font-size: 80px;
          margin-bottom: 20px;
          opacity: 0.5;
      }
      
      .empty-text {
          font-size: 20px;
          font-weight: 600;
      }
      
      /* è¨Šæ¯æç¤º */
      .toast {
          position: fixed;
          top: 75px;
          left: 20px;
          right: 20px;
          padding: 22px 24px;
          border-radius: 12px;
          color: white;
          font-weight: bold;
          font-size: 19px;
          text-align: center;
          z-index: 2000;
          transform: translateY(-150px);
          opacity: 0;
          transition: all 0.3s;
          box-shadow: 0 6px 20px rgba(0,0,0,0.25);
          line-height: 1.5;
      }
      
      .toast.show {
          transform: translateY(0);
          opacity: 1;
      }
      
      .toast.success {
          background: var(--success-color);
      }
      
      .toast.error {
          background: var(--error-color);
      }
      
      /* è¼‰å…¥å‹•ç•« */
      .loading-spinner {
          display: inline-block;
          width: 24px;
          height: 24px;
          border: 4px solid rgba(255,255,255,.3);
          border-radius: 50%;
          border-top-color: #fff;
          animation: spin 0.8s linear infinite;
          margin-right: 10px;
          vertical-align: middle;
      }
      
      @keyframes spin {
          to { transform: rotate(360deg); }
      }
      
      /* éŸ¿æ‡‰å¼è¨­è¨ˆ */
      @media (min-width: 768px) {
          .app-content {
              max-width: 600px;
              margin-left: auto;
              margin-right: auto;
          }
          
          .app-header {
              max-width: 600px;
              left: 50%;
              transform: translateX(-50%);
          }
          
          .bottom-nav {
              max-width: 600px;
              left: 50%;
              transform: translateX(-50%);
          }
          
          .toast {
              max-width: 560px;
              left: 50%;
              transform: translateX(-50%) translateY(-150px);
          }
          
          .toast.show {
              transform: translateX(-50%) translateY(0);
          }
      }
      
      /* å¹³æ¿å’Œæ¡Œé¢å„ªåŒ– */
      @media (min-width: 1024px) {
          body {
              font-size: 19px;
          }
          
          .app-content {
              max-width: 800px;
          }
          
          .app-header {
              max-width: 800px;
          }
          
          .bottom-nav {
              max-width: 800px;
          }
          
          .stats-grid {
              grid-template-columns: repeat(2, 1fr);
          }
      }
      
      /* é«˜å°æ¯”åº¦æ¨¡å¼æ”¯æ´ */
      @media (prefers-contrast: high) {
          .form-control,
          .radio-option,
          .diet-option,
          .payment-option {
              border-width: 4px;
          }
      }
  </style>
</head>
<body>
  <!-- é ‚éƒ¨æ¨™é¡Œæ¬„ -->
  <header class="app-header">
      <div class="app-title">ğŸ‰ æœƒå“¡å¤§æœƒå ±å</div>
  </header>

  <!-- è¨Šæ¯æç¤º -->
  <div class="toast" id="toast"></div>

  <!-- ä¸»è¦å…§å®¹å€ -->
  <main class="app-content">
      <!-- æ´»å‹•è³‡è¨Šé é¢ -->
      <div class="page active" id="infoPage">
          <div class="event-banner">
              <h1>ç¬¬å››å±†ç¬¬ä¸€æ¬¡<br>æœƒå“¡å¤§æœƒ</h1>
              <div class="subtitle">å°ç£å¸•é‡‘æ£®ç—…å‹<br>æ¬Šç›Šä¿ƒé€²æœƒ</div>
          </div>

          <div class="event-date">
              <div class="year">2025å¹´</div>
              <div class="date">12æœˆ20æ—¥ï¼ˆå…­ï¼‰</div>
          </div>

          <div class="info-card">
              <div class="info-card-title">ğŸ“ æ´»å‹•åœ°é»</div>
              <div class="info-item">
                  <div class="info-label">å ´åœ°åç¨±</div>
                  <div class="info-value">æœæš®è‰¯è¾°</div>
              </div>
              <div class="info-item">
                  <div class="info-label">åœ°å€</div>
                  <div class="info-value">å°ä¸­å¸‚å—å±¯å€<br>æ–‡å¿ƒå—è·¯99è™Ÿ</div>
              </div>
              <div class="info-item">
                  <div class="info-label">äº¤é€šè³‡è¨Š</div>
                  <div class="info-value">ğŸš‡ æ·é‹è±æ¨‚å…¬åœ’ç«™</div>
              </div>
              <div class="info-item">
                  <div class="info-label">è¯çµ¡é›»è©±</div>
                  <div class="info-value">ğŸ“ (04) 3600-6000</div>
              </div>
              <a href="https://www.yourhomewedding.com/archive/images/editor/faq/10dd58e528ba79f1.jpg" target="_blank" class="link-button">
                  ğŸš— æŸ¥çœ‹åœè»Šå ´ä½ç½®åœ–
              </a>
          </div>

          <div class="info-card">
              <div class="info-card-title">ğŸ’° è²»ç”¨èªªæ˜</div>
              <div class="fee-item">
                  <div class="fee-label">æœƒå“¡<br><small>ï¼ˆç¹³äº¤105å¹´æœƒè²»ï¼‰</small></div>
                  <div class="fee-amount">1,000å…ƒ<br><small style="font-size: 16px;">å…é¤è²»</small></div>
              </div>
              <div class="fee-item">
                  <div class="fee-label">ç…§é¡§é™ªä¼´è€…<br><small>ï¼ˆé™1ä½ï¼‰</small></div>
                  <div class="fee-amount">500å…ƒ<br><small style="font-size: 16px;">å…é¤è²»</small></div>
              </div>
              <div class="fee-item">
                  <div class="fee-label">éæœƒå“¡<br><small>ï¼ˆææ¬¾ï¼‰</small></div>
                  <div class="fee-amount">1,000å…ƒ<br><small style="font-size: 16px;">å…é¤è²»</small></div>
              </div>
          </div>

          <div class="info-card">
              <div class="info-card-title">ğŸ¦ åŒ¯æ¬¾è³‡è¨Š</div>
              <div class="bank-info">
                  <div class="bank-row">
                      <div class="bank-label">æˆ¶å</div>
                      <div class="bank-value">ç¤¾åœ˜æ³•äººå°ç£<br>å¸•é‡‘æ£®ç—…å‹<br>æ¬Šç›Šä¿ƒé€²æœƒ</div>
                  </div>
                  <div class="bank-row">
                      <div class="bank-label">éŠ€è¡Œ</div>
                      <div class="bank-value">ç¬¬ä¸€éŠ€è¡Œ<br>ä¸‰é‡åŸ”åˆ†è¡Œ</div>
                  </div>
                  <div class="bank-row">
                      <div class="bank-label">éŠ€è¡Œä»£è™Ÿ</div>
                      <div class="bank-value">007</div>
                  </div>
                  <div class="bank-row">
                      <div class="bank-label">å¸³è™Ÿ</div>
                      <div class="bank-value account-number">211-1015-0402</div>
                  </div>
              </div>
          </div>
      </div>

      <!-- å ±åè¡¨å–®é é¢ -->
      <div class="page" id="formPage">
          <div class="form-container">
              <form id="registrationForm">
                  <div class="form-card">
                      <div class="form-group">
                          <label for="name">å§“å <span class="required">*</span></label>
                          <input type="text" id="name" name="name" class="form-control" placeholder="è«‹è¼¸å…¥æ‚¨çš„å§“å" required>
                      </div>

                      <div class="form-group">
                          <label for="phone">è¯çµ¡é›»è©± <span class="required">*</span></label>
                          <input type="tel" id="phone" name="phone" class="form-control" placeholder="0912-345-678" required>
                      </div>

                      <div class="form-group">
                          <label for="email">é›»å­éƒµä»¶</label>
                          <input type="email" id="email" name="email" class="form-control" placeholder="example@email.com">
                      </div>
                  </div>

                  <div class="form-card">
                      <div class="form-group">
                          <label>å ±åé¡å‹ <span class="required">*</span></label>
                          <div class="radio-group">
                              <label class="radio-option">
                                  <input type="radio" name="type" value="member" data-fee="1000" required>
                                  <div class="radio-check"></div>
                                  <span class="radio-label">æœƒå“¡<br><small>ç¹³äº¤105å¹´æœƒè²»1,000å…ƒï¼ˆå…é¤è²»ï¼‰</small></span>
                              </label>
                              <label class="radio-option">
                                  <input type="radio" name="type" value="caregiver" data-fee="500">
                                  <div class="radio-check"></div>
                                  <span class="radio-label">ç…§é¡§é™ªä¼´è€…<br><small>500å…ƒï¼ˆé™1ä½ï¼Œå…é¤è²»ï¼‰</small></span>
                              </label>
                              <label class="radio-option">
                                  <input type="radio" name="type" value="non-member" data-fee="1000">
                                  <div class="radio-check"></div>
                                  <span class="radio-label">éæœƒå“¡<br><small>ææ¬¾1,000å…ƒï¼ˆå…é¤è²»ï¼‰</small></span>
                              </label>
                          </div>
                      </div>

                      <div class="form-group">
                          <label>é£²é£Ÿç¿’æ…£ <span class="required">*</span></label>
                          <div class="diet-group">
                              <label class="diet-option">
                                  <input type="radio" name="diet" value="meat" required>
                                  <div class="diet-icon">ğŸ–</div>
                                  <div class="diet-label">è‘·é£Ÿ</div>
                              </label>
                              <label class="diet-option">
                                  <input type="radio" name="diet" value="vegetarian">
                                  <div class="diet-icon">ğŸ¥—</div>
                                  <div class="diet-label">ç´ é£Ÿ</div>
                              </label>
                          </div>
                      </div>

                      <div class="form-group">
                          <label>ç¹³è²»æ–¹å¼ <span class="required">*</span></label>
                          <div class="payment-group">
                              <label class="payment-option">
                                  <input type="radio" name="payment" value="transfer" required>
                                  <div class="payment-icon">ğŸ¦</div>
                                  <div class="payment-label">è½‰å¸³</div>
                              </label>
                              <label class="payment-option">
                                  <input type="radio" name="payment" value="cash">
                                  <div class="payment-icon">ğŸ’µ</div>
                                  <div class="payment-label">ç¾é‡‘</div>
                              </label>
                          </div>
                          <div class="transfer-code-group" id="transferCodeGroup">
                              <div class="transfer-hint">ğŸ’¡ è«‹è¼¸å…¥è½‰å¸³å¸³è™Ÿå¾Œ5ç¢¼</div>
                              <input type="text" id="transferCode" name="transferCode" class="form-control" placeholder="ä¾‹å¦‚ï¼š12345" maxlength="5" pattern="[0-9]{5}">
                          </div>
                      </div>

                      <div class="form-group">
                          <label for="notes">å‚™è¨»</label>
                          <textarea id="notes" name="notes" class="form-control" placeholder="ç‰¹æ®Šéœ€æ±‚æˆ–å…¶ä»–èªªæ˜"></textarea>
                      </div>
                  </div>

                  <div class="fee-display">
                      <div class="label">æ‡‰ç¹³è²»ç”¨</div>
                      <div class="amount" id="totalFee">NT$ 0</div>
                  </div>

                  <button type="submit" class="submit-btn" id="submitBtn">
                      ç¢ºèªå ±å
                  </button>
              </form>
          </div>
      </div>

      <!-- çµ±è¨ˆé é¢ -->
      <div class="page" id="statsPage">
          <div class="stats-container">
              <div class="stats-grid">
                  <div class="stat-card">
                      <div class="stat-icon">ğŸ‘¥</div>
                      <div class="stat-label">ç¸½å ±åäººæ•¸</div>
                      <div class="stat-number" id="totalCount">0</div>
                  </div>
                  <div class="stat-card">
                      <div class="stat-icon">ğŸ½ï¸</div>
                      <div class="stat-label">ç”¨é¤äººæ•¸</div>
                      <div class="stat-number" id="mealCount">0</div>
                  </div>
              </div>

              <div class="registration-list">
                  <div class="list-title">ğŸ“‹ æœ€æ–°å ±å</div>
                  <div id="registrationList">
                      <div class="empty-state">
                          <div class="empty-icon">ğŸ“</div>
                          <div class="empty-text">å°šç„¡å ±åè³‡æ–™</div>
                      </div>
                  </div>
              </div>
          </div>
      </div>
  </main>

  <!-- åº•éƒ¨å°èˆªæ¬„ -->
  <nav class="bottom-nav">
      <div class="nav-item active" data-page="info">
          <div class="nav-icon">ğŸ“‹</div>
          <div class="nav-label">æ´»å‹•è³‡è¨Š</div>
      </div>
      <div class="nav-item" data-page="form">
          <div class="nav-icon">âœï¸</div>
          <div class="nav-label">æˆ‘è¦å ±å</div>
      </div>
      <div class="nav-item" data-page="stats">
          <div class="nav-icon">ğŸ“Š</div>
          <div class="nav-label">å ±åçµ±è¨ˆ</div>
      </div>
  </nav>

  <script>
      // ==================== è¨­å®šå€ ====================
      const GAS_API_URL = 'https://script.google.com/macros/s/AKfycbwOzbbKapocC05YU3o78Us9Tb6nM9PWCXAhrWGoS6IdD91S4KQxSeIbj1neRRr1Juhf/exec';
      
      // ==================== å…¨åŸŸè®Šæ•¸ ====================
      let registrations = [];
      let isSubmitting = false;
      let jsonpCounter = 0;
      let currentPage = 'info';
      
      // ==================== é é¢åˆ‡æ› ====================
      const navItems = document.querySelectorAll('.nav-item');
      const pages = document.querySelectorAll('.page');
      
      navItems.forEach(item => {
          item.addEventListener('click', () => {
              const targetPage = item.dataset.page;
              switchPage(targetPage);
          });
      });
      
      function switchPage(pageName) {
          currentPage = pageName;
          
          navItems.forEach(item => {
              item.classList.toggle('active', item.dataset.page === pageName);
          });
          
          pages.forEach(page => {
              page.classList.toggle('active', page.id === pageName + 'Page');
          });
          
          if (pageName === 'stats') {
              loadRegistrations();
          }
      }
      
      // ==================== API å‡½æ•¸ ====================
      function jsonpRequest(url, callback) {
          const callbackName = 'jsonpCallback' + (jsonpCounter++);
          const script = document.createElement('script');
          
          window[callbackName] = function(data) {
              callback(data);
              document.head.removeChild(script);
              delete window[callbackName];
          };
          
          script.src = url + (url.indexOf('?') >= 0 ? '&' : '?') + 'callback=' + callbackName;
          document.head.appendChild(script);
      }
      
      function loadFromGoogleSheets() {
          return new Promise((resolve) => {
              jsonpRequest(GAS_API_URL + '?action=getAll', (result) => {
                  if (result.success) {
                      console.log('è¼‰å…¥è³‡æ–™æˆåŠŸ:', result.data.length, 'ç­†');
                      resolve(result.data);
                  } else {
                      console.error('è¼‰å…¥è³‡æ–™å¤±æ•—:', result.message);
                      resolve([]);
                  }
              });
          });
      }
      
      // ==================== UI æ›´æ–°å‡½æ•¸ ====================
      function updateFee() {
          const typeRadios = document.querySelectorAll('input[name="type"]');
          let totalFee = 0;
          
          typeRadios.forEach(radio => {
              if (radio.checked) {
                  totalFee = parseInt(radio.dataset.fee);
              }
          });
          
          document.getElementById('totalFee').textContent = `NT$ ${totalFee.toLocaleString()}`;
      }
      
      function updateRegistrationList() {
          const listContainer = document.getElementById('registrationList');
          
          if (registrations.length === 0) {
              listContainer.innerHTML = `
                  <div class="empty-state">
                      <div class="empty-icon">ğŸ“</div>
                      <div class="empty-text">å°šç„¡å ±åè³‡æ–™</div>
                  </div>
              `;
              document.getElementById('totalCount').textContent = '0';
              document.getElementById('mealCount').textContent = '0';
              return;
          }
          
          let totalPeople = registrations.length;
          let mealCount = registrations.length; // æ‰€æœ‰äººéƒ½å…é¤è²»ï¼Œä½†éƒ½æœ‰ç”¨é¤
          
          document.getElementById('totalCount').textContent = totalPeople;
          document.getElementById('mealCount').textContent = mealCount;
          
          const sortedRegs = [...registrations].reverse();
          listContainer.innerHTML = sortedRegs.slice(0, 20).map(reg => {
              const dietIcon = reg.diet === 'vegetarian' ? 'ğŸ¥— ç´ é£Ÿ' : 'ğŸ– è‘·é£Ÿ';
              const paymentIcon = reg.payment === 'transfer' ? 'ğŸ¦ è½‰å¸³' : 'ğŸ’µ ç¾é‡‘';
              const transferInfo = reg.payment === 'transfer' && reg.transferCode ? `ï¼ˆå¾Œ5ç¢¼ï¼š${reg.transferCode}ï¼‰` : '';
              return `
                  <div class="registration-item">
                      <div class="item-name">${reg.name}</div>
                      <div class="item-details">
                          ${reg.typeLabel}<br>
                          ${dietIcon}<br>
                          ${paymentIcon}${transferInfo}
                          ${reg.notes ? `<br>ğŸ“ ${reg.notes}` : ''}
                      </div>
                      <div class="item-fee">æ‡‰ç¹³: NT$ ${parseInt(reg.totalFee).toLocaleString()}</div>
                  </div>
              `;
          }).join('');
      }
      
      function showToast(type, message) {
          const toast = document.getElementById('toast');
          toast.textContent = message;
          toast.className = `toast ${type} show`;
          
          setTimeout(() => {
              toast.classList.remove('show');
          }, 4000);
      }
      
      // ==================== è¡¨å–®è™•ç† ====================
      const radioOptions = document.querySelectorAll('.radio-option');
      radioOptions.forEach(option => {
          option.addEventListener('click', function() {
              radioOptions.forEach(opt => opt.classList.remove('checked'));
              this.classList.add('checked');
              const radio = this.querySelector('input[type="radio"]');
              radio.checked = true;
              updateFee();
          });
      });
      
      // è‘·ç´ é¸é …è™•ç†
      const dietOptions = document.querySelectorAll('.diet-option');
      dietOptions.forEach(option => {
          option.addEventListener('click', function() {
              dietOptions.forEach(opt => opt.classList.remove('checked'));
              this.classList.add('checked');
              const radio = this.querySelector('input[type="radio"]');
              radio.checked = true;
          });
      });
      
      // ç¹³è²»æ–¹å¼é¸é …è™•ç†
      const paymentOptions = document.querySelectorAll('.payment-option');
      const transferCodeGroup = document.getElementById('transferCodeGroup');
      const transferCodeInput = document.getElementById('transferCode');
      
      paymentOptions.forEach(option => {
          option.addEventListener('click', function() {
              paymentOptions.forEach(opt => opt.classList.remove('checked'));
              this.classList.add('checked');
              const radio = this.querySelector('input[type="radio"]');
              radio.checked = true;
              
              // é¡¯ç¤ºæˆ–éš±è—è½‰å¸³å¾Œ5ç¢¼è¼¸å…¥æ¡†
              if (radio.value === 'transfer') {
                  transferCodeGroup.classList.add('show');
                  transferCodeInput.required = true;
              } else {
                  transferCodeGroup.classList.remove('show');
                  transferCodeInput.required = false;
                  transferCodeInput.value = '';
              }
          });
      });
      
      document.getElementById('registrationForm').addEventListener('submit', async function(e) {
          e.preventDefault();
          
          if (isSubmitting) return;
          
          // é©—è­‰è½‰å¸³å¾Œ5ç¢¼
          const paymentRadio = document.querySelector('input[name="payment"]:checked');
          if (paymentRadio && paymentRadio.value === 'transfer') {
              const transferCode = document.getElementById('transferCode').value.trim();
              if (!transferCode || transferCode.length !== 5 || !/^\d{5}$/.test(transferCode)) {
                  showToast('error', 'âŒ è«‹è¼¸å…¥æ­£ç¢ºçš„è½‰å¸³å¸³è™Ÿå¾Œ5ç¢¼ï¼ˆ5ä½æ•¸å­—ï¼‰');
                  return;
              }
          }
          
          isSubmitting = true;
          const submitBtn = document.getElementById('submitBtn');
          submitBtn.disabled = true;
          submitBtn.innerHTML = '<span class="loading-spinner"></span>é€å‡ºä¸­...';
          
          const formData = new FormData(e.target);
          const typeRadio = document.querySelector('input[name="type"]:checked');
          const dietRadio = document.querySelector('input[name="diet"]:checked');
          const totalFee = parseInt(typeRadio.dataset.fee);
          
          const registration = {
              action: 'add',
              name: formData.get('name'),
              phone: formData.get('phone'),
              email: formData.get('email') || '',
              type: typeRadio.value,
              typeLabel: typeRadio.parentElement.querySelector('.radio-label').textContent.split('\n')[0],
              diet: dietRadio ? dietRadio.value : 'meat',
              payment: paymentRadio.value,
              transferCode: paymentRadio.value === 'transfer' ? formData.get('transferCode') : '',
              totalFee: totalFee,
              notes: formData.get('notes') || ''
          };
          
          try {
              await fetch(GAS_API_URL, {
                  method: 'POST',
                  body: JSON.stringify(registration)
              });
              
              showToast('success', 'âœ… å ±åæˆåŠŸï¼æ„Ÿè¬æ‚¨çš„åƒèˆ‡');
              
              e.target.reset();
              radioOptions.forEach(opt => opt.classList.remove('checked'));
              dietOptions.forEach(opt => opt.classList.remove('checked'));
              paymentOptions.forEach(opt => opt.classList.remove('checked'));
              transferCodeGroup.classList.remove('show');
              transferCodeInput.required = false;
              updateFee();
              
              setTimeout(() => {
                  loadRegistrations();
              }, 2000);
              
          } catch (error) {
              showToast('success', 'âœ… å ±åè³‡æ–™å·²é€å‡ºï¼');
              
              e.target.reset();
              radioOptions.forEach(opt => opt.classList.remove('checked'));
              dietOptions.forEach(opt => opt.classList.remove('checked'));
              paymentOptions.forEach(opt => opt.classList.remove('checked'));
              transferCodeGroup.classList.remove('show');
              transferCodeInput.required = false;
              updateFee();
              
              setTimeout(() => {
                  loadRegistrations();
              }, 3000);
          }
          
          isSubmitting = false;
          submitBtn.disabled = false;
          submitBtn.textContent = 'ç¢ºèªå ±å';
      });
      
      // ==================== åˆå§‹åŒ– ====================
      async function loadRegistrations() {
          try {
              const data = await loadFromGoogleSheets();
              registrations = data;
              updateRegistrationList();
          } catch (error) {
              console.error('è¼‰å…¥å ±åè³‡æ–™å¤±æ•—:', error);
          }
      }
      
      window.addEventListener('DOMContentLoaded', function() {
          updateFee();
          loadRegistrations();
          
          setInterval(() => {
              if (currentPage === 'stats') {
                  loadRegistrations();
              }
          }, 30000);
      });
      
      // é˜²æ­¢é›™æ“Šç¸®æ”¾
      let lastTouchEnd = 0;
      document.addEventListener('touchend', function(event) {
          const now = Date.now();
          if (now - lastTouchEnd <= 300) {
              event.preventDefault();
          }
          lastTouchEnd = now;
      }, false);
  </script>
</body>
</html>
