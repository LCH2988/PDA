<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Â∏ïÈáëÊ£ÆÁóÖÂ∞àÊ•≠Ë™ûË®ÄÂæ©ÂÅ•Á≥ªÁµ±</title>
<style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }
    
    :root {
        --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        --success-color: #38b2ac;
        --warning-color: #ed8936;
        --danger-color: #f56565;
        --card-shadow: 0 10px 30px rgba(0,0,0,0.1);
        --hover-shadow: 0 20px 40px rgba(0,0,0,0.15);
    }
    
    body {
        font-family: 'Microsoft JhengHei', 'Segoe UI', Arial, sans-serif;
        font-size: 16px;
        line-height: 1.6;
        color: #2d3748;
        background: var(--primary-gradient);
        min-height: 100vh;
        padding: 20px;
    }
    
    .container {
        max-width: 1600px;
        margin: 0 auto;
    }
    
    .header {
        background: white;
        padding: 30px;
        border-radius: 20px;
        box-shadow: var(--card-shadow);
        margin-bottom: 30px;
        text-align: center;
        position: relative;
        overflow: hidden;
    }
    
    .header::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 5px;
        background: linear-gradient(90deg, #667eea, #764ba2, #f093fb);
    }
    
    .header h1 {
        color: #4a5568;
        font-size: 2.5em;
        margin-bottom: 10px;
        font-weight: 700;
    }
    
    .header .subtitle {
        color: #718096;
        font-size: 1.2em;
        font-weight: 500;
        margin-bottom: 15px;
    }
    
    .header .certification {
        background: var(--primary-gradient);
        color: white;
        padding: 10px 20px;
        border-radius: 25px;
        display: inline-block;
        font-size: 0.9em;
        font-weight: 600;
    }
    
    .nav-tabs {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-bottom: 30px;
        justify-content: center;
    }
    
    .nav-tab {
        background: white;
        border: none;
        padding: 15px 25px;
        border-radius: 25px;
        cursor: pointer;
        font-size: 14px;
        font-weight: 600;
        color: #4a5568;
        box-shadow: var(--card-shadow);
        transition: all 0.3s ease;
        min-width: 120px;
        position: relative;
        overflow: hidden;
    }
    
    .nav-tab:hover, .nav-tab.active {
        background: #667eea;
        color: white;
        transform: translateY(-2px);
        box-shadow: var(--hover-shadow);
    }
    
    .content-section {
        display: none;
    }
    
    .content-section.active {
        display: block;
        animation: fadeIn 0.5s ease;
    }
    
    @keyframes fadeIn {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }
    
    .cards-container {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
        gap: 25px;
        margin-bottom: 30px;
    }
    
    .training-card, .analysis-card {
        background: white;
        border-radius: 20px;
        padding: 25px;
        box-shadow: var(--card-shadow);
        transition: all 0.3s ease;
        border: 2px solid transparent;
        position: relative;
        overflow: hidden;
    }
    
    .training-card::before, .analysis-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 3px;
        background: var(--primary-gradient);
    }
    
    .training-card:hover, .analysis-card:hover {
        transform: translateY(-5px);
        box-shadow: var(--hover-shadow);
        border-color: #667eea;
    }
    
    .card-header {
        background: var(--primary-gradient);
        color: white;
        padding: 20px;
        border-radius: 15px;
        margin-bottom: 20px;
        text-align: center;
        position: relative;
    }
    
    .card-header h3 {
        font-size: 1.5em;
        margin-bottom: 8px;
        font-weight: 700;
    }
    
    .card-header .day-info {
        font-size: 1em;
        opacity: 0.9;
        font-weight: 500;
    }
    
    .card-header .duration {
        position: absolute;
        top: 10px;
        right: 15px;
        background: rgba(255,255,255,0.2);
        padding: 5px 10px;
        border-radius: 15px;
        font-size: 0.8em;
    }
    
    .upload-zone {
        border: 3px dashed #667eea;
        border-radius: 15px;
        padding: 50px;
        text-align: center;
        background: #f8f9ff;
        cursor: pointer;
        transition: all 0.3s;
        margin-bottom: 30px;
    }
    
    .upload-zone:hover {
        background: #eef0ff;
        border-color: #764ba2;
        transform: scale(1.02);
    }
    
    .upload-zone.dragover {
        background: #e0e7ff;
        border-color: #4c51bf;
    }
    
    .controls {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin: 20px 0;
    }
    
    button {
        padding: 15px 30px;
        border: none;
        border-radius: 10px;
        font-size: 16px;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s;
        color: white;
    }
    
    .btn-primary { background: var(--primary-gradient); }
    .btn-success { background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%); }
    .btn-danger { background: linear-gradient(135deg, #eb3349 0%, #f45c43 100%); }
    .btn-warning { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
    
    button:hover { 
        transform: translateY(-2px); 
        box-shadow: 0 10px 20px rgba(0,0,0,0.2); 
    }
    
    button:disabled { 
        opacity: 0.5; 
        cursor: not-allowed; 
        transform: none; 
    }
    
    .waveform-container, .spectrogram {
        background: #1a1a2e;
        border-radius: 15px;
        padding: 20px;
        margin: 20px 0;
        position: relative;
        overflow: hidden;
    }
    
    canvas {
        width: 100%;
        height: 200px;
        display: block;
    }
    
    .analysis-results {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-top: 30px;
    }
    
    .metric-card {
        background: var(--primary-gradient);
        color: white;
        padding: 25px;
        border-radius: 15px;
        box-shadow: var(--card-shadow);
        transition: transform 0.3s;
    }
    
    .metric-card:hover {
        transform: translateY(-5px);
    }
    
    .metric-label {
        font-size: 14px;
        opacity: 0.9;
        margin-bottom: 10px;
    }
    
    .metric-value {
        font-size: 32px;
        font-weight: bold;
        margin-bottom: 5px;
    }
    
    .metric-unit {
        font-size: 14px;
        opacity: 0.8;
    }
    
    .metric-status {
        margin-top: 10px;
        padding: 5px 10px;
        background: rgba(255,255,255,0.2);
        border-radius: 5px;
        font-size: 12px;
    }
    
    .progress-bar {
        width: 100%;
        height: 30px;
        background: #e0e0e0;
        border-radius: 15px;
        overflow: hidden;
        margin: 20px 0;
        display: none;
    }
    
    .progress-fill {
        height: 100%;
        background: var(--primary-gradient);
        width: 0%;
        transition: width 0.3s;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
    }
    
    .status-message {
        padding: 15px;
        border-radius: 10px;
        margin: 15px 0;
        display: none;
    }
    
    .status-success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
    .status-error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
    .status-info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
    
    .exercise-section {
        margin-bottom: 25px;
    }
    
    .exercise-title {
        background: #f7fafc;
        padding: 15px;
        border-radius: 12px;
        margin-bottom: 15px;
        border-left: 4px solid #667eea;
    }
    
    .exercise-title h4 {
        color: #667eea;
        font-size: 1.2em;
        margin-bottom: 5px;
        font-weight: 700;
    }
    
    .exercise-title .description {
        color: #4a5568;
        font-size: 0.95em;
        font-weight: 500;
    }
    
    .practice-content {
        background: #fff5f5;
        padding: 20px;
        border-radius: 12px;
        border: 2px dashed #667eea;
        margin: 15px 0;
    }
    
    .practice-text {
        font-size: 1.1em;
        line-height: 1.8;
        color: #2d3748;
        font-weight: 500;
    }
    
    .practice-text strong {
        color: #667eea;
        font-size: 1.05em;
    }
    
    .difficulty-badge {
        display: inline-block;
        padding: 5px 12px;
        border-radius: 15px;
        font-size: 0.8em;
        font-weight: 700;
        margin-left: 10px;
    }
    
    .easy { background: #c6f6d5; color: #22543d; }
    .medium { background: #feebc8; color: #c05621; }
    .hard { background: #fed7d7; color: #c53030; }
    
    .tips-card {
        background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
        padding: 25px;
        border-radius: 15px;
        margin: 20px 0;
        border: 2px solid var(--warning-color);
        position: relative;
    }
    
    .tips-card::before {
        content: 'üí°';
        font-size: 1.5em;
        position: absolute;
        top: 15px;
        right: 20px;
    }
    
    .tips-card h4 {
        color: #c05621;
        font-size: 1.3em;
        margin-bottom: 15px;
        font-weight: 700;
    }
    
    .tips-card ul {
        font-size: 1em;
        line-height: 1.6;
        color: #744210;
    }
    
    .tips-card li {
        margin-bottom: 8px;
        font-weight: 500;
        padding-left: 5px;
    }
    
    .professional-note {
        background: linear-gradient(135deg, #e6f3ff 0%, #cce7ff 100%);
        border: 2px solid #3182ce;
        border-radius: 15px;
        padding: 20px;
        margin: 20px 0;
        position: relative;
    }
    
    .professional-note::before {
        content: 'üë®‚Äç‚öïÔ∏è';
        font-size: 1.5em;
        position: absolute;
        top: 15px;
        right: 20px;
    }
    
    .professional-note h4 {
        color: #2b6cb0;
        font-size: 1.2em;
        margin-bottom: 10px;
        font-weight: 700;
    }
    
    .professional-note p {
        color: #2d3748;
        font-size: 1em;
        line-height: 1.6;
    }
    
    .audio-instruction {
        background: linear-gradient(135deg, #e6fffa 0%, #b2f5ea 100%);
        padding: 20px;
        border-radius: 15px;
        margin: 20px 0;
        border: 2px solid var(--success-color);
        text-align: center;
    }
    
    .audio-instruction::before {
        content: 'üé§';
        font-size: 2em;
        display: block;
        margin-bottom: 10px;
    }
    
    .audio-instruction h4 {
        color: #2c7a7b;
        font-size: 1.2em;
        margin-bottom: 10px;
        font-weight: 700;
    }
    
    .progress-card {
        background: white;
        padding: 25px;
        border-radius: 15px;
        margin: 20px 0;
        box-shadow: var(--card-shadow);
    }
    
    .progress-card h3 {
        color: #4a5568;
        font-size: 1.5em;
        margin-bottom: 20px;
        font-weight: 700;
    }
    
    .checkbox-item {
        display: flex;
        align-items: center;
        margin-bottom: 15px;
        padding: 12px;
        background: #f7fafc;
        border-radius: 10px;
        transition: all 0.2s ease;
    }
    
    .checkbox-item:hover {
        background: #edf2f7;
        transform: translateX(5px);
    }
    
    .checkbox-item input[type="checkbox"] {
        margin-right: 15px;
        transform: scale(1.3);
        cursor: pointer;
    }
    
    .checkbox-item label {
        font-size: 1em;
        color: #2d3748;
        cursor: pointer;
        font-weight: 500;
        flex: 1;
    }
    
    .week-overview {
        background: white;
        padding: 30px;
        border-radius: 20px;
        box-shadow: var(--card-shadow);
        margin-bottom: 25px;
        text-align: center;
    }
    
    .week-overview h2 {
        color: #4a5568;
        font-size: 2.2em;
        margin-bottom: 15px;
        font-weight: 700;
    }
    
    .week-goals {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 20px;
        margin-top: 25px;
    }
    
    .goal-item {
        background: var(--primary-gradient);
        color: white;
        padding: 20px;
        border-radius: 15px;
        font-size: 1em;
        font-weight: 500;
        position: relative;
        overflow: hidden;
    }
    
    .goal-item h3 {
        font-size: 1.2em;
        margin-bottom: 10px;
        font-weight: 700;
    }
    
    .progress-visualization {
        background: white;
        padding: 25px;
        border-radius: 15px;
        margin: 20px 0;
        box-shadow: var(--card-shadow);
        text-align: center;
    }
    
    .progress-circle {
        width: 150px;
        height: 150px;
        border-radius: 50%;
        background: conic-gradient(#667eea 0deg, #667eea var(--progress, 0deg), #e2e8f0 var(--progress, 0deg));
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 20px;
        position: relative;
    }
    
    .progress-circle::before {
        content: '';
        width: 100px;
        height: 100px;
        background: white;
        border-radius: 50%;
        position: absolute;
    }
    
    .progress-text {
        position: relative;
        z-index: 1;
        font-size: 2em;
        font-weight: 700;
        color: #667eea;
    }
    
    .video-container {
        background: #1a202c;
        border-radius: 15px;
        padding: 20px;
        margin: 20px 0;
        text-align: center;
    }
    
    .video-placeholder {
        background: #2d3748;
        border-radius: 10px;
        padding: 40px 20px;
        color: white;
        margin-bottom: 15px;
    }
    
    .video-placeholder::before {
        content: '‚ñ∂Ô∏è';
        font-size: 3em;
        display: block;
        margin-bottom: 10px;
    }
    
    .video-title {
        color: white;
        font-size: 1.1em;
        font-weight: 600;
        margin-bottom: 10px;
    }
    
    .video-description {
        color: #a0aec0;
        font-size: 0.9em;
    }
    
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin: 20px 0;
    }
    
    .stat-box {
        background: white;
        padding: 20px;
        border-radius: 12px;
        text-align: center;
        box-shadow: var(--card-shadow);
    }
    
    .stat-number {
        font-size: 2.5em;
        font-weight: bold;
        color: #667eea;
        margin-bottom: 5px;
    }
    
    .stat-label {
        color: #718096;
        font-size: 0.9em;
    }
    
    @media (max-width: 768px) {
        body { font-size: 14px; padding: 15px; }
        .header h1 { font-size: 2em; }
        .nav-tab { font-size: 12px; padding: 12px 20px; }
        .cards-container { grid-template-columns: 1fr; gap: 20px; }
        .card-header h3 { font-size: 1.3em; }
        .practice-text { font-size: 1em; }
    }
    
    @media (max-width: 480px) {
        body { font-size: 13px; }
        .header h1 { font-size: 1.8em; }
        .nav-tab { font-size: 11px; }
        .practice-text { font-size: 0.95em; }
    }
</style>
</head>
<body>
<div class="container">
    <div class="header">
        <h1>üó£Ô∏è Â∏ïÈáëÊ£ÆÁóÖÂ∞àÊ•≠Ë™ûË®ÄÂæ©ÂÅ•Á≥ªÁµ±</h1>
        <div class="subtitle">Professional Speech Rehabilitation System for Parkinson's Disease</div>
        <div class="certification">Êï¥ÂêàË®ìÁ∑¥ + Êô∫ËÉΩÂàÜÊûê | 30Â§©ÂÆåÊï¥Ë®àÁï´</div>
    </div>
    
    <div class="nav-tabs">
        <button class="nav-tab active" onclick="showSection('overview')">Á≥ªÁµ±Ê¶ÇË¶Ω</button>
        <button class="nav-tab" onclick="showSection('analysis')">ËÅ≤Â≠∏ÂàÜÊûê</button>
        <button class="nav-tab" onclick="showSection('week1')">Á¨¨1ÈÄ±</button>
        <button class="nav-tab" onclick="showSection('week2')">Á¨¨2ÈÄ±</button>
        <button class="nav-tab" onclick="showSection('week3')">Á¨¨3ÈÄ±</button>
        <button class="nav-tab" onclick="showSection('week4')">Á¨¨4ÈÄ±</button>
        <button class="nav-tab" onclick="showSection('progress')">ÈÄ≤Â∫¶ËøΩËπ§</button>
    </div>
    
    <!-- Á≥ªÁµ±Ê¶ÇË¶Ω -->
    <div id="overview" class="content-section active">
        <div class="week-overview">
            <h2>üìã Á≥ªÁµ±ÂäüËÉΩÁ∏ΩË¶Ω</h2>
            
            <div class="professional-note">
                <h4>üéØ Á≥ªÁµ±ÁâπËâ≤</h4>
                <p>Êú¨Á≥ªÁµ±Êï¥Âêà‰∫Ü<strong>30Â§©Á≥ªÁµ±ÊÄßË®ìÁ∑¥Ë®àÁï´</strong>Ëàá<strong>Â∞àÊ•≠ËÅ≤Â≠∏ÂàÜÊûêÂ∑•ÂÖ∑</strong>ÔºåÊé°Áî®Á•ûÁ∂ìÂèØÂ°ëÊÄßÂéüÁêÜÔºåÁµêÂêàLSVT LOUD¬ÆÁôÇÊ≥ïÔºåÁÇ∫Â∏ïÈáëÊ£ÆÁóÖÊÇ£ËÄÖÊèê‰æõÂÖ®Êñπ‰ΩçË™ûË®ÄÂæ©ÂÅ•Ëß£Ê±∫ÊñπÊ°à„ÄÇ</p>
            </div>
            
            <div class="stats-grid">
                <div class="stat-box">
                    <div class="stat-number">30</div>
                    <div class="stat-label">Â§©ÂÆåÊï¥Ë®ìÁ∑¥</div>
                </div>
                <div class="stat-box">
                    <div class="stat-number">100+</div>
                    <div class="stat-label">Ë®ìÁ∑¥È†ÖÁõÆ</div>
                </div>
                <div class="stat-box">
                    <div class="stat-number">9</div>
                    <div class="stat-label">ËÅ≤Â≠∏ÂèÉÊï∏</div>
                </div>
                <div class="stat-box">
                    <div class="stat-number">24/7</div>
                    <div class="stat-label">Èö®ÊôÇÂèØÁî®</div>
                </div>
            </div>
            
            <div class="week-goals">
                <div class="goal-item">
                    <h3>ü´Å Á¨¨1ÈÄ±ÔºöÂü∫Á§éÂª∫Á´ã</h3>
                    <p>‚Ä¢ ËÖπÂºèÂëºÂê∏Ë®ìÁ∑¥</p>
                    <p>‚Ä¢ ËÅ≤Èü≥ÈüøÂ∫¶ÊèêÂçá</p>
                    <p>‚Ä¢ Âü∫Á§éÊßãÈü≥Á∑¥Áøí</p>
                    <p><strong>7Â§© ¬∑ ÊØèÊó•30-45ÂàÜÈêò</strong></p>
                </div>
                
                <div class="goal-item">
                    <h3>üéµ Á¨¨2ÈÄ±ÔºöÊäÄËÉΩÂº∑Âåñ</h3>
                    <p>‚Ä¢ Â§öÈü≥ÁØÄË®ìÁ∑¥</p>
                    <p>‚Ä¢ Ë™ûÈÄüÁØÄÂæãÊéßÂà∂</p>
                    <p>‚Ä¢ ËÅ≤Ë™øËÆäÂåñÁ∑¥Áøí</p>
                    <p><strong>7Â§© ¬∑ ÊØèÊó•35-45ÂàÜÈêò</strong></p>
                </div>
                
                <div class="goal-item">
                    <h3>üí¨ Á¨¨3ÈÄ±ÔºöÂ∞çË©±ÊáâÁî®</h3>
                    <p>‚Ä¢ Âè•Â≠êÂ±§Ê¨°Ë®ìÁ∑¥</p>
                    <p>‚Ä¢ ÂäüËÉΩÊÄßÂ∞çË©±</p>
                    <p>‚Ä¢ ÊÉÖÂ¢ÉÊ®°Êì¨Á∑¥Áøí</p>
                    <p><strong>7Â§© ¬∑ ÊØèÊó•40-50ÂàÜÈêò</strong></p>
                </div>
                
                <div class="goal-item">
                    <h3>üöÄ Á¨¨4ÈÄ±ÔºöÁ∂úÂêàÊèêÂçá</h3>
                    <p>‚Ä¢ Ë§áÈõúË™ûË®Ä‰ªªÂãô</p>
                    <p>‚Ä¢ Ëá™ÁÑ∂ÊÉÖÂ¢ÉÊáâÁî®</p>
                    <p>‚Ä¢ Èï∑ÊúüÁ∂≠ÊåÅÁ≠ñÁï•</p>
                    <p><strong>9Â§© ¬∑ ÊØèÊó•45-60ÂàÜÈêò</strong></p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ËÅ≤Â≠∏ÂàÜÊûêÁ≥ªÁµ± -->
    <div id="analysis" class="content-section">
        <div class="week-overview">
            <h2>üî¨ Â∞àÊ•≠ËÅ≤Â≠∏ÂàÜÊûêÁ≥ªÁµ±</h2>
            
            <div class="professional-note">
                <h4>üéØ ÂàÜÊûêÂäüËÉΩ</h4>
                <p>Êé°Áî®Web Audio APIÊäÄË°ìÔºåÂç≥ÊôÇÂàÜÊûêË™ûÈü≥ÂèÉÊï∏ÔºåÂåÖÊã¨Âü∫È†ª(F0)„ÄÅÈü≥Èáè„ÄÅHNRË´ßÂô™ÊØî„ÄÅJitter„ÄÅShimmer„ÄÅÂÖ±ÊåØÂ≥∞Á≠â9Â§ßÊ†∏ÂøÉÊåáÊ®ôÔºåÂÆ¢ËßÄË©ï‰º∞Ë®ìÁ∑¥ÊïàÊûú„ÄÇ</p>
            </div>
        </div>
        
        <div class="analysis-card">
            <div class="upload-zone" id="uploadZone">
                <div style="font-size: 64px; margin-bottom: 20px;">üéµ</div>
                <h3>ÊãñÊîæÈü≥Ê™îÊàñÈªûÊìä‰∏äÂÇ≥</h3>
                <p style="color: #666; margin-top: 10px;">ÊîØÊè¥ WAV, MP3, M4A, OGG Ê†ºÂºè</p>
                <input type="file" id="fileInput" accept="audio/*" style="display: none;">
            </div>
            
            <div class="status-message" id="statusMessage"></div>
            
            <div class="progress-bar" id="progressBar">
                <div class="progress-fill" id="progressFill">0%</div>
            </div>
            
            <div class="controls">
                <button class="btn-primary" id="recordBtn">üéôÔ∏è ÈñãÂßãÈåÑÈü≥</button>
                <button class="btn-danger" id="stopBtn" disabled>‚èπÔ∏è ÂÅúÊ≠¢ÈåÑÈü≥</button>
                <button class="btn-success" id="analyzeBtn" disabled>üî¨ ÈñãÂßãÂàÜÊûê</button>
                <button class="btn-primary" id="playBtn" disabled>‚ñ∂Ô∏è Êí≠ÊîæÈü≥Ê™î</button>
            </div>
            
            <div class="waveform-container" style="display: none;" id="waveformContainer">
                <h3 style="color: white; margin-bottom: 15px;">Ê≥¢ÂΩ¢Âúñ</h3>
                <canvas id="waveformCanvas"></canvas>
            </div>
            
            <div class="spectrogram" style="display: none;" id="spectrogramContainer">
                <h3 style="color: white; margin-bottom: 15px;">È†ªË≠úÂúñ</h3>
                <canvas id="spectrogramCanvas"></canvas>
            </div>
            
            <div class="analysis-results" id="resultsContainer" style="display: none;"></div>
        </div>
    </div>
    
    <!-- Á¨¨1ÈÄ±Ë®ìÁ∑¥ -->
    <div id="week1" class="content-section">
        <div class="week-overview">
            <h2>ü´Å Á¨¨1ÈÄ±ÔºöÂëºÂê∏ËàáÁôºËÅ≤Âü∫Á§éÂª∫Á´ã</h2>
        </div>
        
        <div class="cards-container">
            <div class="training-card">
                <div class="card-header">
                    <h3>Á¨¨1Â§©</h3>
                    <div class="day-info">ËÖπÂºèÂëºÂê∏Âª∫Á´ã</div>
                    <div class="duration">30ÂàÜÈêò</div>
                </div>
                
                <div class="exercise-section">
                    <div class="exercise-title">
                        <h4>ü´Å ËÖπÂºèÂëºÂê∏Ë®ìÁ∑¥ <span class="difficulty-badge easy">Âü∫Á§é</span></h4>
                    </div>
                    
                    <div class="practice-content">
                        <div class="practice-text">
                            <strong>Ê≠•È©ü1Ôºö</strong>‰ª∞Ëá•‰ΩçÔºå‰∏ÄÊâãÁΩÆËÉ∏ÈÉ®Ôºå‰∏ÄÊâãÁΩÆËÖπÈÉ®<br><br>
                              <strong>Ê≠•È©ü2Ôºö</strong>ÈºªÂê∏Ê∞£4ÁßíÔºåÊÑüÂèóËÖπÈÉ®‰∏äÂçá<br><br>
                              <strong>Ê≠•È©ü3Ôºö</strong>Â±èÊÅØ2ÁßíÔºå‰øùÊåÅËÖπÈÉ®Êì¥Âºµ<br><br>
                              <strong>Ê≠•È©ü4Ôºö</strong>Âò¥ÂëºÊ∞£6ÁßíÔºåËÖπÈÉ®Á∑©ÊÖ¢‰∏ãÈôç<br><br>
                              <strong>ÈáçË§áÔºö</strong>10Ê¨°√ó3ÁµÑ
                          </div>
                      </div>
                  </div>
              </div>
              
              <div class="training-card">
                  <div class="card-header">
                      <h3>Á¨¨2-7Â§©</h3>
                      <div class="day-info">ÊåÅÁ∫åÂü∫Á§éË®ìÁ∑¥</div>
                      <div class="duration">30-45ÂàÜÈêò</div>
                  </div>
                  
                  <div class="exercise-section">
                      <div class="exercise-title">
                          <h4>üì¢ ËÅ≤Èü≥ÈüøÂ∫¶ËàáÊßãÈü≥Ë®ìÁ∑¥</h4>
                      </div>
                      
                      <div class="practice-content">
                          <div class="practice-text">
                              <strong>Á¨¨2Â§©Ôºö</strong>LOUDËÅ≤Èü≥Ë®ìÁ∑¥<br>
                              <strong>Á¨¨3Â§©Ôºö</strong>ÂîáÈü≥ÊßãÈü≥Ë®ìÁ∑¥<br>
                              <strong>Á¨¨4Â§©Ôºö</strong>ËàåÈü≥ÊßãÈü≥Ë®ìÁ∑¥<br>
                              <strong>Á¨¨5Â§©Ôºö</strong>ÈΩíÈü≥ÊßãÈü≥Ë®ìÁ∑¥<br>
                              <strong>Á¨¨6Â§©Ôºö</strong>Á∂úÂêàÂæ©ÁøíÂº∑Âåñ<br>
                              <strong>Á¨¨7Â§©Ôºö</strong>Á¨¨1ÈÄ±Ë©ï‰º∞
                          </div>
                      </div>
                  </div>
              </div>
          </div>
      </div>
      
      <!-- Á¨¨2ÈÄ±Ë®ìÁ∑¥ -->
      <div id="week2" class="content-section">
          <div class="week-overview">
              <h2>üéµ Á¨¨2ÈÄ±ÔºöÊßãÈü≥ËàáÈüªÂæãÂº∑Âåñ</h2>
          </div>
          
          <div class="cards-container">
              <div class="training-card">
                  <div class="card-header">
                      <h3>Á¨¨8-14Â§©</h3>
                      <div class="day-info">ÈüªÂæãËàáË™ûÈÄüË®ìÁ∑¥</div>
                      <div class="duration">35-45ÂàÜÈêò</div>
                  </div>
                  
                  <div class="exercise-section">
                      <div class="exercise-title">
                          <h4>üéº Â§öÈü≥ÁØÄËàáÈüªÂæãË®ìÁ∑¥</h4>
                      </div>
                      
                      <div class="practice-content">
                          <div class="practice-text">
                              <strong>Á¨¨8Â§©Ôºö</strong>ÈõôÈü≥ÁØÄË©ûÂΩôË®ìÁ∑¥<br>
                              <strong>Á¨¨9Â§©Ôºö</strong>‰∏âÈü≥ÁØÄË©ûÂΩôË®ìÁ∑¥<br>
                              <strong>Á¨¨10Â§©Ôºö</strong>Ë™ûÈÄüÊéßÂà∂Ë®ìÁ∑¥<br>
                              <strong>Á¨¨11Â§©Ôºö</strong>ÁπûÂè£‰ª§ÊåëÊà∞<br>
                              <strong>Á¨¨12Â§©Ôºö</strong>ËÅ≤Ë™øÊ®°ÂºèË®ìÁ∑¥<br>
                              <strong>Á¨¨13Â§©Ôºö</strong>Áü≠Âè•ÈüªÂæãË®ìÁ∑¥<br>
                              <strong>Á¨¨14Â§©Ôºö</strong>Á¨¨2ÈÄ±Ë©ï‰º∞
                          </div>
                      </div>
                  </div>
              </div>
          </div>
      </div>
      
      <!-- Á¨¨3ÈÄ±Ë®ìÁ∑¥ -->
      <div id="week3" class="content-section">
          <div class="week-overview">
              <h2>üí¨ Á¨¨3ÈÄ±ÔºöË™ûÂè•ËàáÂ∞çË©±Ë®ìÁ∑¥</h2>
          </div>
          
          <div class="cards-container">
              <div class="training-card">
                  <div class="card-header">
                      <h3>Á¨¨15-21Â§©</h3>
                      <div class="day-info">Â∞çË©±ËàáÊïò‰∫ãË®ìÁ∑¥</div>
                      <div class="duration">40-50ÂàÜÈêò</div>
                  </div>
                  
                  <div class="exercise-section">
                      <div class="exercise-title">
                          <h4>üí¨ ÂäüËÉΩÊÄßÂ∞çË©±Ë®ìÁ∑¥</h4>
                      </div>
                      
                      <div class="practice-content">
                          <div class="practice-text">
                              <strong>Á¨¨15Â§©Ôºö</strong>Âè•ÂûãÁµêÊßãË®ìÁ∑¥<br>
                              <strong>Á¨¨16Â§©Ôºö</strong>ÁñëÂïèÂè•Ë®ìÁ∑¥<br>
                              <strong>Á¨¨17Â§©Ôºö</strong>Ë§áÂêàÂè•Ë®ìÁ∑¥<br>
                              <strong>Á¨¨18Â§©Ôºö</strong>ÂäüËÉΩÊÄßÂ∞çË©±Ë®ìÁ∑¥<br>
                              <strong>Á¨¨19Â§©Ôºö</strong>ÈõªË©±Â∞çË©±Ë®ìÁ∑¥<br>
                              <strong>Á¨¨20Â§©Ôºö</strong>Êïò‰∫ãËÉΩÂäõË®ìÁ∑¥<br>
                              <strong>Á¨¨21Â§©Ôºö</strong>Á¨¨3ÈÄ±Ë©ï‰º∞
                          </div>
                      </div>
                  </div>
              </div>
          </div>
      </div>
      
      <!-- Á¨¨4ÈÄ±Ë®ìÁ∑¥ -->
      <div id="week4" class="content-section">
          <div class="week-overview">
              <h2>üöÄ Á¨¨4ÈÄ±ÔºöÁ∂úÂêàÊáâÁî®ËàáÁ∂≠ÊåÅ</h2>
          </div>
          
          <div class="cards-container">
              <div class="training-card">
                  <div class="card-header">
                      <h3>Á¨¨22-30Â§©</h3>
                      <div class="day-info">È´òÈöéÊáâÁî®Ë®ìÁ∑¥</div>
                      <div class="duration">45-60ÂàÜÈêò</div>
                  </div>
                  
                  <div class="exercise-section">
                      <div class="exercise-title">
                          <h4>üé≠ Á∂úÂêàÊáâÁî®Ë®ìÁ∑¥</h4>
                      </div>
                      
                      <div class="practice-content">
                          <div class="practice-text">
                              <strong>Á¨¨22Â§©Ôºö</strong>Êñ∞ËÅûÊúóËÆÄË®ìÁ∑¥<br>
                              <strong>Á¨¨23Â§©Ôºö</strong>Ë©©Ë©ûÊúóË™¶Ë®ìÁ∑¥<br>
                              <strong>Á¨¨24Â§©Ôºö</strong>Âç≥ËààË°®ÈÅîË®ìÁ∑¥<br>
                              <strong>Á¨¨25Â§©Ôºö</strong>Á§æ‰∫§Â∞çË©±Ë®ìÁ∑¥<br>
                              <strong>Á¨¨26Â§©Ôºö</strong>ÈÄ≤ÈöéÁπûÂè£‰ª§Ë®ìÁ∑¥<br>
                              <strong>Á¨¨27Â§©Ôºö</strong>Ê≠åÂî±Ê≤ªÁôÇË®ìÁ∑¥<br>
                              <strong>Á¨¨28Â§©Ôºö</strong>ÊÉÖÂ¢ÉÊ®°Êì¨Ë®ìÁ∑¥<br>
                              <strong>Á¨¨29Â§©Ôºö</strong>Á∂úÂêàÊáâÁî®Ë®ìÁ∑¥<br>
                              <strong>Á¨¨30Â§©Ôºö</strong>Á∏ΩÁµêË©ï‰º∞ËàáÊú™‰æÜË¶èÂäÉ
                          </div>
                      </div>
                      
                      <div class="tips-card">
                          <h4>üí° Èï∑ÊúüÁ∂≠ÊåÅÂª∫Ë≠∞</h4>
                          <ul>
                              <li>ÊØèÊó•Á∂≠ÊåÅË®ìÁ∑¥30ÂàÜÈêò</li>
                              <li>ÊØèÈÄ±Âä†Âº∑Ë®ìÁ∑¥1Ê¨°Ôºà60ÂàÜÈêòÔºâ</li>
                              <li>ÊØèÊúàÂ∞àÊ•≠ËøΩËπ§1Ê¨°</li>
                              <li>ÊåÅÁ∫åÈåÑÈü≥Ëá™ÊàëË©ï‰º∞</li>
                              <li>Á©çÊ•µÂèÉËàáÁ§æ‰∫§Ê¥ªÂãï</li>
                          </ul>
                      </div>
                  </div>
              </div>
          </div>
      </div>
      
      <!-- ÈÄ≤Â∫¶ËøΩËπ§ -->
      <div id="progress" class="content-section">
          <div class="week-overview">
              <h2>üìä Êô∫ËÉΩÈÄ≤Â∫¶ËøΩËπ§Á≥ªÁµ±</h2>
              
              <div class="progress-visualization">
                  <div class="progress-circle" style="--progress: 0deg;">
                      <div class="progress-text">0%</div>
                  </div>
                  <h3>Á∏ΩÈ´îÂÆåÊàêÈÄ≤Â∫¶</h3>
              </div>
              
              <div class="stats-grid">
                  <div class="stat-box">
                      <div class="stat-number" id="completedDays">0</div>
                      <div class="stat-label">Â∑≤ÂÆåÊàêÂ§©Êï∏</div>
                  </div>
                  <div class="stat-box">
                      <div class="stat-number" id="totalMinutes">0</div>
                      <div class="stat-label">Á¥ØË®àË®ìÁ∑¥ÂàÜÈêò</div>
                  </div>
                  <div class="stat-box">
                      <div class="stat-number" id="currentStreak">0</div>
                      <div class="stat-label">ÈÄ£Á∫åË®ìÁ∑¥Â§©Êï∏</div>
                  </div>
                  <div class="stat-box">
                      <div class="stat-number" id="remainingDays">30</div>
                      <div class="stat-label">Ââ©È§òÂ§©Êï∏</div>
                  </div>
              </div>
          </div>
          
          <div class="progress-card">
              <h3>üìã 30Â§©Ë®ìÁ∑¥Ê∏ÖÂñÆ</h3>
              <div id="checklistContainer"></div>
          </div>
      </div>
  </div>

  <script>
  // ========== ÂÖ®Â±ÄËÆäÊï∏ ==========
  let audioContext;
  let audioBuffer;
  let audioSource;
  let mediaRecorder;
  let recordedChunks = [];
  let isRecording = false;
  let isPlaying = false;

  // ========== ÂàùÂßãÂåñ ==========
  document.addEventListener('DOMContentLoaded', function() {
      audioContext = new (window.AudioContext || window.webkitAudioContext)();
      setupEventListeners();
      initializeProgressTracking();
      generateChecklist();
  });

  // ========== È†ÅÈù¢ÂàáÊèõ ==========
  function showSection(sectionId) {
      const sections = document.querySelectorAll('.content-section');
      sections.forEach(section => section.classList.remove('active'));
      
      const tabs = document.querySelectorAll('.nav-tab');
      tabs.forEach(tab => tab.classList.remove('active'));
      
      document.getElementById(sectionId).classList.add('active');
      event.target.classList.add('active');
  }

  // ========== ‰∫ã‰ª∂Áõ£ËÅΩÂô®Ë®≠ÁΩÆ ==========
  function setupEventListeners() {
      const uploadZone = document.getElementById('uploadZone');
      const fileInput = document.getElementById('fileInput');
      
      if (uploadZone && fileInput) {
          uploadZone.addEventListener('click', () => fileInput.click());
          uploadZone.addEventListener('dragover', handleDragOver);
          uploadZone.addEventListener('dragleave', handleDragLeave);
          uploadZone.addEventListener('drop', handleDrop);
          fileInput.addEventListener('change', handleFileSelect);
      }
      
      const recordBtn = document.getElementById('recordBtn');
      const stopBtn = document.getElementById('stopBtn');
      const analyzeBtn = document.getElementById('analyzeBtn');
      const playBtn = document.getElementById('playBtn');
      
      if (recordBtn) recordBtn.addEventListener('click', startRecording);
      if (stopBtn) stopBtn.addEventListener('click', stopRecording);
      if (analyzeBtn) analyzeBtn.addEventListener('click', analyzeAudio);
      if (playBtn) playBtn.addEventListener('click', togglePlayback);
  }

  // ========== ÊãñÊîæËôïÁêÜ ==========
  function handleDragOver(e) {
      e.preventDefault();
      e.currentTarget.classList.add('dragover');
  }

  function handleDragLeave(e) {
      e.currentTarget.classList.remove('dragover');
  }

  function handleDrop(e) {
      e.preventDefault();
      e.currentTarget.classList.remove('dragover');
      const files = e.dataTransfer.files;
      if (files.length > 0) loadAudioFile(files[0]);
  }

  function handleFileSelect(e) {
      const file = e.target.files[0];
      if (file) loadAudioFile(file);
  }

  // ========== ËºâÂÖ•Èü≥Ê™î ==========
  function loadAudioFile(file) {
      showStatus('Ê≠£Âú®ËºâÂÖ•Èü≥Ê™î...', 'info');
      showProgress(true);
      
      const reader = new FileReader();
      reader.onload = function(e) {
          audioContext.decodeAudioData(e.target.result, function(buffer) {
              audioBuffer = buffer;
              showStatus('‚úÖ Èü≥Ê™îËºâÂÖ•ÊàêÂäüÔºÅ', 'success');
              showProgress(false);
              document.getElementById('analyzeBtn').disabled = false;
              document.getElementById('playBtn').disabled = false;
              drawWaveform(buffer);
          }, function(error) {
              showStatus('‚ùå Èü≥Ê™îËß£Á¢ºÂ§±ÊïóÔºö' + error, 'error');
              showProgress(false);
          });
      };
      reader.readAsArrayBuffer(file);
  }

  // ========== ÈåÑÈü≥ÂäüËÉΩ ==========
  async function startRecording() {
      try {
          const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
          mediaRecorder = new MediaRecorder(stream);
          recordedChunks = [];
          
          mediaRecorder.ondataavailable = function(e) {
              if (e.data.size > 0) recordedChunks.push(e.data);
          };
          
          mediaRecorder.onstop = function() {
              const blob = new Blob(recordedChunks, { type: 'audio/webm' });
              loadAudioFile(blob);
          };
          
          mediaRecorder.start();
          isRecording = true;
          document.getElementById('recordBtn').disabled = true;
          document.getElementById('stopBtn').disabled = false;
          showStatus('üéôÔ∏è ÈåÑÈü≥‰∏≠...', 'info');
      } catch (error) {
          showStatus('‚ùå ÁÑ°Ê≥ïÂ≠òÂèñÈ∫•ÂÖãÈ¢®Ôºö' + error, 'error');
      }
  }

  function stopRecording() {
      if (mediaRecorder && isRecording) {
          mediaRecorder.stop();
          isRecording = false;
          document.getElementById('recordBtn').disabled = false;
          document.getElementById('stopBtn').disabled = true;
          showStatus('‚úÖ ÈåÑÈü≥ÂÆåÊàêÔºÅ', 'success');
      }
  }

  // ========== Êí≠ÊîæÈü≥Ê™î ==========
  function togglePlayback() {
      if (isPlaying) {
          audioSource.stop();
          isPlaying = false;
          document.getElementById('playBtn').textContent = '‚ñ∂Ô∏è Êí≠ÊîæÈü≥Ê™î';
      } else {
          playAudio();
      }
  }

  function playAudio() {
      audioSource = audioContext.createBufferSource();
      audioSource.buffer = audioBuffer;
      audioSource.connect(audioContext.destination);
      audioSource.onended = function() {
          isPlaying = false;
          document.getElementById('playBtn').textContent = '‚ñ∂Ô∏è Êí≠ÊîæÈü≥Ê™î';
      };
      audioSource.start(0);
      isPlaying = true;
      document.getElementById('playBtn').textContent = '‚è∏Ô∏è ÂÅúÊ≠¢Êí≠Êîæ';
  }

  // ========== Áπ™Ë£ΩÊ≥¢ÂΩ¢Âúñ ==========
  function drawWaveform(buffer) {
      const canvas = document.getElementById('waveformCanvas');
      const ctx = canvas.getContext('2d');
      const width = canvas.width = canvas.offsetWidth * 2;
      const height = canvas.height = 400;
      
      ctx.fillStyle = '#1a1a2e';
      ctx.fillRect(0, 0, width, height);
      
      const data = buffer.getChannelData(0);
      const step = Math.ceil(data.length / width);
      const amp = height / 2;
      
      ctx.strokeStyle = '#667eea';
      ctx.lineWidth = 2;
      ctx.beginPath();
      
      for (let i = 0; i < width; i++) {
          const min = Math.min(...data.slice(i * step, (i + 1) * step));
          const max = Math.max(...data.slice(i * step, (i + 1) * step));
          ctx.moveTo(i, (1 + min) * amp);
          ctx.lineTo(i, (1 + max) * amp);
      }
      
      ctx.stroke();
      document.getElementById('waveformContainer').style.display = 'block';
  }

  // ========== ËÅ≤Â≠∏ÂàÜÊûê ==========
  async function analyzeAudio() {
      if (!audioBuffer) {
          showStatus('‚ùå Ë´ãÂÖàËºâÂÖ•Èü≥Ê™î', 'error');
          return;
      }
      
      showStatus('üî¨ Ê≠£Âú®ÈÄ≤Ë°åËÅ≤Â≠∏ÂàÜÊûê...', 'info');
      showProgress(true);
      document.getElementById('analyzeBtn').disabled = true;
      
      try {
          const duration = audioBuffer.duration;
          const sampleRate = audioBuffer.sampleRate;
          const channelData = audioBuffer.getChannelData(0);
          
          const rms = calculateRMS(channelData);
          const intensity = 20 * Math.log10(rms) + 94;
          const f0 = estimatePitch(channelData, sampleRate);
          const hnr = calculateHNR(channelData, sampleRate, f0);
          const { jitter, shimmer } = calculatePerturbation(channelData, sampleRate, f0);
          const spectrum = await analyzeSpectrum(channelData, sampleRate);
          const formants = estimateFormants(spectrum, sampleRate);
          
          displayResults({
              duration: duration.toFixed(2),
              sampleRate: sampleRate,
              intensity: intensity.toFixed(1),
              f0: f0.toFixed(1),
              hnr: hnr.toFixed(1),
              jitter: jitter.toFixed(2),
              shimmer: shimmer.toFixed(2),
              f1: formants.f1.toFixed(0),
              f2: formants.f2.toFixed(0),
              f3: formants.f3.toFixed(0)
          });
          
          drawSpectrogram(channelData, sampleRate);
          showStatus('‚úÖ ÂàÜÊûêÂÆåÊàêÔºÅ', 'success');
          showProgress(false);
          
      } catch (error) {
          showStatus('‚ùå ÂàÜÊûêÂ§±ÊïóÔºö' + error.message, 'error');
          showProgress(false);
          document.getElementById('analyzeBtn').disabled = false;
      }
  }

  // ========== Ë®àÁÆóÂáΩÊï∏ ==========
  function calculateRMS(data) {
      let sum = 0;
      for (let i = 0; i < data.length; i++) {
          sum += data[i] * data[i];
      }
      return Math.sqrt(sum / data.length);
  }

  function estimatePitch(data, sampleRate) {
      const minFreq = 75;
      const maxFreq = 500;
      const minPeriod = Math.floor(sampleRate / maxFreq);
      const maxPeriod = Math.floor(sampleRate / minFreq);
      
      const start = Math.floor(data.length / 2 - sampleRate / 2);
      const end = Math.floor(data.length / 2 + sampleRate / 2);
      const segment = data.slice(start, end);
      
      let maxCorrelation = 0;
      let bestPeriod = 0;
      
      for (let period = minPeriod; period < maxPeriod; period++) {
          let correlation = 0;
          for (let i = 0; i < segment.length - period; i++) {
              correlation += segment[i] * segment[i + period];
          }
          if (correlation > maxCorrelation) {
              maxCorrelation = correlation;
              bestPeriod = period;
          }
      }
      
      return sampleRate / bestPeriod;
  }

  function calculateHNR(data, sampleRate, f0) {
      if (f0 < 75 || f0 > 500) return 0;
      
      const period = Math.round(sampleRate / f0);
      const start = Math.floor(data.length / 2 - sampleRate / 2);
      const end = Math.floor(data.length / 2 + sampleRate / 2);
      const segment = data.slice(start, end);
      
      let harmonicEnergy = 0;
      let noiseEnergy = 0;
      
      for (let i = 0; i < segment.length - period; i++) {
          const diff = segment[i] - segment[i + period];
          noiseEnergy += diff * diff;
          harmonicEnergy += segment[i] * segment[i];
      }
      
      if (noiseEnergy === 0) return 40;
      
      const hnr = 10 * Math.log10(harmonicEnergy / noiseEnergy);
      return Math.max(0, Math.min(40, hnr));
  }

  function calculatePerturbation(data, sampleRate, f0) {
      if (f0 < 75 || f0 > 500) return { jitter: 0, shimmer: 0 };
      
      const period = Math.round(sampleRate / f0);
      const start = Math.floor(data.length / 2 - sampleRate / 2);
      const end = Math.floor(data.length / 2 + sampleRate / 2);
      
      const periods = [];
      const amplitudes = [];
      
      for (let i = start; i < end - period * 2; i += period) {
          let maxCorr = -1;
          let actualPeriod = period;
          
          for (let p = period - 10; p < period + 10; p++) {
              let corr = 0;
              for (let j = 0; j < 100; j++) {
                  corr += data[i + j] * data[i + p + j];
              }
              if (corr > maxCorr) {
                  maxCorr = corr;
                  actualPeriod = p;
              }
          }
          
          periods.push(actualPeriod);
          
          let maxAmp = 0;
          for (let j = i; j < i + actualPeriod; j++) {
              maxAmp = Math.max(maxAmp, Math.abs(data[j]));
          }
          amplitudes.push(maxAmp);
      }
      
      let jitterSum = 0;
      for (let i = 1; i < periods.length; i++) {
          jitterSum += Math.abs(periods[i] - periods[i-1]);
      }
      const avgPeriod = periods.reduce((a, b) => a + b, 0) / periods.length;
      const jitter = (jitterSum / (periods.length - 1) / avgPeriod) * 100;
      
      let shimmerSum = 0;
      for (let i = 1; i < amplitudes.length; i++) {
          shimmerSum += Math.abs(amplitudes[i] - amplitudes[i-1]);
      }
      const avgAmplitude = amplitudes.reduce((a, b) => a + b, 0) / amplitudes.length;
      const shimmer = (shimmerSum / (amplitudes.length - 1) / avgAmplitude) * 100;
      
      return {
          jitter: Math.min(10, jitter),
          shimmer: Math.min(20, shimmer)
      };
  }

  async function analyzeSpectrum(data, sampleRate) {
      const fftSize = 2048;
      const spectrum = new Float32Array(fftSize / 2);
      
      const start = Math.floor(data.length / 2 - fftSize / 2);
      const segment = data.slice(start, start + fftSize);
      
      const windowed = segment.map((val, i) => {
          const window = 0.54 - 0.46 * Math.cos(2 * Math.PI * i / fftSize);
          return val * window;
      });
      
      for (let k = 0; k < fftSize / 2; k++) {
          let real = 0;
          let imag = 0;
          for (let n = 0; n < fftSize; n++) {
              const angle = -2 * Math.PI * k * n / fftSize;
              real += windowed[n] * Math.cos(angle);
              imag += windowed[n] * Math.sin(angle);
          }
          spectrum[k] = Math.sqrt(real * real + imag * imag);
      }
      
      return spectrum;
  }

  function estimateFormants(spectrum, sampleRate) {
      const freqResolution = sampleRate / spectrum.length / 2;
      
      const peaks = [];
      for (let i = 2; i < spectrum.length - 2; i++) {
          if (spectrum[i] > spectrum[i-1] && 
              spectrum[i] > spectrum[i+1] &&
              spectrum[i] > spectrum[i-2] &&
              spectrum[i] > spectrum[i+2]) {
              peaks.push({
                  freq: i * freqResolution,
                  magnitude: spectrum[i]
              });
          }
      }
      
      peaks.sort((a, b) => b.magnitude - a.magnitude);
      
      const f1 = peaks.find(p => p.freq >= 200 && p.freq <= 1200) || { freq: 700 };
      const f2 = peaks.find(p => p.freq >= 800 && p.freq <= 3000) || { freq: 1200 };
      const f3 = peaks.find(p => p.freq >= 1800 && p.freq <= 4000) || { freq: 2500 };
      
      return { f1: f1.freq, f2: f2.freq, f3: f3.freq };
  }

  function drawSpectrogram(data, sampleRate) {
      const canvas = document.getElementById('spectrogramCanvas');
      const ctx = canvas.getContext('2d');
      const width = canvas.width = canvas.offsetWidth * 2;
      const height = canvas.height = 400;
      
      const fftSize = 2048;
      const hopSize = 512;
      const numFrames = Math.floor((data.length - fftSize) / hopSize);
      
      ctx.fillStyle = '#1a1a2e';
      ctx.fillRect(0, 0, width, height);
      
      const frameWidth = width / numFrames;
      const freqHeight = height / (fftSize / 2);
      
      for (let frame = 0; frame < numFrames; frame++) {
          const start = frame * hopSize;
          const segment = data.slice(start, start + fftSize);
          
          const spectrum = new Float32Array(fftSize / 2);
          for (let k = 0; k < fftSize / 2; k++) {
              let real = 0;
              let imag = 0;
              for (let n = 0; n < fftSize; n++) {
                  const angle = -2 * Math.PI * k * n / fftSize;
                  real += segment[n] * Math.cos(angle);
                  imag += segment[n] * Math.sin(angle);
              }
              spectrum[k] = Math.sqrt(real * real + imag * imag);
          }
          
          for (let k = 0; k < fftSize / 2; k++) {
              const magnitude = Math.log(spectrum[k] + 1) * 20;
              const intensity = Math.min(255, magnitude);
              ctx.fillStyle = `rgb(${intensity}, ${intensity * 0.5}, ${255 - intensity})`;
              ctx.fillRect(
                  frame * frameWidth,
                  height - k * freqHeight,
                  frameWidth + 1,
                  freqHeight + 1
              );
          }
      }
      
      document.getElementById('spectrogramContainer').style.display = 'block';
  }

  function displayResults(results) {
      const container = document.getElementById('resultsContainer');
      container.style.display = 'grid';
      
      const metrics = [
          { label: 'ÊôÇÈï∑', value: results.duration, unit: 'Áßí', status: 'Ê≠£Â∏∏' },
          { label: 'Âπ≥ÂùáÈü≥Èáè', value: results.intensity, unit: 'dB', 
            status: results.intensity >= 55 ? '‚úÖ Ê≠£Â∏∏' : '‚ö†Ô∏è ÂÅè‰Ωé' },
          { label: 'Âü∫È†ª F0', value: results.f0, unit: 'Hz', 
            status: results.f0 >= 85 && results.f0 <= 255 ? '‚úÖ Ê≠£Â∏∏' : '‚ö†Ô∏è Áï∞Â∏∏' },
          { label: 'HNR Ë´ßÂô™ÊØî', value: results.hnr, unit: 'dB', 
            status: results.hnr >= 15 ? '‚úÖ ÂÑ™ÁßÄ' : results.hnr >= 13 ? 'üëç ËâØÂ•Ω' : '‚ö†Ô∏è ‰∏ç‰Ω≥' },
          { label: 'Jitter', value: results.jitter, unit: '%', 
            status: results.jitter <= 1.04 ? '‚úÖ ÂÑ™ÁßÄ' : results.jitter <= 1.5 ? 'üëç ËâØÂ•Ω' : '‚ö†Ô∏è ‰∏ç‰Ω≥' },
          { label: 'Shimmer', value: results.shimmer, unit: '%', 
            status: results.shimmer <= 3.81 ? '‚úÖ ÂÑ™ÁßÄ' : results.shimmer <= 5 ? 'üëç ËâØÂ•Ω' : '‚ö†Ô∏è ‰∏ç‰Ω≥' },
          { label: 'F1 ÂÖ±ÊåØÂ≥∞', value: results.f1, unit: 'Hz', status: 'Ê≠£Â∏∏' },
          { label: 'F2 ÂÖ±ÊåØÂ≥∞', value: results.f2, unit: 'Hz', status: 'Ê≠£Â∏∏' },
          { label: 'F3 ÂÖ±ÊåØÂ≥∞', value: results.f3, unit: 'Hz', status: 'Ê≠£Â∏∏' }
      ];
      
      container.innerHTML = metrics.map(metric => `
          <div class="metric-card">
              <div class="metric-label">${metric.label}</div>
              <div class="metric-value">${metric.value}</div>
              <div class="metric-unit">${metric.unit}</div>
              <div class="metric-status">${metric.status}</div>
          </div>
      `).join('');
  }

  // ========== UI ËºîÂä©ÂáΩÊï∏ ==========
  function showStatus(message, type) {
      const statusEl = document.getElementById('statusMessage');
      statusEl.textContent = message;
      statusEl.className = 'status-message status-' + type;
      statusEl.style.display = 'block';
      
      if (type === 'success') {
          setTimeout(() => {
              statusEl.style.display = 'none';
          }, 5000);
      }
  }

  function showProgress(show) {
      const progressBar = document.getElementById('progressBar');
      const progressFill = document.getElementById('progressFill');
      
      if (show) {
          progressBar.style.display = 'block';
          let progress = 0;
          const interval = setInterval(() => {
              progress += 5;
              if (progress >= 90) {
                  clearInterval(interval);
              }
              progressFill.style.width = progress + '%';
              progressFill.textContent = progress + '%';
          }, 100);
      } else {
          progressFill.style.width = '100%';
          progressFill.textContent = '100%';
          setTimeout(() => {
              progressBar.style.display = 'none';
              progressFill.style.width = '0%';
          }, 500);
      }
  }

  // ========== ÈÄ≤Â∫¶ËøΩËπ§Á≥ªÁµ± ==========
  function initializeProgressTracking() {
      const savedProgress = localStorage.getItem('parkinsonProgress');
      if (savedProgress) {
          const progressData = JSON.parse(savedProgress);
          Object.keys(progressData).forEach(id => {
              const checkbox = document.getElementById(id);
              if (checkbox) {
                  checkbox.checked = progressData[id];
              }
          });
      }
      updateProgressStats();
  }

  function generateChecklist() {
      const container = document.getElementById('checklistContainer');
      if (!container) return;
      
      const weeks = [
          { name: 'Á¨¨1ÈÄ±', days: 7, start: 1 },
          { name: 'Á¨¨2ÈÄ±', days: 7, start: 8 },
          { name: 'Á¨¨3ÈÄ±', days: 7, start: 15 },
          { name: 'Á¨¨4ÈÄ±', days: 9, start: 22 }
      ];
      
      const durations = [30, 35, 40, 40, 40, 45, 30, 35, 40, 40, 35, 40, 40, 45, 
                        40, 40, 45, 45, 40, 50, 45, 45, 50, 50, 50, 45, 45, 60, 60, 60];
      
      let html = '';
      weeks.forEach(week => {
          html += `<div style="margin-bottom: 30px;">
              <h4 style="color: #667eea; margin-bottom: 15px; font-size: 1.3em;">${week.name}</h4>`;
          
          for (let i = 0; i < week.days; i++) {
              const dayNum = week.start + i;
              const duration = durations[dayNum - 1];
              html += `
                  <div class="checkbox-item">
                      <input type="checkbox" id="day${dayNum}" onchange="updateProgressStats()">
                      <label for="day${dayNum}">Á¨¨${dayNum}Â§© - Ë®ìÁ∑¥ (${duration}ÂàÜÈêò)</label>
                  </div>`;
          }
          html += '</div>';
      });
      
      container.innerHTML = html;
      initializeProgressTracking();
  }

  function updateProgressStats() {
      const checkboxes = document.querySelectorAll('#checklistContainer input[type="checkbox"]');
      const totalDays = checkboxes.length;
      const completedDays = document.querySelectorAll('#checklistContainer input[type="checkbox"]:checked').length;
      
      const percentage = Math.round((completedDays / totalDays) * 100);
      const degrees = (completedDays / totalDays) * 360;
      
      const progressCircle = document.querySelector('.progress-circle');
      const progressText = document.querySelector('.progress-text');
      
      if (progressCircle && progressText) {
          progressCircle.style.setProperty('--progress', degrees + 'deg');
          progressText.textContent = percentage + '%';
      }
      
      // Êõ¥Êñ∞Áµ±Ë®àÊï∏Êìö
      const durations = [30, 35, 40, 40, 40, 45, 30, 35, 40, 40, 35, 40, 40, 45, 
                        40, 40, 45, 45, 40, 50, 45, 45, 50, 50, 50, 45, 45, 60, 60, 60];
      
      let totalMinutes = 0;
      checkboxes.forEach((checkbox, index) => {
          if (checkbox.checked) {
              totalMinutes += durations[index];
          }
      });
      
      document.getElementById('completedDays').textContent = completedDays;
      document.getElementById('totalMinutes').textContent = totalMinutes;
      document.getElementById('remainingDays').textContent = totalDays - completedDays;
      
      // Ë®àÁÆóÈÄ£Á∫åÂ§©Êï∏
      let currentStreak = 0;
      for (let i = checkboxes.length - 1; i >= 0; i--) {
          if (checkboxes[i].checked) {
              currentStreak++;
          } else {
              break;
          }
      }
      document.getElementById('currentStreak').textContent = currentStreak;
      
      // ‰øùÂ≠òÈÄ≤Â∫¶
      const progressData = {};
      checkboxes.forEach(checkbox => {
          progressData[checkbox.id] = checkbox.checked;
      });
      localStorage.setItem('parkinsonProgress', JSON.stringify(progressData));
      
      // Êí≠ÊîæÂÆåÊàêÈü≥Êïà
      if (event && event.target.checked) {
          playCompletionSound();
      }
  }

  function playCompletionSound() {
      try {
          const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
          const oscillator = audioCtx.createOscillator();
          const gainNode = audioCtx.createGain();
          
          oscillator.connect(gainNode);
          gainNode.connect(audioCtx.destination);
          
          oscillator.frequency.setValueAtTime(800, audioCtx.currentTime);
          oscillator.frequency.setValueAtTime(1000, audioCtx.currentTime + 0.1);
          
          gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
          gainNode.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.3);
          
          oscillator.start(audioCtx.currentTime);
          oscillator.stop(audioCtx.currentTime + 0.3);
      } catch (e) {
          console.log('Èü≥ÊïàÊí≠ÊîæÂ§±Êïó');
      }
  }
  </script>
  </body>
  </html>

