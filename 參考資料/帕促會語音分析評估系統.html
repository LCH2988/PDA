<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>å¸•é‡‘æ£®ç—…èªéŸ³åˆ†æè©•ä¼°ç³»çµ± - åœ‹å®¶æ¨™æº–ç‰ˆ</title>
<style>
  * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
  }
  
  body {
      font-family: 'Microsoft JhengHei', 'Segoe UI', Arial, sans-serif;
      font-size: 16px;
      line-height: 1.6;
      color: #2d3748;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
  }
  
  .container {
      max-width: 1400px;
      margin: 0 auto;
  }
  
  .header {
      background: white;
      padding: 30px;
      border-radius: 20px;
      box-shadow: 0 15px 35px rgba(0,0,0,0.1);
      margin-bottom: 30px;
      text-align: center;
      position: relative;
  }
  
  .header::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 5px;
      background: linear-gradient(90deg, #667eea, #764ba2, #f093fb);
      border-radius: 20px 20px 0 0;
  }
  
  .header h1 {
      color: #4a5568;
      font-size: 2.2em;
      margin-bottom: 10px;
      font-weight: 700;
  }
  
  .header .subtitle {
      color: #718096;
      font-size: 1.1em;
      font-weight: 500;
  }
  
  .certification-badge {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      padding: 10px 20px;
      border-radius: 25px;
      display: inline-block;
      font-size: 0.9em;
      font-weight: 600;
      margin-top: 15px;
  }
  
  .nav-tabs {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 30px;
      justify-content: center;
  }
  
  .nav-tab {
      background: white;
      border: none;
      padding: 15px 25px;
      border-radius: 25px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      color: #4a5568;
      box-shadow: 0 8px 25px rgba(0,0,0,0.1);
      transition: all 0.3s ease;
  }
  
  .nav-tab:hover, .nav-tab.active {
      background: #667eea;
      color: white;
      transform: translateY(-2px);
      box-shadow: 0 12px 35px rgba(0,0,0,0.2);
  }
  
  .content-section {
      display: none;
  }
  
  .content-section.active {
      display: block;
  }
  
  .assessment-card {
      background: white;
      border-radius: 20px;
      padding: 30px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
      margin-bottom: 25px;
  }
  
  .card-title {
      color: #667eea;
      font-size: 1.8em;
      font-weight: 700;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 3px solid #667eea;
  }
  
  .form-group {
      margin-bottom: 25px;
  }
  
  .form-label {
      display: block;
      font-weight: 600;
      color: #2d3748;
      margin-bottom: 10px;
      font-size: 1.1em;
  }
  
  .form-input {
      width: 100%;
      padding: 12px 15px;
      border: 2px solid #e2e8f0;
      border-radius: 10px;
      font-size: 1em;
      transition: all 0.3s ease;
  }
  
  .form-input:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
  }
  
  .form-row {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
  }
  
  .assessment-section {
      background: #f7fafc;
      padding: 25px;
      border-radius: 15px;
      margin-bottom: 25px;
      border-left: 5px solid #667eea;
  }
  
  .section-title {
      color: #667eea;
      font-size: 1.4em;
      font-weight: 700;
      margin-bottom: 20px;
  }
  
  .measurement-item {
      background: white;
      padding: 20px;
      border-radius: 10px;
      margin-bottom: 15px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
  }
  
  .measurement-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
  }
  
  .measurement-name {
      font-weight: 600;
      color: #2d3748;
      font-size: 1.1em;
  }
  
  .standard-badge {
      background: #e6fffa;
      color: #2c7a7b;
      padding: 5px 12px;
      border-radius: 15px;
      font-size: 0.85em;
      font-weight: 600;
  }
  
  .measurement-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 15px;
      margin-top: 15px;
  }
  
  .measurement-field {
      display: flex;
      flex-direction: column;
  }
  
  .field-label {
      font-size: 0.9em;
      color: #718096;
      margin-bottom: 5px;
      font-weight: 500;
  }
  
  .field-input {
      padding: 10px;
      border: 2px solid #e2e8f0;
      border-radius: 8px;
      font-size: 1em;
  }
  
  .field-input:focus {
      outline: none;
      border-color: #667eea;
  }
  
  .comparison-box {
      background: linear-gradient(135deg, #e6f3ff 0%, #cce7ff 100%);
      border: 2px solid #3182ce;
      border-radius: 12px;
      padding: 20px;
      margin-top: 15px;
  }
  
  .comparison-title {
      color: #2b6cb0;
      font-weight: 700;
      margin-bottom: 10px;
  }
  
  .comparison-result {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px;
      background: white;
      border-radius: 8px;
      margin-top: 10px;
  }
  
  .result-label {
      font-weight: 600;
      color: #2d3748;
  }
  
  .result-value {
      font-size: 1.2em;
      font-weight: 700;
  }
  
  .result-normal { color: #22543d; }
  .result-mild { color: #c05621; }
  .result-moderate { color: #c53030; }
  .result-severe { color: #742a2a; }
  
  .rating-scale {
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
      margin-top: 10px;
  }
  
  .rating-option {
      display: flex;
      align-items: center;
      gap: 8px;
  }
  
  .rating-option input[type="radio"] {
      width: 20px;
      height: 20px;
      cursor: pointer;
  }
  
  .rating-option label {
      cursor: pointer;
      font-weight: 500;
  }
  
  .standard-reference {
      background: #fffaf0;
      border: 2px dashed #ed8936;
      border-radius: 12px;
      padding: 20px;
      margin: 20px 0;
  }
  
  .reference-title {
      color: #c05621;
      font-weight: 700;
      font-size: 1.2em;
      margin-bottom: 15px;
  }
  
  .reference-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
  }
  
  .reference-table th,
  .reference-table td {
      padding: 12px;
      text-align: left;
      border-bottom: 1px solid #e2e8f0;
  }
  
  .reference-table th {
      background: #f7fafc;
      font-weight: 700;
      color: #2d3748;
  }
  
  .reference-table tr:hover {
      background: #f7fafc;
  }
  
  .btn-primary {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      border: none;
      padding: 15px 30px;
      border-radius: 25px;
      font-size: 1.1em;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 8px 25px rgba(0,0,0,0.15);
  }
  
  .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 35px rgba(0,0,0,0.25);
  }
  
  .btn-secondary {
      background: white;
      color: #667eea;
      border: 2px solid #667eea;
      padding: 12px 25px;
      border-radius: 25px;
      font-size: 1em;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-left: 10px;
  }
  
  .btn-secondary:hover {
      background: #667eea;
      color: white;
  }
  
  .button-group {
      display: flex;
      gap: 15px;
      margin-top: 30px;
      justify-content: center;
      flex-wrap: wrap;
  }
  
  .report-preview {
      background: white;
      border: 2px solid #e2e8f0;
      border-radius: 15px;
      padding: 30px;
      margin-top: 30px;
  }
  
  .report-header {
      text-align: center;
      border-bottom: 3px solid #667eea;
      padding-bottom: 20px;
      margin-bottom: 30px;
  }
  
  .report-title {
      font-size: 2em;
      font-weight: 700;
      color: #2d3748;
      margin-bottom: 10px;
  }
  
  .report-subtitle {
      color: #718096;
      font-size: 1.1em;
  }
  
  .report-section {
      margin-bottom: 30px;
  }
  
  .report-section-title {
      background: #667eea;
      color: white;
      padding: 12px 20px;
      border-radius: 10px;
      font-size: 1.3em;
      font-weight: 700;
      margin-bottom: 20px;
  }
  
  .data-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-top: 20px;
  }
  
  .data-card {
      background: #f7fafc;
      padding: 20px;
      border-radius: 12px;
      border-left: 4px solid #667eea;
  }
  
  .data-label {
      color: #718096;
      font-size: 0.9em;
      margin-bottom: 5px;
  }
  
  .data-value {
      color: #2d3748;
      font-size: 1.3em;
      font-weight: 700;
  }
  
  .chart-container {
      background: white;
      padding: 25px;
      border-radius: 15px;
      margin: 20px 0;
      box-shadow: 0 4px 15px rgba(0,0,0,0.05);
  }
  
  .chart-title {
      font-size: 1.2em;
      font-weight: 700;
      color: #2d3748;
      margin-bottom: 20px;
      text-align: center;
  }
  
  .progress-bar-container {
      margin: 15px 0;
  }
  
  .progress-label {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
      font-weight: 600;
  }
  
  .progress-bar {
      width: 100%;
      height: 30px;
      background: #e2e8f0;
      border-radius: 15px;
      overflow: hidden;
      position: relative;
  }
  
  .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #667eea, #764ba2);
      border-radius: 15px;
      transition: width 1s ease;
      display: flex;
      align-items: center;
      justify-content: flex-end;
      padding-right: 10px;
      color: white;
      font-weight: 700;
  }
  
  .recommendation-box {
      background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
      border: 2px solid #ed8936;
      border-radius: 15px;
      padding: 25px;
      margin: 20px 0;
  }
  
  .recommendation-title {
      color: #c05621;
      font-size: 1.4em;
      font-weight: 700;
      margin-bottom: 15px;
  }
  
  .recommendation-list {
      list-style: none;
      padding: 0;
  }
  
  .recommendation-list li {
      padding: 12px 0;
      border-bottom: 1px solid rgba(237, 137, 54, 0.2);
      font-weight: 500;
      color: #744210;
  }
  
  .recommendation-list li:before {
      content: 'âœ“';
      color: #c05621;
      font-weight: 700;
      margin-right: 10px;
  }
  
  .signature-section {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 30px;
      margin-top: 40px;
      padding-top: 30px;
      border-top: 2px solid #e2e8f0;
  }
  
  .signature-box {
      text-align: center;
  }
  
  .signature-line {
      border-top: 2px solid #2d3748;
      margin: 40px 20px 10px;
  }
  
  .signature-label {
      color: #718096;
      font-size: 0.9em;
  }
  
  @media print {
      body {
          background: white;
          padding: 0;
      }
      
      .nav-tabs,
      .button-group,
      .btn-primary,
      .btn-secondary {
          display: none;
      }
      
      .assessment-card {
          box-shadow: none;
          page-break-inside: avoid;
      }
  }
  
  @media (max-width: 768px) {
      .form-row {
          grid-template-columns: 1fr;
      }
      
      .measurement-grid {
          grid-template-columns: 1fr;
      }
      
      .data-grid {
          grid-template-columns: 1fr;
      }
      
      .signature-section {
          grid-template-columns: 1fr;
      }
  }
</style>
</head>
<body>
<div class="container">
  <div class="header">
      <h1>ğŸ¥ å¸•é‡‘æ£®ç—…èªéŸ³åˆ†æè©•ä¼°ç³»çµ±</h1>
      <div class="subtitle">ä¾æ“šè¡›ç”Ÿç¦åˆ©éƒ¨èªè¨€æ²»ç™‚æ¨™æº–ä½œæ¥­è¦ç¯„</div>
      <div class="certification-badge">ç¬¦åˆåœ‹å®¶é†«ç™‚å“è³ªæ¨™æº– | ISO 9001èªè­‰</div>
  </div>
  
  <div class="nav-tabs">
      <button class="nav-tab active" onclick="showSection('basic-info')">åŸºæœ¬è³‡æ–™</button>
      <button class="nav-tab" onclick="showSection('acoustic')">è²å­¸åƒæ•¸è©•ä¼°</button>
      <button class="nav-tab" onclick="showSection('perceptual')">çŸ¥è¦ºè©•ä¼°</button>
      <button class="nav-tab" onclick="showSection('functional')">åŠŸèƒ½æ€§è©•ä¼°</button>
      <button class="nav-tab" onclick="showSection('report')">è©•ä¼°å ±å‘Š</button>
  </div>
  
  <!-- åŸºæœ¬è³‡æ–™ -->
  <div id="basic-info" class="content-section active">
      <div class="assessment-card">
          <h2 class="card-title">ğŸ“‹ å—è©•è€…åŸºæœ¬è³‡æ–™</h2>
          
          <div class="form-row">
              <div class="form-group">
                  <label class="form-label">å§“å</label>
                  <input type="text" class="form-input" id="patientName" placeholder="è«‹è¼¸å…¥å§“å">
              </div>
              
              <div class="form-group">
                  <label class="form-label">ç—…æ­·è™Ÿ</label>
                  <input type="text" class="form-input" id="patientID" placeholder="è«‹è¼¸å…¥ç—…æ­·è™Ÿ">
              </div>
              
              <div class="form-group">
                  <label class="form-label">æ€§åˆ¥</label>
                  <select class="form-input" id="gender">
                      <option value="">è«‹é¸æ“‡</option>
                      <option value="male">ç”·æ€§</option>
                      <option value="female">å¥³æ€§</option>
                  </select>
              </div>
              
              <div class="form-group">
                  <label class="form-label">å‡ºç”Ÿæ—¥æœŸ</label>
                  <input type="date" class="form-input" id="birthDate">
              </div>
          </div>
          
          <div class="form-row">
              <div class="form-group">
                  <label class="form-label">è¨ºæ–·æ—¥æœŸ</label>
                  <input type="date" class="form-input" id="diagnosisDate">
              </div>
              
              <div class="form-group">
                  <label class="form-label">è©•ä¼°æ—¥æœŸ</label>
                  <input type="date" class="form-input" id="assessmentDate">
              </div>
              
              <div class="form-group">
                  <label class="form-label">è©•ä¼°æ¬¡æ•¸</label>
                  <select class="form-input" id="assessmentNumber">
                      <option value="baseline">åŸºç·šè©•ä¼°</option>
                      <option value="week1">ç¬¬1é€±</option>
                      <option value="week2">ç¬¬2é€±</option>
                      <option value="week3">ç¬¬3é€±</option>
                      <option value="week4">ç¬¬4é€±</option>
                      <option value="followup">è¿½è¹¤è©•ä¼°</option>
                  </select>
              </div>
              
              <div class="form-group">
                  <label class="form-label">Hoehn-Yahråˆ†æœŸ</label>
                  <select class="form-input" id="hohenYahr">
                      <option value="">è«‹é¸æ“‡</option>
                      <option value="1">ç¬¬1æœŸ</option>
                      <option value="1.5">ç¬¬1.5æœŸ</option>
                      <option value="2">ç¬¬2æœŸ</option>
                      <option value="2.5">ç¬¬2.5æœŸ</option>
                      <option value="3">ç¬¬3æœŸ</option>
                      <option value="4">ç¬¬4æœŸ</option>
                      <option value="5">ç¬¬5æœŸ</option>
                  </select>
              </div>
          </div>
          
          <div class="form-group">
              <label class="form-label">ä¸»è¦ä¸»è¨´</label>
              <textarea class="form-input" id="chiefComplaint" rows="3" placeholder="è«‹æè¿°ä¸»è¦èªè¨€æºé€šå›°é›£..."></textarea>
          </div>
          
          <div class="form-group">
              <label class="form-label">ç›®å‰ç”¨è—¥</label>
              <textarea class="form-input" id="medications" rows="2" placeholder="è«‹åˆ—å‡ºç›®å‰ä½¿ç”¨çš„å¸•é‡‘æ£®ç—…ç›¸é—œè—¥ç‰©..."></textarea>
          </div>
      </div>
  </div>
  
  <!-- è²å­¸åƒæ•¸è©•ä¼° -->
  <div id="acoustic" class="content-section">
      <div class="assessment-card">
          <h2 class="card-title">ğŸ”Š è²å­¸åƒæ•¸è©•ä¼°ï¼ˆä¾æ“šåœ‹å®¶æ¨™æº–ï¼‰</h2>
          
          <div class="standard-reference">
              <div class="reference-title">ğŸ“Š åœ‹å®¶æ¨™æº–åƒè€ƒå€¼</div>
              <p style="color: #744210; margin-bottom: 15px;">ä¾æ“šè¡›ç”Ÿç¦åˆ©éƒ¨ã€Œèªè¨€æ²»ç™‚æœå‹™æ¨™æº–ä½œæ¥­è¦ç¯„ã€åŠå°ç£èªè¨€æ²»ç™‚å­¸æœƒåˆ¶å®šä¹‹æ¨™æº–</p>
              
              <table class="reference-table">
                  <thead>
                      <tr>
                          <th>è©•ä¼°é …ç›®</th>
                          <th>æ­£å¸¸ç¯„åœï¼ˆç”·æ€§ï¼‰</th>
                          <th>æ­£å¸¸ç¯„åœï¼ˆå¥³æ€§ï¼‰</th>
                          <th>æ¸¬é‡å–®ä½</th>
                      </tr>
                  </thead>
                  <tbody>
                      <tr>
                          <td>åŸºæœ¬é »ç‡ (F0)</td>
                          <td>100-150 Hz</td>
                          <td>180-250 Hz</td>
                          <td>èµ«èŒ² (Hz)</td>
                      </tr>
                      <tr>
                          <td>éŸ³é‡ (SPL)</td>
                          <td>65-75 dB</td>
                          <td>60-70 dB</td>
                          <td>åˆ†è² (dB)</td>
                      </tr>
                      <tr>
                          <td>æœ€å¤§ç™¼è²æ™‚é–“ (MPT)</td>
                          <td>â‰¥ 20ç§’</td>
                          <td>â‰¥ 15ç§’</td>
                          <td>ç§’ (s)</td>
                      </tr>
                      <tr>
                          <td>å—“éŸ³æ“¾å‹• (Jitter)</td>
                          <td colspan="2">< 1.04%</td>
                          <td>ç™¾åˆ†æ¯” (%)</td>
                      </tr>
                      <tr>
                          <td>æŒ¯å¹…æ“¾å‹• (Shimmer)</td>
                          <td colspan="2">< 3.81%</td>
                          <td>ç™¾åˆ†æ¯” (%)</td>
                      </tr>
                      <tr>
                          <td>è«§å™ªæ¯” (HNR)</td>
                          <td colspan="2">â‰¥ 20 dB</td>
                          <td>åˆ†è² (dB)</td>
                      </tr>
                  </tbody>
              </table>
          </div>
          
          <!-- åŸºæœ¬é »ç‡è©•ä¼° -->
          <div class="assessment-section">
              <h3 class="section-title">1. åŸºæœ¬é »ç‡ (Fundamental Frequency, F0)</h3>
              
              <div class="measurement-item">
                  <div class="measurement-header">
                      <span class="measurement-name">æŒçºŒæ¯éŸ³ /a/ ç™¼è²</span>
                      <span class="standard-badge">åœ‹å®¶æ¨™æº–é …ç›®</span>
                  </div>
                  
                  <div class="measurement-grid">
                      <div class="measurement-field">
                          <label class="field-label">å¹³å‡åŸºæœ¬é »ç‡ (Hz)</label>
                          <input type="number" class="field-input" id="f0_mean" step="0.1" oninput="calculateF0Status()">
                      </div>
                      
                      <div class="measurement-field">
                          <label class="field-label">æ¨™æº–å·® (Hz)</label>
                          <input type="number" class="field-input" id="f0_sd" step="0.1">
                      </div>
                      
                      <div class="measurement-field">
                          <label class="field-label">æœ€ä½é »ç‡ (Hz)</label>
                          <input type="number" class="field-input" id="f0_min" step="0.1">
                      </div>
                      
                      <div class="measurement-field">
                          <label class="field-label">æœ€é«˜é »ç‡ (Hz)</label>
                          <input type="number" class="field-input" id="f0_max" step="0.1">
                      </div>
                  </div>
                  
                  <div class="comparison-box" id="f0_comparison" style="display:none;">
                      <div class="comparison-title">èˆ‡æ¨™æº–å€¼æ¯”è¼ƒ</div>
                      <div class="comparison-result">
                          <span class="result-label">è©•ä¼°çµæœï¼š</span>
                          <span class="result-value" id="f0_status"></span>
                      </div>
                  </div>
              </div>
          </div>
          
          <!-- éŸ³é‡è©•ä¼° -->
          <div class="assessment-section">
              <h3 class="section-title">2. è²éŸ³éŸ¿åº¦ (Sound Pressure Level, SPL)</h3>
              
              <div class="measurement-item">
                  <div class="measurement-header">
                      <span class="measurement-name">æ¨™æº–åŒ–éŸ³é‡æ¸¬é‡</span>
                      <span class="standard-badge">è·é›¢30å…¬åˆ†æ¸¬é‡</span>
                  </div>
                  
                  <div class="measurement-grid">
                      <div class="measurement-field">
                          <label class="field-label">èˆ’é©éŸ³é‡ (dB)</label>
                          <input type="number" class="field-input" id="spl_comfortable" step="0.1" oninput="calculateSPLStatus()">
                      </div>
                      
                      <div class="measurement-field">
                          <label class="field-label">æœ€å¤§éŸ³é‡ (dB)</label>
                          <input type="number" class="field-input" id="spl_max" step="0.1">
                      </div>
                      
                      <div class="measurement-field">
                          <label class="field-label">æœ€å°éŸ³é‡ (dB)</label>
                          <input type="number" class="field-input" id="spl_min" step="0.1">
                      </div>
                      
                      <div class="measurement-field">
                          <label class="field-label">å‹•æ…‹ç¯„åœ (dB)</label>
                          <input type="number" class="field-input" id="spl_range" step="0.1">
                      </div>
                  </div>
                  
                  <div class="comparison-box" id="spl_comparison" style="display:none;">
                      <div class="comparison-title">èˆ‡æ¨™æº–å€¼æ¯”è¼ƒ</div>
                      <div class="comparison-result">
                          <span class="result-label">è©•ä¼°çµæœï¼š</span>
                          <span class="result-value" id="spl_status"></span>
                      </div>
                  </div>
              </div>
          </div>
          
          <!-- æœ€å¤§ç™¼è²æ™‚é–“ -->
          <div class="assessment-section">
              <h3 class="section-title">3. æœ€å¤§ç™¼è²æ™‚é–“ (Maximum Phonation Time, MPT)</h3>
              
              <div class="measurement-item">
                  <div class="measurement-header">
                      <span class="measurement-name">æŒçºŒæ¯éŸ³ç™¼è²æ¸¬è©¦</span>
                      <span class="standard-badge">æ¸¬é‡3æ¬¡å–å¹³å‡</span>
                  </div>
                  
                  <div class="measurement-grid">
                      <div class="measurement-field">
                          <label class="field-label">ç¬¬1æ¬¡ (ç§’)</label>
                          <input type="number" class="field-input" id="mpt_1" step="0.1" oninput="calculateMPT()">
                      </div>
                      
                      <div class="measurement-field">
                          <label class="field-label">ç¬¬2æ¬¡ (ç§’)</label>
                            <input type="number" class="field-input" id="mpt_2" step="0.1" oninput="calculateMPT()">
                        </div>
                        
                        <div class="measurement-field">
                            <label class="field-label">ç¬¬3æ¬¡ (ç§’)</label>
                            <input type="number" class="field-input" id="mpt_3" step="0.1" oninput="calculateMPT()">
                        </div>
                        
                        <div class="measurement-field">
                            <label class="field-label">å¹³å‡å€¼ (ç§’)</label>
                            <input type="number" class="field-input" id="mpt_avg" step="0.1" readonly style="background:#f7fafc;">
                        </div>
                    </div>
                    
                    <div class="comparison-box" id="mpt_comparison" style="display:none;">
                        <div class="comparison-title">èˆ‡æ¨™æº–å€¼æ¯”è¼ƒ</div>
                        <div class="comparison-result">
                            <span class="result-label">è©•ä¼°çµæœï¼š</span>
                            <span class="result-value" id="mpt_status"></span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- å—“éŸ³å“è³ªåƒæ•¸ -->
            <div class="assessment-section">
                <h3 class="section-title">4. å—“éŸ³å“è³ªåƒæ•¸ (Voice Quality Parameters)</h3>
                
                <div class="measurement-item">
                    <div class="measurement-header">
                        <span class="measurement-name">Jitter (å—“éŸ³æ“¾å‹•)</span>
                        <span class="standard-badge">æ­£å¸¸å€¼ < 1.04%</span>
                    </div>
                    
                    <div class="measurement-grid">
                        <div class="measurement-field">
                            <label class="field-label">Jitter (%)</label>
                            <input type="number" class="field-input" id="jitter" step="0.01" oninput="calculateJitterStatus()">
                        </div>
                        
                        <div class="measurement-field">
                            <label class="field-label">Jitter (absolute)</label>
                            <input type="number" class="field-input" id="jitter_abs" step="0.001">
                        </div>
                    </div>
                    
                    <div class="comparison-box" id="jitter_comparison" style="display:none;">
                        <div class="comparison-title">èˆ‡æ¨™æº–å€¼æ¯”è¼ƒ</div>
                        <div class="comparison-result">
                            <span class="result-label">è©•ä¼°çµæœï¼š</span>
                            <span class="result-value" id="jitter_status"></span>
                        </div>
                    </div>
                </div>
                
                <div class="measurement-item">
                    <div class="measurement-header">
                        <span class="measurement-name">Shimmer (æŒ¯å¹…æ“¾å‹•)</span>
                        <span class="standard-badge">æ­£å¸¸å€¼ < 3.81%</span>
                    </div>
                    
                    <div class="measurement-grid">
                        <div class="measurement-field">
                            <label class="field-label">Shimmer (%)</label>
                            <input type="number" class="field-input" id="shimmer" step="0.01" oninput="calculateShimmerStatus()">
                        </div>
                        
                        <div class="measurement-field">
                            <label class="field-label">Shimmer (dB)</label>
                            <input type="number" class="field-input" id="shimmer_db" step="0.01">
                        </div>
                    </div>
                    
                    <div class="comparison-box" id="shimmer_comparison" style="display:none;">
                        <div class="comparison-title">èˆ‡æ¨™æº–å€¼æ¯”è¼ƒ</div>
                        <div class="comparison-result">
                            <span class="result-label">è©•ä¼°çµæœï¼š</span>
                            <span class="result-value" id="shimmer_status"></span>
                        </div>
                    </div>
                </div>
                
                <div class="measurement-item">
                    <div class="measurement-header">
                        <span class="measurement-name">HNR (è«§å™ªæ¯”)</span>
                        <span class="standard-badge">æ­£å¸¸å€¼ â‰¥ 20 dB</span>
                    </div>
                    
                    <div class="measurement-grid">
                        <div class="measurement-field">
                            <label class="field-label">HNR (dB)</label>
                            <input type="number" class="field-input" id="hnr" step="0.1" oninput="calculateHNRStatus()">
                        </div>
                        
                        <div class="measurement-field">
                            <label class="field-label">NHR (å™ªè«§æ¯”)</label>
                            <input type="number" class="field-input" id="nhr" step="0.001">
                        </div>
                    </div>
                    
                    <div class="comparison-box" id="hnr_comparison" style="display:none;">
                        <div class="comparison-title">èˆ‡æ¨™æº–å€¼æ¯”è¼ƒ</div>
                        <div class="comparison-result">
                            <span class="result-label">è©•ä¼°çµæœï¼š</span>
                            <span class="result-value" id="hnr_status"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- çŸ¥è¦ºè©•ä¼° -->
    <div id="perceptual" class="content-section">
        <div class="assessment-card">
            <h2 class="card-title">ğŸ‘‚ çŸ¥è¦ºè©•ä¼°ï¼ˆGRBASé‡è¡¨ + åœ‹å®¶æ¨™æº–ï¼‰</h2>
            
            <div class="standard-reference">
                <div class="reference-title">ğŸ“‹ GRBASè©•ä¼°æ¨™æº–</div>
                <p style="color: #744210; margin-bottom: 10px;">ä¾æ“šæ—¥æœ¬è€³é¼»å–‰ç§‘å­¸æœƒåˆ¶å®šï¼Œåœ‹éš›é€šç”¨ä¹‹å—“éŸ³çŸ¥è¦ºè©•ä¼°é‡è¡¨</p>
                <p style="color: #744210;"><strong>è©•åˆ†æ¨™æº–ï¼š</strong> 0=æ­£å¸¸ã€1=è¼•åº¦ã€2=ä¸­åº¦ã€3=é‡åº¦</p>
            </div>
            
            <div class="assessment-section">
                <h3 class="section-title">GRBASé‡è¡¨è©•ä¼°</h3>
                
                <div class="measurement-item">
                    <div class="measurement-name">G (Grade) - æ•´é«”åš´é‡åº¦</div>
                    <div class="rating-scale">
                        <div class="rating-option">
                            <input type="radio" name="grbas_g" value="0" id="g0">
                            <label for="g0">0 - æ­£å¸¸</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="grbas_g" value="1" id="g1">
                            <label for="g1">1 - è¼•åº¦</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="grbas_g" value="2" id="g2">
                            <label for="g2">2 - ä¸­åº¦</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="grbas_g" value="3" id="g3">
                            <label for="g3">3 - é‡åº¦</label>
                        </div>
                    </div>
                </div>
                
                <div class="measurement-item">
                    <div class="measurement-name">R (Roughness) - ç²—ç³™åº¦</div>
                    <div class="rating-scale">
                        <div class="rating-option">
                            <input type="radio" name="grbas_r" value="0" id="r0">
                            <label for="r0">0 - æ­£å¸¸</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="grbas_r" value="1" id="r1">
                            <label for="r1">1 - è¼•åº¦</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="grbas_r" value="2" id="r2">
                            <label for="r2">2 - ä¸­åº¦</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="grbas_r" value="3" id="r3">
                            <label for="r3">3 - é‡åº¦</label>
                        </div>
                    </div>
                </div>
                
                <div class="measurement-item">
                    <div class="measurement-name">B (Breathiness) - æ°£æ¯è²</div>
                    <div class="rating-scale">
                        <div class="rating-option">
                            <input type="radio" name="grbas_b" value="0" id="b0">
                            <label for="b0">0 - æ­£å¸¸</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="grbas_b" value="1" id="b1">
                            <label for="b1">1 - è¼•åº¦</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="grbas_b" value="2" id="b2">
                            <label for="b2">2 - ä¸­åº¦</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="grbas_b" value="3" id="b3">
                            <label for="b3">3 - é‡åº¦</label>
                        </div>
                    </div>
                </div>
                
                <div class="measurement-item">
                    <div class="measurement-name">A (Asthenia) - ç„¡åŠ›åº¦</div>
                    <div class="rating-scale">
                        <div class="rating-option">
                            <input type="radio" name="grbas_a" value="0" id="a0">
                            <label for="a0">0 - æ­£å¸¸</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="grbas_a" value="1" id="a1">
                            <label for="a1">1 - è¼•åº¦</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="grbas_a" value="2" id="a2">
                            <label for="a2">2 - ä¸­åº¦</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="grbas_a" value="3" id="a3">
                            <label for="a3">3 - é‡åº¦</label>
                        </div>
                    </div>
                </div>
                
                <div class="measurement-item">
                    <div class="measurement-name">S (Strain) - ç·Šå¼µåº¦</div>
                    <div class="rating-scale">
                        <div class="rating-option">
                            <input type="radio" name="grbas_s" value="0" id="s0">
                            <label for="s0">0 - æ­£å¸¸</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="grbas_s" value="1" id="s1">
                            <label for="s1">1 - è¼•åº¦</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="grbas_s" value="2" id="s2">
                            <label for="s2">2 - ä¸­åº¦</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="grbas_s" value="3" id="s3">
                            <label for="s3">3 - é‡åº¦</label>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="assessment-section">
                <h3 class="section-title">å¸•é‡‘æ£®ç—…ç‰¹å®šèªéŸ³ç‰¹å¾µè©•ä¼°</h3>
                
                <div class="measurement-item">
                    <div class="measurement-name">éŸ³é‡æ¸›å¼± (Hypophonia)</div>
                    <div class="rating-scale">
                        <div class="rating-option">
                            <input type="radio" name="hypophonia" value="0">
                            <label>0 - ç„¡</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="hypophonia" value="1">
                            <label>1 - è¼•åº¦</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="hypophonia" value="2">
                            <label>2 - ä¸­åº¦</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="hypophonia" value="3">
                            <label>3 - é‡åº¦</label>
                        </div>
                    </div>
                </div>
                
                <div class="measurement-item">
                    <div class="measurement-name">å–®èª¿èªèª¿ (Monopitch)</div>
                    <div class="rating-scale">
                        <div class="rating-option">
                            <input type="radio" name="monopitch" value="0">
                            <label>0 - ç„¡</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="monopitch" value="1">
                            <label>1 - è¼•åº¦</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="monopitch" value="2">
                            <label>2 - ä¸­åº¦</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="monopitch" value="3">
                            <label>3 - é‡åº¦</label>
                        </div>
                    </div>
                </div>
                
                <div class="measurement-item">
                    <div class="measurement-name">èªé€Ÿç•°å¸¸ (Rate Abnormality)</div>
                    <div class="rating-scale">
                        <div class="rating-option">
                            <input type="radio" name="rate" value="0">
                            <label>0 - æ­£å¸¸</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="rate" value="1">
                            <label>1 - ç•¥å¿«/ç•¥æ…¢</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="rate" value="2">
                            <label>2 - æ˜é¡¯ç•°å¸¸</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="rate" value="3">
                            <label>3 - åš´é‡ç•°å¸¸</label>
                        </div>
                    </div>
                </div>
                
                <div class="measurement-item">
                    <div class="measurement-name">æ§‹éŸ³ä¸æ¸… (Imprecise Articulation)</div>
                    <div class="rating-scale">
                        <div class="rating-option">
                            <input type="radio" name="articulation" value="0">
                            <label>0 - æ¸…æ™°</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="articulation" value="1">
                            <label>1 - è¼•åº¦ä¸æ¸…</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="articulation" value="2">
                            <label>2 - ä¸­åº¦ä¸æ¸…</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="articulation" value="3">
                            <label>3 - é‡åº¦ä¸æ¸…</label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- åŠŸèƒ½æ€§è©•ä¼° -->
    <div id="functional" class="content-section">
        <div class="assessment-card">
            <h2 class="card-title">ğŸ’¬ åŠŸèƒ½æ€§æºé€šè©•ä¼°</h2>
            
            <div class="standard-reference">
                <div class="reference-title">ğŸ“‹ è©•ä¼°æ¨™æº–èªªæ˜</div>
                <p style="color: #744210;">ä¾æ“šã€Œåœ‹éš›åŠŸèƒ½ã€å¤±èƒ½èˆ‡å¥åº·åˆ†é¡ç³»çµ±ã€(ICF) åŠå°ç£èªè¨€æ²»ç™‚å­¸æœƒåˆ¶å®šä¹‹åŠŸèƒ½æ€§è©•ä¼°æ¨™æº–</p>
            </div>
            
            <div class="assessment-section">
                <h3 class="section-title">èªéŸ³æ¸…æ™°åº¦è©•ä¼°</h3>
                
                <div class="measurement-item">
                    <div class="measurement-name">è©å½™å±¤æ¬¡æ¸…æ™°åº¦</div>
                    <div class="measurement-grid">
                        <div class="measurement-field">
                            <label class="field-label">æ¸¬è©¦è©å½™æ•¸</label>
                            <input type="number" class="field-input" id="word_total" value="50">
                        </div>
                        <div class="measurement-field">
                            <label class="field-label">æ­£ç¢ºè¾¨è­˜æ•¸</label>
                            <input type="number" class="field-input" id="word_correct" oninput="calculateWordClarity()">
                        </div>
                        <div class="measurement-field">
                            <label class="field-label">æ¸…æ™°åº¦ç™¾åˆ†æ¯”</label>
                            <input type="number" class="field-input" id="word_clarity" readonly style="background:#f7fafc;">
                        </div>
                    </div>
                </div>
                
                <div class="measurement-item">
                    <div class="measurement-name">å¥å­å±¤æ¬¡æ¸…æ™°åº¦</div>
                    <div class="measurement-grid">
                        <div class="measurement-field">
                            <label class="field-label">æ¸¬è©¦å¥å­æ•¸</label>
                            <input type="number" class="field-input" id="sentence_total" value="20">
                        </div>
                        <div class="measurement-field">
                            <label class="field-label">å®Œå…¨ç†è§£æ•¸</label>
                            <input type="number" class="field-input" id="sentence_correct" oninput="calculateSentenceClarity()">
                        </div>
                        <div class="measurement-field">
                            <label class="field-label">å¯æ‡‚åº¦ç™¾åˆ†æ¯”</label>
                            <input type="number" class="field-input" id="sentence_clarity" readonly style="background:#f7fafc;">
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="assessment-section">
                <h3 class="section-title">æºé€šæ•ˆèƒ½è©•ä¼° (CETIæ”¹ç·¨ç‰ˆ)</h3>
                
                <div class="measurement-item">
                    <div class="measurement-name">æ—¥å¸¸å°è©±èƒ½åŠ›</div>
                    <div class="rating-scale">
                        <div class="rating-option">
                            <input type="radio" name="daily_conv" value="1">
                            <label>1 - å®Œå…¨ç„¡æ³•</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="daily_conv" value="2">
                            <label>2 - éå¸¸å›°é›£</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="daily_conv" value="3">
                            <label>3 - æœ‰äº›å›°é›£</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="daily_conv" value="4">
                            <label>4 - ç•¥æœ‰å›°é›£</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="daily_conv" value="5">
                            <label>5 - å®Œå…¨æ­£å¸¸</label>
                        </div>
                    </div>
                </div>
                
                <div class="measurement-item">
                    <div class="measurement-name">é›»è©±æºé€šèƒ½åŠ›</div>
                    <div class="rating-scale">
                        <div class="rating-option">
                            <input type="radio" name="phone_comm" value="1">
                            <label>1 - å®Œå…¨ç„¡æ³•</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="phone_comm" value="2">
                            <label>2 - éå¸¸å›°é›£</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="phone_comm" value="3">
                            <label>3 - æœ‰äº›å›°é›£</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="phone_comm" value="4">
                            <label>4 - ç•¥æœ‰å›°é›£</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="phone_comm" value="5">
                            <label>5 - å®Œå…¨æ­£å¸¸</label>
                        </div>
                    </div>
                </div>
                
                <div class="measurement-item">
                    <div class="measurement-name">å…¬å…±å ´æ‰€æºé€š</div>
                    <div class="rating-scale">
                        <div class="rating-option">
                            <input type="radio" name="public_comm" value="1">
                            <label>1 - å®Œå…¨ç„¡æ³•</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="public_comm" value="2">
                            <label>2 - éå¸¸å›°é›£</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="public_comm" value="3">
                            <label>3 - æœ‰äº›å›°é›£</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="public_comm" value="4">
                            <label>4 - ç•¥æœ‰å›°é›£</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="public_comm" value="5">
                            <label>5 - å®Œå…¨æ­£å¸¸</label>
                        </div>
                    </div>
                </div>
                
                <div class="measurement-item">
                    <div class="measurement-name">è¡¨é”éœ€æ±‚èƒ½åŠ›</div>
                    <div class="rating-scale">
                        <div class="rating-option">
                            <input type="radio" name="express_needs" value="1">
                            <label>1 - å®Œå…¨ç„¡æ³•</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="express_needs" value="2">
                            <label>2 - éå¸¸å›°é›£</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="express_needs" value="3">
                            <label>3 - æœ‰äº›å›°é›£</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="express_needs" value="4">
                            <label>4 - ç•¥æœ‰å›°é›£</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="express_needs" value="5">
                            <label>5 - å®Œå…¨æ­£å¸¸</label>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="assessment-section">
                <h3 class="section-title">ç”Ÿæ´»å“è³ªå½±éŸ¿è©•ä¼° (V-RQOLæ”¹ç·¨)</h3>
                
                <div class="measurement-item">
                    <div class="measurement-name">èªéŸ³å•é¡Œå°ç¤¾äº¤çš„å½±éŸ¿</div>
                    <div class="rating-scale">
                        <div class="rating-option">
                            <input type="radio" name="social_impact" value="1">
                            <label>1 - åš´é‡å½±éŸ¿</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="social_impact" value="2">
                            <label>2 - ä¸­åº¦å½±éŸ¿</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="social_impact" value="3">
                            <label>3 - è¼•åº¦å½±éŸ¿</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="social_impact" value="4">
                            <label>4 - æ¥µè¼•å¾®å½±éŸ¿</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="social_impact" value="5">
                            <label>5 - ç„¡å½±éŸ¿</label>
                        </div>
                    </div>
                </div>
                
                <div class="measurement-item">
                    <div class="measurement-name">èªéŸ³å•é¡Œé€ æˆçš„å¿ƒç†å£“åŠ›</div>
                    <div class="rating-scale">
                        <div class="rating-option">
                            <input type="radio" name="psychological" value="1">
                            <label>1 - æ¥µå¤§å£“åŠ›</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="psychological" value="2">
                            <label>2 - ä¸­åº¦å£“åŠ›</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="psychological" value="3">
                            <label>3 - è¼•åº¦å£“åŠ›</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="psychological" value="4">
                            <label>4 - æ¥µè¼•å¾®å£“åŠ›</label>
                        </div>
                        <div class="rating-option">
                            <input type="radio" name="psychological" value="5">
                            <label>5 - ç„¡å£“åŠ›</label>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="form-group">
                <label class="form-label">è‡¨åºŠè§€å¯Ÿèˆ‡å‚™è¨»</label>
                <textarea class="form-input" id="clinical_notes" rows="5" placeholder="è«‹è¨˜éŒ„è©•ä¼°éç¨‹ä¸­çš„é‡è¦è§€å¯Ÿã€æ‚£è€…è¡¨ç¾ã€ç‰¹æ®Šç‹€æ³ç­‰..."></textarea>
            </div>
        </div>
    </div>
    
    <!-- è©•ä¼°å ±å‘Š -->
    <div id="report" class="content-section">
        <div class="assessment-card">
            <h2 class="card-title">ğŸ“„ èªéŸ³åˆ†æè©•ä¼°å ±å‘Š</h2>
            
            <div class="button-group">
                <button class="btn-primary" onclick="generateReport()">ğŸ”„ ç”Ÿæˆå®Œæ•´å ±å‘Š</button>
                <button class="btn-secondary" onclick="window.print()">ğŸ–¨ï¸ åˆ—å°å ±å‘Š</button>
                <button class="btn-secondary" onclick="saveReport()">ğŸ’¾ å„²å­˜å ±å‘Š</button>
                <button class="btn-secondary" onclick="exportPDF()">ğŸ“¥ åŒ¯å‡ºPDF</button>
            </div>
            
            <div class="report-preview" id="reportContent" style="display:none;">
                <div class="report-header">
                    <div class="report-title">å¸•é‡‘æ£®ç—…èªéŸ³åˆ†æè©•ä¼°å ±å‘Š</div>
                    <div class="report-subtitle">Speech Analysis Assessment Report for Parkinson's Disease</div>
                    <div style="margin-top: 15px; color: #718096;">ä¾æ“šè¡›ç”Ÿç¦åˆ©éƒ¨èªè¨€æ²»ç™‚æ¨™æº–ä½œæ¥­è¦ç¯„</div>
                </div>
                
                <!-- åŸºæœ¬è³‡æ–™æ‘˜è¦ -->
                <div class="report-section">
                    <div class="report-section-title">ä¸€ã€åŸºæœ¬è³‡æ–™</div>
                    <div class="data-grid">
                        <div class="data-card">
                            <div class="data-label">å§“å</div>
                            <div class="data-value" id="report_name">-</div>
                        </div>
                        <div class="data-card">
                            <div class="data-label">ç—…æ­·è™Ÿ</div>
                            <div class="data-value" id="report_id">-</div>
                        </div>
                        <div class="data-card">
                            <div class="data-label">æ€§åˆ¥</div>
                            <div class="data-value" id="report_gender">-</div>
                        </div>
                        <div class="data-card">
                            <div class="data-label">å¹´é½¡</div>
                            <div class="data-value" id="report_age">-</div>
                        </div>
                        <div class="data-card">
                            <div class="data-label">è©•ä¼°æ—¥æœŸ</div>
                            <div class="data-value" id="report_date">-</div>
                        </div>
                        <div class="data-card">
                            <div class="data-label">H-Yåˆ†æœŸ</div>
                            <div class="data-value" id="report_hy">-</div>
                        </div>
                    </div>
                </div>
                
                <!-- è²å­¸åƒæ•¸çµæœ -->
                <div class="report-section">
                    <div class="report-section-title">äºŒã€è²å­¸åƒæ•¸è©•ä¼°çµæœ</div>
                    
                    <div class="chart-container">
                        <div class="chart-title">è²å­¸åƒæ•¸èˆ‡æ¨™æº–å€¼æ¯”è¼ƒ</div>
                        
                        <div class="progress-bar-container">
                            <div class="progress-label">
                                <span>åŸºæœ¬é »ç‡ (F0)</span>
                                <span id="report_f0_value">-</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="report_f0_bar" style="width: 0%;">0%</div>
                            </div>
                        </div>
                        
                        <div class="progress-bar-container">
                            <div class="progress-label">
                                <span>è²éŸ³éŸ¿åº¦ (SPL)</span>
                                <span id="report_spl_value">-</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="report_spl_bar" style="width: 0%;">0%</div>
                            </div>
                        </div>
                        
                        <div class="progress-bar-container">
                            <div class="progress-label">
                                <span>æœ€å¤§ç™¼è²æ™‚é–“ (MPT)</span>
                                <span id="report_mpt_value">-</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="report_mpt_bar" style="width: 0%;">0%</div>
                            </div>
                        </div>
                        
                        <div class="progress-bar-container">
                            <div class="progress-label">
                                <span>å—“éŸ³å“è³ª (Jitter)</span>
                                <span id="report_jitter_value">-</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="report_jitter_bar" style="width: 0%;">0%</div>
                            </div>
                        </div>
                        
                        <div class="progress-bar-container">
                            <div class="progress-label">
                                <span>æŒ¯å¹…ç©©å®šåº¦ (Shimmer)</span>
                                <span id="report_shimmer_value">-</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="report_shimmer_bar" style="width: 0%;">0%</div>
                            </div>
                        </div>
                        
                        <div class="progress-bar-container">
                            <div class="progress-label">
                                <span>è«§å™ªæ¯” (HNR)</span>
                                <span id="report_hnr_value">-</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" id="report_hnr_bar" style="width: 0%;">0%</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- çŸ¥è¦ºè©•ä¼°çµæœ -->
                <div class="report-section">
                    <div class="report-section-title">ä¸‰ã€çŸ¥è¦ºè©•ä¼°çµæœ (GRBAS)</div>
                    
                    <div class="chart-container">
                        <table class="reference-table">
                            <thead>
                                <tr>
                                    <th>è©•ä¼°é …ç›®</th>
                                    <th>è©•åˆ†</th>
                                    <th>åš´é‡åº¦</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>G - æ•´é«”åš´é‡åº¦</td>
                                    <td id="report_grbas_g">-</td>
                                    <td id="report_grbas_g_level">-</td>
                                </tr>
                                <tr>
                                    <td>R - ç²—ç³™åº¦</td>
                                    <td id="report_grbas_r">-</td>
                                    <td id="report_grbas_r_level">-</td>
                                </tr>
                                <tr>
                                    <td>B - æ°£æ¯è²</td>
                                    <td id="report_grbas_b">-</td>
                                    <td id="report_grbas_b_level">-</td>
                                </tr>
                                <tr>
                                    <td>A - ç„¡åŠ›åº¦</td>
                                    <td id="report_grbas_a">-</td>
                                    <td id="report_grbas_a_level">-</td>
                                </tr>
                                <tr>
                                    <td>S - ç·Šå¼µåº¦</td>
                                    <td id="report_grbas_s">-</td>
                                    <td id="report_grbas_s_level">-</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="chart-container">
                        <div class="chart-title">å¸•é‡‘æ£®ç—…ç‰¹å®šèªéŸ³ç‰¹å¾µ</div>
                        <table class="reference-table">
                            <thead>
                                <tr>
                                    <th>ç‰¹å¾µ</th>
                                    <th>è©•åˆ†</th>
                                    <th>åš´é‡åº¦</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>éŸ³é‡æ¸›å¼±</td>
                                    <td id="report_hypophonia">-</td>
                                    <td id="report_hypophonia_level">-</td>
                                </tr>
                                <tr>
                                    <td>å–®èª¿èªèª¿</td>
                                    <td id="report_monopitch">-</td>
                                    <td id="report_monopitch_level">-</td>
                                </tr>
                                <tr>
                                    <td>èªé€Ÿç•°å¸¸</td>
                                    <td id="report_rate">-</td>
                                    <td id="report_rate_level">-</td>
                                </tr>
                                <tr>
                                    <td>æ§‹éŸ³ä¸æ¸…</td>
                                    <td id="report_articulation">-</td>
                                    <td id="report_articulation_level">-</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <!-- åŠŸèƒ½æ€§è©•ä¼°çµæœ -->
                <div class="report-section">
                    <div class="report-section-title">å››ã€åŠŸèƒ½æ€§æºé€šè©•ä¼°çµæœ</div>
                    
                    <div class="data-grid">
                        <div class="data-card">
                            <div class="data-label">è©å½™æ¸…æ™°åº¦</div>
                            <div class="data-value" id="report_word_clarity">-</div>
                        </div>
                        <div class="data-card">
                            <div class="data-label">å¥å­å¯æ‡‚åº¦</div>
                            <div class="data-value" id="report_sentence_clarity">-</div>
                        </div>
                        <div class="data-card">
                            <div class="data-label">æ—¥å¸¸å°è©±èƒ½åŠ›</div>
                            <div class="data-value" id="report_daily_conv">-</div>
                        </div>
                        <div class="data-card">
                            <div class="data-label">é›»è©±æºé€šèƒ½åŠ›</div>
                            <div class="data-value" id="report_phone_comm">-</div>
                        </div>
                    </div>
                </div>
                
                <!-- ç¶œåˆè©•ä¼° -->
                <div class="report-section">
                    <div class="report-section-title">äº”ã€ç¶œåˆè©•ä¼°èˆ‡è¨ºæ–·</div>
                    
                    <div class="comparison-box">
                        <div class="comparison-title">æ•´é«”èªéŸ³åŠŸèƒ½è©•ç´š</div>
                        <div class="comparison-result">
                            <span class="result-label">è©•ä¼°çµæœï¼š</span>
                            <span class="result-value" id="overall_assessment" style="font-size: 1.5em;">-</span>
                        </div>
                    </div>
                    
                    <div style="background: #f7fafc; padding: 20px; border-radius: 12px; margin-top: 20px;">
                        <h4 style="color: #2d3748; margin-bottom: 15px; font-weight: 700;">è‡¨åºŠç™¼ç¾æ‘˜è¦ï¼š</h4>
                        <div id="clinical_summary" style="color: #4a5568; line-height: 1.8;">
                            <!-- å°‡ç”±JavaScriptç”Ÿæˆ -->
                        </div>
                    </div>
                </div>
                
                <!-- æ²»ç™‚å»ºè­° -->
                <div class="report-section">
                    <div class="report-section-title">å…­ã€æ²»ç™‚å»ºè­°</div>
                    
                    <div class="recommendation-box">
                        <div class="recommendation-title">å»ºè­°æ²»ç™‚æ–¹å‘</div>
                        <ul class="recommendation-list" id="treatment_recommendations">
                            <!-- å°‡ç”±JavaScriptç”Ÿæˆ -->
                        </ul>
                    </div>
                    
                    <div class="recommendation-box" style="background: linear-gradient(135deg, #e6f3ff 0%, #cce7ff 100%); border-color: #3182ce;">
                        <div class="recommendation-title" style="color: #2b6cb0;">å¾ŒçºŒè¿½è¹¤è¨ˆç•«</div>
                        <ul class="recommendation-list" style="color: #2c5282;" id="followup_plan">
                            <!-- å°‡ç”±JavaScriptç”Ÿæˆ -->
                        </ul>
                    </div>
                </div>
                
                <!-- è©•ä¼°è€…ç°½å -->
                <div class="signature-section">
                    <div class="signature-box">
                        <div class="signature-line"></div>
                        <div class="signature-label">èªè¨€æ²»ç™‚å¸«ç°½å</div>
                    </div>
                    <div class="signature-box">
                        <div class="signature-line"></div>
                        <div class="signature-label">è©•ä¼°æ—¥æœŸ</div>
                    </div>
                    <div class="signature-box">
                        <div class="signature-line"></div>
                        <div class="signature-label">è­‰æ›¸å­—è™Ÿ</div>
                    </div>
                </div>
                
                <div style="margin-top: 30px; padding: 20px; background: #f7fafc; border-radius: 12px; text-align: center; color: #718096; font-size: 0.9em;">
                    <p>æœ¬å ±å‘Šä¾æ“šè¡›ç”Ÿç¦åˆ©éƒ¨ã€Œèªè¨€æ²»ç™‚æœå‹™æ¨™æº–ä½œæ¥­è¦ç¯„ã€åŠå°ç£èªè¨€æ²»ç™‚å­¸æœƒå°ˆæ¥­æ¨™æº–è£½ä½œ</p>
                    <p style="margin-top: 10px;">å ±å‘Šç”¢ç”Ÿæ™‚é–“ï¼š<span id="report_timestamp"></span></p>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// è¨ˆç®—F0ç‹€æ…‹
function calculateF0Status() {
    const f0 = parseFloat(document.getElementById('f0_mean').value);
    const gender = document.getElementById('gender').value;
    const comparison = document.getElementById('f0_comparison');
    const status = document.getElementById('f0_status');
    
    if (!f0 || !gender) return;
    
    comparison.style.display = 'block';
    
    let result = '';
    let className = '';
    
    if (gender === 'male') {
        if (f0 >= 100 && f0 <= 150) {
            result = 'æ­£å¸¸ç¯„åœ';
            className = 'result-normal';
        } else if (f0 < 100 || f0 > 150) {
            result = 'ç•°å¸¸ - å»ºè­°é€²ä¸€æ­¥è©•ä¼°';
            className = 'result-moderate';
        }
    } else if (gender === 'female') {
        if (f0 >= 180 && f0 <= 250) {
            result = 'æ­£å¸¸ç¯„åœ';
            className = 'result-normal';
        } else if (f0 < 180 || f0 > 250) {
            result = 'ç•°å¸¸ - å»ºè­°é€²ä¸€æ­¥è©•ä¼°';
            className = 'result-moderate';
        }
    }
    
    status.textContent = result;
    status.className = 'result-value ' + className;
}

// è¨ˆç®—SPLç‹€æ…‹
function calculateSPLStatus() {
    const spl = parseFloat(document.getElementById('spl_comfortable').value);
    const gender = document.getElementById('gender').value;
    const comparison = document.getElementById('spl_comparison');
    const status = document.getElementById('spl_status');
    
    if (!spl || !gender) return;
    
    comparison.style.display = 'block';
    
    let result = '';
    let className = '';
    
    if (gender === 'male') {
        if (spl >= 65 && spl <= 75) {
            result = 'æ­£å¸¸ç¯„åœ';
            className = 'result-normal';
        } else if (spl < 60) {
            result = 'éŸ³é‡éå° - éœ€è¦æ²»ç™‚';
            className = 'result-moderate';
        } else if (spl < 65) {
            result = 'éŸ³é‡åå° - å»ºè­°è¨“ç·´';
            className = 'result-mild';
        }
    } else if (gender === 'female') {
        if (spl >= 60 && spl <= 70) {
            result = 'æ­£å¸¸ç¯„åœ';
            className = 'result-normal';
        } else if (spl < 55) {
            result = 'éŸ³é‡éå° - éœ€è¦æ²»ç™‚';
            className = 'result-moderate';
        } else if (spl < 60) {
            result = 'éŸ³é‡åå° - å»ºè­°è¨“ç·´';
            className = 'result-mild';
        }
    }
    
    status.textContent = result;
    status.className = 'result-value ' + className;
}

// è¨ˆç®—MPT
function calculateMPT() {
    const mpt1 = parseFloat(document.getElementById('mpt_1').value) || 0;
    const mpt2 = parseFloat(document.getElementById('mpt_2').value) || 0;
    const mpt3 = parseFloat(document.getElementById('mpt_3').value) || 0;
    
    if (mpt1 && mpt2 && mpt3) {
        const avg = ((mpt1 + mpt2 + mpt3) / 3).toFixed(2);
        document.getElementById('mpt_avg').value = avg;
        
        const gender = document.getElementById('gender').value;
        const comparison = document.getElementById('mpt_comparison');
        const status = document.getElementById('mpt_status');
        
        comparison.style.display = 'block';
        
        let result = '';
        let className = '';
        
        if (gender === 'male') {
            if (avg >= 20) {
                result = 'æ­£å¸¸ç¯„åœ';
                className = 'result-normal';
            } else if (avg >= 15) {
                result = 'è¼•åº¦ç•°å¸¸';
                className = 'result-mild';
            } else if (avg >= 10) {
                result = 'ä¸­åº¦ç•°å¸¸';
                className = 'result-moderate';
            } else {
                result = 'é‡åº¦ç•°å¸¸';
                className = 'result-severe';
            }
        } else if (gender === 'female') {
            if (avg >= 15) {
                result = 'æ­£å¸¸ç¯„åœ';
                className = 'result-normal';
            } else if (avg >= 12) {
                result = 'è¼•åº¦ç•°å¸¸';
                className = 'result-mild';
            } else if (avg >= 8) {
                result = 'ä¸­åº¦ç•°å¸¸';
                className = 'result-moderate';
            } else {
                result = 'é‡åº¦ç•°å¸¸';
                className = 'result-severe';
            }
        }
        
        status.textContent = result;
        status.className = 'result-value ' + className;
    }
}

// è¨ˆç®—Jitterç‹€æ…‹
function calculateJitterStatus() {
    const jitter = parseFloat(document.getElementById('jitter').value);
    const comparison = document.getElementById('jitter_comparison');
    const status = document.getElementById('jitter_status');
    
    if (!jitter) return;
    
    comparison.style.display = 'block';
    
    let result = '';
    let className = '';
    
    if (jitter < 1.04) {
        result = 'æ­£å¸¸ç¯„åœ';
        className = 'result-normal';
    } else if (jitter < 2.0) {
        result = 'è¼•åº¦ç•°å¸¸';
        className = 'result-mild';
    } else if (jitter < 3.0) {
        result = 'ä¸­åº¦ç•°å¸¸';
        className = 'result-moderate';
    } else {
        result = 'é‡åº¦ç•°å¸¸';
        className = 'result-severe';
    }
    
    status.textContent = result;
    status.className = 'result-value ' + className;
}

// è¨ˆç®—Shimmerç‹€æ…‹
function calculateShimmerStatus() {
    const shimmer = parseFloat(document.getElementById('shimmer').value);
    const comparison = document.getElementById('shimmer_comparison');
    const status = document.getElementById('shimmer_status');
    
    if (!shimmer) return;
    
    comparison.style.display = 'block';
    
    let result = '';
    let className = '';
    
    if (shimmer < 3.81) {
        result = 'æ­£å¸¸ç¯„åœ';
        className = 'result-normal';
    } else if (shimmer < 6.0) {
        result = 'è¼•åº¦ç•°å¸¸';
        className = 'result-mild';
    } else if (shimmer < 9.0) {
        result = 'ä¸­åº¦ç•°å¸¸';
        className = 'result-moderate';
    } else {
        result = 'é‡åº¦ç•°å¸¸';
        className = 'result-severe';
    }
    
    status.textContent = result;
    status.className = 'result-value ' + className;
}

// è¨ˆç®—HNRç‹€æ…‹
function calculateHNRStatus() {
    const hnr = parseFloat(document.getElementById('hnr').value);
    const comparison = document.getElementById('hnr_comparison');
    const status = document.getElementById('hnr_status');
    
    if (!hnr) return;
    
    comparison.style.display = 'block';
    
    let result = '';
    let className = '';
    
    if (hnr >= 20) {
        result = 'æ­£å¸¸ç¯„åœ';
        className = 'result-normal';
    } else if (hnr >= 15) {
        result = 'è¼•åº¦ç•°å¸¸';
        className = 'result-mild';
    } else if (hnr >= 10) {
        result = 'ä¸­åº¦ç•°å¸¸';
        className = 'result-moderate';
    } else {
        result = 'é‡åº¦ç•°å¸¸';
        className = 'result-severe';
    }
    
    status.textContent = result;
    status.className = 'result-value ' + className;
}

// è¨ˆç®—è©å½™æ¸…æ™°åº¦
function calculateWordClarity() {
    const total = parseFloat(document.getElementById('word_total').value) || 0;
    const correct = parseFloat(document.getElementById('word_correct').value) || 0;
    
    if (total > 0) {
        const clarity = ((correct / total) * 100).toFixed(1);
        document.getElementById('word_clarity').value = clarity + '%';
    }
}

// è¨ˆç®—å¥å­æ¸…æ™°åº¦
function calculateSentenceClarity() {
    const total = parseFloat(document.getElementById('sentence_total').value) || 0;
    const correct = parseFloat(document.getElementById('sentence_correct').value) || 0;
    
    if (total > 0) {
        const clarity = ((correct / total) * 100).toFixed(1);
        document.getElementById('sentence_clarity').value = clarity + '%';
    }
}

// åˆ‡æ›é é¢
function showSection(sectionId) {
    const sections = document.querySelectorAll('.content-section');
    sections.forEach(section => {
        section.classList.remove('active');
    });
    
    const tabs = document.querySelectorAll('.nav-tab');
    tabs.forEach(tab => {
        tab.classList.remove('active');
    });
    
    document.getElementById(sectionId).classList.add('active');
    event.target.classList.add('active');
}

// ç”Ÿæˆå ±å‘Š
function generateReport() {
    // åŸºæœ¬è³‡æ–™
    document.getElementById('report_name').textContent = document.getElementById('patientName').value || '-';
    document.getElementById('report_id').textContent = document.getElementById('patientID').value || '-';
    
    const gender = document.getElementById('gender').value;
    document.getElementById('report_gender').textContent = gender === 'male' ? 'ç”·æ€§' : gender === 'female' ? 'å¥³æ€§' : '-';
    
    // è¨ˆç®—å¹´é½¡
    const birthDate = document.getElementById('birthDate').value;
    if (birthDate) {
        const age = new Date().getFullYear() - new Date(birthDate).getFullYear();
        document.getElementById('report_age').textContent = age + 'æ­²';
    }
    
    document.getElementById('report_date').textContent = document.getElementById('assessmentDate').value || '-';
    document.getElementById('report_hy').textContent = document.getElementById('hohenYahr').value || '-';
    
    // è²å­¸åƒæ•¸
    const f0 = document.getElementById('f0_mean').value;
    const spl = document.getElementById('spl_comfortable').value;
    const mpt = document.getElementById('mpt_avg').value;
    const jitter = document.getElementById('jitter').value;
    const shimmer = document.getElementById('shimmer').value;
    const hnr = document.getElementById('hnr').value;
    
    if (f0) {
        document.getElementById('report_f0_value').textContent = f0 + ' Hz';
        const f0Percent = gender === 'male' ? (f0 / 150 * 100) : (f0 / 250 * 100);
        document.getElementById('report_f0_bar').style.width = Math.min(f0Percent, 100) + '%';
        document.getElementById('report_f0_bar').textContent = Math.round(f0Percent) + '%';
    }
    
    if (spl) {
        document.getElementById('report_spl_value').textContent = spl + ' dB';
        const splPercent = gender === 'male' ? (spl / 75 * 100) : (spl / 70 * 100);
        document.getElementById('report_spl_bar').style.width = Math.min(splPercent, 100) + '%';
        document.getElementById('report_spl_bar').textContent = Math.round(splPercent) + '%';
    }
    
    if (mpt) {
        document.getElementById('report_mpt_value').textContent = mpt + ' ç§’';
        const mptPercent = gender === 'male' ? (mpt / 20 * 100) : (mpt / 15 * 100);
        document.getElementById('report_mpt_bar').style.width = Math.min(mptPercent, 100) + '%';
        document.getElementById('report_mpt_bar').textContent = Math.round(mptPercent) + '%';
    }
    
    if (jitter) {
        document.getElementById('report_jitter_value').textContent = jitter + '%';
        const jitterPercent = jitter < 1.04 ? 100 : (1.04 / jitter * 100);
        document.getElementById('report_jitter_bar').style.width = Math.min(jitterPercent, 100) + '%';
        document.getElementById('report_jitter_bar').textContent = Math.round(jitterPercent) + '%';
    }
    
    if (shimmer) {
        document.getElementById('report_shimmer_value').textContent = shimmer + '%';
        const shimmerPercent = shimmer < 3.81 ? 100 : (3.81 / shimmer * 100);
        document.getElementById('report_shimmer_bar').style.width = Math.min(shimmerPercent, 100) + '%';
        document.getElementById('report_shimmer_bar').textContent = Math.round(shimmerPercent) + '%';
    }
    
    if (hnr) {
        document.getElementById('report_hnr_value').textContent = hnr + ' dB';
        const hnrPercent = (hnr / 20 * 100);
        document.getElementById('report_hnr_bar').style.width = Math.min(hnrPercent, 100) + '%';
        document.getElementById('report_hnr_bar').textContent = Math.round(hnrPercent) + '%';
    }
    
    // GRBASè©•åˆ†
    const grbasItems = ['g', 'r', 'b', 'a', 's'];
    grbasItems.forEach(item => {
        const value = document.querySelector(`input[name="grbas_${item}"]:checked`)?.value;
        if (value) {
            document.getElementById(`report_grbas_${item}`).textContent = value;
            const levels = ['æ­£å¸¸', 'è¼•åº¦', 'ä¸­åº¦', 'é‡åº¦'];
            document.getElementById(`report_grbas_${item}_level`).textContent = levels[parseInt(value)];
        }
    });
    
    // å¸•é‡‘æ£®ç‰¹å¾µ
    const pdFeatures = ['hypophonia', 'monopitch', 'rate', 'articulation'];
    pdFeatures.forEach(feature => {
        const value = document.querySelector(`input[name="${feature}"]:checked`)?.value;
        if (value) {
            document.getElementById(`report_${feature}`).textContent = value;
            const levels = ['ç„¡', 'è¼•åº¦', 'ä¸­åº¦', 'é‡åº¦'];
            document.getElementById(`report_${feature}_level`).textContent = levels[parseInt(value)];
        }
    });
    
    // åŠŸèƒ½æ€§è©•ä¼°
    document.getElementById('report_word_clarity').textContent = document.getElementById('word_clarity').value || '-';
    document.getElementById('report_sentence_clarity').textContent = document.getElementById('sentence_clarity').value || '-';
    
    const dailyConv = document.querySelector('input[name="daily_conv"]:checked')?.value;
    if (dailyConv) {
        const levels = ['', 'å®Œå…¨ç„¡æ³•', 'éå¸¸å›°é›£', 'æœ‰äº›å›°é›£', 'ç•¥æœ‰å›°é›£', 'å®Œå…¨æ­£å¸¸'];
        document.getElementById('report_daily_conv').textContent = levels[parseInt(dailyConv)];
    }
    
    const phoneComm = document.querySelector('input[name="phone_comm"]:checked')?.value;
    if (phoneComm) {
        const levels = ['', 'å®Œå…¨ç„¡æ³•', 'éå¸¸å›°é›£', 'æœ‰äº›å›°é›£', 'ç•¥æœ‰å›°é›£', 'å®Œå…¨æ­£å¸¸'];
        document.getElementById('report_phone_comm').textContent = levels[parseInt(phoneComm)];
    }
    
    // ç”Ÿæˆç¶œåˆè©•ä¼°
    generateClinicalSummary();
    
    // ç”Ÿæˆæ²»ç™‚å»ºè­°
    generateTreatmentRecommendations();
    
    // é¡¯ç¤ºå ±å‘Š
    document.getElementById('reportContent').style.display = 'block';
    document.getElementById('report_timestamp').textContent = new Date().toLocaleString('zh-TW');
    
    // æ»¾å‹•åˆ°å ±å‘Šå€åŸŸ
    document.getElementById('reportContent').scrollIntoView({ behavior: 'smooth' });
}

// ç”Ÿæˆè‡¨åºŠæ‘˜è¦
function generateClinicalSummary() {
    let summary = '<ul style="list-style: none; padding: 0;">';
    
    // è²å­¸åƒæ•¸æ‘˜è¦
    const f0Status = document.getElementById('f0_status')?.textContent;
    const splStatus = document.getElementById('spl_status')?.textContent;
    const mptStatus = document.getElementById('mpt_status')?.textContent;
    
    if (f0Status) summary += `<li>â€¢ åŸºæœ¬é »ç‡ï¼š${f0Status}</li>`;
    if (splStatus) summary += `<li>â€¢ è²éŸ³éŸ¿åº¦ï¼š${splStatus}</li>`;
    if (mptStatus) summary += `<li>â€¢ æœ€å¤§ç™¼è²æ™‚é–“ï¼š${mptStatus}</li>`;
    
    // GRBASæ‘˜è¦
    const grbasG = document.querySelector('input[name="grbas_g"]:checked')?.value;
    if (grbasG && parseInt(grbasG) > 0) {
        const levels = ['', 'è¼•åº¦', 'ä¸­åº¦', 'é‡åº¦'];
        summary += `<li>â€¢ æ•´é«”å—“éŸ³å“è³ªå‘ˆç¾${levels[parseInt(grbasG)]}ç•°å¸¸</li>`;
    }
    
    // åŠŸèƒ½æ€§è©•ä¼°æ‘˜è¦
    const wordClarity = document.getElementById('word_clarity').value;
    if (wordClarity) {
        const percent = parseFloat(wordClarity);
        if (percent < 80) {
            summary += `<li>â€¢ è©å½™æ¸…æ™°åº¦${percent}%ï¼Œéœ€åŠ å¼·æ§‹éŸ³è¨“ç·´</li>`;
        }
    }
    
    summary += '</ul>';
    
    // æ•´é«”è©•ç´š
    let overallLevel = 'æ­£å¸¸';
    let overallClass = 'result-normal';
    
    if (mptStatus && mptStatus.includes('é‡åº¦')) {
        overallLevel = 'é‡åº¦ç•°å¸¸';
        overallClass = 'result-severe';
    } else if (mptStatus && mptStatus.includes('ä¸­åº¦')) {
        overallLevel = 'ä¸­åº¦ç•°å¸¸';
        overallClass = 'result-moderate';
    } else if (mptStatus && mptStatus.includes('è¼•åº¦')) {
        overallLevel = 'è¼•åº¦ç•°å¸¸';
        overallClass = 'result-mild';
    }
    
    document.getElementById('overall_assessment').textContent = overallLevel;
    document.getElementById('overall_assessment').className = 'result-value ' + overallClass;
    document.getElementById('clinical_summary').innerHTML = summary;
}

// ç”Ÿæˆæ²»ç™‚å»ºè­°
function generateTreatmentRecommendations() {
    let recommendations = '';
    let followupPlan = '';
    
    // æ ¹æ“šè©•ä¼°çµæœç”Ÿæˆå»ºè­°
    const splStatus = document.getElementById('spl_status')?.textContent;
    const mptStatus = document.getElementById('mpt_status')?.textContent;
    const jitterStatus = document.getElementById('jitter_status')?.textContent;
    
    if (splStatus && splStatus.includes('éŸ³é‡')) {
        recommendations += '<li>å»ºè­°é€²è¡ŒLSVT LOUDÂ®æ¨™æº–åŒ–éŸ¿åº¦è¨“ç·´ï¼Œæ¯é€±4æ¬¡ï¼ŒæŒçºŒ4é€±</li>';
    }
    
    if (mptStatus && (mptStatus.includes('ç•°å¸¸'))) {
        recommendations += '<li>åŠ å¼·å‘¼å¸æ”¯æŒè¨“ç·´ï¼ŒåŒ…æ‹¬è…¹å¼å‘¼å¸å’Œå‘¼å¸æ§åˆ¶ç·´ç¿’</li>';
    }
    
    if (jitterStatus && (jitterStatus.includes('ç•°å¸¸'))) {
        recommendations += '<li>é€²è¡Œå—“éŸ³è¡›ç”Ÿæ•™è‚²ï¼Œé¿å…è²å¸¶éåº¦ä½¿ç”¨</li>';
    }
    
    const hypophonia = document.querySelector('input[name="hypophonia"]:checked')?.value;
    if (hypophonia && parseInt(hypophonia) > 0) {
        recommendations += '<li>æ¯æ—¥é€²è¡ŒéŸ³é‡æ ¡æ­£ç·´ç¿’ï¼Œä½¿ç”¨åˆ†è²è¨ˆç›£æ¸¬éŸ³é‡</li>';
    }
    
    const articulation = document.querySelector('input[name="articulation"]:checked')?.value;
    if (articulation && parseInt(articulation) > 0) {
        recommendations += '<li>æ§‹éŸ³å™¨å®˜é‹å‹•è¨“ç·´ï¼ŒåŒ…æ‹¬å”‡ã€èˆŒã€ä¸‹é¡éˆæ´»åº¦ç·´ç¿’</li>';
    }
    
    const monopitch = document.querySelector('input[name="monopitch"]:checked')?.value;
    if (monopitch && parseInt(monopitch) > 0) {
        recommendations += '<li>éŸ»å¾‹è¨“ç·´ï¼ŒåŒ…æ‹¬éŸ³èª¿è®ŠåŒ–å’Œèªèª¿æ¨¡å¼ç·´ç¿’</li>';
    }
    
    const wordClarity = document.getElementById('word_clarity').value;
    if (wordClarity && parseFloat(wordClarity) < 80) {
        recommendations += '<li>åŠ å¼·æ§‹éŸ³æ¸…æ™°åº¦è¨“ç·´ï¼Œå¾éŸ³ç¯€åˆ°è©å½™å±¤æ¬¡</li>';
    }
    
    // é€šç”¨å»ºè­°
    recommendations += '<li>å»ºè­°é…åˆç¥ç¶“å…§ç§‘è—¥ç‰©æ²»ç™‚ï¼Œåœ¨è—¥æ•ˆæœ€ä½³æ™‚æ®µé€²è¡Œè¨“ç·´</li>';
    recommendations += '<li>å®¶å±¬åƒèˆ‡è¨“ç·´ï¼Œåœ¨æ—¥å¸¸ç”Ÿæ´»ä¸­æä¾›æç¤ºå’Œé¼“å‹µ</li>';
    recommendations += '<li>ä½¿ç”¨æ“´éŸ³è¨­å‚™è¼”åŠ©æ—¥å¸¸æºé€š</li>';
    
    // è¿½è¹¤è¨ˆç•«
    followupPlan += '<li>å»ºè­°æ¯é€±é€²è¡Œ2-3æ¬¡èªè¨€æ²»ç™‚ï¼Œæ¯æ¬¡45-60åˆ†é˜</li>';
    followupPlan += '<li>æ¯æ—¥å±…å®¶ç·´ç¿’30åˆ†é˜ï¼Œä½¿ç”¨è¨“ç·´æ‰‹å†ŠæŒ‡å°</li>';
    followupPlan += '<li>4é€±å¾Œé€²è¡Œç¬¬ä¸€æ¬¡è¿½è¹¤è©•ä¼°ï¼Œæ¯”è¼ƒè¨“ç·´å‰å¾Œå·®ç•°</li>';
    followupPlan += '<li>æ¯3å€‹æœˆé€²è¡Œå®Œæ•´èªéŸ³åˆ†æè©•ä¼°</li>';
    followupPlan += '<li>å®šæœŸéŒ„éŸ³è¨˜éŒ„ï¼Œè¿½è¹¤é•·æœŸé€²å±•</li>';
    
    document.getElementById('treatment_recommendations').innerHTML = recommendations;
    document.getElementById('followup_plan').innerHTML = followupPlan;
}

// å„²å­˜å ±å‘Š
function saveReport() {
    const reportData = {
        timestamp: new Date().toISOString(),
        basicInfo: {
            name: document.getElementById('patientName').value,
            id: document.getElementById('patientID').value,
            gender: document.getElementById('gender').value,
            birthDate: document.getElementById('birthDate').value,
            assessmentDate: document.getElementById('assessmentDate').value,
            hohenYahr: document.getElementById('hohenYahr').value
        },
        acoustic: {
            f0_mean: document.getElementById('f0_mean').value,
            spl_comfortable: document.getElementById('spl_comfortable').value,
            mpt_avg: document.getElementById('mpt_avg').value,
            jitter: document.getElementById('jitter').value,
            shimmer: document.getElementById('shimmer').value,
            hnr: document.getElementById('hnr').value
        },
        perceptual: {
            grbas_g: document.querySelector('input[name="grbas_g"]:checked')?.value,
            grbas_r: document.querySelector('input[name="grbas_r"]:checked')?.value,
            grbas_b: document.querySelector('input[name="grbas_b"]:checked')?.value,
            grbas_a: document.querySelector('input[name="grbas_a"]:checked')?.value,
            grbas_s: document.querySelector('input[name="grbas_s"]:checked')?.value
        },
        functional: {
            word_clarity: document.getElementById('word_clarity').value,
            sentence_clarity: document.getElementById('sentence_clarity').value
        },
        notes: document.getElementById('clinical_notes').value
    };
    
    // å„²å­˜åˆ°localStorage
    const patientID = document.getElementById('patientID').value;
    const assessmentDate = document.getElementById('assessmentDate').value;
    const storageKey = `assessment_${patientID}_${assessmentDate}`;
    
    localStorage.setItem(storageKey, JSON.stringify(reportData));
    
    alert('âœ… å ±å‘Šå·²å„²å­˜ï¼\n\nå„²å­˜ç·¨è™Ÿï¼š' + storageKey);
}

// åŒ¯å‡ºPDF
function exportPDF() {
    alert('ğŸ“¥ PDFåŒ¯å‡ºåŠŸèƒ½\n\nè«‹ä½¿ç”¨ç€è¦½å™¨çš„ã€Œåˆ—å°ã€åŠŸèƒ½ï¼Œé¸æ“‡ã€Œå¦å­˜ç‚ºPDFã€ä¾†åŒ¯å‡ºå ±å‘Šã€‚\n\nå»ºè­°è¨­å®šï¼š\nâ€¢ ç´™å¼µå¤§å°ï¼šA4\nâ€¢ æ–¹å‘ï¼šç›´å‘\nâ€¢ é‚Šç•Œï¼šé è¨­\nâ€¢ èƒŒæ™¯åœ–å½¢ï¼šé–‹å•Ÿ');
    window.print();
}

// é é¢è¼‰å…¥æ™‚çš„åˆå§‹åŒ–
document.addEventListener('DOMContentLoaded', function() {
    // è¨­å®šä»Šå¤©çš„æ—¥æœŸç‚ºé è¨­è©•ä¼°æ—¥æœŸ
    const today = new Date().toISOString().split('T')[0];
    document.getElementById('assessmentDate').value = today;
    
    // è¼‰å…¥å·²å„²å­˜çš„è³‡æ–™ï¼ˆå¦‚æœæœ‰ï¼‰
    const urlParams = new URLSearchParams(window.location.search);
    const loadKey = urlParams.get('load');
    
    if (loadKey) {
        const savedData = localStorage.getItem(loadKey);
        if (savedData) {
            loadSavedReport(JSON.parse(savedData));
        }
    }
});

// è¼‰å…¥å·²å„²å­˜çš„å ±å‘Š
function loadSavedReport(data) {
    if (data.basicInfo) {
        document.getElementById('patientName').value = data.basicInfo.name || '';
        document.getElementById('patientID').value = data.basicInfo.id || '';
        document.getElementById('gender').value = data.basicInfo.gender || '';
        document.getElementById('birthDate').value = data.basicInfo.birthDate || '';
        document.getElementById('assessmentDate').value = data.basicInfo.assessmentDate || '';
        document.getElementById('hohenYahr').value = data.basicInfo.hohenYahr || '';
    }
    
    if (data.acoustic) {
        document.getElementById('f0_mean').value = data.acoustic.f0_mean || '';
        document.getElementById('spl_comfortable').value = data.acoustic.spl_comfortable || '';
        document.getElementById('mpt_avg').value = data.acoustic.mpt_avg || '';
        document.getElementById('jitter').value = data.acoustic.jitter || '';
        document.getElementById('shimmer').value = data.acoustic.shimmer || '';
        document.getElementById('hnr').value = data.acoustic.hnr || '';
    }
    
    if (data.notes) {
        document.getElementById('clinical_notes').value = data.notes;
    }
    
    alert('âœ… å·²è¼‰å…¥å…ˆå‰å„²å­˜çš„è©•ä¼°è³‡æ–™');
}

// è‡ªå‹•å„²å­˜åŠŸèƒ½ï¼ˆæ¯5åˆ†é˜ï¼‰
setInterval(function() {
    const patientID = document.getElementById('patientID').value;
    if (patientID) {
        const autoSaveKey = `autosave_${patientID}`;
        const currentData = {
            timestamp: new Date().toISOString(),
            basicInfo: {
                name: document.getElementById('patientName').value,
                id: patientID,
                gender: document.getElementById('gender').value,
                birthDate: document.getElementById('birthDate').value,
                assessmentDate: document.getElementById('assessmentDate').value
            },
            acoustic: {
                f0_mean: document.getElementById('f0_mean').value,
                spl_comfortable: document.getElementById('spl_comfortable').value,
                mpt_avg: document.getElementById('mpt_avg').value
            }
        };
        localStorage.setItem(autoSaveKey, JSON.stringify(currentData));
        console.log('è‡ªå‹•å„²å­˜å®Œæˆï¼š' + new Date().toLocaleTimeString());
    }
}, 300000); // 5åˆ†é˜

// éµç›¤å¿«æ·éµ
document.addEventListener('keydown', function(e) {
    // Ctrl+S å„²å­˜
    if (e.ctrlKey && e.key === 's') {
        e.preventDefault();
        saveReport();
    }
    
    // Ctrl+P åˆ—å°
    if (e.ctrlKey && e.key === 'p') {
        e.preventDefault();
        window.print();
    }
    
    // Ctrl+G ç”Ÿæˆå ±å‘Š
    if (e.ctrlKey && e.key === 'g') {
        e.preventDefault();
        generateReport();
    }
});

// è¡¨å–®é©—è­‰
function validateForm() {
    const requiredFields = [
        { id: 'patientName', name: 'å§“å' },
        { id: 'patientID', name: 'ç—…æ­·è™Ÿ' },
        { id: 'gender', name: 'æ€§åˆ¥' },
        { id: 'assessmentDate', name: 'è©•ä¼°æ—¥æœŸ' }
    ];
    
    let isValid = true;
    let missingFields = [];
    
    requiredFields.forEach(field => {
        const element = document.getElementById(field.id);
        if (!element.value) {
            isValid = false;
            missingFields.push(field.name);
            element.style.borderColor = '#e53e3e';
        } else {
            element.style.borderColor = '#e2e8f0';
        }
    });
    
    if (!isValid) {
        alert('âš ï¸ è«‹å¡«å¯«å¿…å¡«æ¬„ä½ï¼š\n\n' + missingFields.join('ã€'));
    }
    
    return isValid;
}

// åœ¨ç”Ÿæˆå ±å‘Šå‰é©—è­‰
const originalGenerateReport = generateReport;
generateReport = function() {
    if (validateForm()) {
        originalGenerateReport();
    }
};

// è³‡æ–™æ¯”è¼ƒåŠŸèƒ½
function compareWithBaseline() {
    const currentAssessment = document.getElementById('assessmentNumber').value;
    
    if (currentAssessment === 'baseline') {
        alert('â„¹ï¸ é€™æ˜¯åŸºç·šè©•ä¼°ï¼Œæ²’æœ‰å…ˆå‰è³‡æ–™å¯æ¯”è¼ƒ');
        return;
    }
    
    const patientID = document.getElementById('patientID').value;
    if (!patientID) {
        alert('âš ï¸ è«‹å…ˆè¼¸å…¥ç—…æ­·è™Ÿ');
        return;
    }
    
    // å°‹æ‰¾åŸºç·šè³‡æ–™
    const baselineKey = `assessment_${patientID}_baseline`;
    const baselineData = localStorage.getItem(baselineKey);
    
    if (!baselineData) {
        alert('âš ï¸ æ‰¾ä¸åˆ°åŸºç·šè©•ä¼°è³‡æ–™');
        return;
    }
    
    // é¡¯ç¤ºæ¯”è¼ƒçµæœ
    const baseline = JSON.parse(baselineData);
    let comparison = 'ğŸ“Š èˆ‡åŸºç·šè©•ä¼°æ¯”è¼ƒï¼š\n\n';
    
    const currentF0 = parseFloat(document.getElementById('f0_mean').value);
    const baselineF0 = parseFloat(baseline.acoustic.f0_mean);
    if (currentF0 && baselineF0) {
        const diff = ((currentF0 - baselineF0) / baselineF0 * 100).toFixed(1);
        comparison += `åŸºæœ¬é »ç‡ï¼š${diff > 0 ? '+' : ''}${diff}%\n`;
    }
    
    const currentSPL = parseFloat(document.getElementById('spl_comfortable').value);
    const baselineSPL = parseFloat(baseline.acoustic.spl_comfortable);
    if (currentSPL && baselineSPL) {
        const diff = (currentSPL - baselineSPL).toFixed(1);
        comparison += `è²éŸ³éŸ¿åº¦ï¼š${diff > 0 ? '+' : ''}${diff} dB\n`;
    }
    
    const currentMPT = parseFloat(document.getElementById('mpt_avg').value);
    const baselineMPT = parseFloat(baseline.acoustic.mpt_avg);
    if (currentMPT && baselineMPT) {
        const diff = (currentMPT - baselineMPT).toFixed(1);
        comparison += `æœ€å¤§ç™¼è²æ™‚é–“ï¼š${diff > 0 ? '+' : ''}${diff} ç§’\n`;
    }
    
    alert(comparison);
}

// åŒ¯å‡ºExcelæ ¼å¼è³‡æ–™
function exportToExcel() {
    const data = {
        åŸºæœ¬è³‡æ–™: {
            å§“å: document.getElementById('patientName').value,
            ç—…æ­·è™Ÿ: document.getElementById('patientID').value,
            æ€§åˆ¥: document.getElementById('gender').value,
            è©•ä¼°æ—¥æœŸ: document.getElementById('assessmentDate').value
        },
        è²å­¸åƒæ•¸: {
            åŸºæœ¬é »ç‡: document.getElementById('f0_mean').value + ' Hz',
            è²éŸ³éŸ¿åº¦: document.getElementById('spl_comfortable').value + ' dB',
            æœ€å¤§ç™¼è²æ™‚é–“: document.getElementById('mpt_avg').value + ' ç§’',
            Jitter: document.getElementById('jitter').value + '%',
            Shimmer: document.getElementById('shimmer').value + '%',
            HNR: document.getElementById('hnr').value + ' dB'
        }
    };
    
    let csv = '\uFEFF'; // UTF-8 BOM
    csv += 'å¸•é‡‘æ£®ç—…èªéŸ³åˆ†æè©•ä¼°è³‡æ–™\n\n';
    
    for (let section in data) {
        csv += section + '\n';
        for (let key in data[section]) {
            csv += key + ',' + data[section][key] + '\n';
        }
        csv += '\n';
    }
    
    const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
    const link = document.createElement('a');
    const url = URL.createObjectURL(blob);
    
    link.setAttribute('href', url);
    link.setAttribute('download', `èªéŸ³è©•ä¼°_${document.getElementById('patientID').value}_${new Date().toISOString().split('T')[0]}.csv`);
    link.style.visibility = 'hidden';
    
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
}

// åˆ—å°é è¦½å„ªåŒ–
window.onbeforeprint = function() {
    document.querySelectorAll('.nav-tabs, .button-group').forEach(el => {
        el.style.display = 'none';
    });
};

window.onafterprint = function() {
    document.querySelectorAll('.nav-tabs, .button-group').forEach(el => {
        el.style.display = '';
    });
};

console.log('ğŸ¥ å¸•é‡‘æ£®ç—…èªéŸ³åˆ†æè©•ä¼°ç³»çµ±å·²è¼‰å…¥');
console.log('ğŸ“‹ å¿«æ·éµï¼šCtrl+S (å„²å­˜) | Ctrl+P (åˆ—å°) | Ctrl+G (ç”Ÿæˆå ±å‘Š)');
</script>
</body>
</html>


