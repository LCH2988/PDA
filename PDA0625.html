<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å°ç£å¸•é‡‘æ£®ç—…å‹æ¬Šç›Šä¿ƒé€²æœƒ - æœƒè¨ˆç®¡ç†ç³»çµ± v5.0</title>
  
  <style>
      /* åŸºç¤æ¨£å¼é‡ç½® */
      * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
      }

      body {
          font-family: 'Microsoft JhengHei', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
          line-height: 1.6;
          color: #333;
          background-color: #f8f9fa;
      }

      /* é ‚éƒ¨å°èˆª */
      .navbar {
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          color: white;
          padding: 1rem 0;
          box-shadow: 0 2px 10px rgba(0,0,0,0.1);
          position: sticky;
          top: 0;
          z-index: 1000;
      }

      .navbar .container {
          max-width: 1200px;
          margin: 0 auto;
          padding: 0 20px;
          display: flex;
          justify-content: space-between;
          align-items: center;
      }

      .navbar h1 {
          font-size: 1.5rem;
          font-weight: 600;
      }

      .navbar .nav-info {
          display: flex;
          align-items: center;
          gap: 20px;
          font-size: 0.9rem;
      }

      /* ä¸»è¦å®¹å™¨ */
      .container {
          max-width: 1200px;
          margin: 0 auto;
          padding: 20px;
      }

      /* è¼‰å…¥å‹•ç•« */
      .loading {
          display: none;
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: rgba(255, 255, 255, 0.9);
          z-index: 9999;
          justify-content: center;
          align-items: center;
      }

      .loading.show {
          display: flex;
      }

      .spinner {
          width: 50px;
          height: 50px;
          border: 4px solid #f3f3f3;
          border-top: 4px solid #667eea;
          border-radius: 50%;
          animation: spin 1s linear infinite;
      }

      @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
      }

      /* æ¨™ç±¤é å°èˆª */
      .tab-nav {
          display: flex;
          background: white;
          border-radius: 10px;
          box-shadow: 0 2px 10px rgba(0,0,0,0.1);
          margin-bottom: 20px;
          overflow: hidden;
      }

      .tab-nav button {
          flex: 1;
          padding: 15px 20px;
          border: none;
          background: white;
          color: #666;
          cursor: pointer;
          transition: all 0.3s ease;
          font-size: 1rem;
          font-weight: 500;
      }

      .tab-nav button:hover {
          background: #f8f9fa;
          color: #333;
      }

      .tab-nav button.active {
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          color: white;
      }

      /* æ¨™ç±¤é å…§å®¹ */
      .tab-content {
          display: none;
          background: white;
          border-radius: 10px;
          box-shadow: 0 2px 10px rgba(0,0,0,0.1);
          padding: 30px;
          margin-bottom: 20px;
      }

      .tab-content.active {
          display: block;
          animation: fadeIn 0.3s ease-in;
      }

      @keyframes fadeIn {
          from { opacity: 0; transform: translateY(10px); }
          to { opacity: 1; transform: translateY(0); }
      }

      /* è¡¨å–®æ¨£å¼ */
      .form-group {
          margin-bottom: 20px;
      }

      .form-row {
          display: flex;
          gap: 20px;
          margin-bottom: 20px;
      }

      .form-row .form-group {
          flex: 1;
          margin-bottom: 0;
      }

      label {
          display: block;
          margin-bottom: 8px;
          font-weight: 500;
          color: #555;
      }

      input, select, textarea {
          width: 100%;
          padding: 12px 15px;
          border: 2px solid #e1e5e9;
          border-radius: 8px;
          font-size: 1rem;
          transition: all 0.3s ease;
          background: white;
      }

      input:focus, select:focus, textarea:focus {
          outline: none;
          border-color: #667eea;
          box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
      }

      textarea {
          resize: vertical;
          min-height: 100px;
      }

      /* æŒ‰éˆ•æ¨£å¼ */
      .btn {
          padding: 12px 24px;
          border: none;
          border-radius: 8px;
          font-size: 1rem;
          font-weight: 500;
          cursor: pointer;
          transition: all 0.3s ease;
          text-decoration: none;
          display: inline-block;
          text-align: center;
          line-height: 1.4;
      }

      .btn-primary {
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          color: white;
      }

      .btn-primary:hover {
          transform: translateY(-2px);
          box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
      }

      .btn-secondary {
          background: #6c757d;
          color: white;
      }

      .btn-secondary:hover {
          background: #5a6268;
          transform: translateY(-2px);
      }

      .btn-success {
          background: #28a745;
          color: white;
      }

      .btn-success:hover {
          background: #218838;
          transform: translateY(-2px);
      }

      .btn-danger {
          background: #dc3545;
          color: white;
      }

      .btn-danger:hover {
          background: #c82333;
          transform: translateY(-2px);
      }

      .btn-warning {
          background: #ffc107;
          color: #212529;
      }

      .btn-warning:hover {
          background: #e0a800;
          transform: translateY(-2px);
      }

      .btn-info {
          background: #17a2b8;
          color: white;
      }

      .btn-info:hover {
          background: #138496;
          transform: translateY(-2px);
      }

      .btn-group {
          display: flex;
          gap: 10px;
          margin-top: 20px;
      }

      .btn-sm {
          padding: 8px 16px;
          font-size: 0.875rem;
      }

      .btn:disabled {
          opacity: 0.6;
          cursor: not-allowed;
          transform: none !important;
      }

      /* è¡¨æ ¼æ¨£å¼ */
      /* æ¥çºŒè¡¨æ ¼æ¨£å¼ */
      .table-container {
          overflow-x: auto;
          margin: 20px 0;
          border-radius: 10px;
          box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      }

      table {
          width: 100%;
          border-collapse: collapse;
          background: white;
      }

      th, td {
          padding: 15px;
          text-align: left;
          border-bottom: 1px solid #e1e5e9;
      }

      th {
          background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
          font-weight: 600;
          color: #495057;
          position: sticky;
          top: 0;
          z-index: 10;
      }

      tr:hover {
          background: #f8f9fa;
      }

      tr:last-child td {
          border-bottom: none;
      }

      .table-actions {
          display: flex;
          gap: 5px;
      }

      /* å¡ç‰‡æ¨£å¼ */
      .card {
          background: white;
          border-radius: 10px;
          box-shadow: 0 2px 10px rgba(0,0,0,0.1);
          padding: 25px;
          margin-bottom: 20px;
          transition: all 0.3s ease;
      }

      .card:hover {
          transform: translateY(-2px);
          box-shadow: 0 5px 20px rgba(0,0,0,0.15);
      }

      .card-header {
          border-bottom: 2px solid #e1e5e9;
          padding-bottom: 15px;
          margin-bottom: 20px;
      }

      .card-title {
          font-size: 1.25rem;
          font-weight: 600;
          color: #333;
          margin: 0;
      }

      .card-subtitle {
          font-size: 0.9rem;
          color: #666;
          margin: 5px 0 0 0;
      }

      /* çµ±è¨ˆå¡ç‰‡ */
      .stats-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
          gap: 20px;
          margin-bottom: 30px;
      }

      .stat-card {
          background: white;
          border-radius: 15px;
          padding: 25px;
          box-shadow: 0 5px 15px rgba(0,0,0,0.1);
          text-align: center;
          transition: all 0.3s ease;
          position: relative;
          overflow: hidden;
      }

      .stat-card::before {
          content: '';
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          height: 4px;
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      }

      .stat-card:hover {
          transform: translateY(-5px);
          box-shadow: 0 10px 25px rgba(0,0,0,0.15);
      }

      .stat-number {
          font-size: 2.5rem;
          font-weight: 700;
          color: #333;
          margin-bottom: 10px;
      }

      .stat-label {
          font-size: 1rem;
          color: #666;
          font-weight: 500;
      }

      .stat-change {
          font-size: 0.875rem;
          margin-top: 8px;
      }

      .stat-change.positive {
          color: #28a745;
      }

      .stat-change.negative {
          color: #dc3545;
      }

      /* è­¦å‘Šå’Œé€šçŸ¥ */
      .alert {
          padding: 15px 20px;
          border-radius: 8px;
          margin-bottom: 20px;
          border-left: 4px solid;
          display: flex;
          align-items: center;
          gap: 10px;
      }

      .alert-success {
          background: #d4edda;
          color: #155724;
          border-color: #28a745;
      }

      .alert-error {
          background: #f8d7da;
          color: #721c24;
          border-color: #dc3545;
      }

      .alert-warning {
          background: #fff3cd;
          color: #856404;
          border-color: #ffc107;
      }

      .alert-info {
          background: #d1ecf1;
          color: #0c5460;
          border-color: #17a2b8;
      }

      .alert .close {
          margin-left: auto;
          background: none;
          border: none;
          font-size: 1.5rem;
          cursor: pointer;
          opacity: 0.7;
      }

      .alert .close:hover {
          opacity: 1;
      }

      /* æœå°‹å’Œç¯©é¸ */
      .search-filters {
          background: white;
          border-radius: 10px;
          padding: 20px;
          margin-bottom: 20px;
          box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      }

      .search-row {
          display: flex;
          gap: 15px;
          align-items: end;
          flex-wrap: wrap;
      }

      .search-group {
          flex: 1;
          min-width: 200px;
      }

      .search-group label {
          margin-bottom: 5px;
          font-size: 0.9rem;
      }

      /* åˆ†é  */
      .pagination {
          display: flex;
          justify-content: center;
          align-items: center;
          gap: 10px;
          margin: 20px 0;
      }

      .pagination button {
          padding: 8px 12px;
          border: 1px solid #dee2e6;
          background: white;
          color: #495057;
          border-radius: 5px;
          cursor: pointer;
          transition: all 0.3s ease;
      }

      .pagination button:hover {
          background: #e9ecef;
      }

      .pagination button.active {
          background: #667eea;
          color: white;
          border-color: #667eea;
      }

      .pagination button:disabled {
          opacity: 0.5;
          cursor: not-allowed;
      }

      /* æ¨¡æ…‹æ¡† */
      .modal {
          display: none;
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: rgba(0,0,0,0.5);
          z-index: 10000;
          justify-content: center;
          align-items: center;
      }

      .modal.show {
          display: flex;
      }

      .modal-content {
          background: white;
          border-radius: 15px;
          padding: 30px;
          max-width: 600px;
          width: 90%;
          max-height: 80vh;
          overflow-y: auto;
          position: relative;
          box-shadow: 0 10px 30px rgba(0,0,0,0.3);
      }

      .modal-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 20px;
          padding-bottom: 15px;
          border-bottom: 2px solid #e1e5e9;
      }

      .modal-title {
          font-size: 1.5rem;
          font-weight: 600;
          color: #333;
      }

      .modal-close {
          background: none;
          border: none;
          font-size: 2rem;
          cursor: pointer;
          color: #999;
          line-height: 1;
      }

      .modal-close:hover {
          color: #333;
      }

      /* éŸ¿æ‡‰å¼è¨­è¨ˆ */
      @media (max-width: 768px) {
          .container {
              padding: 10px;
          }

          .tab-nav {
              flex-direction: column;
          }

          .form-row {
              flex-direction: column;
              gap: 0;
          }

          .search-row {
              flex-direction: column;
              align-items: stretch;
          }

          .search-group {
              min-width: auto;
          }

          .btn-group {
              flex-direction: column;
          }

          .stats-grid {
              grid-template-columns: 1fr;
          }

          .navbar .container {
              flex-direction: column;
              gap: 10px;
              text-align: center;
          }

          .navbar .nav-info {
              justify-content: center;
          }

          .table-container {
              font-size: 0.875rem;
          }

          th, td {
              padding: 10px 8px;
          }
      }

      /* æ·±è‰²ä¸»é¡Œæ”¯æ´ */
      @media (prefers-color-scheme: dark) {
          body {
              background-color: #1a1a1a;
              color: #e0e0e0;
          }

          .card, .tab-content, .search-filters {
              background: #2d2d2d;
              color: #e0e0e0;
          }

          input, select, textarea {
              background: #3d3d3d;
              color: #e0e0e0;
              border-color: #555;
          }

          table {
              background: #2d2d2d;
          }

          th {
              background: #3d3d3d;
              color: #e0e0e0;
          }

          tr:hover {
              background: #3d3d3d;
          }
      }

      /* åˆ—å°æ¨£å¼ */
      @media print {
          .navbar, .tab-nav, .btn, .search-filters {
              display: none !important;
          }

          .container {
              max-width: none;
              padding: 0;
          }

          .card, .tab-content {
              box-shadow: none;
              border: 1px solid #ddd;
          }
      }

      /* å‹•ç•«æ•ˆæœ */
      .fade-in {
          animation: fadeIn 0.5s ease-in;
      }

      .slide-up {
          animation: slideUp 0.3s ease-out;
      }

      @keyframes slideUp {
          from {
              opacity: 0;
              transform: translateY(20px);
          }
          to {
              opacity: 1;
              transform: translateY(0);
          }
      }

      /* å·¥å…·æç¤º */
      .tooltip {
          position: relative;
          display: inline-block;
      }

      .tooltip .tooltiptext {
          visibility: hidden;
          width: 200px;
          background-color: #333;
          color: #fff;
          text-align: center;
          border-radius: 6px;
          padding: 8px;
          position: absolute;
          z-index: 1;
          bottom: 125%;
          left: 50%;
          margin-left: -100px;
          opacity: 0;
          transition: opacity 0.3s;
          font-size: 0.875rem;
      }

      .tooltip:hover .tooltiptext {
          visibility: visible;
          opacity: 1;
      }

      /* é€²åº¦æ¢ */
      .progress {
          width: 100%;
          height: 8px;
          background: #e1e5e9;
          border-radius: 4px;
          overflow: hidden;
          margin: 10px 0;
      }

      .progress-bar {
          height: 100%;
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          transition: width 0.3s ease;
      }

      /* å¾½ç«  */
      .badge {
          display: inline-block;
          padding: 4px 8px;
          font-size: 0.75rem;
          font-weight: 600;
          border-radius: 12px;
          text-align: center;
          white-space: nowrap;
      }

      .badge-primary {
          background: #667eea;
          color: white;
      }

      .badge-success {
          background: #28a745;
          color: white;
      }

      .badge-danger {
          background: #dc3545;
          color: white;
      }

      .badge-warning {
          background: #ffc107;
          color: #212529;
      }

      .badge-info {
          background: #17a2b8;
          color: white;
      }

      .badge-secondary {
          background: #6c757d;
          color: white;
      }

      /* ç©ºç‹€æ…‹ */
      .empty-state {
          text-align: center;
          padding: 60px 20px;
          color: #999;
      }

      .empty-state h3 {
          font-size: 1.5rem;
          margin-bottom: 10px;
          color: #666;
      }

      .empty-state p {
          font-size: 1rem;
          margin-bottom: 20px;
      }

      /* è¼‰å…¥éª¨æ¶å± */
      .skeleton {
          background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
          background-size: 200% 100%;
          animation: loading 1.5s infinite;
      }

      @keyframes loading {
          0% {
              background-position: 200% 0;
          }
          100% {
              background-position: -200% 0;
          }
      }

      .skeleton-text {
          height: 1rem;
          border-radius: 4px;
          margin-bottom: 8px;
      }

      .skeleton-text:last-child {
          width: 60%;
      }
  </style>
</head>

<body>
  <!-- è¼‰å…¥å‹•ç•« -->
  <div id="loading" class="loading">
      <div class="spinner"></div>
  </div>

  <!-- é ‚éƒ¨å°èˆª -->
  <nav class="navbar">
      <div class="container">
          <h1>å°ç£å¸•é‡‘æ£®ç—…å‹æ¬Šç›Šä¿ƒé€²æœƒ - æœƒè¨ˆç®¡ç†ç³»çµ±</h1>
          <div class="nav-info">
              <span id="currentTime"></span>
              <span>v5.0</span>
          </div>
      </div>
  </nav>

  <!-- ä¸»è¦å…§å®¹ -->
  <div class="container">
      <!-- è­¦å‘Šè¨Šæ¯å€åŸŸ -->
      <div id="alertContainer"></div>

      <!-- æ¨™ç±¤é å°èˆª -->
      <div class="tab-nav">
          <button class="tab-btn active" data-tab="dashboard">ğŸ“Š å„€è¡¨æ¿</button>
          <button class="tab-btn" data-tab="transactions">ğŸ’° äº¤æ˜“è¨˜éŒ„</button>
          <button class="tab-btn" data-tab="receipts">ğŸ§¾ æ”¶æ“šç®¡ç†</button>
          <button class="tab-btn" data-tab="vouchers">ğŸ“‹ æ”¯å‡ºæ†‘è­‰</button>
          <button class="tab-btn" data-tab="members">ğŸ‘¥ æœƒå“¡ç®¡ç†</button>
          <button class="tab-btn" data-tab="reports">ğŸ“ˆ å ±è¡¨åˆ†æ</button>
          <button class="tab-btn" data-tab="settings">âš™ï¸ ç³»çµ±è¨­å®š</button>
      </div>

      <!-- å„€è¡¨æ¿ -->
      <div id="dashboard" class="tab-content active">
          <div class="card-header">
              <h2 class="card-title">è²¡å‹™æ¦‚è¦½</h2>
              <p class="card-subtitle">æœ¬æœˆè²¡å‹™ç‹€æ³çµ±è¨ˆ</p>
          </div>

          <div class="stats-grid">
              <div class="stat-card">
                  <div class="stat-number" id="totalIncome">$0</div>
                  <div class="stat-label">æœ¬æœˆæ”¶å…¥</div>
                  <div class="stat-change positive" id="incomeChange">+0%</div>
              </div>
              <div class="stat-card">
                  <div class="stat-number" id="totalExpense">$0</div>
                  <div class="stat-label">æœ¬æœˆæ”¯å‡º</div>
                  <div class="stat-change negative" id="expenseChange">+0%</div>
              </div>
              <div class="stat-card">
                  <div class="stat-number" id="receiptCount">0</div>
                  <div class="stat-label">æœ¬æœˆæ”¶æ“š</div>
                  <div class="stat-change positive" id="receiptChange">+0</div>
              </div>
              <div class="stat-card">
                  <div class="stat-number" id="memberCount">0</div>
                  <div class="stat-label">æœƒå“¡ç¸½æ•¸</div>
                  <div class="stat-change positive" id="memberChange">+0</div>
              </div>
          </div>

          <div class="card">
              <div class="card-header">
                  <h3 class="card-title">æœ€è¿‘æ´»å‹•</h3>
              </div>
              <div id="recentActivities">
                  <div class="empty-state">
                      <h3>è¼‰å…¥ä¸­...</h3>
                      <p>æ­£åœ¨å–å¾—æœ€æ–°æ´»å‹•è¨˜éŒ„</p>
                  </div>
              </div>
          </div>
      </div>

      <!-- äº¤æ˜“è¨˜éŒ„ -->
      <div id="transactions" class="tab-content">
          <div class="card-header">
              <h2 class="card-title">äº¤æ˜“è¨˜éŒ„ç®¡ç†</h2>
              <p class="card-subtitle">è¨˜éŒ„å’Œç®¡ç†æ‰€æœ‰æ”¶æ”¯äº¤æ˜“</p>
          </div>

          <!-- æ–°å¢äº¤æ˜“è¡¨å–® -->
          <div class="card">
              <div class="card-header">
                  <h3 class="card-title">æ–°å¢äº¤æ˜“è¨˜éŒ„</h3>
              </div>
              <form id="transactionForm">
                  <div class="form-row">
                      <div class="form-group">
                          <label for="transactionDate">äº¤æ˜“æ—¥æœŸ *</label>
                          <input type="date" id="transactionDate" name="date" required>
                      </div>
                      <div class="form-group">
                          <label for="transactionType">æ”¶æ”¯é¡å‹ *</label>
                          <select id="transactionType" name="type" required>
                              <option value="">è«‹é¸æ“‡</option>
                              <option value="æ”¶å…¥">æ”¶å…¥</option>
                              <option value="æ”¯å‡º">æ”¯å‡º</option>
                          </select>
                      </div>
                  </div>

                  <div class="form-row">
                      <div class="form-group">
                          <label for="transactionCategory">é¡åˆ¥ *</label>
                          <select id="transactionCategory" name="category" required>
                              <option value="">è«‹é¸æ“‡</option>
                              <option value="ææ¬¾">ææ¬¾</option>
                              <option value="æœƒè²»">æœƒè²»</option>
                              <option value="æ´»å‹•æ”¶å…¥">æ´»å‹•æ”¶å…¥</option>
                              <option value="è£œåŠ©æ¬¾">è£œåŠ©æ¬¾</option>
                              <option value="è¾¦å…¬è²»ç”¨">è¾¦å…¬è²»ç”¨</option>
                              <option value="æ´»å‹•æ”¯å‡º">æ´»å‹•æ”¯å‡º</option>
                              <option value="äº¤é€šè²»">äº¤é€šè²»</option>
                              <option value="å…¶ä»–">å…¶ä»–</option>
                          </select>
                      </div>
                      <div class="form-group">
                          <label for="transactionAmount">é‡‘é¡ *</label>
                          <input type="number" id="transactionAmount" name="amount" min="0" step="1" required>
                      </div>
                  </div>

                  <div class="form-row">
                      <div class="form-group">
                          <label for="transactionName">äº¤æ˜“å°è±¡ *</label>
                          <input type="text" id="transactionName" name="name" required>
                      </div>
                      <div class="form-group">
                          <label for="transactionAccount">å¸³æˆ¶</label>
                          <select id="transactionAccount" name="account">
                              <option value="">è«‹é¸æ“‡</option>
                              <option value="ç¾é‡‘">ç¾é‡‘</option>
                              <option value="éŠ€è¡Œå¸³æˆ¶">éŠ€è¡Œå¸³æˆ¶</option>
                              <option value="éƒµå±€å¸³æˆ¶">éƒµå±€å¸³æˆ¶</option>
                          </select>
                      </div>
                  </div>

                  <div class="form-group">
                      <label for="transactionDescription">èªªæ˜</label>
                      <textarea id="transactionDescription" name="description" placeholder="è«‹è¼¸å…¥äº¤æ˜“èªªæ˜..."></textarea>
                  </div>

                  <div class="form-row">
                      <div class="form-group">
                          <label>
                              <input type="checkbox" id="generateReceipt" name="generateReceipt" value="true">
                              è‡ªå‹•ç”¢ç”Ÿæ”¶æ“šï¼ˆåƒ…é™æ”¶å…¥ï¼‰
                          </label>
                      </div>
                      <div class="form-group">
                          <label>
                              <input type="checkbox" id="generateVoucher" name="generateVoucher" value="true">
                              è‡ªå‹•ç”¢ç”Ÿæ†‘è­‰ï¼ˆåƒ…é™æ”¯å‡ºï¼‰
                          </label>
                      </div>
                  </div>

                  <div class="btn-group">
                      <button type="submit" class="btn btn-primary">å„²å­˜äº¤æ˜“è¨˜éŒ„</button>
                      <button type="reset" class="btn btn-secondary">æ¸…é™¤è¡¨å–®</button>
                  </div>
              </form>
          </div>

          <!-- äº¤æ˜“è¨˜éŒ„æœå°‹ -->
          <div class="search-filters">
              <div class="search-row">
                  <div class="search-group">
                      <label for="transactionSearch">æœå°‹</label>
                      <input type="text" id="transactionSearch" placeholder="æœå°‹äº¤æ˜“å°è±¡ã€èªªæ˜...">
                  </div>
                  <div class="search-group">
                      <label for="transactionTypeFilter">é¡å‹</label>
                      <select id="transactionTypeFilter">
                          <option value="">å…¨éƒ¨</option>
                          <option value="æ”¶å…¥">æ”¶å…¥</option>
                          <option value="æ”¯å‡º">æ”¯å‡º</option>
                      </select>
                  </div>
                  <div class="search-group">
                      <label for="transactionDateFrom">é–‹å§‹æ—¥æœŸ</label>
                      <input type="date" id="transactionDateFrom">
                  </div>
                  <div class="search-group">
                      <label for="transactionDateTo">çµæŸæ—¥æœŸ</label>
                      <input type="date" id="transactionDateTo">
                  </div>
                  <div class="search-group">
                      <label>&nbsp;</label>
                      <button type="button" class="btn btn-primary" onclick="searchTransactions()">æœå°‹</button>
                  </div>
              </div>
          </div>

          <!-- äº¤æ˜“è¨˜éŒ„åˆ—è¡¨ -->
          <div class="card">
              <div class="card-header">
                  <h3 class="card-title">äº¤æ˜“è¨˜éŒ„åˆ—è¡¨</h3>
              </div>
              <div class="table-container">
                  <table id="transactionsTable">
                      <thead>
                          <tr>
                              <th>æ—¥æœŸ</th>
                              <th>é¡å‹</th>
                              <th>é¡åˆ¥</th>
                              <th>äº¤æ˜“å°è±¡</th>
                              <th>é‡‘é¡</th>
                              <th>å¸³æˆ¶</th>
                              <th>ç‹€æ…‹</th>
                              <th>æ“ä½œ</th>
                          </tr>
                      </thead>
                      <tbody>
                          <tr>
                              <td colspan="8" class="empty-state">
                                  <h3>å°šç„¡äº¤æ˜“è¨˜éŒ„</h3>
                                  <p>è«‹æ–°å¢ç¬¬ä¸€ç­†äº¤æ˜“è¨˜éŒ„</p>
                              </td>
                          </tr>
                      </tbody>
                  </table>
              </div>
              <div id="transactionsPagination" class="pagination"></div>
          </div>
      </div>

      <!-- æ”¶æ“šç®¡ç† -->
      <div id="receipts" class="tab-content">
          <div class="card-header">
              <h2 class="card-title">æ”¶æ“šç®¡ç†</h2>
              <p class="card-subtitle">é–‹ç«‹å’Œç®¡ç†ææ¬¾æ”¶æ“š</p>
          </div>

          <!-- é–‹ç«‹æ”¶æ“šè¡¨å–® -->
          <div class="card">
              <div class="card-header">
                  <h3 class="card-title">é–‹ç«‹æ–°æ”¶æ“š</h3>
              </div>
              <form id="receiptForm">
                  <div class="form-row">
                      <div class="form-group">
                          <label for="receiptDate">æ”¶æ“šæ—¥æœŸ *</label>
                          <input type="date" id="receiptDate" name="date" required>
                      </div>
                      <div class="form-group">
                          <label for="receiptPayer">ä»˜æ¬¾äºº *</label>
                          <input type="text" id="receiptPayer" name="payer" required>
                      </div>
                  </div>

                  <div class="form-row">
                      <div class="form-group">
                          <label for="receiptIdentity">èº«ä»½é¡åˆ¥</label>
                          <select id="receiptIdentity" name="identity">
                              <option value="ä¸€èˆ¬æ°‘çœ¾">ä¸€èˆ¬æ°‘çœ¾</option>
                              <option value="æœƒå“¡">æœƒå“¡</option>
                              <option value="ä¼æ¥­">ä¼æ¥­</option>
                              <option value="åœ˜é«”">åœ˜é«”</option>
                          </select>
                      </div>
                      <div class="form-group">
                          <label for="receiptPhone">è¯çµ¡é›»è©±</label>
                          <input type="tel" id="receiptPhone" name="phone">
                      </div>
                  </div>

                  <div class="form-group">
                      <label for="receiptEmail">é›»å­éƒµä»¶</label>
                      <input type="email" id="receiptEmail" name="email" placeholder="ç”¨æ–¼è‡ªå‹•å¯„é€æ”¶æ“š">
                  </div>

                  <div class="form-row">
                      <div class="form-group">
                          <label for="receiptCategory">æ”¶æ“šé¡åˆ¥ *</label>
                          <select id="receiptCategory" name="category" required>
                              <option value="">è«‹é¸æ“‡</option>
                              <option value="ä¸€èˆ¬ææ¬¾">ä¸€èˆ¬ææ¬¾</option>
                              <option value="æŒ‡å®šç”¨é€”ææ¬¾">æŒ‡å®šç”¨é€”ææ¬¾</option>
                              <option value="æœƒè²»">æœƒè²»</option>
                              <option value="æ´»å‹•è²»ç”¨">æ´»å‹•è²»ç”¨</option>
                          </select>
                      </div>
                      <div class="form-group">
                          <label for="receiptAmount">é‡‘é¡ *</label>
                          <input type="number" id="receiptAmount" name="amount" min="0" step="1" required>
                      </div>
                  </div>

                  <div class="form-group">
                      <label for="receiptPurpose">ç”¨é€”èªªæ˜</label>
                      <textarea id="receiptPurpose" name="purpose" placeholder="è«‹è¼¸å…¥ææ¬¾ç”¨é€”..."></textarea>
                  </div>

                  <div class="form-group">
                      <label>
                          <input type="checkbox" id="autoSendReceipt" name="autoSend" value="true">
                          è‡ªå‹•å¯„é€æ”¶æ“šè‡³é›»å­éƒµä»¶
                      </label>
                  </div>

                  <div class="btn-group">
                      <button type="submit" class="btn btn-primary">é–‹ç«‹æ”¶æ“š</button>
                      <button type="reset" class="btn btn-secondary">æ¸…é™¤è¡¨å–®</button>
                  </div>
              </form>
          </div>

          <!-- æ”¶æ“šè¨˜éŒ„æœå°‹ -->
          <div class="search-filters">
              <div class="search-row">
                  <div class="search-group">
                      <label for="receiptSearch">æœå°‹</label>
                      <input type="text" id="receiptSearch" placeholder="æœå°‹æ”¶æ“šç·¨è™Ÿã€ä»˜æ¬¾äºº...">
                  </div>
                  <div class="search-group">
                      <label for="receiptStatusFilter">ç‹€æ…‹</label>
                      <select id="receiptStatusFilter">
                          <option value="">å…¨éƒ¨</option>
                          <option value="å·²é–‹ç«‹">å·²é–‹ç«‹</option>
                          <option value="å·²å¯„é€">å·²å¯„é€</option>
                          <option value="å·²ä½œå»¢">å·²ä½œå»¢</option>
                      </select>
                  </div>
                  <div class="search-group">
                      <label>&nbsp;</label>
                      <button type="button" class="btn btn-primary" onclick="searchReceipts()">æœå°‹</button>
                  </div>
              </div>
          </div>

          <!-- æ”¶æ“šè¨˜éŒ„åˆ—è¡¨ -->
          <div class="card">
              <div class="card-header">
                  <h3 class="card-title">æ”¶æ“šè¨˜éŒ„åˆ—è¡¨</h3>
              </div>
              <!-- æ¥çºŒæ”¶æ“šè¨˜éŒ„åˆ—è¡¨ -->
              <div class="table-container">
                  <table id="receiptsTable">
                      <thead>
                          <tr>
                              <th>æ”¶æ“šç·¨è™Ÿ</th>
                              <th>æ—¥æœŸ</th>
                              <th>ä»˜æ¬¾äºº</th>
                              <th>é¡åˆ¥</th>
                              <th>é‡‘é¡</th>
                              <th>ç‹€æ…‹</th>
                              <th>æ“ä½œ</th>
                          </tr>
                      </thead>
                      <tbody>
                          <tr>
                              <td colspan="7" class="empty-state">
                                  <h3>å°šç„¡æ”¶æ“šè¨˜éŒ„</h3>
                                  <p>è«‹é–‹ç«‹ç¬¬ä¸€å¼µæ”¶æ“š</p>
                              </td>
                          </tr>
                      </tbody>
                  </table>
              </div>
              <div id="receiptsPagination" class="pagination"></div>
          </div>
      </div>

      <!-- æ”¯å‡ºæ†‘è­‰ -->
      <div id="vouchers" class="tab-content">
          <div class="card-header">
              <h2 class="card-title">æ”¯å‡ºæ†‘è­‰ç®¡ç†</h2>
              <p class="card-subtitle">ç”³è«‹å’Œç®¡ç†æ”¯å‡ºæ†‘è­‰</p>
          </div>

          <!-- ç”³è«‹æ†‘è­‰è¡¨å–® -->
          <div class="card">
              <div class="card-header">
                  <h3 class="card-title">ç”³è«‹æ”¯å‡ºæ†‘è­‰</h3>
              </div>
              <form id="voucherForm">
                  <div class="form-row">
                      <div class="form-group">
                          <label for="voucherDate">ç”³è«‹æ—¥æœŸ *</label>
                          <input type="date" id="voucherDate" name="date" required>
                      </div>
                      <div class="form-group">
                          <label for="voucherApplicant">ç”³è«‹äºº *</label>
                          <input type="text" id="voucherApplicant" name="applicant" required>
                      </div>
                  </div>

                  <div class="form-row">
                      <div class="form-group">
                          <label for="voucherCategory">æ”¯å‡ºé¡åˆ¥ *</label>
                          <select id="voucherCategory" name="category" required>
                              <option value="">è«‹é¸æ“‡</option>
                              <option value="è¾¦å…¬è²»ç”¨">è¾¦å…¬è²»ç”¨</option>
                              <option value="äº¤é€šè²»">äº¤é€šè²»</option>
                              <option value="æ´»å‹•æ”¯å‡º">æ´»å‹•æ”¯å‡º</option>
                              <option value="è¨­å‚™æ¡è³¼">è¨­å‚™æ¡è³¼</option>
                              <option value="å…¶ä»–">å…¶ä»–</option>
                          </select>
                      </div>
                      <div class="form-group">
                          <label for="voucherAmount">ç”³è«‹é‡‘é¡ *</label>
                          <input type="number" id="voucherAmount" name="amount" min="0" step="1" required>
                      </div>
                  </div>

                  <div class="form-group">
                      <label for="voucherPurpose">ç”¨é€”èªªæ˜ *</label>
                      <textarea id="voucherPurpose" name="purpose" required placeholder="è«‹è©³ç´°èªªæ˜æ”¯å‡ºç”¨é€”..."></textarea>
                  </div>

                  <div class="form-group">
                      <label for="voucherAttachment">é™„ä»¶æ•¸é‡</label>
                      <input type="number" id="voucherAttachment" name="attachmentCount" min="0" value="0">
                      <small>è«‹è¨»æ˜ç›¸é—œæ”¶æ“šæˆ–ç™¼ç¥¨æ•¸é‡</small>
                  </div>

                  <div class="btn-group">
                      <button type="submit" class="btn btn-primary">æäº¤ç”³è«‹</button>
                      <button type="reset" class="btn btn-secondary">æ¸…é™¤è¡¨å–®</button>
                  </div>
              </form>
          </div>

          <!-- æ†‘è­‰è¨˜éŒ„åˆ—è¡¨ -->
          <div class="card">
              <div class="card-header">
                  <h3 class="card-title">æ†‘è­‰è¨˜éŒ„åˆ—è¡¨</h3>
              </div>
              <div class="table-container">
                  <table id="vouchersTable">
                      <thead>
                          <tr>
                              <th>æ†‘è­‰ç·¨è™Ÿ</th>
                              <th>ç”³è«‹æ—¥æœŸ</th>
                              <th>ç”³è«‹äºº</th>
                              <th>é¡åˆ¥</th>
                              <th>é‡‘é¡</th>
                              <th>ç‹€æ…‹</th>
                              <th>æ“ä½œ</th>
                          </tr>
                      </thead>
                      <tbody>
                          <tr>
                              <td colspan="7" class="empty-state">
                                  <h3>å°šç„¡æ†‘è­‰è¨˜éŒ„</h3>
                                  <p>è«‹æäº¤ç¬¬ä¸€ç­†æ†‘è­‰ç”³è«‹</p>
                              </td>
                          </tr>
                      </tbody>
                  </table>
              </div>
          </div>
      </div>

      <!-- æœƒå“¡ç®¡ç† -->
      <div id="members" class="tab-content">
          <div class="card-header">
              <h2 class="card-title">æœƒå“¡ç®¡ç†</h2>
              <p class="card-subtitle">ç®¡ç†æœƒå“¡è³‡æ–™å’Œæœƒç±ç‹€æ…‹</p>
          </div>

          <!-- æ–°å¢æœƒå“¡è¡¨å–® -->
          <div class="card">
              <div class="card-header">
                  <h3 class="card-title">æ–°å¢æœƒå“¡</h3>
              </div>
              <form id="memberForm">
                  <div class="form-row">
                      <div class="form-group">
                          <label for="memberName">å§“å *</label>
                          <input type="text" id="memberName" name="name" required>
                      </div>
                      <div class="form-group">
                          <label for="memberGender">æ€§åˆ¥</label>
                          <select id="memberGender" name="gender">
                              <option value="">è«‹é¸æ“‡</option>
                              <option value="ç”·">ç”·</option>
                              <option value="å¥³">å¥³</option>
                          </select>
                      </div>
                  </div>

                  <div class="form-row">
                      <div class="form-group">
                          <label for="memberBirthDate">å‡ºç”Ÿæ—¥æœŸ</label>
                          <input type="date" id="memberBirthDate" name="birthDate">
                      </div>
                      <div class="form-group">
                          <label for="memberIdNumber">èº«ä»½è­‰å­—è™Ÿ</label>
                          <input type="text" id="memberIdNumber" name="idNumber" pattern="[A-Z][0-9]{9}">
                      </div>
                  </div>

                  <div class="form-row">
                      <div class="form-group">
                          <label for="memberPhone">è¯çµ¡é›»è©± *</label>
                          <input type="tel" id="memberPhone" name="phone" required>
                      </div>
                      <div class="form-group">
                          <label for="memberEmail">é›»å­éƒµä»¶</label>
                          <input type="email" id="memberEmail" name="email">
                      </div>
                  </div>

                  <div class="form-group">
                      <label for="memberAddress">è¯çµ¡åœ°å€</label>
                      <textarea id="memberAddress" name="address" rows="3"></textarea>
                  </div>

                  <div class="form-row">
                      <div class="form-group">
                          <label for="memberType">æœƒå“¡é¡å‹ *</label>
                          <select id="memberType" name="memberType" required>
                              <option value="">è«‹é¸æ“‡</option>
                              <option value="ä¸€èˆ¬æœƒå“¡">ä¸€èˆ¬æœƒå“¡</option>
                              <option value="æ°¸ä¹…æœƒå“¡">æ°¸ä¹…æœƒå“¡</option>
                              <option value="æ¦®è­½æœƒå“¡">æ¦®è­½æœƒå“¡</option>
                              <option value="è´ŠåŠ©æœƒå“¡">è´ŠåŠ©æœƒå“¡</option>
                          </select>
                      </div>
                      <div class="form-group">
                          <label for="memberJoinDate">åŠ å…¥æ—¥æœŸ *</label>
                          <input type="date" id="memberJoinDate" name="joinDate" required>
                      </div>
                  </div>

                  <div class="form-group">
                      <label for="memberNotes">å‚™è¨»</label>
                      <textarea id="memberNotes" name="notes" rows="3"></textarea>
                  </div>

                  <div class="btn-group">
                      <button type="submit" class="btn btn-primary">æ–°å¢æœƒå“¡</button>
                      <button type="reset" class="btn btn-secondary">æ¸…é™¤è¡¨å–®</button>
                  </div>
              </form>
          </div>

          <!-- æœƒå“¡æœå°‹ -->
          <div class="search-filters">
              <div class="search-row">
                  <div class="search-group">
                      <label for="memberSearch">æœå°‹</label>
                      <input type="text" id="memberSearch" placeholder="æœå°‹å§“åã€é›»è©±...">
                  </div>
                  <div class="search-group">
                      <label for="memberTypeFilter">æœƒå“¡é¡å‹</label>
                      <select id="memberTypeFilter">
                          <option value="">å…¨éƒ¨</option>
                          <option value="ä¸€èˆ¬æœƒå“¡">ä¸€èˆ¬æœƒå“¡</option>
                          <option value="æ°¸ä¹…æœƒå“¡">æ°¸ä¹…æœƒå“¡</option>
                          <option value="æ¦®è­½æœƒå“¡">æ¦®è­½æœƒå“¡</option>
                          <option value="è´ŠåŠ©æœƒå“¡">è´ŠåŠ©æœƒå“¡</option>
                      </select>
                  </div>
                  <div class="search-group">
                      <label>&nbsp;</label>
                      <button type="button" class="btn btn-primary" onclick="searchMembers()">æœå°‹</button>
                  </div>
              </div>
          </div>

          <!-- æœƒå“¡åˆ—è¡¨ -->
          <div class="card">
              <div class="card-header">
                  <h3 class="card-title">æœƒå“¡åˆ—è¡¨</h3>
              </div>
              <div class="table-container">
                  <table id="membersTable">
                      <thead>
                          <tr>
                              <th>æœƒå“¡ç·¨è™Ÿ</th>
                              <th>å§“å</th>
                              <th>é›»è©±</th>
                              <th>æœƒå“¡é¡å‹</th>
                              <th>åŠ å…¥æ—¥æœŸ</th>
                              <th>ç‹€æ…‹</th>
                              <th>æ“ä½œ</th>
                          </tr>
                      </thead>
                      <tbody>
                          <tr>
                              <td colspan="7" class="empty-state">
                                  <h3>å°šç„¡æœƒå“¡è¨˜éŒ„</h3>
                                  <p>è«‹æ–°å¢ç¬¬ä¸€ä½æœƒå“¡</p>
                              </td>
                          </tr>
                      </tbody>
                  </table>
              </div>
          </div>
      </div>

      <!-- å ±è¡¨åˆ†æ -->
      <div id="reports" class="tab-content">
          <div class="card-header">
              <h2 class="card-title">å ±è¡¨åˆ†æ</h2>
              <p class="card-subtitle">ç”¢ç”Ÿå„ç¨®è²¡å‹™å’Œçµ±è¨ˆå ±è¡¨</p>
          </div>

          <!-- å ±è¡¨é¸é … -->
          <div class="card">
              <div class="card-header">
                  <h3 class="card-title">å ±è¡¨ç”¢ç”Ÿ</h3>
              </div>
              <form id="reportForm">
                  <div class="form-row">
                      <div class="form-group">
                          <label for="reportType">å ±è¡¨é¡å‹ *</label>
                          <select id="reportType" name="type" required>
                              <option value="">è«‹é¸æ“‡</option>
                              <option value="monthly">æœˆåº¦è²¡å‹™å ±è¡¨</option>
                              <option value="yearly">å¹´åº¦è²¡å‹™å ±è¡¨</option>
                              <option value="category">é¡åˆ¥çµ±è¨ˆå ±è¡¨</option>
                              <option value="member">æœƒå“¡çµ±è¨ˆå ±è¡¨</option>
                              <option value="donation">ææ¬¾çµ±è¨ˆå ±è¡¨</option>
                          </select>
                      </div>
                      <div class="form-group">
                          <label for="reportYear">å¹´ä»½ *</label>
                          <select id="reportYear" name="year" required>
                              <option value="">è«‹é¸æ“‡</option>
                          </select>
                      </div>
                  </div>

                  <div class="form-row">
                      <div class="form-group">
                          <label for="reportMonth">æœˆä»½</label>
                          <select id="reportMonth" name="month">
                              <option value="">å…¨å¹´</option>
                              <option value="1">1æœˆ</option>
                              <option value="2">2æœˆ</option>
                              <option value="3">3æœˆ</option>
                              <option value="4">4æœˆ</option>
                              <option value="5">5æœˆ</option>
                              <option value="6">6æœˆ</option>
                              <option value="7">7æœˆ</option>
                              <option value="8">8æœˆ</option>
                              <option value="9">9æœˆ</option>
                              <option value="10">10æœˆ</option>
                              <option value="11">11æœˆ</option>
                              <option value="12">12æœˆ</option>
                          </select>
                      </div>
                      <div class="form-group">
                          <label for="reportFormat">åŒ¯å‡ºæ ¼å¼</label>
                          <select id="reportFormat" name="format">
                              <option value="excel">Excel (.xlsx)</option>
                              <option value="pdf">PDF</option>
                          </select>
                      </div>
                  </div>

                  <div class="btn-group">
                      <button type="button" class="btn btn-primary" onclick="generateReport()">ç”¢ç”Ÿå ±è¡¨</button>
                      <button type="button" class="btn btn-success" onclick="exportReport()">åŒ¯å‡ºå ±è¡¨</button>
                  </div>
              </form>
          </div>

          <!-- å ±è¡¨é è¦½ -->
          <div class="card">
              <div class="card-header">
                  <h3 class="card-title">å ±è¡¨é è¦½</h3>
              </div>
              <div id="reportPreview">
                  <div class="empty-state">
                      <h3>è«‹é¸æ“‡å ±è¡¨é¡å‹</h3>
                      <p>é¸æ“‡å ±è¡¨é¡å‹å’Œæ™‚é–“ç¯„åœå¾Œï¼Œé»æ“Šã€Œç”¢ç”Ÿå ±è¡¨ã€æŸ¥çœ‹é è¦½</p>
                  </div>
              </div>
          </div>
      </div>

      <!-- ç³»çµ±è¨­å®š -->
      <div id="settings" class="tab-content">
          <div class="card-header">
              <h2 class="card-title">ç³»çµ±è¨­å®š</h2>
              <p class="card-subtitle">ç®¡ç†ç³»çµ±é…ç½®å’Œçµ„ç¹”è³‡è¨Š</p>
          </div>

          <!-- çµ„ç¹”è³‡è¨Šè¨­å®š -->
          <div class="card">
              <div class="card-header">
                  <h3 class="card-title">çµ„ç¹”è³‡è¨Š</h3>
              </div>
              <form id="organizationForm">
                  <div class="form-row">
                      <div class="form-group">
                          <label for="orgName">çµ„ç¹”åç¨± *</label>
                          <input type="text" id="orgName" name="name" required>
                      </div>
                      <div class="form-group">
                          <label for="orgTaxId">çµ±ä¸€ç·¨è™Ÿ</label>
                          <input type="text" id="orgTaxId" name="taxId">
                      </div>
                  </div>

                  <div class="form-group">
                      <label for="orgAddress">åœ°å€</label>
                      <textarea id="orgAddress" name="address" rows="3"></textarea>
                  </div>

                  <div class="form-row">
                      <div class="form-group">
                          <label for="orgPhone">é›»è©±</label>
                          <input type="tel" id="orgPhone" name="phone">
                      </div>
                      <div class="form-group">
                          <label for="orgEmail">é›»å­éƒµä»¶</label>
                          <input type="email" id="orgEmail" name="email">
                      </div>
                  </div>

                  <div class="form-group">
                      <label for="orgWebsite">ç¶²ç«™</label>
                      <input type="url" id="orgWebsite" name="website">
                  </div>

                  <div class="btn-group">
                      <button type="submit" class="btn btn-primary">å„²å­˜è¨­å®š</button>
                  </div>
              </form>
          </div>

          <!-- ç³»çµ±ç®¡ç† -->
          <div class="card">
              <div class="card-header">
                  <h3 class="card-title">ç³»çµ±ç®¡ç†</h3>
              </div>
              <div class="btn-group">
                  <button type="button" class="btn btn-info" onclick="performSystemCheck()">ç³»çµ±æª¢æŸ¥</button>
                  <button type="button" class="btn btn-warning" onclick="createBackup()">å»ºç«‹å‚™ä»½</button>
                  <button type="button" class="btn btn-secondary" onclick="cleanupSystem()">æ¸…ç†ç³»çµ±</button>
              </div>

              <div id="systemStatus" class="card" style="margin-top: 20px; display: none;">
                  <div class="card-header">
                      <h4 class="card-title">ç³»çµ±ç‹€æ…‹</h4>
                  </div>
                  <div id="systemStatusContent"></div>
              </div>
          </div>
      </div>
  </div>

  <!-- æ¨¡æ…‹æ¡† -->
  <div id="modal" class="modal">
      <div class="modal-content">
          <div class="modal-header">
              <h3 class="modal-title" id="modalTitle">æ¨™é¡Œ</h3>
              <button class="modal-close" onclick="closeModal()">&times;</button>
          </div>
          <div id="modalBody">
              å…§å®¹
          </div>
          <div class="btn-group" style="margin-top: 20px;">
              <button type="button" class="btn btn-secondary" onclick="closeModal()">é—œé–‰</button>
          </div>
      </div>
  </div>

  <script>
      // å…¨åŸŸè®Šæ•¸
      let currentTab = 'dashboard';
      let currentPage = 1;
      let itemsPerPage = 10;

      // ç³»çµ±é…ç½®
      const API_BASE_URL = 'https://script.google.com/macros/s/AKfycbxdH1dRpnHytaxOubg5cX-t7ur6t-Ckv0IiMrK3CqjUbUipu37KUhuSd1mFKFrFhcDlTQ/exec';

      // åˆå§‹åŒ–
      document.addEventListener('DOMContentLoaded', function() {
          initializeApp();
          updateCurrentTime();
          setInterval(updateCurrentTime, 1000);
      });

      function initializeApp() {
          console.log('åˆå§‹åŒ–æ‡‰ç”¨ç¨‹å¼...');
          
          // è¨­å®šé è¨­æ—¥æœŸ
          const today = new Date().toISOString().split('T')[0];
          document.getElementById('transactionDate').value = today;
          document.getElementById('receiptDate').value = today;
          document.getElementById('voucherDate').value = today;
          document.getElementById('memberJoinDate').value = today;

          // åˆå§‹åŒ–å¹´ä»½é¸é …
          initializeYearOptions();

          // è¨­å®šäº‹ä»¶ç›£è½å™¨
          setupEventListeners();

          // è¼‰å…¥å„€è¡¨æ¿æ•¸æ“š
          loadDashboard();
      }

      function setupEventListeners() {
          // æ¨™ç±¤é åˆ‡æ›
          document.querySelectorAll('.tab-btn').forEach(btn => {
              btn.addEventListener('click', function() {
                  switchTab(this.dataset.tab);
              });
          });

          // è¡¨å–®æäº¤
          document.getElementById('transactionForm').addEventListener('submit', handleTransactionSubmit);
          document.getElementById('receiptForm').addEventListener('submit', handleReceiptSubmit);
          document.getElementById('voucherForm').addEventListener('submit', handleVoucherSubmit);
          document.getElementById('memberForm').addEventListener('submit', handleMemberSubmit);
          document.getElementById('organizationForm').addEventListener('submit', handleOrganizationSubmit);

          // æ¨¡æ…‹æ¡†é—œé–‰
          document.getElementById('modal').addEventListener('click', function(e) {
              if (e.target === this) {
                  closeModal();
              }
          });
      }

      function updateCurrentTime() {
          const now = new Date();
          const timeString = now.toLocaleString('zh-TW', {
              year: 'numeric',
              month: '2-digit',
              day: '2-digit',
              hour: '2-digit',
              minute: '2-digit',
              second: '2-digit'
          });
          document.getElementById('currentTime').textContent = timeString;
      }

      function initializeYearOptions() {
          const currentYear = new Date().getFullYear();
          const yearSelect = document.getElementById('reportYear');
          
          for (let year = currentYear; year >= currentYear - 10; year--) {
              const option = document.createElement('option');
              option.value = year;
              option.textContent = year + 'å¹´';
              yearSelect.appendChild(option);
          }
      }

      // æ¨™ç±¤é åˆ‡æ›
      function switchTab(tabName) {
          // éš±è—æ‰€æœ‰æ¨™ç±¤é å…§å®¹
          document.querySelectorAll('.tab-content').forEach(content => {
              content.classList.remove('active');
          });

          // ç§»é™¤æ‰€æœ‰æŒ‰éˆ•çš„activeé¡åˆ¥
          document.querySelectorAll('.tab-btn').forEach(btn => {
              btn.classList.remove('active');
          });

          // é¡¯ç¤ºé¸ä¸­çš„æ¨™ç±¤é 
          document.getElementById(tabName).classList.add('active');
          document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');

          currentTab = tabName;

          // è¼‰å…¥å°æ‡‰æ•¸æ“š
          switch (tabName) {
              case 'dashboard':
                  loadDashboard();
                  break;
              case 'transactions':
                  loadTransactions();
                  break;
              case 'receipts':
                  loadReceipts();
                  break;
              case 'vouchers':
                  loadVouchers();
                  break;
              case 'members':
                  loadMembers();
                  break;
          }
      }

      // API å‘¼å«å‡½æ•¸
      async function callAPI(functionName, data = {}) {
          showLoading();
          
          try {
              const formData = new FormData();
              formData.append('function', functionName);
              formData.append('data', JSON.stringify(data));

              const response = await fetch(API_BASE_URL, {
                  method: 'POST',
                  body: formData
              });

              const result = await response.json();
              
              if (result.success) {
                  return result;
              } else {
                  throw new Error(result.error || 'æ“ä½œå¤±æ•—');
              }
          } catch (error) {
              console.error('APIå‘¼å«å¤±æ•—:', error);
              showAlert('error', 'æ“ä½œå¤±æ•—ï¼š' + error.message);
              return { success: false, error: error.message };
          } finally {
              hideLoading();
          }
      }

      // è¼‰å…¥å„€è¡¨æ¿
      async function loadDashboard() {
          try {
              const result = await callAPI('getDashboardData');
              if (result.success) {
                  updateDashboardStats(result.data);
              }
          } catch (error) {
              console.error('è¼‰å…¥å„€è¡¨æ¿å¤±æ•—:', error);
          }
      }

      function updateDashboardStats(data) {
          document.getElementById('totalIncome').textContent = '$' + (data.totalIncome || 0).toLocaleString();
          document.getElementById('totalExpense').textContent = '$' + (data.totalExpense || 0).toLocaleString();
          document.getElementById('receiptCount').textContent = data.receiptCount || 0;
          document.getElementById('memberCount').textContent = data.memberCount || 0;

          // æ›´æ–°è®ŠåŒ–ç™¾åˆ†æ¯”
          document.getElementById('incomeChange').textContent = '+' + (data.incomeChange || 0) + '%';
          document.getElementById('expenseChange').textContent = '+' + (data.expenseChange || 0) + '%';
          document.getElementById('receiptChange').textContent = '+' + (data.receiptChange || 0);
          document.getElementById('memberChange').textContent = '+' + (data.memberChange || 0);
      }

      // è¡¨å–®è™•ç†å‡½æ•¸
      async function handleTransactionSubmit(e) {
          e.preventDefault();
          
          const formData = new FormData(e.target);
          const data = Object.fromEntries(formData.entries());
          
          const result = await callAPI('addTransaction', data);
          
          if (result.success) {
              showAlert('success', 'äº¤æ˜“è¨˜éŒ„å·²æˆåŠŸæ–°å¢');
              e.target.reset();
              document.getElementById('transactionDate').value = new Date().toISOString().split('T')[0];
              loadTransactions();
          }
      }

      async function handleReceiptSubmit(e) {
          e.preventDefault();
          
          const formData = new FormData(e.target);
          const data = Object.fromEntries(formData.entries());
          
          const result = await callAPI('issueReceipt', data);
          
          if (result.success) {
              showAlert('success', 'æ”¶æ“šå·²æˆåŠŸé–‹ç«‹ï¼Œç·¨è™Ÿï¼š' + result.receiptNumber);
              e.target.reset();
              document.getElementById('receiptDate').value = new Date().toISOString().split('T')[0];
              loadReceipts();
          }
      }

      async function handleVoucherSubmit(e) {
          e.preventDefault();
          
          const formData = new FormData(e.target);
          const data = Object.fromEntries(formData.entries());
          
          const result = await callAPI('submitVoucher', data);
          
          if (result.success) {
              showAlert('success', 'æ†‘è­‰ç”³è«‹å·²æäº¤ï¼Œç·¨è™Ÿï¼š' + result.voucherNumber);
              e.target.reset();
              document.getElementById('voucherDate').value = new Date().toISOString().split('T')[0];
              loadVouchers();
          }
      }

      async function handleMemberSubmit(e) {
          e.preventDefault();
          
          const formData = new FormData(e.target);
          const data = Object.fromEntries(formData.entries());
          
          const result = await callAPI('addMember', data);
          
          if (result.success) {
              showAlert('success', 'æœƒå“¡å·²æˆåŠŸæ–°å¢ï¼Œç·¨è™Ÿï¼š' + result.memberNumber);
              e.target.reset();
              document.getElementById('memberJoinDate').value = new Date().toISOString().split('T')[0];
              loadMembers();
          }
      }

      async function handleOrganizationSubmit(e) {
          e.preventDefault();
          
          const formData = new FormData(e.target);
          const data = Object.fromEntries(formData.entries());
          
          const result = await callAPI('saveOrganizationInfo', data);
          
          if (result.success) {
              showAlert('success', 'çµ„ç¹”è³‡è¨Šå·²æˆåŠŸå„²å­˜');
          }
      }

      // è¼‰å…¥æ•¸æ“šå‡½æ•¸
      async function loadTransactions() {
          const result = await callAPI('getTransactions', { page: currentPage, limit: itemsPerPage });
          if (result.success) {
              displayTransactions(result.data);
          }
      }

      async function loadReceipts() {
          const result = await callAPI('getReceipts', { page: currentPage, limit: itemsPerPage });
          if (result.success) {
              displayReceipts(result.data);
          }
      }

      async function loadVouchers() {
          const result = await callAPI('getVouchers', { page: currentPage, limit: itemsPerPage });
          if (result.success) {
              displayVouchers(result.data);
          }
      }

      async function loadMembers() {
          const result = await callAPI('getMembers', { page: currentPage, limit: itemsPerPage });
          if (result.success) {
              displayMembers(result.data);
          }
      }

      // é¡¯ç¤ºæ•¸æ“šå‡½æ•¸
      function displayTransactions(data) {
          const tbody = document.querySelector('#transactionsTable tbody');
          
          if (!data || data.length === 0) {
              tbody.innerHTML = `
                  <tr>
                      <td colspan="8" class="empty-state">
                          <h3>å°šç„¡äº¤æ˜“è¨˜éŒ„</h3>
                          <p>è«‹æ–°å¢ç¬¬ä¸€ç­†äº¤æ˜“è¨˜éŒ„</p>
                      </td>
                  </tr>
              `;
              return;
          }

          tbody.innerHTML = data.map(transaction => `
              <tr>
                  <td>${formatDate(transaction.date)}</td>
                  <td><span class="badge badge-${transaction.type === 'æ”¶å…¥' ? 'success' : 'danger'}">${transaction.type}</span></td>
                  <td>${transaction.category}</td>
                  <td>${transaction.name}</td>
                  <td>$${Number(transaction.amount).toLocaleString()}</td>
                  <td>${transaction.account || '-'}</td>
                  <td><span class="badge badge-success">${transaction.status || 'æ­£å¸¸'}</span></td>
                  <td class="table-actions">
                      <button class="btn btn-sm btn-info" onclick="viewTransaction('${transaction.id}')">æŸ¥çœ‹</button>
                      <button class="btn btn-sm btn-warning" onclick="editTransaction('${transaction.id}')">ç·¨è¼¯</button>
                  </td>
              </tr>
          `).join('');
      }

      function displayReceipts(data) {
          const tbody = document.querySelector('#receiptsTable tbody');
          
          if (!data || data.length === 0) {
              tbody.innerHTML = `
                  <tr>
                      <td colspan="7" class="empty-state">
                          <h3>å°šç„¡æ”¶æ“šè¨˜éŒ„</h3>
                          <p>è«‹é–‹ç«‹ç¬¬ä¸€å¼µæ”¶æ“š</p>
                      </td>
                  </tr>
              `;
              return;
          }

          tbody.innerHTML = data.map(receipt => `
              <tr>
                  <td>${receipt.receiptNumber}</td>
                  <td>${formatDate(receipt.date)}</td>
                  <td>${receipt.payer}</td>
                  <td>${receipt.category}</td>
                  <td>$${Number(receipt.amount).toLocaleString()}</td>
                  <td><span class="badge badge-success">${receipt.status || 'å·²é–‹ç«‹'}</span></td>
                  <td class="table-actions">
                      <button class="btn btn-sm btn-info" onclick="viewReceipt('${receipt.receiptNumber}')">æŸ¥çœ‹</button>
                      <button class="btn btn-sm btn-primary" onclick="printReceipt('${receipt.receiptNumber}')">åˆ—å°</button>
                      <button class="btn btn-sm btn-secondary" onclick="emailReceipt('${receipt.receiptNumber}')">å¯„é€</button>
                  </td>
              </tr>
          `).join('');
      }

      function displayVouchers(data) {
          const tbody = document.querySelector('#vouchersTable tbody');
          
          if (!data || data.length === 0) {
              tbody.innerHTML = `
                  <tr>
                      <td colspan="7" class="empty-state">
                          <h3>å°šç„¡æ†‘è­‰è¨˜éŒ„</h3>
                          <p>è«‹æäº¤ç¬¬ä¸€ç­†æ†‘è­‰ç”³è«‹</p>
                      </td>
                  </tr>
              `;
              return;
          }

          tbody.innerHTML = data.map(voucher => `
              <tr>
                  <td>${voucher.voucherNumber}</td>
                  <td>${formatDate(voucher.date)}</td>
                  <td>${voucher.applicant}</td>
                  <td>${voucher.category}</td>
                  <td>$${Number(voucher.amount).toLocaleString()}</td>
                  <td><span class="badge badge-warning">${voucher.status || 'å¾…å¯©æ ¸'}</span></td>
                  <td class="table-actions">
                      <button class="btn btn-sm btn-info" onclick="viewVoucher('${voucher.voucherNumber}')">æŸ¥çœ‹</button>
                      <button class="btn btn-sm btn-success" onclick="approveVoucher('${voucher.voucherNumber}')">æ ¸å‡†</button>
                  </td>
              </tr>
          `).join('');
      }

      function displayMembers(data) {
          const tbody = document.querySelector('#membersTable tbody');
          
          if (!data || data.length === 0) {
              tbody.innerHTML = `
                  <tr>
                      <td colspan="7" class="empty-state">
                          <h3>å°šç„¡æœƒå“¡è¨˜éŒ„</h3>
                          <p>è«‹æ–°å¢ç¬¬ä¸€ä½æœƒå“¡</p>
                      </td>
                  </tr>
              `;
              return;
          }

          tbody.innerHTML = data.map(member => `
              <tr>
                  <td>${member.memberNumber}</td>
                  <td>${member.name}</td>
                  <td>${member.phone}</td>
                  <td>${member.memberType}</td>
                  <td>${formatDate(member.joinDate)}</td>
                  <td><span class="badge badge-success">${member.status || 'æ­£å¸¸'}</span></td>
                  <td class="table-actions">
                      <button class="btn btn-sm btn-info" onclick="viewMember('${member.memberNumber}')">æŸ¥çœ‹</button>
                      <button class="btn btn-sm btn-warning" onclick="editMember('${member.memberNumber}')">ç·¨è¼¯</button>
                  </td>
              </tr>
          `).join('');
      }

      // æœå°‹å‡½æ•¸
      async function searchTransactions() {
          const searchData = {
              search: document.getElementById('transactionSearch').value,
              type: document.getElementById('transactionTypeFilter').value,
              dateFrom: document.getElementById('transactionDateFrom').value,
              dateTo: document.getElementById('transactionDateTo').value,
              page: 1,
              limit: itemsPerPage
          };

          const result = await callAPI('searchTransactions', searchData);
          if (result.success) {
              displayTransactions(result.data);
          }
      }

      async function searchReceipts() {
          const searchData = {
              search: document.getElementById('receiptSearch').value,
              status: document.getElementById('receiptStatusFilter').value,
              page: 1,
              limit: itemsPerPage
          };

          const result = await callAPI('searchReceipts', searchData);
          if (result.success) {
              displayReceipts(result.data);
          }
      }

      async function searchMembers() {
          const searchData = {
              search: document.getElementById('memberSearch').value,
              memberType: document.getElementById('memberTypeFilter').value,
              page: 1,
              limit: itemsPerPage
          };

          const result = await callAPI('searchMembers', searchData);
          if (result.success) {
              displayMembers(result.data);
          }
      }

      // å ±è¡¨åŠŸèƒ½
      async function generateReport() {
          const reportType = document.getElementById('reportType').value;
          const year = document.getElementById('reportYear').value;
          const month = document.getElementById('reportMonth').value;

          if (!reportType || !year) {
              showAlert('warning', 'è«‹é¸æ“‡å ±è¡¨é¡å‹å’Œå¹´ä»½');
              return;
          }

          const reportData = {
              type: reportType,
              year: year,
              month: month
          };

          const result = await callAPI('generateReport', reportData);
          if (result.success) {
              displayReportPreview(result.data);
              showAlert('success', 'å ±è¡¨å·²æˆåŠŸç”¢ç”Ÿ');
          }
      }

      async function exportReport() {
          const reportType = document.getElementById('reportType').value;
          const year = document.getElementById('reportYear').value;
          const month = document.getElementById('reportMonth').value;
          const format = document.getElementById('reportFormat').value;

          if (!reportType || !year) {
              showAlert('warning', 'è«‹é¸æ“‡å ±è¡¨é¡å‹å’Œå¹´ä»½');
              return;
          }

          const exportData = {
              type: reportType,
              year: year,
              month: month,
              format: format
          };

          const result = await callAPI('exportReport', exportData);
          if (result.success) {
              // ä¸‹è¼‰æª”æ¡ˆ
              const link = document.createElement('a');
              link.href = result.downloadUrl;
              link.download = result.filename;
              link.click();
              showAlert('success', 'å ±è¡¨å·²æˆåŠŸåŒ¯å‡º');
          }
      }

      function displayReportPreview(data) {
          const previewDiv = document.getElementById('reportPreview');
          
          let html = '<div class="report-content">';
          
          if (data.summary) {
              html += '<div class="report-summary">';
              html += '<h4>å ±è¡¨æ‘˜è¦</h4>';
              html += '<div class="stats-grid">';
              
              Object.entries(data.summary).forEach(([key, value]) => {
                  html += `
                      <div class="stat-card">
                          <div class="stat-number">${typeof value === 'number' ? value.toLocaleString() : value}</div>
                          <div class="stat-label">${key}</div>
                      </div>
                  `;
              });
              
              html += '</div></div>';
          }

          if (data.details && data.details.length > 0) {
              html += '<div class="report-details">';
              html += '<h4>è©³ç´°è³‡æ–™</h4>';
              html += '<div class="table-container">';
              html += '<table><thead><tr>';
              
              // è¡¨é ­
              Object.keys(data.details[0]).forEach(key => {
                  html += `<th>${key}</th>`;
              });
              html += '</tr></thead><tbody>';
              
              // è³‡æ–™è¡Œ
              data.details.forEach(row => {
                  html += '<tr>';
                  Object.values(row).forEach(value => {
                      html += `<td>${value}</td>`;
                  });
                  html += '</tr>';
              });
              
              html += '</tbody></table></div></div>';
          }

          html += '</div>';
          previewDiv.innerHTML = html;
      }

      // ç³»çµ±ç®¡ç†åŠŸèƒ½
      async function performSystemCheck() {
          const result = await callAPI('performSystemCheck');
          if (result.success) {
              displaySystemStatus(result.data);
              showAlert('success', 'ç³»çµ±æª¢æŸ¥å®Œæˆ');
          }
      }

      async function createBackup() {
          const result = await callAPI('createBackup');
          if (result.success) {
              showAlert('success', 'å‚™ä»½å·²æˆåŠŸå»ºç«‹');
          }
      }

      async function cleanupSystem() {
          if (confirm('ç¢ºå®šè¦åŸ·è¡Œç³»çµ±æ¸…ç†å—ï¼Ÿé€™å°‡æ¸…é™¤èˆŠçš„æ—¥èªŒè¨˜éŒ„ã€‚')) {
              const result = await callAPI('cleanupSystem');
              if (result.success) {
                  showAlert('success', result.message);
              }
          }
      }

      function displaySystemStatus(data) {
          const statusDiv = document.getElementById('systemStatus');
          const contentDiv = document.getElementById('systemStatusContent');
          
          let html = '<div class="system-status-grid">';
          
          // ç³»çµ±ç‰ˆæœ¬è³‡è¨Š
          html += `
              <div class="status-item">
                  <h5>ç³»çµ±ç‰ˆæœ¬</h5>
                  <p>${data.version || 'v5.0'}</p>
              </div>
          `;
          
          // å¥åº·ç‹€æ…‹
          html += `
              <div class="status-item">
                  <h5>ç³»çµ±ç‹€æ…‹</h5>
                  <p class="${data.health === 'healthy' ? 'text-success' : 'text-danger'}">
                      ${data.health === 'healthy' ? 'æ­£å¸¸' : 'ç•°å¸¸'}
                  </p>
              </div>
          `;
          
          // çµ±è¨ˆè³‡è¨Š
          if (data.statistics) {
              Object.entries(data.statistics).forEach(([key, value]) => {
                  html += `
                      <div class="status-item">
                          <h5>${key}</h5>
                          <p>${value}</p>
                      </div>
                  `;
              });
          }
          
          html += '</div>';
          
          contentDiv.innerHTML = html;
          statusDiv.style.display = 'block';
      }

      // è©³ç´°æª¢è¦–åŠŸèƒ½
      async function viewTransaction(id) {
          const result = await callAPI('getTransactionDetail', { id: id });
          if (result.success) {
              showModal('äº¤æ˜“è©³æƒ…', createTransactionDetailHTML(result.data));
          }
      }

      async function viewReceipt(receiptNumber) {
          const result = await callAPI('getReceiptDetail', { receiptNumber: receiptNumber });
          if (result.success) {
              showModal('æ”¶æ“šè©³æƒ…', createReceiptDetailHTML(result.data));
          }
      }

      async function viewVoucher(voucherNumber) {
          const result = await callAPI('getVoucherDetail', { voucherNumber: voucherNumber });
          if (result.success) {
              showModal('æ†‘è­‰è©³æƒ…', createVoucherDetailHTML(result.data));
          }
      }

      async function viewMember(memberNumber) {
          const result = await callAPI('getMemberDetail', { memberNumber: memberNumber });
          if (result.success) {
              showModal('æœƒå“¡è©³æƒ…', createMemberDetailHTML(result.data));
          }
      }

      // å»ºç«‹è©³æƒ…HTML
      function createTransactionDetailHTML(data) {
          return `
              <div class="detail-content">
                  <div class="detail-row">
                      <span class="detail-label">äº¤æ˜“ç·¨è™Ÿï¼š</span>
                      <span class="detail-value">${data.transactionId}</span>
                  </div>
                  <div class="detail-row">
                      <span class="detail-label">äº¤æ˜“æ—¥æœŸï¼š</span>
                      <span class="detail-value">${formatDate(data.date)}</span>
                  </div>
                  <div class="detail-row">
                      <span class="detail-label">æ”¶æ”¯é¡å‹ï¼š</span>
                      <span class="detail-value badge badge-${data.type === 'æ”¶å…¥' ? 'success' : 'danger'}">${data.type}</span>
                  </div>
                  <div class="detail-row">
                      <span class="detail-label">é¡åˆ¥ï¼š</span>
                      <span class="detail-value">${data.category}</span>
                  </div>
                  <div class="detail-row">
                      <span class="detail-label">é‡‘é¡ï¼š</span>
                      <span class="detail-value">$${Number(data.amount).toLocaleString()}</span>
                  </div>
                  <div class="detail-row">
                      <span class="detail-label">äº¤æ˜“å°è±¡ï¼š</span>
                      <span class="detail-value">${data.name}</span>
                  </div>
                  <div class="detail-row">
                      <span class="detail-label">å¸³æˆ¶ï¼š</span>
                      <span class="detail-value">${data.account || '-'}</span>
                  </div>
                  <div class="detail-row">
                      <span class="detail-label">èªªæ˜ï¼š</span>
                      <span class="detail-value">${data.description || '-'}</span>
                  </div>
                  <div class="detail-row">
                      <span class="detail-label">å»ºç«‹æ™‚é–“ï¼š</span>
                      <span class="detail-value">${formatDateTime(data.createdAt)}</span>
                  </div>
              </div>
          `;
      }

      function createReceiptDetailHTML(data) {
          return `
              <div class="detail-content">
                  <div class="detail-row">
                      <span class="detail-label">æ”¶æ“šç·¨è™Ÿï¼š</span>
                      <span class="detail-value">${data.receiptNumber}</span>
                  </div>
                  <div class="detail-row">
                      <span class="detail-label">æ”¶æ“šæ—¥æœŸï¼š</span>
                      <span class="detail-value">${formatDate(data.date)}</span>
                  </div>
                  <div class="detail-row">
                      <span class="detail-label">ä»˜æ¬¾äººï¼š</span>
                      <span class="detail-value">${data.payer}</span>
                  </div>
                  <div class="detail-row">
                      <span class="detail-label">èº«ä»½é¡åˆ¥ï¼š</span>
                      <span class="detail-value">${data.identity}</span>
                  </div>
                  <div class="detail-row">
                      <span class="detail-label">è¯çµ¡é›»è©±ï¼š</span>
                      <span class="detail-value">${data.phone || '-'}</span>
                  </div>
                  <div class="detail-row">
                      <span class="detail-label">é›»å­éƒµä»¶ï¼š</span>
                      <span class="detail-value">${data.email || '-'}</span>
                  </div>
                  <div class="detail-row">
                      <span class="detail-label">æ”¶æ“šé¡åˆ¥ï¼š</span>
                      <span class="detail-value">${data.category}</span>
                  </div>
                  <div class="detail-row">
                      <span class="detail-label">é‡‘é¡ï¼š</span>
                      <span class="detail-value">$${Number(data.amount).toLocaleString()}</span>
                  </div>
                  <div class="detail-row">
                      <span class="detail-label">ç”¨é€”ï¼š</span>
                      <span class="detail-value">${data.purpose || '-'}</span>
                  </div>
                  <div class="detail-row">
                      <span class="detail-label">ç‹€æ…‹ï¼š</span>
                      <span class="detail-value badge badge-success">${data.status}</span>
                  </div>
              </div>
              <div class="btn-group" style="margin-top: 20px;">
                  <button class="btn btn-primary" onclick="printReceipt('${data.receiptNumber}')">åˆ—å°æ”¶æ“š</button>
                  <button class="btn btn-secondary" onclick="emailReceipt('${data.receiptNumber}')">å¯„é€æ”¶æ“š</button>
              </div>
          `;
      }

      function createVoucherDetailHTML(data) {
          return `
              <div class="detail-content">
                  <div class="detail-row">
                      <span class="detail-label">æ†‘è­‰ç·¨è™Ÿï¼š</span>
                      <span class="detail-value">${data.voucherNumber}</span>
                  </div>
                  <div class="detail-row">
                      <span class="detail-label">ç”³è«‹æ—¥æœŸï¼š</span>
                      <span class="detail-value">${formatDate(data.date)}</span>
                  </div>
                  <div class="detail-row">
                      <span class="detail-label">ç”³è«‹äººï¼š</span>
                      <span class="detail-value">${data.applicant}</span>
                  </div>
                  <div class="detail-row">
                      <span class="detail-label">æ”¯å‡ºé¡åˆ¥ï¼š</span>
                      <span class="detail-value">${data.category}</span>
                  </div>
                  <div class="detail-row">
                      <span class="detail-label">ç”³è«‹é‡‘é¡ï¼š</span>
                      <span class="detail-value">$${Number(data.amount).toLocaleString()}</span>
                  </div>
                  <div class="detail-row">
                      <span class="detail-label">ç”¨é€”èªªæ˜ï¼š</span>
                      <span class="detail-value">${data.purpose}</span>
                  </div>
                  <div class="detail-row">
                      <span class="detail-label">é™„ä»¶æ•¸é‡ï¼š</span>
                      <span class="detail-value">${data.attachmentCount || 0} å€‹</span>
                  </div>
                  <div class="detail-row">
                      <span class="detail-label">ç‹€æ…‹ï¼š</span>
                      <span class="detail-value badge badge-warning">${data.status}</span>
                  </div>
              </div>
              <div class="btn-group" style="margin-top: 20px;">
                  <button class="btn btn-success" onclick="approveVoucher('${data.voucherNumber}')">æ ¸å‡†</button>
                  <button class="btn btn-danger" onclick="rejectVoucher('${data.voucherNumber}')">é§å›</button>
              </div>
          `;
      }

      function createMemberDetailHTML(data) {
          return `
              <div class="detail-content">
                  <div class="detail-row">
                      <span class="detail-label">æœƒå“¡ç·¨è™Ÿï¼š</span>
                      <span class="detail-value">${data.memberNumber}</span>
                  </div>
                  <div class="detail-row">
                      <span class="detail-label">å§“åï¼š</span>
                      <span class="detail-value">${data.name}</span>
                  </div>
                  <div class="detail-row">
                      <span class="detail-label">æ€§åˆ¥ï¼š</span>
                      <span class="detail-value">${data.gender || '-'}</span>
                  </div>
                  <div class="detail-row">
                      <span class="detail-label">å‡ºç”Ÿæ—¥æœŸï¼š</span>
                      <span class="detail-value">${data.birthDate ? formatDate(data.birthDate) : '-'}</span>
                  </div>
                  <div class="detail-row">
                      <span class="detail-label">èº«ä»½è­‰å­—è™Ÿï¼š</span>
                      <span class="detail-value">${data.idNumber || '-'}</span>
                  </div>
                  <div class="detail-row">
                      <span class="detail-label">è¯çµ¡é›»è©±ï¼š</span>
                      <span class="detail-value">${data.phone}</span>
                  </div>
                  <div class="detail-row">
                      <span class="detail-label">é›»å­éƒµä»¶ï¼š</span>
                      <span class="detail-value">${data.email || '-'}</span>
                  </div>
                  <div class="detail-row">
                      <span class="detail-label">è¯çµ¡åœ°å€ï¼š</span>
                      <span class="detail-value">${data.address || '-'}</span>
                  </div>
                  <div class="detail-row">
                      <span class="detail-label">æœƒå“¡é¡å‹ï¼š</span>
                      <span class="detail-value">${data.memberType}</span>
                  </div>
                  <div class="detail-row">
                      <span class="detail-label">åŠ å…¥æ—¥æœŸï¼š</span>
                      <span class="detail-value">${formatDate(data.joinDate)}</span>
                  </div>
                  <div class="detail-row">
                      <span class="detail-label">å‚™è¨»ï¼š</span>
                      <span class="detail-value">${data.notes || '-'}</span>
                  </div>
                  <div class="detail-row">
                      <span class="detail-label">ç‹€æ…‹ï¼š</span>
                      <span class="detail-value badge badge-success">${data.status}</span>
                  </div>
              </div>
          `;
      }

      // æ“ä½œåŠŸèƒ½
      async function printReceipt(receiptNumber) {
          const result = await callAPI('printReceipt', { receiptNumber: receiptNumber });
          if (result.success) {
              // é–‹å•Ÿæ–°è¦–çª—åˆ—å°
              const printWindow = window.open('', '_blank');
              printWindow.document.write(result.printContent);
              printWindow.document.close();
              printWindow.print();
              showAlert('success', 'æ”¶æ“šå·²æº–å‚™åˆ—å°');
          }
      }

      async function emailReceipt(receiptNumber) {
          const result = await callAPI('emailReceipt', { receiptNumber: receiptNumber });
          if (result.success) {
              showAlert('success', 'æ”¶æ“šå·²æˆåŠŸå¯„é€');
          }
      }

      async function approveVoucher(voucherNumber) {
          if (confirm('ç¢ºå®šè¦æ ¸å‡†é€™ç­†æ†‘è­‰ç”³è«‹å—ï¼Ÿ')) {
              const result = await callAPI('approveVoucher', { voucherNumber: voucherNumber });
              if (result.success) {
                  showAlert('success', 'æ†‘è­‰å·²æ ¸å‡†');
                  loadVouchers();
                  closeModal();
              }
          }
      }

      async function rejectVoucher(voucherNumber) {
          const reason = prompt('è«‹è¼¸å…¥é§å›åŸå› ï¼š');
          if (reason) {
              const result = await callAPI('rejectVoucher', { 
                  voucherNumber: voucherNumber, 
                  reason: reason 
              });
              if (result.success) {
                  showAlert('success', 'æ†‘è­‰å·²é§å›');
                  loadVouchers();
                  closeModal();
              }
          }
      }

      // å·¥å…·å‡½æ•¸
      function formatDate(dateString) {
          if (!dateString) return '-';
          const date = new Date(dateString);
          return date.toLocaleDateString('zh-TW');
      }

      function formatDateTime(dateString) {
          if (!dateString) return '-';
          const date = new Date(dateString);
          return date.toLocaleString('zh-TW');
      }

      function showLoading() {
          document.getElementById('loading').classList.add('show');
      }

      function hideLoading() {
          document.getElementById('loading').classList.remove('show');
      }

      function showAlert(type, message) {
          const alertContainer = document.getElementById('alertContainer');
          const alertId = 'alert-' + Date.now();
          
          const alertHTML = `
              <div id="${alertId}" class="alert alert-${type} fade-in">
                  <span>${message}</span>
                  <button class="close" onclick="closeAlert('${alertId}')">&times;</button>
              </div>
          `;
          
          alertContainer.insertAdjacentHTML('beforeend', alertHTML);
          
          // è‡ªå‹•é—œé–‰
          setTimeout(() => {
              closeAlert(alertId);
          }, 5000);
      }

      function closeAlert(alertId) {
          const alert = document.getElementById(alertId);
          if (alert) {
              alert.style.opacity = '0';
              alert.style.transform = 'translateY(-10px)';
              setTimeout(() => {
                  alert.remove();
              }, 300);
          }
      }

      function showModal(title, content) {
          document.getElementById('modalTitle').textContent = title;
          document.getElementById('modalBody').innerHTML = content;
          document.getElementById('modal').classList.add('show');
      }

      function closeModal() {
          document.getElementById('modal').classList.remove('show');
      }

      // éµç›¤å¿«æ·éµ
      document.addEventListener('keydown', function(e) {
          // ESC é—œé–‰æ¨¡æ…‹æ¡†
          if (e.key === 'Escape') {
              closeModal();
          }
          
          // Ctrl+S å„²å­˜ï¼ˆé˜²æ­¢ç€è¦½å™¨é è¨­è¡Œç‚ºï¼‰
          if (e.ctrlKey && e.key === 's') {
              e.preventDefault();
              // å¯ä»¥åœ¨é€™è£¡æ·»åŠ å„²å­˜é‚è¼¯
          }
      });

      // é é¢é›¢é–‹å‰ç¢ºèª
      window.addEventListener('beforeunload', function(e) {
          // æª¢æŸ¥æ˜¯å¦æœ‰æœªå„²å­˜çš„è¡¨å–®
          const forms = document.querySelectorAll('form');
          let hasUnsavedData = false;
          
          forms.forEach(form => {
              const formData = new FormData(form);
              for (let [key, value] of formData.entries()) {
                  if (value && value.trim() !== '') {
                      hasUnsavedData = true;
                      break;
                  }
              }
          });
          
          if (hasUnsavedData) {
              e.preventDefault();
              e.returnValue = '';
          }
      });

      // è‡ªå‹•å„²å­˜è‰ç¨¿åŠŸèƒ½
      function autoSaveDraft() {
          const forms = document.querySelectorAll('form');
          forms.forEach(form => {
              const formData = new FormData(form);
              const draftData = Object.fromEntries(formData.entries());
              localStorage.setItem(`draft_${form.id}`, JSON.stringify(draftData));
          });
      }

      function loadDraft(formId) {
          const draftData = localStorage.getItem(`draft_${formId}`);
          if (draftData) {
              const data = JSON.parse(draftData);
              const form = document.getElementById(formId);
              
              Object.entries(data).forEach(([key, value]) => {
                  const input = form.querySelector(`[name="${key}"]`);
                  if (input) {
                      input.value = value;
                  }
              });
          }
      }

      function clearDraft(formId) {
          localStorage.removeItem(`draft_${formId}`);
      }

      // å®šæœŸè‡ªå‹•å„²å­˜è‰ç¨¿
      setInterval(autoSaveDraft, 30000); // æ¯30ç§’è‡ªå‹•å„²å­˜

      // åˆå§‹åŒ–å®Œæˆ
      console.log('å°ç£å¸•é‡‘æ£®ç—…å‹æ¬Šç›Šä¿ƒé€²æœƒæœƒè¨ˆç®¡ç†ç³»çµ± v5.0 è¼‰å…¥å®Œæˆ');
  </script>

  <style>
      /* è©³æƒ…é¡¯ç¤ºæ¨£å¼ */
      .detail-content {
          max-width: 100%;
      }

      .detail-row {
          display: flex;
          margin-bottom: 15px;
          padding-bottom: 10px;
          border-bottom: 1px solid #f0f0f0;
      }

      .detail-row:last-child {
          border-bottom: none;
          margin-bottom: 0;
      }

      .detail-label {
          font-weight: 600;
          color: #555;
          min-width: 120px;
          flex-shrink: 0;
      }

      .detail-value {
          color: #333;
          flex: 1;
      }

      /* ç³»çµ±ç‹€æ…‹æ¨£å¼ */
      .system-status-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
          gap: 20px;
      }

      .status-item {
          padding: 15px;
          background: #f8f9fa;
          border-radius: 8px;
          text-align: center;
      }

      .status-item h5 {
          margin-bottom: 10px;
          color: #666;
          font-size: 0.9rem;
      }

      .status-item p {
          margin: 0;
          font-size: 1.1rem;
          font-weight: 600;
      }

      .text-success {
          color: #28a745 !important;
      }

      .text-danger {
          color: #dc3545 !important;
      }

      .text-warning {
          color: #ffc107 !important;
      }

      .text-info {
          color: #17a2b8 !important;
      }

      /* å ±è¡¨å…§å®¹æ¨£å¼ */
      .report-content {
          background: white;
          border-radius: 10px;
          padding: 20px;
      }

      .report-summary {
          margin-bottom: 30px;
      }

      .report-summary h4 {
          color: #333;
          margin-bottom: 20px;
          padding-bottom: 10px;
          border-bottom: 2px solid #e1e5e9;
      }

      .report-details {
          margin-top: 30px;
      }

      .report-details h4 {
          color: #333;
          margin-bottom: 20px;
          padding-bottom: 10px;
          border-bottom: 2px solid #e1e5e9;
      }

      /* è¼‰å…¥éª¨æ¶å±å‹•ç•« */
      .skeleton-card {
          background: white;
          border-radius: 10px;
          padding: 20px;
          margin-bottom: 20px;
      }

      .skeleton-header {
          height: 24px;
          background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
          background-size: 200% 100%;
          animation: loading 1.5s infinite;
          border-radius: 4px;
          margin-bottom: 15px;
          width: 60%;
      }

      .skeleton-line {
          height: 16px;
          background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
          background-size: 200% 100%;
          animation: loading 1.5s infinite;
          border-radius: 4px;
          margin-bottom: 10px;
      }

      .skeleton-line:nth-child(odd) {
          width: 90%;
      }

      .skeleton-line:nth-child(even) {
          width: 70%;
      }

      /* ç„¡éšœç¤™è¼”åŠ©æ¨£å¼ */
      .sr-only {
          position: absolute;
          width: 1px;
          height: 1px;
          padding: 0;
          margin: -1px;
          overflow: hidden;
          clip: rect(0, 0, 0, 0);
          white-space: nowrap;
          border: 0;
      }

      /* é«˜å°æ¯”åº¦æ¨¡å¼ */
      @media (prefers-contrast: high) {
          .btn {
              border: 2px solid;
          }
          
          .card {
              border: 1px solid #333;
          }
          
          .alert {
              border: 2px solid;
          }
      }

      /* æ¸›å°‘å‹•ç•«æ¨¡å¼ */
      @media (prefers-reduced-motion: reduce) {
          * {
              animation-duration: 0.01ms !important;
              animation-iteration-count: 1 !important;
              transition-duration: 0.01ms !important;
          }
      }

      /* åˆ—å°å°ˆç”¨æ¨£å¼ */
      @media print {
          .no-print {
              display: none !important;
          }
          
          .print-only {
              display: block !important;
          }
          
          body {
              font-size: 12pt;
              line-height: 1.4;
          }
          
          .card {
              page-break-inside: avoid;
              border: 1px solid #000;
              margin-bottom: 20pt;
          }
          
          table {
              page-break-inside: auto;
          }
          
          tr {
              page-break-inside: avoid;
              page-break-after: auto;
          }
          
          thead {
              display: table-header-group;
          }
          
          .page-break {
              page-break-before: always;
          }
      }

      /* éŒ¯èª¤è™•ç†æ¨£å¼ */
      .error-boundary {
          padding: 40px;
          text-align: center;
          color: #dc3545;
          background: #f8d7da;
          border: 1px solid #f5c6cb;
          border-radius: 10px;
          margin: 20px 0;
      }

      .error-boundary h3 {
          margin-bottom: 15px;
      }

      .error-boundary p {
          margin-bottom: 20px;
      }

      /* ç¶²è·¯ç‹€æ…‹æŒ‡ç¤ºå™¨ */
      .network-status {
          position: fixed;
          top: 10px;
          right: 10px;
          padding: 8px 15px;
          border-radius: 20px;
          font-size: 0.875rem;
          font-weight: 600;
          z-index: 9999;
          transition: all 0.3s ease;
      }

      .network-status.online {
          background: #d4edda;
          color: #155724;
          border: 1px solid #c3e6cb;
      }

      .network-status.offline {
          background: #f8d7da;
          color: #721c24;
          border: 1px solid #f5c6cb;
      }

      /* è‡ªå®šç¾©æ²è»¸ */
      ::-webkit-scrollbar {
          width: 8px;
          height: 8px;
      }

      ::-webkit-scrollbar-track {
          background: #f1f1f1;
          border-radius: 4px;
      }

      ::-webkit-scrollbar-thumb {
          background: #c1c1c1;
          border-radius: 4px;
      }

      ::-webkit-scrollbar-thumb:hover {
          background: #a8a8a8;
      }

      /* é¸å–æ–‡å­—æ¨£å¼ */
      ::selection {
          background: rgba(102, 126, 234, 0.3);
          color: inherit;
      }

      ::-moz-selection {
          background: rgba(102, 126, 234, 0.3);
          color: inherit;
      }

      /* ç„¦é»æ¨£å¼ */
      *:focus {
          outline: 2px solid #667eea;
          outline-offset: 2px;
      }

      button:focus,
      .btn:focus {
          box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.3);
      }

      /* è¡¨å–®é©—è­‰æ¨£å¼ */
      .form-group.has-error input,
      .form-group.has-error select,
      .form-group.has-error textarea {
          border-color: #dc3545;
          box-shadow: 0 0 0 0.2rem rgba(220, 53, 69, 0.25);
      }

      .form-group.has-success input,
      .form-group.has-success select,
      .form-group.has-success textarea {
          border-color: #28a745;
          box-shadow: 0 0 0 0.2rem rgba(40, 167, 69, 0.25);
      }

      .error-message {
          color: #dc3545;
          font-size: 0.875rem;
          margin-top: 5px;
          display: block;
      }

      .success-message {
          color: #28a745;
          font-size: 0.875rem;
          margin-top: 5px;
          display: block;
      }

      /* è¼‰å…¥ç‹€æ…‹æ¨£å¼ */
      .btn.loading {
          position: relative;
          color: transparent !important;
      }

      .btn.loading::after {
          content: '';
          position: absolute;
          top: 50%;
          left: 50%;
          width: 16px;
          height: 16px;
          margin: -8px 0 0 -8px;
          border: 2px solid transparent;
          border-top-color: currentColor;
          border-radius: 50%;
          animation: spin 0.8s linear infinite;
      }

      @keyframes spin {
          to {
              transform: rotate(360deg);
          }
      }

      /* æ‹–æ‹½æ¨£å¼ */
      .drag-over {
          border: 2px dashed #667eea;
          background: rgba(102, 126, 234, 0.1);
      }

      .draggable {
          cursor: move;
      }

      .draggable:hover {
          opacity: 0.8;
      }

      /* ç‰ˆé¢é…ç½®è¼”åŠ©é¡åˆ¥ */
      .d-none {
          display: none !important;
      }

      .d-block {
          display: block !important;
      }

      .d-flex {
          display: flex !important;
      }

      .justify-content-center {
          justify-content: center !important;
      }

      .justify-content-between {
          justify-content: space-between !important;
      }

      .align-items-center {
          align-items: center !important;
      }

      .text-center {
          text-align: center !important;
      }

      .text-left {
          text-align: left !important;
      }

      .text-right {
          text-align: right !important;
      }

      .mt-0 { margin-top: 0 !important; }
      .mt-1 { margin-top: 0.25rem !important; }
      .mt-2 { margin-top: 0.5rem !important; }
      .mt-3 { margin-top: 1rem !important; }
      .mt-4 { margin-top: 1.5rem !important; }
      .mt-5 { margin-top: 3rem !important; }

      .mb-0 { margin-bottom: 0 !important; }
      .mb-1 { margin-bottom: 0.25rem !important; }
      .mb-2 { margin-bottom: 0.5rem !important; }
      .mb-3 { margin-bottom: 1rem !important; }
      .mb-4 { margin-bottom: 1.5rem !important; }
      .mb-5 { margin-bottom: 3rem !important; }

      .p-0 { padding: 0 !important; }
      .p-1 { padding: 0.25rem !important; }
      .p-2 { padding: 0.5rem !important; }
      .p-3 { padding: 1rem !important; }
      .p-4 { padding: 1.5rem !important; }
      .p-5 { padding: 3rem !important; }

      /* éŸ¿æ‡‰å¼æ–‡å­—å¤§å° */
      .text-xs { font-size: 0.75rem; }
      .text-sm { font-size: 0.875rem; }
      .text-base { font-size: 1rem; }
      .text-lg { font-size: 1.125rem; }
      .text-xl { font-size: 1.25rem; }
      .text-2xl { font-size: 1.5rem; }
      .text-3xl { font-size: 1.875rem; }

      /* å­—é‡ */
      .font-light { font-weight: 300; }
      .font-normal { font-weight: 400; }
      .font-medium { font-weight: 500; }
      .font-semibold { font-weight: 600; }
      .font-bold { font-weight: 700; }

      /* åœ“è§’ */
      .rounded-none { border-radius: 0; }
      .rounded-sm { border-radius: 0.125rem; }
      .rounded { border-radius: 0.25rem; }
      .rounded-md { border-radius: 0.375rem; }
      .rounded-lg { border-radius: 0.5rem; }
      .rounded-xl { border-radius: 0.75rem; }
      .rounded-2xl { border-radius: 1rem; }
      .rounded-full { border-radius: 9999px; }

      /* é™°å½± */
      .shadow-none { box-shadow: none; }
      .shadow-sm { box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05); }
      .shadow { box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06); }
      .shadow-md { box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); }
      .shadow-lg { box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); }
      .shadow-xl { box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04); }

      /* å¯¬åº¦å’Œé«˜åº¦ */
      .w-full { width: 100%; }
      .w-auto { width: auto; }
      .h-full { height: 100%; }
      .h-auto { height: auto; }

      /* æœ€çµ‚æ¨£å¼èª¿æ•´ */
      .app-footer {
          margin-top: 50px;
          padding: 20px 0;
          text-align: center;
          color: #666;
          font-size: 0.875rem;
          border-top: 1px solid #e1e5e9;
      }

      .app-footer a {
          color: #667eea;
          text-decoration: none;
      }

      .app-footer a:hover {
          text-decoration: underline;
      }
  </style>
</head>

<body>
  <!-- ç¶²è·¯ç‹€æ…‹æŒ‡ç¤ºå™¨ -->
  <div id="networkStatus" class="network-status online">
      <span id="networkStatusText">ç·šä¸Š</span>
  </div>

  <!-- è¼‰å…¥å‹•ç•« -->
  <div id="loading" class="loading">
      <div class="spinner"></div>
      <p>è¼‰å…¥ä¸­...</p>
  </div>

  <!-- é ‚éƒ¨å°èˆª -->
  <nav class="navbar">
      <div class="container">
          <h1>å°ç£å¸•é‡‘æ£®ç—…å‹æ¬Šç›Šä¿ƒé€²æœƒ - æœƒè¨ˆç®¡ç†ç³»çµ±</h1>
          <div class="nav-info">
              <span id="currentTime"></span>
              <span>v5.0</span>
          </div>
      </div>
  </nav>

  <!-- ä¸»è¦å…§å®¹ -->
  <div class="container">
      <!-- è­¦å‘Šè¨Šæ¯å€åŸŸ -->
      <div id="alertContainer"></div>

      <!-- æ¨™ç±¤é å°èˆª -->
      <div class="tab-nav">
          <button class="tab-btn active" data-tab="dashboard">ğŸ“Š å„€è¡¨æ¿</button>
          <button class="tab-btn" data-tab="transactions">ğŸ’° äº¤æ˜“è¨˜éŒ„</button>
          <button class="tab-btn" data-tab="receipts">ğŸ§¾ æ”¶æ“šç®¡ç†</button>
          <button class="tab-btn" data-tab="vouchers">ğŸ“‹ æ”¯å‡ºæ†‘è­‰</button>
          <button class="tab-btn" data-tab="members">ğŸ‘¥ æœƒå“¡ç®¡ç†</button>
          <button class="tab-btn" data-tab="reports">ğŸ“ˆ å ±è¡¨åˆ†æ</button>
          <button class="tab-btn" data-tab="settings">âš™ï¸ ç³»çµ±è¨­å®š</button>
      </div>

      <!-- å„€è¡¨æ¿ -->
      <div id="dashboard" class="tab-content active">
          <div class="card-header">
              <h2 class="card-title">è²¡å‹™æ¦‚è¦½</h2>
              <p class="card-subtitle">æœ¬æœˆè²¡å‹™ç‹€æ³çµ±è¨ˆ</p>
          </div>

          <div class="stats-grid">
              <div class="stat-card">
                  <div class="stat-number" id="totalIncome">$0</div>
                  <div class="stat-label">æœ¬æœˆæ”¶å…¥</div>
                  <div class="stat-change positive" id="incomeChange">+0%</div>
              </div>
              <div class="stat-card">
                  <div class="stat-number" id="totalExpense">$0</div>
                  <div class="stat-label">æœ¬æœˆæ”¯å‡º</div>
                  <div class="stat-change negative" id="expenseChange">+0%</div>
              </div>
              <div class="stat-card">
                  <div class="stat-number" id="receiptCount">0</div>
                  <div class="stat-label">æœ¬æœˆæ”¶æ“š</div>
                  <div class="stat-change positive" id="receiptChange">+0</div>
              </div>
              <div class="stat-card">
                  <div class="stat-number" id="memberCount">0</div>
                  <div class="stat-label">æœƒå“¡ç¸½æ•¸</div>
                  <div class="stat-change positive" id="memberChange">+0</div>
              </div>
          </div>

          <div class="card">
              <div class="card-header">
                  <h3 class="card-title">æœ€è¿‘æ´»å‹•</h3>
              </div>
              <div id="recentActivities">
                  <div class="empty-state">
                      <h3>è¼‰å…¥ä¸­...</h3>
                      <p>æ­£åœ¨å–å¾—æœ€æ–°æ´»å‹•è¨˜éŒ„</p>
                  </div>
              </div>
          </div>
      </div>

      <!-- å…¶ä»–æ¨™ç±¤é å…§å®¹ä¿æŒä¸è®Š... -->
      <!-- ç”±æ–¼ç¯‡å¹…é™åˆ¶ï¼Œé€™è£¡çœç•¥äº†å…¶ä»–æ¨™ç±¤é çš„å®Œæ•´HTMLå…§å®¹ -->
      <!-- å¯¦éš›ä½¿ç”¨æ™‚éœ€è¦åŒ…å«æ‰€æœ‰æ¨™ç±¤é çš„å®Œæ•´å…§å®¹ -->

  </div>

  <!-- æ‡‰ç”¨ç¨‹å¼é è…³ -->
  <footer class="app-footer">
      <div class="container">
          <p>&copy; 2024 å°ç£å¸•é‡‘æ£®ç—…å‹æ¬Šç›Šä¿ƒé€²æœƒ. ç‰ˆæ¬Šæ‰€æœ‰ | 
             <a href="#" onclick="showModal('é—œæ–¼ç³»çµ±', getAboutContent())">é—œæ–¼ç³»çµ±</a> | 
             <a href="#" onclick="showModal('ä½¿ç”¨èªªæ˜', getHelpContent())">ä½¿ç”¨èªªæ˜</a> | 
             <a href="#" onclick="showModal('è¯çµ¡æˆ‘å€‘', getContactContent())">è¯çµ¡æˆ‘å€‘</a>
          </p>
          <p>ç³»çµ±ç‰ˆæœ¬ï¼šv5.0 | æœ€å¾Œæ›´æ–°ï¼š2024å¹´12æœˆ</p>
      </div>
  </footer>

  <!-- æ¨¡æ…‹æ¡† -->
  <div id="modal" class="modal">
      <div class="modal-content">
          <div class="modal-header">
              <h3 class="modal-title" id="modalTitle">æ¨™é¡Œ</h3>
              <button class="modal-close" onclick="closeModal()" aria-label="é—œé–‰">&times;</button>
          </div>
          <div id="modalBody">
              å…§å®¹
          </div>
          <div class="btn-group" style="margin-top: 20px;">
              <button type="button" class="btn btn-secondary" onclick="closeModal()">é—œé–‰</button>
          </div>
      </div>
  </div>

  <script>
      // ç¶²è·¯ç‹€æ…‹ç›£æ§
      function updateNetworkStatus() {
          const statusEl = document.getElementById('networkStatus');
          const textEl = document.getElementById('networkStatusText');
          
          if (navigator.onLine) {
              statusEl.className = 'network-status online';
              textEl.textContent = 'ç·šä¸Š';
          } else {
              statusEl.className = 'network-status offline';
              textEl.textContent = 'é›¢ç·š';
          }
      }

      // ç›£è½ç¶²è·¯ç‹€æ…‹è®ŠåŒ–
      window.addEventListener('online', updateNetworkStatus);
      window.addEventListener('offline', updateNetworkStatus);

      // éŒ¯èª¤è™•ç†
      window.addEventListener('error', function(e) {
          console.error('å…¨åŸŸéŒ¯èª¤:', e.error);
          showAlert('error', 'ç³»çµ±ç™¼ç”ŸéŒ¯èª¤ï¼Œè«‹é‡æ–°æ•´ç†é é¢æˆ–è¯çµ¡ç®¡ç†å“¡');
      });

      window.addEventListener('unhandledrejection', function(e) {
          console.error('æœªè™•ç†çš„Promiseæ‹’çµ•:', e.reason);
          showAlert('error', 'æ“ä½œå¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦');
      });

      // ç³»çµ±è³‡è¨Šå…§å®¹
      function getAboutContent() {
          return `
              <div class="text-center">
                  <h4>å°ç£å¸•é‡‘æ£®ç—…å‹æ¬Šç›Šä¿ƒé€²æœƒ</h4>
                  <h5>æœƒè¨ˆç®¡ç†ç³»çµ± v5.0</h5>
                  <hr>
                  <p><strong>ç³»çµ±ç‰¹è‰²ï¼š</strong></p>
                  <ul class="text-left">
                      <li>å®Œæ•´çš„è²¡å‹™ç®¡ç†åŠŸèƒ½</li>
                      <li>è‡ªå‹•åŒ–æ”¶æ“šé–‹ç«‹ç³»çµ±</li>
                      <li>æ”¯å‡ºæ†‘è­‰ç”³è«‹èˆ‡å¯©æ ¸</li>
                      <li>æœƒå“¡è³‡æ–™ç®¡ç†</li>
                      <li>å¤šæ¨£åŒ–å ±è¡¨ç”¢ç”Ÿ</li>
                      <li>éŸ¿æ‡‰å¼ç¶²é è¨­è¨ˆ</li>
                      <li>è³‡æ–™å®‰å…¨ä¿è­·</li>
                  </ul>
                  <hr>
                  <p><strong>æŠ€è¡“è¦æ ¼ï¼š</strong></p>
                  <p>å‰ç«¯ï¼šHTML5, CSS3, JavaScript ES6+<br>
                     å¾Œç«¯ï¼šGoogle Apps Script<br>
                     è³‡æ–™åº«ï¼šGoogle Sheets<br>
                     é›²ç«¯å¹³å°ï¼šGoogle Cloud Platform</p>
              </div>
          `;
      }

      function getHelpContent() {
          return `
              <div>
                  <h4>ç³»çµ±ä½¿ç”¨èªªæ˜</h4>
                  <hr>
                  <h5>ğŸ“Š å„€è¡¨æ¿</h5>
                  <p>æŸ¥çœ‹è²¡å‹™æ¦‚è¦½å’Œæœ€è¿‘æ´»å‹•è¨˜éŒ„ã€‚</p>
                  
                  <h5>ğŸ’° äº¤æ˜“è¨˜éŒ„</h5>
                  <p>æ–°å¢ã€æŸ¥çœ‹å’Œç®¡ç†æ‰€æœ‰æ”¶æ”¯äº¤æ˜“ã€‚æ”¯æ´æœå°‹å’Œç¯©é¸åŠŸèƒ½ã€‚</p>
                  
                  <h5>ğŸ§¾ æ”¶æ“šç®¡ç†</h5>
                  <p>é–‹ç«‹ææ¬¾æ”¶æ“šï¼Œæ”¯æ´è‡ªå‹•å¯„é€åŠŸèƒ½ã€‚</p>
                  
                  <h5>ğŸ“‹ æ”¯å‡ºæ†‘è­‰</h5>
                  <p>ç”³è«‹å’Œå¯©æ ¸æ”¯å‡ºæ†‘è­‰ï¼Œç¢ºä¿è²¡å‹™é€æ˜ã€‚</p>
                  
                  <h5>ğŸ‘¥ æœƒå“¡ç®¡ç†</h5>
                  <p>ç®¡ç†æœƒå“¡åŸºæœ¬è³‡æ–™å’Œæœƒç±ç‹€æ…‹ã€‚</p>
                  
                  <h5>ğŸ“ˆ å ±è¡¨åˆ†æ</h5>
                  <p>ç”¢ç”Ÿå„ç¨®è²¡å‹™å’Œçµ±è¨ˆå ±è¡¨ï¼Œæ”¯æ´Excelå’ŒPDFåŒ¯å‡ºã€‚</p>
                  
                  <h5>âš™ï¸ ç³»çµ±è¨­å®š</h5>
                  <p>é…ç½®çµ„ç¹”è³‡è¨Šå’Œç³»çµ±åƒæ•¸ã€‚</p>
                  
                  <hr>
                  <p><strong>å¿«æ·éµï¼š</strong></p>
                  <ul>
                      <li>ESCï¼šé—œé–‰å½ˆå‡ºè¦–çª—</li>
                      <li>Ctrl+Sï¼šå„²å­˜è¡¨å–®ï¼ˆéƒ¨åˆ†é é¢ï¼‰</li>
                  </ul>
              </div>
          `;
      }

      function getContactContent() {
          return `
              <div class="text-center">
                  <h4>è¯çµ¡è³‡è¨Š</h4>
                  <hr>
                  <p><strong>å°ç£å¸•é‡‘æ£®ç—…å‹æ¬Šç›Šä¿ƒé€²æœƒ</strong></p>
                  <p>ğŸ“ åœ°å€ï¼š[è«‹å¡«å…¥å¯¦éš›åœ°å€]</p>
                  <p>ğŸ“ é›»è©±ï¼š[è«‹å¡«å…¥å¯¦éš›é›»è©±]</p>
                  <p>ğŸ“§ ä¿¡ç®±ï¼š[è«‹å¡«å…¥å¯¦éš›ä¿¡ç®±]</p>
                  <p>ğŸŒ ç¶²ç«™ï¼š[è«‹å¡«å…¥å¯¦éš›ç¶²ç«™]</p>
                  <hr>
                  <p><strong>ç³»çµ±æŠ€è¡“æ”¯æ´ï¼š</strong></p>
                  <p>å¦‚é‡ç³»çµ±å•é¡Œï¼Œè«‹è¯çµ¡æŠ€è¡“æ”¯æ´åœ˜éšŠ</p>
                  <p>ğŸ“§ æŠ€è¡“æ”¯æ´ä¿¡ç®±ï¼š[è«‹å¡«å…¥æŠ€è¡“æ”¯æ´ä¿¡ç®±]</p>
                  <hr>
                  <p><em>æœå‹™æ™‚é–“ï¼šé€±ä¸€è‡³é€±äº” 09:00-17:00</em></p>
              </div>
          `;
      }

      // åˆå§‹åŒ–ç¶²è·¯ç‹€æ…‹
      updateNetworkStatus();

      // ç³»çµ±åˆå§‹åŒ–å®Œæˆæç¤º
      document.addEventListener('DOMContentLoaded', function() {
          console.log('ğŸ‰ å°ç£å¸•é‡‘æ£®ç—…å‹æ¬Šç›Šä¿ƒé€²æœƒæœƒè¨ˆç®¡ç†ç³»çµ± v5.0 åˆå§‹åŒ–å®Œæˆ');
          console.log('ğŸ“± éŸ¿æ‡‰å¼è¨­è¨ˆå·²å•Ÿç”¨');
          console.log('ğŸ”’ å®‰å…¨åŠŸèƒ½å·²è¼‰å…¥');
          console.log('â™¿ ç„¡éšœç¤™åŠŸèƒ½å·²å•Ÿç”¨');
          
          // éš±è—è¼‰å…¥ç•«é¢
          setTimeout(() => {
              hideLoading();
          }, 1000);
      });

      // æœå‹™å·¥ä½œè€…è¨»å†Šï¼ˆPWAæ”¯æ´ï¼‰
      if ('serviceWorker' in navigator) {
          window.addEventListener('load', function() {
              navigator.serviceWorker.register('/sw.js')
                  .then(function(registration) {
                      console.log('ServiceWorker è¨»å†ŠæˆåŠŸ:', registration.scope);
                  })
                  .catch(function(error) {
                      console.log('ServiceWorker è¨»å†Šå¤±æ•—:', error);
                  });
          });
      }
  </script>
</body>
</html>
              
