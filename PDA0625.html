<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å°ç£å¸•é‡‘æ£®ç—…å‹æ¬Šç›Šä¿ƒé€²æœƒ - æœƒè¨ˆç®¡ç†ç³»çµ±</title>
  
  <!-- CSS æ¨£å¼ -->
  <style>
      /* åŸºç¤æ¨£å¼é‡ç½® */
      * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
      }

      body {
          font-family: 'Microsoft JhengHei', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
          line-height: 1.6;
          color: #333;
          background-color: #f8f9fa;
      }

      /* é ‚éƒ¨å°èˆª */
      .navbar {
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          color: white;
          padding: 1rem 0;
          box-shadow: 0 2px 10px rgba(0,0,0,0.1);
          position: sticky;
          top: 0;
          z-index: 1000;
      }

      .navbar .container {
          max-width: 1200px;
          margin: 0 auto;
          padding: 0 20px;
          display: flex;
          justify-content: space-between;
          align-items: center;
      }

      .navbar h1 {
          font-size: 1.5rem;
          font-weight: 600;
      }

      .navbar .nav-info {
          display: flex;
          align-items: center;
          gap: 20px;
          font-size: 0.9rem;
      }

      /* ä¸»è¦å®¹å™¨ */
      .container {
          max-width: 1200px;
          margin: 0 auto;
          padding: 20px;
      }

      /* è¼‰å…¥å‹•ç•« */
      .loading {
          display: none;
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: rgba(255, 255, 255, 0.9);
          z-index: 9999;
          justify-content: center;
          align-items: center;
      }

      .loading.show {
          display: flex;
      }

      .spinner {
          width: 50px;
          height: 50px;
          border: 4px solid #f3f3f3;
          border-top: 4px solid #667eea;
          border-radius: 50%;
          animation: spin 1s linear infinite;
      }

      @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
      }

      /* æ¨™ç±¤é å°èˆª */
      .tab-nav {
          display: flex;
          background: white;
          border-radius: 10px;
          box-shadow: 0 2px 10px rgba(0,0,0,0.1);
          margin-bottom: 20px;
          overflow: hidden;
      }

      .tab-nav button {
          flex: 1;
          padding: 15px 20px;
          border: none;
          background: white;
          color: #666;
          cursor: pointer;
          transition: all 0.3s ease;
          font-size: 1rem;
          font-weight: 500;
      }

      .tab-nav button:hover {
          background: #f8f9fa;
          color: #333;
      }

      .tab-nav button.active {
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          color: white;
      }

      /* æ¨™ç±¤é å…§å®¹ */
      .tab-content {
          display: none;
          background: white;
          border-radius: 10px;
          box-shadow: 0 2px 10px rgba(0,0,0,0.1);
          padding: 30px;
          margin-bottom: 20px;
      }

      .tab-content.active {
          display: block;
          animation: fadeIn 0.3s ease-in;
      }

      @keyframes fadeIn {
          from { opacity: 0; transform: translateY(10px); }
          to { opacity: 1; transform: translateY(0); }
      }

      /* è¡¨å–®æ¨£å¼ */
      .form-group {
          margin-bottom: 20px;
      }

      .form-row {
          display: flex;
          gap: 20px;
          margin-bottom: 20px;
      }

      .form-row .form-group {
          flex: 1;
          margin-bottom: 0;
      }

      label {
          display: block;
          margin-bottom: 8px;
          font-weight: 500;
          color: #555;
      }

      input, select, textarea {
          width: 100%;
          padding: 12px 15px;
          border: 2px solid #e1e5e9;
          border-radius: 8px;
          font-size: 1rem;
          transition: all 0.3s ease;
          background: white;
      }

      input:focus, select:focus, textarea:focus {
          outline: none;
          border-color: #667eea;
          box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
      }

      textarea {
          resize: vertical;
          min-height: 100px;
      }

      /* æŒ‰éˆ•æ¨£å¼ */
      .btn {
          padding: 12px 24px;
          border: none;
          border-radius: 8px;
          font-size: 1rem;
          font-weight: 500;
          cursor: pointer;
          transition: all 0.3s ease;
          text-decoration: none;
          display: inline-block;
          text-align: center;
          line-height: 1.4;
      }

      .btn-primary {
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          color: white;
      }

      .btn-primary:hover {
          transform: translateY(-2px);
          box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
      }

      .btn-secondary {
          background: #6c757d;
          color: white;
      }

      .btn-secondary:hover {
          background: #5a6268;
          transform: translateY(-2px);
      }

      .btn-success {
          background: #28a745;
          color: white;
      }

      .btn-success:hover {
          background: #218838;
          transform: translateY(-2px);
      }

      .btn-danger {
          background: #dc3545;
          color: white;
      }

      .btn-danger:hover {
          background: #c82333;
          transform: translateY(-2px);
      }

      .btn-warning {
          background: #ffc107;
          color: #212529;
      }

      .btn-warning:hover {
          background: #e0a800;
          transform: translateY(-2px);
      }

      .btn-info {
          background: #17a2b8;
          color: white;
      }

      .btn-info:hover {
          background: #138496;
          transform: translateY(-2px);
      }

      .btn-group {
          display: flex;
          gap: 10px;
          margin-top: 20px;
      }

      .btn-sm {
          padding: 8px 16px;
          font-size: 0.875rem;
      }

      .btn:disabled {
          opacity: 0.6;
          cursor: not-allowed;
          transform: none !important;
      }

      /* è¡¨æ ¼æ¨£å¼ */
      .table-container {
          overflow-x: auto;
          margin: 20px 0;
          border-radius: 10px;
          box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      }

      table {
          width: 100%;
          border-collapse: collapse;
          background: white;
      }

      th, td {
          padding: 15px;
          text-align: left;
          border-bottom: 1px solid #e1e5e9;
      }

      th {
          background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
          font-weight: 600;
          color: #495057;
          position: sticky;
          top: 0;
          z-index: 10;
      }

      tr:hover {
          background-color: #f8f9fa;
      }

      tr:last-child td {
          border-bottom: none;
      }

      /* æœå°‹å’Œç¯©é¸å€åŸŸ */
      .search-filters {
          background: white;
          padding: 20px;
          border-radius: 10px;
          box-shadow: 0 2px 10px rgba(0,0,0,0.1);
          margin-bottom: 20px;
      }

      .search-row {
          display: flex;
          gap: 15px;
          align-items: end;
          flex-wrap: wrap;
      }

      .search-group {
          flex: 1;
          min-width: 200px;
      }

      /* çµ±è¨ˆå¡ç‰‡ */
      .stats-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
          gap: 20px;
          margin-bottom: 30px;
      }

      .stat-card {
          background: white;
          padding: 25px;
          border-radius: 15px;
          box-shadow: 0 5px 15px rgba(0,0,0,0.08);
          text-align: center;
          transition: transform 0.3s ease;
          position: relative;
          overflow: hidden;
      }

      .stat-card:hover {
          transform: translateY(-5px);
      }

      .stat-card::before {
          content: '';
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          height: 4px;
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      }

      .stat-value {
          font-size: 2.5rem;
          font-weight: bold;
          color: #667eea;
          margin-bottom: 10px;
      }

      .stat-label {
          font-size: 1.1rem;
          color: #666;
          font-weight: 500;
      }

      .stat-change {
          font-size: 0.9rem;
          margin-top: 8px;
      }

      .stat-change.positive {
          color: #28a745;
      }

      .stat-change.negative {
          color: #dc3545;
      }

      /* è­¦å‘Šå’Œè¨Šæ¯ */
      .alert {
          padding: 15px 20px;
          border-radius: 8px;
          margin-bottom: 20px;
          border-left: 4px solid;
          display: none;
      }

      .alert.show {
          display: block;
          animation: slideDown 0.3s ease;
      }

      @keyframes slideDown {
          from { opacity: 0; transform: translateY(-10px); }
          to { opacity: 1; transform: translateY(0); }
      }

      .alert-success {
          background-color: #d4edda;
          border-color: #28a745;
          color: #155724;
      }

      .alert-danger {
          background-color: #f8d7da;
          border-color: #dc3545;
          color: #721c24;
      }

      .alert-warning {
          background-color: #fff3cd;
          border-color: #ffc107;
          color: #856404;
      }

      .alert-info {
          background-color: #cce7ff;
          border-color: #17a2b8;
          color: #0c5460;
      }

      /* æ¨¡æ…‹æ¡† */
      .modal {
          display: none;
          position: fixed;
          z-index: 2000;
          left: 0;
          top: 0;
          width: 100%;
          height: 100%;
          background-color: rgba(0,0,0,0.5);
          backdrop-filter: blur(5px);
      }

      .modal.show {
          display: flex;
          justify-content: center;
          align-items: center;
          animation: fadeIn 0.3s ease;
      }

      .modal-content {
          background-color: white;
          padding: 30px;
          border-radius: 15px;
          width: 90%;
          max-width: 600px;
          max-height: 90vh;
          overflow-y: auto;
          box-shadow: 0 10px 30px rgba(0,0,0,0.3);
          position: relative;
          animation: slideUp 0.3s ease;
      }

      @keyframes slideUp {
          from { opacity: 0; transform: translateY(30px); }
          to { opacity: 1; transform: translateY(0); }
      }

      .modal-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 20px;
          padding-bottom: 15px;
          border-bottom: 2px solid #e1e5e9;
      }

      .modal-title {
          font-size: 1.5rem;
          font-weight: 600;
          color: #333;
      }

      .close {
          background: none;
          border: none;
          font-size: 1.5rem;
          cursor: pointer;
          color: #666;
          padding: 5px;
          border-radius: 50%;
          width: 35px;
          height: 35px;
          display: flex;
          align-items: center;
          justify-content: center;
          transition: all 0.3s ease;
      }

      .close:hover {
          background-color: #f8f9fa;
          color: #333;
      }

      /* åˆ†é  */
      .pagination {
          display: flex;
          justify-content: center;
          align-items: center;
          gap: 10px;
          margin: 20px 0;
      }

      .pagination button {
          padding: 8px 12px;
          border: 1px solid #dee2e6;
          background: white;
          color: #495057;
          border-radius: 5px;
          cursor: pointer;
          transition: all 0.3s ease;
      }

      .pagination button:hover:not(:disabled) {
          background: #e9ecef;
          border-color: #adb5bd;
      }

      .pagination button.active {
          background: #667eea;
          border-color: #667eea;
          color: white;
      }

      .pagination button:disabled {
          opacity: 0.5;
          cursor: not-allowed;
      }

      /* å·¥å…·åˆ— */
      .toolbar {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 20px;
          flex-wrap: wrap;
          gap: 15px;
      }

      .toolbar-left, .toolbar-right {
          display: flex;
          gap: 10px;
          align-items: center;
      }

      /* æ¨™ç±¤ */
      .badge {
          display: inline-block;
          padding: 4px 8px;
          font-size: 0.75rem;
          font-weight: 500;
          border-radius: 12px;
          text-align: center;
          white-space: nowrap;
      }

      .badge-success {
          background-color: #28a745;
          color: white;
      }

      .badge-danger {
          background-color: #dc3545;
          color: white;
      }

      .badge-warning {
          background-color: #ffc107;
          color: #212529;
      }

      .badge-info {
          background-color: #17a2b8;
          color: white;
      }

      .badge-secondary {
          background-color: #6c757d;
          color: white;
      }

      /* é€²åº¦æ¢ */
      .progress {
          width: 100%;
          height: 8px;
          background-color: #e9ecef;
          border-radius: 4px;
          overflow: hidden;
          margin: 10px 0;
      }

      .progress-bar {
          height: 100%;
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          border-radius: 4px;
          transition: width 0.3s ease;
      }

      /* åœ–è¡¨å®¹å™¨ */
      .chart-container {
          background: white;
          padding: 25px;
          border-radius: 10px;
          box-shadow: 0 2px 10px rgba(0,0,0,0.1);
          margin-bottom: 20px;
      }

      .chart-title {
          font-size: 1.25rem;
          font-weight: 600;
          margin-bottom: 20px;
          color: #333;
          text-align: center;
      }

      /* éŸ¿æ‡‰å¼è¨­è¨ˆ */
      @media (max-width: 768px) {
          .container {
              padding: 10px;
          }

          .navbar .container {
              padding: 0 15px;
          }

          .navbar h1 {
              font-size: 1.25rem;
          }

          .navbar .nav-info {
              display: none;
          }

          .tab-nav {
              flex-direction: column;
          }

          .tab-nav button {
              border-radius: 0;
          }

          .form-row {
              flex-direction: column;
              gap: 0;
          }

          .search-row {
              flex-direction: column;
              align-items: stretch;
          }

          .search-group {
              min-width: auto;
          }

          .stats-grid {
              grid-template-columns: 1fr;
          }

          .toolbar {
              flex-direction: column;
              align-items: stretch;
          }

          .toolbar-left, .toolbar-right {
              justify-content: center;
          }

          .btn-group {
              flex-direction: column;
          }

          .table-container {
              font-size: 0.875rem;
          }

          th, td {
              padding: 10px 8px;
          }

          .modal-content {
              width: 95%;
              padding: 20px;
              margin: 10px;
          }
      }

      @media (max-width: 480px) {
          .tab-content {
              padding: 20px 15px;
          }

          .stat-value {
              font-size: 2rem;
          }

          .btn {
              padding: 10px 20px;
              font-size: 0.9rem;
          }
      }

      /* è‡ªå®šç¾©æ»¾å‹•æ¢ */
      ::-webkit-scrollbar {
          width: 8px;
          height: 8px;
      }

      ::-webkit-scrollbar-track {
          background: #f1f1f1;
          border-radius: 4px;
      }

      ::-webkit-scrollbar-thumb {
          background: #c1c1c1;
          border-radius: 4px;
      }

      ::-webkit-scrollbar-thumb:hover {
          background: #a8a8a8;
      }

      /* å‹•ç•«æ•ˆæœ */
      .fade-in {
          animation: fadeIn 0.5s ease-in;
      }

      .slide-up {
          animation: slideUp 0.5s ease-out;
      }

      .bounce-in {
          animation: bounceIn 0.6s ease-out;
      }

      @keyframes bounceIn {
          0% { opacity: 0; transform: scale(0.3); }
          50% { opacity: 1; transform: scale(1.05); }
          70% { transform: scale(0.9); }
          100% { opacity: 1; transform: scale(1); }
      }

      /* å·¥å…·æç¤º */
      .tooltip {
          position: relative;
          display: inline-block;
      }

      .tooltip .tooltiptext {
          visibility: hidden;
          width: 200px;
          background-color: #333;
          color: #fff;
          text-align: center;
          border-radius: 6px;
          padding: 8px;
          position: absolute;
          z-index: 1001;
          bottom: 125%;
          left: 50%;
          margin-left: -100px;
          opacity: 0;
          transition: opacity 0.3s;
          font-size: 0.875rem;
      }

      .tooltip .tooltiptext::after {
          content: "";
          position: absolute;
          top: 100%;
          left: 50%;
          margin-left: -5px;
          border-width: 5px;
          border-style: solid;
          border-color: #333 transparent transparent transparent;
      }

      .tooltip:hover .tooltiptext {
          visibility: visible;
          opacity: 1;
      }

      /* ç©ºç‹€æ…‹ */
      .empty-state {
          text-align: center;
          padding: 60px 20px;
          color: #6c757d;
      }

      .empty-state-icon {
          font-size: 4rem;
          margin-bottom: 20px;
          opacity: 0.5;
      }

      .empty-state-title {
          font-size: 1.5rem;
          font-weight: 600;
          margin-bottom: 10px;
      }

      .empty-state-description {
          font-size: 1rem;
          margin-bottom: 20px;
      }

      /* æ‰“å°æ¨£å¼ */
      @media print {
          .navbar, .tab-nav, .toolbar, .btn, .search-filters {
              display: none !important;
          }

          .tab-content {
              box-shadow: none;
              border: none;
              padding: 0;
          }

          .container {
              max-width: none;
              padding: 0;
          }

          body {
              background: white;
          }

          table {
              font-size: 12px;
          }

          th, td {
              padding: 8px;
          }
      }
  </style>
</head>
<body>
  <!-- è¼‰å…¥å‹•ç•« -->
  <div id="loading" class="loading">
      <div class="spinner"></div>
  </div>

  <!-- é ‚éƒ¨å°èˆª -->
  <nav class="navbar">
      <div class="container">
          <h1>å°ç£å¸•é‡‘æ£®ç—…å‹æ¬Šç›Šä¿ƒé€²æœƒ - æœƒè¨ˆç®¡ç†ç³»çµ±</h1>
          <div class="nav-info">
              <span id="currentUser">è¼‰å…¥ä¸­...</span>
              <span id="currentTime"></span>
              <span id="systemStatus" class="badge badge-success">ç³»çµ±æ­£å¸¸</span>
          </div>
      </div>
  </nav>

  <!-- ä¸»è¦å…§å®¹å€åŸŸ -->
  <div class="container">
      <!-- ç³»çµ±ç‹€æ…‹è­¦å‘Š -->
      <div id="systemAlert" class="alert alert-warning">
          <strong>ç³»çµ±æé†’ï¼š</strong> <span id="alertMessage"></span>
      </div>

      <!-- çµ±è¨ˆè³‡è¨Šå¡ç‰‡ -->
      <div id="statsGrid" class="stats-grid">
          <div class="stat-card">
              <div class="stat-value" id="totalIncome">-</div>
              <div class="stat-label">æœ¬æœˆç¸½æ”¶å…¥</div>
              <div class="stat-change positive" id="incomeChange">-</div>
          </div>
          <div class="stat-card">
              <div class="stat-value" id="totalExpense">-</div>
              <div class="stat-label">æœ¬æœˆç¸½æ”¯å‡º</div>
              <div class="stat-change negative" id="expenseChange">-</div>
          </div>
          <div class="stat-card">
              <div class="stat-value" id="netAmount">-</div>
              <div class="stat-label">æœ¬æœˆæ·¨é¡</div>
              <div class="stat-change" id="netChange">-</div>
          </div>
          <div class="stat-card">
              <div class="stat-value" id="totalMembers">-</div>
              <div class="stat-label">æœƒå“¡ç¸½æ•¸</div>
              <div class="stat-change positive" id="memberChange">-</div>
          </div>
      </div>

      <!-- æ¨™ç±¤é å°èˆª -->
      <div class="tab-nav">
          <button class="tab-btn active" data-tab="dashboard">å„€è¡¨æ¿</button>
          <button class="tab-btn" data-tab="transactions">äº¤æ˜“ç®¡ç†</button>
          <button class="tab-btn" data-tab="receipts">æ”¶æ“šç®¡ç†</button>
          <button class="tab-btn" data-tab="vouchers">æ†‘è­‰ç®¡ç†</button>
          <button class="tab-btn" data-tab="members">æœƒå“¡ç®¡ç†</button>
          <button class="tab-btn" data-tab="reports">å ±è¡¨åˆ†æ</button>
          <button class="tab-btn" data-tab="settings">ç³»çµ±è¨­å®š</button>
      </div>

      <!-- å„€è¡¨æ¿æ¨™ç±¤é  -->
      <div id="dashboard" class="tab-content active">
          <h2>ç³»çµ±å„€è¡¨æ¿</h2>
          
          <!-- å¿«é€Ÿæ“ä½œ -->
          <div class="toolbar">
              <div class="toolbar-left">
                  <h3>å¿«é€Ÿæ“ä½œ</h3>
              </div>
              <div class="toolbar-right">
                  <button class="btn btn-primary" onclick="showAddTransactionModal()">
                      â• æ–°å¢äº¤æ˜“
                  </button>
                  <button class="btn btn-success" onclick="showAddReceiptModal()">
                      ğŸ“„ é–‹ç«‹æ”¶æ“š
                  </button>
                  <button class="btn btn-info" onclick="showAddMemberModal()">
                      ğŸ‘¥ æ–°å¢æœƒå“¡
                  </button>
              </div>
          </div>

          <!-- æœ€è¿‘äº¤æ˜“ -->
          <div class="chart-container">
              <h3 class="chart-title">æœ€è¿‘äº¤æ˜“è¨˜éŒ„</h3>
              <div id="recentTransactions">
                  <div class="empty-state">
                      <div class="empty-state-icon">ğŸ“Š</div>
                      <div class="empty-state-title">è¼‰å…¥ä¸­...</div>
                      <div class="empty-state-description">æ­£åœ¨è¼‰å…¥æœ€è¿‘çš„äº¤æ˜“è¨˜éŒ„</div>
                  </div>
              </div>
          </div>

          <!-- æœˆåº¦è¶¨å‹¢åœ– -->
          <div class="chart-container">
              <h3 class="chart-title">æœˆåº¦æ”¶æ”¯è¶¨å‹¢</h3>
              <div id="monthlyChart">
                  <canvas id="trendChart" width="400" height="200"></canvas>
              </div>
          </div>
      </div>

      <!-- äº¤æ˜“ç®¡ç†æ¨™ç±¤é  -->
      <div id="transactions" class="tab-content">
          <h2>äº¤æ˜“ç®¡ç†</h2>
          
          <!-- æœå°‹å’Œç¯©é¸ -->
          <div class="search-filters">
              <div class="search-row">
                  <div class="search-group">
                      <label for="transactionSearch">æœå°‹</label>
                      <input type="text" id="transactionSearch" placeholder="æœå°‹äº¤æ˜“å°è±¡ã€èªªæ˜...">
                  </div>
                  <div class="search-group">
                      <label for="transactionType">æ”¶æ”¯é¡å‹</label>
                      <select id="transactionType">
                          <option value="">å…¨éƒ¨</option>
                          <option value="æ”¶å…¥">æ”¶å…¥</option>
                          <option value="æ”¯å‡º">æ”¯å‡º</option>
                      </select>
                  </div>
                  <div class="search-group">
                      <label for="transactionCategory">é¡åˆ¥</label>
                      <select id="transactionCategory">
                          <option value="">å…¨éƒ¨é¡åˆ¥</option>
                      </select>
                  </div>
                  <div class="search-group">
                      <label for="dateFrom">é–‹å§‹æ—¥æœŸ</label>
                      <input type="date" id="dateFrom">
                  </div>
                  <div class="search-group">
                      <label for="dateTo">çµæŸæ—¥æœŸ</label>
                      <input type="date" id="dateTo">
                  </div>
                  <div class="search-group">
                      <label>&nbsp;</label>
                      <button class="btn btn-primary" onclick="searchTransactions()">ğŸ” æœå°‹</button>
                  </div>
              </div>
          </div>

          <!-- å·¥å…·åˆ— -->
          <div class="toolbar">
              <div class="toolbar-left">
                  <button class="btn btn-primary" onclick="showAddTransactionModal()">
                      â• æ–°å¢äº¤æ˜“
                  </button>
                  <button class="btn btn-success" onclick="exportTransactions()">
                      ğŸ“¤ åŒ¯å‡ºè³‡æ–™
                  </button>
              </div>
              <div class="toolbar-right">
                  <span id="transactionCount">å…± 0 ç­†è¨˜éŒ„</span>
              </div>
          </div>

          <!-- äº¤æ˜“åˆ—è¡¨ -->
          <div class="table-container">
              <table id="transactionTable">
                  <thead>
                      <tr>
                          <th>æ—¥æœŸ</th>
                          <th>é¡å‹</th>
                          <th>é¡åˆ¥</th>
                          <th>é‡‘é¡</th>
                          <th>äº¤æ˜“å°è±¡</th>
                          <th>å¸³æˆ¶</th>
                          <th>èªªæ˜</th>
                          <th>ç‹€æ…‹</th>
                          <th>æ“ä½œ</th>
                      </tr>
                  </thead>
                  <tbody>
                      <tr>
                          <td colspan="9" class="empty-state">
                              <div class="empty-state-icon">ğŸ’°</div>
                              <div class="empty-state-title">æš«ç„¡äº¤æ˜“è¨˜éŒ„</div>
                              <div class="empty-state-description">é»æ“Šã€Œæ–°å¢äº¤æ˜“ã€é–‹å§‹è¨˜éŒ„æ‚¨çš„ç¬¬ä¸€ç­†äº¤æ˜“</div>
                          </td>
                      </tr>
                  </tbody>
              </table>
          </div>

          <!-- åˆ†é  -->
          <div class="pagination" id="transactionPagination">
              <button onclick="previousPage('transaction')" id="transactionPrevBtn">â€¹ ä¸Šä¸€é </button>
              <span id="transactionPageInfo">ç¬¬ 1 é ï¼Œå…± 1 é </span>
              <button onclick="nextPage('transaction')" id="transactionNextBtn">ä¸‹ä¸€é  â€º</button>
          </div>
      </div>

      <!-- æ”¶æ“šç®¡ç†æ¨™ç±¤é  -->
      <div id="receipts" class="tab-content">
          <h2>æ”¶æ“šç®¡ç†</h2>
          
          <!-- æœå°‹å’Œç¯©é¸ -->
          <div class="search-filters">
              <div class="search-row">
                  <div class="search-group">
                      <label for="receiptSearch">æœå°‹</label>
                      <input type="text" id="receiptSearch" placeholder="æœå°‹æ”¶æ“šç·¨è™Ÿã€ä»˜æ¬¾äºº...">
                  </div>
                  <div class="search-group">
                      <label for="receiptCategory">æ”¶æ“šé¡åˆ¥</label>
                      <select id="receiptCategory">
                          <option value="">å…¨éƒ¨é¡åˆ¥</option>
                          <option value="ææ¬¾">ææ¬¾</option>
                          <option value="æœƒè²»">æœƒè²»</option>
                          <option value="å…¶ä»–">å…¶ä»–</option>
                      </select>
                  </div>
                  <div class="search-group">
                      <label for="receiptStatus">ç‹€æ…‹</label>
                      <select id="receiptStatus">
                          <option value="">å…¨éƒ¨ç‹€æ…‹</option>
                          <option value="å·²é–‹ç«‹">å·²é–‹ç«‹</option>
                          <option value="å·²å¯„é€">å·²å¯„é€</option>
                          <option value="å·²ä½œå»¢">å·²ä½œå»¢</option>
                      </select>
                  </div>
                  <div class="search-group">
                      <label>&nbsp;</label>
                      <button class="btn btn-primary" onclick="searchReceipts()">ğŸ” æœå°‹</button>
                  </div>
              </div>
          </div>

          <!-- å·¥å…·åˆ— -->
          <div class="toolbar">
              <div class="toolbar-left">
                  <button class="btn btn-primary" onclick="showAddReceiptModal()">
                      â• é–‹ç«‹æ”¶æ“š
                  </button>
                  <button class="btn btn-success" onclick="exportReceipts()">
                      ğŸ“¤ åŒ¯å‡ºè³‡æ–™
                  </button>
              </div>
              <div class="toolbar-right">
                  <span id="receiptCount">å…± 0 ç­†è¨˜éŒ„</span>
              </div>
          </div>

          <!-- æ”¶æ“šåˆ—è¡¨ -->
          <div class="table-container">
              <table id="receiptTable">
                  <thead>
                      <tr>
                          <th>æ—¥æœŸ</th>
                          <th>æ”¶æ“šç·¨è™Ÿ</th>
                          <th>ä»˜æ¬¾äºº</th>
                          <th>èº«ä»½é¡åˆ¥</th>
                          <th>è¯çµ¡é›»è©±</th>
                          <th>æ”¶æ“šé¡åˆ¥</th>
                          <th>é‡‘é¡</th>
                          <th>ç‹€æ…‹</th>
                          <th>æ“ä½œ</th>
                      </tr>
                  </thead>
                  <tbody>
                      <tr>
                          <td colspan="9" class="empty-state">
                              <div class="empty-state-icon">ğŸ“„</div>
                              <div class="empty-state-title">æš«ç„¡æ”¶æ“šè¨˜éŒ„</div>
                              <div class="empty-state-description">é»æ“Šã€Œé–‹ç«‹æ”¶æ“šã€é–‹å§‹é–‹ç«‹æ‚¨çš„ç¬¬ä¸€å¼µæ”¶æ“š</div>
                          </td>
                      </tr>
                  </tbody>
              </table>
          </div>

          <!-- åˆ†é  -->
          <div class="pagination" id="receiptPagination">
              <button onclick="previousPage('receipt')" id="receiptPrevBtn">â€¹ ä¸Šä¸€é </button>
              <span id="receiptPageInfo">ç¬¬ 1 é ï¼Œå…± 1 é </span>
              <button onclick="nextPage('receipt')" id="receiptNextBtn">ä¸‹ä¸€é  â€º</button>
          </div>
      </div>

      <!-- æ†‘è­‰ç®¡ç†æ¨™ç±¤é  -->
      <div id="vouchers" class="tab-content">
          <h2>æ†‘è­‰ç®¡ç†</h2>
          
          <!-- æœå°‹å’Œç¯©é¸ -->
          <div class="search-filters">
              <div class="search-row">
                  <div class="search-group">
                      <label for="voucherSearch">æœå°‹</label>
                      <input type="text" id="voucherSearch" placeholder="æœå°‹æ†‘è­‰ç·¨è™Ÿã€ç”³è«‹äºº...">
                  </div>
                  <div class="search-group">
                      <label for="voucherCategory">æ”¯å‡ºé¡åˆ¥</label>
                      <select id="voucherCategory">
                          <option value="">å…¨éƒ¨é¡åˆ¥</option>
                          <option value="è¾¦å…¬è²»">è¾¦å…¬è²»</option>
                          <option value="äº¤é€šè²»">äº¤é€šè²»</option>
                          <option value="é¤è²»">é¤è²»</option>
                          <option value="æ´»å‹•è²»">æ´»å‹•è²»</option>
                          <option value="å…¶ä»–">å…¶ä»–</option>
                      </select>
                  </div>
                  <div class="search-group">
                      <label for="voucherStatus">ç‹€æ…‹</label>
                      <select id="voucherStatus">
                          <option value="">å…¨éƒ¨ç‹€æ…‹</option>
                          <option value="å¾…å¯©æ ¸">å¾…å¯©æ ¸</option>
                          <option value="å·²æ ¸å‡†">å·²æ ¸å‡†</option>
                          <option value="å·²é§å›">å·²é§å›</option>
                          <option value="å·²æ”¯ä»˜">å·²æ”¯ä»˜</option>
                      </select>
                  </div>
                  <div class="search-group">
                      <label>&nbsp;</label>
                      <button class="btn btn-primary" onclick="searchVouchers()">ğŸ” æœå°‹</button>
                  </div>
              </div>
          </div>

          <!-- å·¥å…·åˆ— -->
          <div class="toolbar">
              <div class="toolbar-left">
                  <button class="btn btn-primary" onclick="showAddVoucherModal()">
                      â• ç”³è«‹æ†‘è­‰
                  </button>
                  <button class="btn btn-success" onclick="exportVouchers()">
                      ğŸ“¤ åŒ¯å‡ºè³‡æ–™
                  </button>
              </div>
              <div class="toolbar-right">
                  <span id="voucherCount">å…± 0 ç­†è¨˜éŒ„</span>
              </div>
          </div>

          <!-- æ†‘è­‰åˆ—è¡¨ -->
          <div class="table-container">
              <table id="voucherTable">
                  <thead>
                      <tr>
                          <th>ç”³è«‹æ—¥æœŸ</th>
                          <th>æ†‘è­‰ç·¨è™Ÿ</th>
                          <th>ç”³è«‹äºº</th>
                          <th>æ”¯å‡ºé¡åˆ¥</th>
                          <th>ç”³è«‹é‡‘é¡</th>
                          <th>ç”¨é€”èªªæ˜</th>
                          <th>ç‹€æ…‹</th>
                          <th>é™„ä»¶</th>
                          <th>æ“ä½œ</th>
                      </tr>
                  </thead>
                  <tbody>
                      <tr>
                          <td colspan="9" class="empty-state">
                              <div class="empty-state-icon">ğŸ“‹</div>
                              <div class="empty-state-title">æš«ç„¡æ†‘è­‰è¨˜éŒ„</div>
                              <div class="empty-state-description">é»æ“Šã€Œç”³è«‹æ†‘è­‰ã€é–‹å§‹ç”³è«‹æ‚¨çš„ç¬¬ä¸€å¼µæ†‘è­‰</div>
                          </td>
                      </tr>
                  </tbody>
              </table>
          </div>
      </div>

      <!-- æœƒå“¡ç®¡ç†æ¨™ç±¤é  -->
      <div id="members" class="tab-content">
          <h2>æœƒå“¡ç®¡ç†</h2>
          
          <!-- æœå°‹å’Œç¯©é¸ -->
          <div class="search-filters">
              <div class="search-row">
                  <div class="search-group">
                      <label for="memberSearch">æœå°‹</label>
                      <input type="text" id="memberSearch" placeholder="æœå°‹æœƒå“¡ç·¨è™Ÿã€å§“åã€é›»è©±...">
                  </div>
                  <div class="search-group">
                      <label for="memberType">æœƒå“¡é¡å‹</label>
                      <select id="memberType">
                          <option value="">å…¨éƒ¨é¡å‹</option>
                          <option value="ä¸€èˆ¬æœƒå“¡">ä¸€èˆ¬æœƒå“¡</option>
                          <option value="æ¦®è­½æœƒå“¡">æ¦®è­½æœƒå“¡</option>
                          <option value="è´ŠåŠ©æœƒå“¡">è´ŠåŠ©æœƒå“¡</option>
                      </select>
                  </div>
                  <div class="search-group">
                      <label for="memberStatus">ç‹€æ…‹</label>
                      <select id="memberStatus">
                          <option value="">å…¨éƒ¨ç‹€æ…‹</option>
                          <option value="æ­£å¸¸">æ­£å¸¸</option>
                          <option value="æš«åœ">æš«åœ</option>
                          <option value="é€€æœƒ">é€€æœƒ</option>
                      </select>
                  </div>
                  <div class="search-group">
                      <label>&nbsp;</label>
                      <button class="btn btn-primary" onclick="searchMembers()">ğŸ” æœå°‹</button>
                  </div>
              </div>
          </div>

          <!-- å·¥å…·åˆ— -->
          <div class="toolbar">
              <div class="toolbar-left">
                  <button class="btn btn-primary" onclick="showAddMemberModal()">
                      â• æ–°å¢æœƒå“¡
                  </button>
                  <button class="btn btn-success" onclick="exportMembers()">
                      ğŸ“¤ åŒ¯å‡ºè³‡æ–™
                  </button>
                  <button class="btn btn-info" onclick="importMembers()">
                      ğŸ“¥ åŒ¯å…¥æœƒå“¡
                  </button>
              </div>
              <div class="toolbar-right">
                  <span id="memberCount">å…± 0 ç­†è¨˜éŒ„</span>
              </div>
          </div>

          <!-- æœƒå“¡åˆ—è¡¨ -->
          <div class="table-container">
              <table id="memberTable">
                  <thead>
                      <tr>
                          <th>æœƒå“¡ç·¨è™Ÿ</th>
                          <th>å§“å</th>
                          <th>æ€§åˆ¥</th>
                          <th>è¯çµ¡é›»è©±</th>
                          <th>é›»å­éƒµä»¶</th>
                          <th>æœƒå“¡é¡å‹</th>
                          <th>åŠ å…¥æ—¥æœŸ</th>
                          <th>ç‹€æ…‹</th>
                          <th>æ“ä½œ</th>
                      </tr>
                  </thead>
                  <tbody>
                      <tr>
                          <td colspan="9" class="empty-state">
                              <div class="empty-state-icon">ğŸ‘¥</div>
                              <div class="empty-state-title">æš«ç„¡æœƒå“¡è¨˜éŒ„</div>
                              <div class="empty-state-description">é»æ“Šã€Œæ–°å¢æœƒå“¡ã€é–‹å§‹æ–°å¢æ‚¨çš„ç¬¬ä¸€ä½æœƒå“¡</div>
                          </td>
                      </tr>
                  </tbody>
              </table>
          </div>
      </div>

      <!-- å ±è¡¨åˆ†ææ¨™ç±¤é  -->
      <div id="reports" class="tab-content">
          <h2>å ±è¡¨åˆ†æ</h2>
          
          <!-- å ±è¡¨é¸é … -->
          <div class="search-filters">
              <div class="search-row">
                  <div class="search-group">
                      <label for="reportType">å ±è¡¨é¡å‹</label>
                      <select id="reportType">
                          <option value="monthly">æœˆåº¦å ±è¡¨</option>
                          <option value="yearly">å¹´åº¦å ±è¡¨</option>
                          <option value="category">é¡åˆ¥çµ±è¨ˆ</option>
                          <option value="member">æœƒå“¡çµ±è¨ˆ</option>
                          <option value="donation">ææ¬¾çµ±è¨ˆ</option>
                      </select>
                  </div>
                  <div class="search-group">
                      <label for="reportYear">å¹´ä»½</label>
                      <select id="reportYear">
                          <option value="2024">2024</option>
                          <option value="2023">2023</option>
                          <option value="2022">2022</option>
                      </select>
                  </div>
                  <div class="search-group">
                      <label for="reportMonth">æœˆä»½</label>
                      <select id="reportMonth">
                          <option value="">å…¨å¹´</option>
                          <option value="1">1æœˆ</option>
                          <option value="2">2æœˆ</option>
                          <option value="3">3æœˆ</option>
                          <option value="4">4æœˆ</option>
                          <option value="5">5æœˆ</option>
                          <option value="6">6æœˆ</option>
                          <option value="7">7æœˆ</option>
                          <option value="8">8æœˆ</option>
                          <option value="9">9æœˆ</option>
                          <option value="10">10æœˆ</option>
                          <option value="11">11æœˆ</option>
                          <option value="12">12æœˆ</option>
                      </select>
                  </div>
                  <div class="search-group">
                      <label>&nbsp;</label>
                      <button class="btn btn-primary" onclick="generateReport()">ğŸ“Š ç”¢ç”Ÿå ±è¡¨</button>
                  </div>
              </div>
          </div>

          <!-- å ±è¡¨å…§å®¹ -->
          <div id="reportContent" class="chart-container">
              <div class="empty-state">
                  <div class="empty-state-icon">ğŸ“ˆ</div>
                  <div class="empty-state-title">è«‹é¸æ“‡å ±è¡¨é¡å‹</div>
                  <div class="empty-state-description">é¸æ“‡ä¸Šæ–¹çš„å ±è¡¨é¡å‹å’Œæ™‚é–“ç¯„åœï¼Œç„¶å¾Œé»æ“Šã€Œç”¢ç”Ÿå ±è¡¨ã€</div>
              </div>
          </div>

          <!-- å ±è¡¨å·¥å…· -->
          <div class="toolbar" id="reportToolbar" style="display: none;">
              <div class="toolbar-left">
                  <button class="btn btn-success" onclick="exportReport()">
                      ğŸ“¤ åŒ¯å‡ºå ±è¡¨
                  </button>
                  <button class="btn btn-info" onclick="printReport()">
                      ğŸ–¨ï¸ åˆ—å°å ±è¡¨
                  </button>
              </div>
              <div class="toolbar-right">
                  <button class="btn btn-secondary" onclick="emailReport()">
                      ğŸ“§ éƒµä»¶å¯„é€
                  </button>
              </div>
          </div>
      </div>

      <!-- ç³»çµ±è¨­å®šæ¨™ç±¤é  -->
      <div id="settings" class="tab-content">
          <h2>ç³»çµ±è¨­å®š</h2>
          
          <!-- è¨­å®šé¸é …å¡ -->
          <div class="tab-nav" style="margin-bottom: 30px;">
              <button class="tab-btn active" data-tab="orgSettings">çµ„ç¹”è¨­å®š</button>
              <button class="tab-btn" data-tab="emailSettings">éƒµä»¶è¨­å®š</button>
              <button class="tab-btn" data-tab="systemSettings">ç³»çµ±è¨­å®š</button>
              <button class="tab-btn" data-tab="backupSettings">å‚™ä»½è¨­å®š</button>
          </div>

          <!-- çµ„ç¹”è¨­å®š -->
          <div id="orgSettings" class="tab-content active">
              <h3>çµ„ç¹”åŸºæœ¬è³‡è¨Š</h3>
              <form id="organizationForm">
                  <div class="form-row">
                      <div class="form-group">
                          <label for="orgName">çµ„ç¹”åç¨±</label>
                          <input type="text" id="orgName" required>
                      </div>
                      <div class="form-group">
                          <label for="taxId">çµ±ä¸€ç·¨è™Ÿ</label>
                          <input type="text" id="taxId" required>
                      </div>
                  </div>
                  <div class="form-group">
                      <label for="orgAddress">çµ„ç¹”åœ°å€</label>
                      <textarea id="orgAddress" rows="3"></textarea>
                  </div>
                  <div class="form-row">
                      <div class="form-group">
                          <label for="orgPhone">è¯çµ¡é›»è©±</label>
                          <input type="tel" id="orgPhone">
                      </div>
                      <div class="form-group">
                          <label for="orgEmail">è¯çµ¡ä¿¡ç®±</label>
                          <input type="email" id="orgEmail">
                      </div>
                  </div>
                  <div class="form-group">
                      <label for="orgWebsite">å®˜æ–¹ç¶²ç«™</label>
                      <input type="url" id="orgWebsite">
                  </div>
                  <div class="btn-group">
                      <button type="submit" class="btn btn-primary">ğŸ’¾ å„²å­˜è¨­å®š</button>
                      <button type="button" class="btn btn-secondary" onclick="resetOrgForm()">ğŸ”„ é‡è¨­</button>
                  </div>
              </form>
          </div>

          <!-- éƒµä»¶è¨­å®š -->
          <div id="emailSettings" class="tab-content">
              <h3>éƒµä»¶ç³»çµ±è¨­å®š</h3>
              <form id="emailForm">
                  <div class="form-row">
                      <div class="form-group">
                          <label for="smtpHost">SMTP ä¸»æ©Ÿ</label>
                          <input type="text" id="smtpHost" placeholder="smtp.gmail.com">
                      </div>
                      <div class="form-group">
                          <label for="smtpPort">SMTP åŸ è™Ÿ</label>
                          <input type="number" id="smtpPort" value="587">
                      </div>
                  </div>
                  <div class="form-row">
                      <div class="form-group">
                          <label for="smtpUser">SMTP ä½¿ç”¨è€…</label>
                          <input type="email" id="smtpUser">
                      </div>
                      <div class="form-group">
                          <label for="smtpPass">SMTP å¯†ç¢¼</label>
                          <input type="password" id="smtpPass">
                      </div>
                  </div>
                  <div class="form-group">
                      <label for="emailFrom">å¯„ä»¶è€…ä¿¡ç®±</label>
                      <input type="email" id="emailFrom">
                  </div>
                  <div class="form-group">
                      <label>
                          <input type="checkbox" id="autoSendReceipt"> è‡ªå‹•å¯„é€æ”¶æ“š
                      </label>
                  </div>
                  <div class="btn-group">
                      <button type="submit" class="btn btn-primary">ğŸ’¾ å„²å­˜è¨­å®š</button>
                      <button type="button" class="btn btn-info" onclick="testEmailSettings()">ğŸ“§ æ¸¬è©¦éƒµä»¶</button>
                      <button type="button" class="btn btn-secondary" onclick="resetEmailForm()">ğŸ”„ é‡è¨­</button>
                  </div>
              </form>
          </div>

          <!-- ç³»çµ±è¨­å®š -->
          <div id="systemSettings" class="tab-content">
              <h3>ç³»çµ±ç¶­è­·</h3>
              <div class="stats-grid">
                  <div class="stat-card">
                      <div class="stat-value" id="systemVersion">v1.0.0</div>
                      <div class="stat-label">ç³»çµ±ç‰ˆæœ¬</div>
                  </div>
                  <div class="stat-card">
                      <div class="stat-value" id="dataCount">0</div>
                      <div class="stat-label">ç¸½è³‡æ–™ç­†æ•¸</div>
                  </div>
                  <div class="stat-card">
                      <div class="stat-value" id="lastBackup">æœªçŸ¥</div>
                      <div class="stat-label">æœ€å¾Œå‚™ä»½</div>
                  </div>
                  <div class="stat-card">
                      <div class="stat-value" id="systemHealth">å¥åº·</div>
                      <div class="stat-label">ç³»çµ±ç‹€æ…‹</div>
                  </div>
              </div>

              <div class="toolbar">
                  <div class="toolbar-left">
                      <button class="btn btn-primary" onclick="performSystemCheck()">
                          ğŸ” ç³»çµ±æª¢æŸ¥
                      </button>
                      <button class="btn btn-warning" onclick="cleanupSystem()">
                          ğŸ§¹ æ¸…ç†ç³»çµ±
                      </button>
                  </div>
                  <div class="toolbar-right">
                      <button class="btn btn-info" onclick="viewSystemLogs()">
                          ğŸ“‹ æŸ¥çœ‹æ—¥èªŒ
                      </button>
                      <button class="btn btn-success" onclick="createBackup()">
                          ğŸ’¾ å»ºç«‹å‚™ä»½
                      </button>
                  </div>
              </div>
          </div>

          <!-- å‚™ä»½è¨­å®š -->
          <div id="backupSettings" class="tab-content">
              <h3>å‚™ä»½èˆ‡é‚„åŸ</h3>
              <form id="backupForm">
                  <div class="form-group">
                      <label>
                          <input type="checkbox" id="autoBackup" checked> å•Ÿç”¨è‡ªå‹•å‚™ä»½
                      </label>
                  </div>
                  <div class="form-group">
                      <label for="backupFrequency">å‚™ä»½é »ç‡</label>
                      <select id="backupFrequency">
                          <option value="daily">æ¯æ—¥</option>
                          <option value="weekly" selected>æ¯é€±</option>
                          <option value="monthly">æ¯æœˆ</option>
                      </select>
                  </div>
                  <div class="form-group">
                      <label for="backupRetention">ä¿ç•™å¤©æ•¸</label>
                      <input type="number" id="backupRetention" value="30" min="1" max="365">
                  </div>
                  <div class="btn-group">
                      <button type="submit" class="btn btn-primary">ğŸ’¾ å„²å­˜è¨­å®š</button>
                      <button type="button" class="btn btn-success" onclick="createManualBackup()">
                          ğŸ“¦ ç«‹å³å‚™ä»½
                      </button>
                      <button type="button" class="btn btn-info" onclick="viewBackupHistory()">
                          ğŸ“‹ å‚™ä»½è¨˜éŒ„
                      </button>
                  </div>
              </form>
          </div>
      </div>
  </div>

  <!-- æ¨¡æ…‹æ¡† -->
  <!-- æ–°å¢äº¤æ˜“æ¨¡æ…‹æ¡† -->
  <div id="addTransactionModal" class="modal">
      <div class="modal-content">
          <div class="modal-header">
              <h3 class="modal-title">æ–°å¢äº¤æ˜“</h3>
              <button class="close" onclick="closeModal('addTransactionModal')">&times;</button>
          </div>
          <form id="addTransactionForm">
              <div class="form-row">
                  <div class="form-group">
                      <label for="transactionDate">äº¤æ˜“æ—¥æœŸ</label>
                      <input type="date" id="transactionDate" required>
                  </div>
                  <div class="form-group">
                      <label for="transactionTypeModal">æ”¶æ”¯é¡å‹</label>
                      <select id="transactionTypeModal" required>
                          <option value="">è«‹é¸æ“‡</option>
                          <option value="æ”¶å…¥">æ”¶å…¥</option>
                          <option value="æ”¯å‡º">æ”¯å‡º</option>
                      </select>
                  </div>
              </div>
              <div class="form-row">
                  <div class="form-group">
                      <label for="transactionCategoryModal">é¡åˆ¥</label>
                      <select id="transactionCategoryModal" required>
                          <option value="">è«‹é¸æ“‡é¡åˆ¥</option>
                      </select>
                  </div>
                  <div class="form-group">
                      <label for="transactionAmount">é‡‘é¡</label>
                      <input type="number" id="transactionAmount" min="0" step="1" required>
                  </div>
              </div>
              <div class="form-group">
                  <label for="transactionName">äº¤æ˜“å°è±¡</label>
                  <input type="text" id="transactionName" required>
              </div>
              <div class="form-group">
                  <label for="transactionAccount">å¸³æˆ¶</label>
                  <select id="transactionAccount" required>
                      <option value="">è«‹é¸æ“‡å¸³æˆ¶</option>
                      <option value="ç¾é‡‘">ç¾é‡‘</option>
                      <option value="éŠ€è¡Œå¸³æˆ¶">éŠ€è¡Œå¸³æˆ¶</option>
                      <option value="ä¿¡ç”¨å¡">ä¿¡ç”¨å¡</option>
                  </select>
              </div>
              <div class="form-group">
                  <label for="transactionDescription">èªªæ˜</label>
                  <textarea id="transactionDescription" rows="3"></textarea>
              </div>
              <div class="form-group">
                  <label>
                      <input type="checkbox" id="generateReceipt"> è‡ªå‹•ç”¢ç”Ÿæ”¶æ“š
                  </label>
              </div>
              <div class="btn-group">
                  <button type="submit" class="btn btn-primary">ğŸ’¾ å„²å­˜</button>
                  <button type="button" class="btn btn-secondary" onclick="closeModal('addTransactionModal')">âŒ å–æ¶ˆ</button>
              </div>
          </form>
      </div>
  </div>

  <!-- æ–°å¢æ”¶æ“šæ¨¡æ…‹æ¡† -->
  <div id="addReceiptModal" class="modal">
      <div class="modal-content">
          <div class="modal-header">
              <h3 class="modal-title">é–‹ç«‹æ”¶æ“š</h3>
              <button class="close" onclick="closeModal('addReceiptModal')">&times;</button>
          </div>
          <form id="addReceiptForm">
              <div class="form-row">
                  <div class="form-group">
                      <label for="receiptDate">æ”¶æ“šæ—¥æœŸ</label>
                      <input type="date" id="receiptDate" required>
                  </div>
                  <div class="form-group">
                      <label for="receiptCategoryModal">æ”¶æ“šé¡åˆ¥</label>
                      <select id="receiptCategoryModal" required>
                          <option value="">è«‹é¸æ“‡</option>
                          <option value="ææ¬¾">ææ¬¾</option>
                          <option value="æœƒè²»">æœƒè²»</option>
                          <option value="å…¶ä»–">å…¶ä»–</option>
                      </select>
                  </div>
              </div>
              <div class="form-row">
                  <div class="form-group">
                      <label for="receiptPayer">ä»˜æ¬¾äºº</label>
                      <input type="text" id="receiptPayer" required>
                  </div>
                  <div class="form-group">
                      <label for="receiptIdentity">èº«ä»½é¡åˆ¥</label>
                      <select id="receiptIdentity" required>
                          <option value="">è«‹é¸æ“‡</option>
                          <option value="å€‹äºº">å€‹äºº</option>
                          <option value="å…¬å¸">å…¬å¸</option>
                          <option value="åœ˜é«”">åœ˜é«”</option>
                      </select>
                  </div>
              </div>
              <div class="form-row">
                  <div class="form-group">
                      <label for="receiptPhone">è¯çµ¡é›»è©±</label>
                      <input type="tel" id="receiptPhone">
                  </div>
                  <div class="form-group">
                      <label for="receiptEmail">é›»å­éƒµä»¶</label>
                      <input type="email" id="receiptEmail">
                  </div>
              </div>
              <div class="form-row">
                  <div class="form-group">
                      <label for="receiptAmount">é‡‘é¡</label>
                      <input type="number" id="receiptAmount" min="0" step="1" required>
                  </div>
                  <div class="form-group">
                      <label for="receiptPurpose">ç”¨é€”</label>
                      <input type="text" id="receiptPurpose">
                  </div>
              </div>
              <div class="form-group">
                  <label>
                      <input type="checkbox" id="autoSendReceiptModal"> è‡ªå‹•å¯„é€æ”¶æ“š
                  </label>
              </div>
              <div class="btn-group">
                  <button type="submit" class="btn btn-primary">ğŸ“„ é–‹ç«‹æ”¶æ“š</button>
                  <button type="button" class="btn btn-secondary" onclick="closeModal('addReceiptModal')">âŒ å–æ¶ˆ</button>
              </div>
          </form>
      </div>
  </div>

  <!-- æ–°å¢æœƒå“¡æ¨¡æ…‹æ¡† -->
  <div id="addMemberModal" class="modal">
      <div class="modal-content">
          <div class="modal-header">
              <h3 class="modal-title">æ–°å¢æœƒå“¡</h3>
              <button class="close" onclick="closeModal('addMemberModal')">&times;</button>
          </div>
          <form id="addMemberForm">
              <div class="form-row">
                  <div class="form-group">
                      <label for="memberName">å§“å</label>
                      <input type="text" id="memberName" required>
                  </div>
                  <div class="form-group">
                      <label for="memberGender">æ€§åˆ¥</label>
                      <select id="memberGender" required>
                          <option value="">è«‹é¸æ“‡</option>
                          <option value="ç”·">ç”·</option>
                          <option value="å¥³">å¥³</option>
                          <option value="å…¶ä»–">å…¶ä»–</option>
                      </select>
                  </div>
              </div>
              <div class="form-row">
                  <div class="form-group">
                      <label for="memberBirthdate">å‡ºç”Ÿæ—¥æœŸ</label>
                      <input type="date" id="memberBirthdate">
                  </div>
                  <div class="form-group">
                      <label for="memberIdNumber">èº«ä»½è­‰å­—è™Ÿ</label>
                      <input type="text" id="memberIdNumber">
                  </div>
              </div>
              <div class="form-row">
                  <div class="form-group">
                      <label for="memberPhone">è¯çµ¡é›»è©±</label>
                      <input type="tel" id="memberPhone" required>
                  </div>
                  <div class="form-group">
                      <label for="memberEmailModal">é›»å­éƒµä»¶</label>
                      <input type="email" id="memberEmailModal">
                  </div>
              </div>
              <div class="form-group">
                  <label for="memberAddress">è¯çµ¡åœ°å€</label>
                  <textarea id="memberAddress" rows="3"></textarea>
              </div>
              <div class="form-row">
                  <div class="form-group">
                      <label for="memberTypeModal">æœƒå“¡é¡å‹</label>
                      <select id="memberTypeModal" required>
                          <option value="">è«‹é¸æ“‡</option>
                          <option value="ä¸€èˆ¬æœƒå“¡">ä¸€èˆ¬æœƒå“¡</option>
                          <option value="æ¦®è­½æœƒå“¡">æ¦®è­½æœƒå“¡</option>
                          <option value="è´ŠåŠ©æœƒå“¡">è´ŠåŠ©æœƒå“¡</option>
                      </select>
                  </div>
                  <div class="form-group">
                      <label for="memberJoinDate">åŠ å…¥æ—¥æœŸ</label>
                      <input type="date" id="memberJoinDate" required>
                  </div>
              </div>
              <div class="form-group">
                  <label for="memberNotes">å‚™è¨»</label>
                  <textarea id="memberNotes" rows="2"></textarea>
              </div>
              <div class="btn-group">
                  <button type="submit" class="btn btn-primary">ğŸ‘¥ æ–°å¢æœƒå“¡</button>
                  <button type="button" class="btn btn-secondary" onclick="closeModal('addMemberModal')">âŒ å–æ¶ˆ</button>
              </div>
          </form>
      </div>
  </div>

  <!-- JavaScript ç¨‹å¼ç¢¼ -->
  <script>
      // å…¨åŸŸè®Šæ•¸
      let currentTab = 'dashboard';
      let currentPage = {
          transaction: 1,
          receipt: 1,
          voucher: 1,
          member: 1
      };
      let itemsPerPage = 20;
      let allData = {
          transactions: [],
          receipts: [],
          vouchers: [],
          members: []
      };

      // åˆå§‹åŒ–
      document.addEventListener('DOMContentLoaded', function() {
          initializeApp();
      });

      // æ‡‰ç”¨ç¨‹å¼åˆå§‹åŒ–
      function initializeApp() {
          console.log('åˆå§‹åŒ–æœƒè¨ˆç®¡ç†ç³»çµ±...');
          
          // è¨­å®šç•¶å‰æ™‚é–“
          updateCurrentTime();
          setInterval(updateCurrentTime, 60000); // æ¯åˆ†é˜æ›´æ–°ä¸€æ¬¡
          
          // è¨­å®šé è¨­æ—¥æœŸ
          setDefaultDates();
          
          // è¼‰å…¥ç³»çµ±è³‡æ–™
          loadSystemData();
          
          // ç¶å®šäº‹ä»¶ç›£è½å™¨
          bindEventListeners();
          
          // è¼‰å…¥çµ±è¨ˆè³‡æ–™
          loadStatistics();
          
          console.log('ç³»çµ±åˆå§‹åŒ–å®Œæˆ');
      }

      // æ›´æ–°ç•¶å‰æ™‚é–“
      function updateCurrentTime() {
          const now = new Date();
          const timeString = now.toLocaleString('zh-TW', {
              year: 'numeric',
              month: '2-digit',
              day: '2-digit',
              hour: '2-digit',
              minute: '2-digit'
          });
          document.getElementById('currentTime').textContent = timeString;
      }

      // è¨­å®šé è¨­æ—¥æœŸ
      function setDefaultDates() {
          const today = new Date().toISOString().split('T')[0];
          const inputs = document.querySelectorAll('input[type="date"]');
          inputs.forEach(input => {
              if (!input.value) {
                  input.value = today;
              }
          });
      }

      // ç¶å®šäº‹ä»¶ç›£è½å™¨
      function bindEventListeners() {
          // æ¨™ç±¤é åˆ‡æ›
          document.querySelectorAll('.tab-btn').forEach(btn => {
              btn.addEventListener('click', function() {
                  const tabName = this.getAttribute('data-tab');
                  if (tabName) {
                      switchTab(tabName);
                  }
              });
          });

          // è¡¨å–®æäº¤
          document.getElementById('addTransactionForm').addEventListener('submit', handleAddTransaction);
          document.getElementById('addReceiptForm').addEventListener('submit', handleAddReceipt);
          document.getElementById('addMemberForm').addEventListener('submit', handleAddMember);
          document.getElementById('organizationForm').addEventListener('submit', handleOrgSettings);
          document.getElementById('emailForm').addEventListener('submit', handleEmailSettings);
          document.getElementById('backupForm').addEventListener('submit', handleBackupSettings);

          // æœå°‹åŠŸèƒ½
          document.getElementById('transactionSearch').addEventListener('input', debounce(searchTransactions, 300));
          document.getElementById('receiptSearch').addEventListener('input', debounce(searchReceipts, 300));
          document.getElementById('memberSearch').addEventListener('input', debounce(searchMembers, 300));

          // æ”¶æ”¯é¡å‹è®Šæ›´æ™‚æ›´æ–°é¡åˆ¥é¸é …
          document.getElementById('transactionTypeModal').addEventListener('change', updateTransactionCategories);

          // æ¨¡æ…‹æ¡†å¤–é»æ“Šé—œé–‰
          document.querySelectorAll('.modal').forEach(modal => {
              modal.addEventListener('click', function(e) {
                  if (e.target === this) {
                      closeModal(this.id);
                  }
              });
          });

          // ESC éµé—œé–‰æ¨¡æ…‹æ¡†
          document.addEventListener('keydown', function(e) {
              if (e.key === 'Escape') {
                  document.querySelectorAll('.modal.show').forEach(modal => {
                      closeModal(modal.id);
                  });
              }
          });
      }

      // é˜²æŠ–å‡½æ•¸
      function debounce(func, wait) {
          let timeout;
          return function executedFunction(...args) {
              const later = () => {
                  clearTimeout(timeout);
                  func(...args);
              };
              clearTimeout(timeout);
              timeout = setTimeout(later, wait);
          };
      }

      // æ¨™ç±¤é åˆ‡æ›
      function switchTab(tabName) {
          // æ›´æ–°å°èˆªæŒ‰éˆ•
          document.querySelectorAll('.tab-btn').forEach(btn => {
              btn.classList.remove('active');
          });
          document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');

          // æ›´æ–°å…§å®¹å€åŸŸ
          document.querySelectorAll('.tab-content').forEach(content => {
              content.classList.remove('active');
          });
          document.getElementById(tabName).classList.add('active');

          currentTab = tabName;

          // è¼‰å…¥å°æ‡‰è³‡æ–™
          switch(tabName) {
              case 'dashboard':
                  loadDashboard();
                  break;
              case 'transactions':
                  loadTransactions();
                  break;
              case 'receipts':
                  loadReceipts();
                  break;
              case 'vouchers':
                  loadVouchers();
                  break;
              case 'members':
                  loadMembers();
                  break;
              case 'reports':
                  loadReports();
                  break;
              case 'settings':
                  loadSettings();
                  break;
          }
      }

      // è¼‰å…¥ç³»çµ±è³‡æ–™
      async function loadSystemData() {
          try {
              showLoading();
              
              // æ¨¡æ“¬è¼‰å…¥è³‡æ–™
              await new Promise(resolve => setTimeout(resolve, 1000));
              
              // è¼‰å…¥åŸºæœ¬è³‡æ–™
              await loadBasicData();
              
              hideLoading();
          } catch (error) {
              console.error('è¼‰å…¥ç³»çµ±è³‡æ–™å¤±æ•—:', error);
              showAlert('è¼‰å…¥ç³»çµ±è³‡æ–™å¤±æ•—', 'danger');
              hideLoading();
          }
      }

      // è¼‰å…¥åŸºæœ¬è³‡æ–™
      async function loadBasicData() {
          // æ¨¡æ“¬è³‡æ–™è¼‰å…¥
          allData.transactions = generateSampleTransactions();
          allData.receipts = generateSampleReceipts();
          allData.members = generateSampleMembers();
          allData.vouchers = generateSampleVouchers();
          
          // æ›´æ–°çµ±è¨ˆ
          updateStatistics();
      }

      // ç”¢ç”Ÿç¯„ä¾‹äº¤æ˜“è³‡æ–™
      function generateSampleTransactions() {
          const transactions = [];
          const categories = ['æœƒè²»', 'ææ¬¾', 'æ´»å‹•è²»', 'è¾¦å…¬è²»', 'äº¤é€šè²»'];
          const accounts = ['ç¾é‡‘', 'éŠ€è¡Œå¸³æˆ¶', 'ä¿¡ç”¨å¡'];
          
          for (let i = 0; i < 50; i++) {
              const isIncome = Math.random() > 0.3;
              transactions.push({
                  id: `T${String(i + 1).padStart(4, '0')}`,
                  date: new Date(Date.now() - Math.random() * 30 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                  type: isIncome ? 'æ”¶å…¥' : 'æ”¯å‡º',
                  category: categories[Math.floor(Math.random() * categories.length)],
                  amount: Math.floor(Math.random() * 10000) + 100,
                  name: `${isIncome ? 'æœƒå“¡' : 'å» å•†'}${i + 1}`,
                  account: accounts[Math.floor(Math.random() * accounts.length)],
                  description: `${isIncome ? 'æ”¶å…¥' : 'æ”¯å‡º'}é …ç›® ${i + 1}`,
                  status: 'å·²ç¢ºèª'
              });
          }
          return transactions.sort((a, b) => new Date(b.date) - new Date(a.date));
      }

      // ç”¢ç”Ÿç¯„ä¾‹æ”¶æ“šè³‡æ–™
      function generateSampleReceipts() {
          const receipts = [];
          const categories = ['ææ¬¾', 'æœƒè²»', 'å…¶ä»–'];
          const identities = ['å€‹äºº', 'å…¬å¸', 'åœ˜é«”'];
          
          for (let i = 0; i < 30; i++) {
              receipts.push({
                  id: `R${String(i + 1).padStart(4, '0')}`,
                  date: new Date(Date.now() - Math.random() * 30 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                  receiptNumber: `${new Date().getFullYear()}${String(i + 1).padStart(4, '0')}`,
                  payer: `ä»˜æ¬¾äºº${i + 1}`,
                  identity: identities[Math.floor(Math.random() * identities.length)],
                  phone: `09${String(Math.floor(Math.random() * 100000000)).padStart(8, '0')}`,
                  category: categories[Math.floor(Math.random() * categories.length)],
                  amount: Math.floor(Math.random() * 5000) + 500,
                  status: Math.random() > 0.2 ? 'å·²é–‹ç«‹' : 'å·²å¯„é€'
              });
          }
          return receipts.sort((a, b) => new Date(b.date) - new Date(a.date));
      }

      // ç”¢ç”Ÿç¯„ä¾‹æœƒå“¡è³‡æ–™
      function generateSampleMembers() {
          const members = [];
          const types = ['ä¸€èˆ¬æœƒå“¡', 'æ¦®è­½æœƒå“¡', 'è´ŠåŠ©æœƒå“¡'];
          const genders = ['ç”·', 'å¥³'];
          
          for (let i = 0; i < 100; i++) {
              members.push({
                  id: `M${String(i + 1).padStart(4, '0')}`,
                  memberNumber: `${new Date().getFullYear()}${String(i + 1).padStart(3, '0')}`,
                  name: `æœƒå“¡${i + 1}`,
                  gender: genders[Math.floor(Math.random() * genders.length)],
                  phone: `09${String(Math.floor(Math.random() * 100000000)).padStart(8, '0')}`,
                  email: `member${i + 1}@example.com`,
                  type: types[Math.floor(Math.random() * types.length)],
                  joinDate: new Date(Date.now() - Math.random() * 365 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                  status: Math.random() > 0.1 ? 'æ­£å¸¸' : 'æš«åœ'
              });
          }
          return members.sort((a, b) => new Date(b.joinDate) - new Date(a.joinDate));
      }

      // ç”¢ç”Ÿç¯„ä¾‹æ†‘è­‰è³‡æ–™
      function generateSampleVouchers() {
          const vouchers = [];
          const categories = ['è¾¦å…¬è²»', 'äº¤é€šè²»', 'é¤è²»', 'æ´»å‹•è²»', 'å…¶ä»–'];
          const statuses = ['å¾…å¯©æ ¸', 'å·²æ ¸å‡†', 'å·²é§å›', 'å·²æ”¯ä»˜'];
          
          for (let i = 0; i < 20; i++) {
              vouchers.push({
                  id: `V${String(i + 1).padStart(4, '0')}`,
                  date: new Date(Date.now() - Math.random() * 30 * 24 * 60 * 60 * 1000).toISOString().split('T')[0],
                  voucherNumber: `V${new Date().getFullYear()}${String(i + 1).padStart(3, '0')}`,
                  applicant: `ç”³è«‹äºº${i + 1}`,
                  category: categories[Math.floor(Math.random() * categories.length)],
                  amount: Math.floor(Math.random() * 3000) + 100,
                  purpose: `æ”¯å‡ºç”¨é€”èªªæ˜ ${i + 1}`,
                  status: statuses[Math.floor(Math.random() * statuses.length)],
                  hasAttachment: Math.random() > 0.3
              });
          }
          return vouchers.sort((a, b) => new Date(b.date) - new Date(a.date));
      }

      // è¼‰å…¥çµ±è¨ˆè³‡æ–™
      function loadStatistics() {
          updateStatistics();
      }

      // æ›´æ–°çµ±è¨ˆè³‡æ–™
      function updateStatistics() {
          const currentMonth = new Date().getMonth();
          const currentYear = new Date().getFullYear();
          
          // è¨ˆç®—æœ¬æœˆæ”¶æ”¯
          const monthlyTransactions = allData.transactions.filter(t => {
              const transactionDate = new Date(t.date);
              return transactionDate.getMonth() === currentMonth && 
                     transactionDate.getFullYear() === currentYear;
          });
          
          const totalIncome = monthlyTransactions
              .filter(t => t.type === 'æ”¶å…¥')
              .reduce((sum, t) => sum + t.amount, 0);
              
          const totalExpense = monthlyTransactions
              .filter(t => t.type === 'æ”¯å‡º')
              .reduce((sum, t) => sum + t.amount, 0);
              
          const netAmount = totalIncome - totalExpense;
          
          // æ›´æ–°é¡¯ç¤º
          document.getElementById('totalIncome').textContent = formatCurrency(totalIncome);
          document.getElementById('totalExpense').textContent = formatCurrency(totalExpense);
          document.getElementById('netAmount').textContent = formatCurrency(netAmount);
          document.getElementById('totalMembers').textContent = allData.members.filter(m => m.status === 'æ­£å¸¸').length;
          
          // æ›´æ–°è®ŠåŒ–è¶¨å‹¢ï¼ˆæ¨¡æ“¬ï¼‰
          document.getElementById('incomeChange').textContent = '+5.2%';
          document.getElementById('expenseChange').textContent = '+2.1%';
          document.getElementById('netChange').textContent = netAmount >= 0 ? '+8.3%' : '-3.2%';
          document.getElementById('memberChange').textContent = '+2';
          
          // æ›´æ–°æ·¨é¡é¡è‰²
          const netChangeElement = document.getElementById('netChange');
          netChangeElement.className = `stat-change ${netAmount >= 0 ? 'positive' : 'negative'}`;
      }

      // æ ¼å¼åŒ–è²¨å¹£
      function formatCurrency(amount) {
          return new Intl.NumberFormat('zh-TW', {
              style: 'currency',
              currency: 'TWD',
              minimumFractionDigits: 0
          }).format(amount);
      }

      // è¼‰å…¥å„€è¡¨æ¿
      function loadDashboard() {
          loadRecentTransactions();
          loadMonthlyChart();
      }

      // è¼‰å…¥æœ€è¿‘äº¤æ˜“
      function loadRecentTransactions() {
          const recentTransactions = allData.transactions.slice(0, 10);
          const container = document.getElementById('recentTransactions');
          
          if (recentTransactions.length === 0) {
              container.innerHTML = `
                  <div class="empty-state">
                      <div class="empty-state-icon">ğŸ’°</div>
                      <div class="empty-state-title">æš«ç„¡äº¤æ˜“è¨˜éŒ„</div>
                      <div class="empty-state-description">é–‹å§‹è¨˜éŒ„æ‚¨çš„ç¬¬ä¸€ç­†äº¤æ˜“</div>
                  </div>
              `;
              return;
          }
          
          const tableHtml = `
              <div class="table-container">
                  <table>
                      <thead>
                          <tr>
                              <th>æ—¥æœŸ</th>
                              <th>é¡å‹</th>
                              <th>é‡‘é¡</th>
                              <th>äº¤æ˜“å°è±¡</th>
                              <th>èªªæ˜</th>
                          </tr>
                      </thead>
                      <tbody>
                          ${recentTransactions.map(t => `
                              <tr>
                                  <td>${formatDate(t.date)}</td>
                                  <td><span class="badge badge-${t.type === 'æ”¶å…¥' ? 'success' : 'danger'}">${t.type}</span></td>
                                  <td>${formatCurrency(t.amount)}</td>
                                  <td>${t.name}</td>
                                  <td>${t.description}</td>
                              </tr>
                          `).join('')}
                      </tbody>
                  </table>
              </div>
          `;
          
          container.innerHTML = tableHtml;
      }

      // è¼‰å…¥æœˆåº¦åœ–è¡¨
      function loadMonthlyChart() {
          // é€™è£¡æ‡‰è©²å¯¦ä½œåœ–è¡¨åŠŸèƒ½
          // ç”±æ–¼æ²’æœ‰åœ–è¡¨åº«ï¼Œæš«æ™‚é¡¯ç¤ºæ–‡å­—èªªæ˜
          const canvas = document.getElementById('trendChart');
          const ctx = canvas.getContext('2d');
          
          // ç°¡å–®çš„åœ–è¡¨ç¹ªè£½
          ctx.clearRect(0, 0, canvas.width, canvas.height);
          ctx.fillStyle = '#667eea';
          ctx.fillRect(50, 50, 100, 100);
          ctx.fillStyle = '#ffffff';
          ctx.font = '16px Arial';
          ctx.fillText('æœˆåº¦è¶¨å‹¢åœ–', 200, 100);
          ctx.fillText('(éœ€è¦åœ–è¡¨åº«æ”¯æ´)', 200, 120);
      }

      // è¼‰å…¥äº¤æ˜“è³‡æ–™
      function loadTransactions() {
          displayTransactions(allData.transactions);
          updateTransactionCount();
          updateTransactionCategories();
      }

      // é¡¯ç¤ºäº¤æ˜“è³‡æ–™
      function displayTransactions(transactions) {
          const tbody = document.querySelector('#transactionTable tbody');
          const startIndex = (currentPage.transaction - 1) * itemsPerPage;
          const endIndex = startIndex + itemsPerPage;
          const pageTransactions = transactions.slice(startIndex, endIndex);
          
          if (pageTransactions.length === 0) {
              tbody.innerHTML = `
                  <tr>
                      <td colspan="9" class="empty-state">
                          <div class="empty-state-icon">ğŸ’°</div>
                          <div class="empty-state-title">æš«ç„¡äº¤æ˜“è¨˜éŒ„</div>
                          <div class="empty-state-description">é»æ“Šã€Œæ–°å¢äº¤æ˜“ã€é–‹å§‹è¨˜éŒ„æ‚¨çš„ç¬¬ä¸€ç­†äº¤æ˜“</div>
                      </td>
                  </tr>
              `;
              return;
          }
          
          tbody.innerHTML = pageTransactions.map(t => `
              <tr>
                  <td>${formatDate(t.date)}</td>
                  <td><span class="badge badge-${t.type === 'æ”¶å…¥' ? 'success' : 'danger'}">${t.type}</span></td>
                  <td>${t.category}</td>
                  <td>${formatCurrency(t.amount)}</td>
                  <td>${t.name}</td>
                  <td>${t.account}</td>
                  <td>${t.description}</td>
                  <td><span class="badge badge-info">${t.status}</span></td>
                  <td>
                      <button class="btn btn-sm btn-info" onclick="editTransaction('${t.id}')">ç·¨è¼¯</button>
                      <button class="btn btn-sm btn-danger" onclick="deleteTransaction('${t.id}')">åˆªé™¤</button>
                  </td>
              </tr>
          `).join('');
          
          updatePagination('transaction', transactions.length);
      }

      // æ›´æ–°äº¤æ˜“æ•¸é‡
      function updateTransactionCount() {
          document.getElementById('transactionCount').textContent = `å…± ${allData.transactions.length} ç­†è¨˜éŒ„`;
      }

      // æ›´æ–°äº¤æ˜“é¡åˆ¥é¸é …
      function updateTransactionCategories() {
          const typeSelect = document.getElementById('transactionTypeModal');
          const categorySelect = document.getElementById('transactionCategoryModal');
          const searchCategorySelect = document.getElementById('transactionCategory');
          
          const incomeCategories = ['æœƒè²»', 'ææ¬¾', 'æ´»å‹•æ”¶å…¥', 'åˆ©æ¯æ”¶å…¥', 'å…¶ä»–æ”¶å…¥'];
          const expenseCategories = ['è¾¦å…¬è²»', 'äº¤é€šè²»', 'é¤è²»', 'æ´»å‹•è²»', 'æ°´é›»è²»', 'ç§Ÿé‡‘', 'å…¶ä»–æ”¯å‡º'];
          
          let categories = [];
          if (typeSelect.value === 'æ”¶å…¥') {
              categories = incomeCategories;
          } else if (typeSelect.value === 'æ”¯å‡º') {
              categories = expenseCategories;
          }
          
          // æ›´æ–°æ¨¡æ…‹æ¡†ä¸­çš„é¡åˆ¥é¸é …
          categorySelect.innerHTML = '<option value="">è«‹é¸æ“‡é¡åˆ¥</option>' + 
              categories.map(cat => `<option value="${cat}">${cat}</option>`).join('');
          
          // æ›´æ–°æœå°‹ä¸­çš„é¡åˆ¥é¸é …
          const allCategories = [...incomeCategories, ...expenseCategories];
          searchCategorySelect.innerHTML = '<option value="">å…¨éƒ¨é¡åˆ¥</option>' + 
              allCategories.map(cat => `<option value="${cat}">${cat}</option>`).join('');
      }

      // æœå°‹äº¤æ˜“
      function searchTransactions() {
          const searchTerm = document.getElementById('transactionSearch').value.toLowerCase();
          const typeFilter = document.getElementById('transactionType').value;
          const categoryFilter = document.getElementById('transactionCategory').value;
          const dateFrom = document.getElementById('dateFrom').value;
          const dateTo = document.getElementById('dateTo').value;
          
          let filteredTransactions = allData.transactions.filter(t => {
              const matchesSearch = !searchTerm || 
                  t.name.toLowerCase().includes(searchTerm) ||
                  t.description.toLowerCase().includes(searchTerm);
              
              const matchesType = !typeFilter || t.type === typeFilter;
              const matchesCategory = !categoryFilter || t.category === categoryFilter;
              
              const matchesDateFrom = !dateFrom || t.date >= dateFrom;
              const matchesDateTo = !dateTo || t.date <= dateTo;
              
              return matchesSearch && matchesType && matchesCategory && matchesDateFrom && matchesDateTo;
          });
          
          currentPage.transaction = 1;
          displayTransactions(filteredTransactions);
          document.getElementById('transactionCount').textContent = `å…± ${filteredTransactions.length} ç­†è¨˜éŒ„`;
      }

      // è¼‰å…¥æ”¶æ“šè³‡æ–™
      function loadReceipts() {
          displayReceipts(allData.receipts);
          updateReceiptCount();
      }

      // é¡¯ç¤ºæ”¶æ“šè³‡æ–™
      function displayReceipts(receipts) {
          const tbody = document.querySelector('#receiptTable tbody');
          const startIndex = (currentPage.receipt - 1) * itemsPerPage;
          const endIndex = startIndex + itemsPerPage;
          const pageReceipts = receipts.slice(startIndex, endIndex);
          
          if (pageReceipts.length === 0) {
              tbody.innerHTML = `
                  <tr>
                      <td colspan="9" class="empty-state">
                          <div class="empty-state-icon">ğŸ“„</div>
                          <div class="empty-state-title">æš«ç„¡æ”¶æ“šè¨˜éŒ„</div>
                          <div class="empty-state-description">é»æ“Šã€Œé–‹ç«‹æ”¶æ“šã€é–‹å§‹é–‹ç«‹æ‚¨çš„ç¬¬ä¸€å¼µæ”¶æ“š</div>
                      </td>
                  </tr>
              `;
              return;
          }
          
          tbody.innerHTML = pageReceipts.map(r => `
              <tr>
                  <td>${formatDate(r.date)}</td>
                  <td>${r.receiptNumber}</td>
                  <td>${r.payer}</td>
                  <td>${r.identity}</td>
                  <td>${r.phone}</td>
                  <td>${r.category}</td>
                  <td>${formatCurrency(r.amount)}</td>
                  <td><span class="badge badge-${r.status === 'å·²é–‹ç«‹' ? 'success' : 'info'}">${r.status}</span></td>
                  <td>
                      <button class="btn btn-sm btn-info" onclick="printReceipt('${r.id}')">åˆ—å°</button>
                      <button class="btn btn-sm btn-success" onclick="emailReceipt('${r.id}')">å¯„é€</button>
                      <button class="btn btn-sm btn-danger" onclick="voidReceipt('${r.id}')">ä½œå»¢</button>
                  </td>
              </tr>
          `).join('');
          
          updatePagination('receipt', receipts.length);
      }

      // æ›´æ–°æ”¶æ“šæ•¸é‡
      function updateReceiptCount() {
          document.getElementById('receiptCount').textContent = `å…± ${allData.receipts.length} ç­†è¨˜éŒ„`;
      }

      // æœå°‹æ”¶æ“š
      function searchReceipts() {
          const searchTerm = document.getElementById('receiptSearch').value.toLowerCase();
          const categoryFilter = document.getElementById('receiptCategory').value;
          const statusFilter = document.getElementById('receiptStatus').value;
          
          let filteredReceipts = allData.receipts.filter(r => {
              const matchesSearch = !searchTerm || 
                  r.receiptNumber.toLowerCase().includes(searchTerm) ||
                  r.payer.toLowerCase().includes(searchTerm);
              
              const matchesCategory = !categoryFilter || r.category === categoryFilter;
              const matchesStatus = !statusFilter || r.status === statusFilter;
              
              return matchesSearch && matchesCategory && matchesStatus;
          });
          
          currentPage.receipt = 1;
          displayReceipts(filteredReceipts);
          document.getElementById('receiptCount').textContent = `å…± ${filteredReceipts.length} ç­†è¨˜éŒ„`;
      }

      // è¼‰å…¥æœƒå“¡è³‡æ–™
      function loadMembers() {
          displayMembers(allData.members);
          updateMemberCount();
      }

      // é¡¯ç¤ºæœƒå“¡è³‡æ–™
      function displayMembers(members) {
          const tbody = document.querySelector('#memberTable tbody');
          const startIndex = (currentPage.member - 1) * itemsPerPage;
          const endIndex = startIndex + itemsPerPage;
          const pageMembers = members.slice(startIndex, endIndex);
          
          if (pageMembers.length === 0) {
              tbody.innerHTML = `
                  <tr>
                      <td colspan="9" class="empty-state">
                          <div class="empty-state-icon">ğŸ‘¥</div>
                          <div class="empty-state-title">æš«ç„¡æœƒå“¡è¨˜éŒ„</div>
                          <div class="empty-state-description">é»æ“Šã€Œæ–°å¢æœƒå“¡ã€é–‹å§‹æ–°å¢æ‚¨çš„ç¬¬ä¸€ä½æœƒå“¡</div>
                      </td>
                  </tr>
              `;
              return;
          }
          
          tbody.innerHTML = pageMembers.map(m => `
              <tr>
                  <td>${m.memberNumber}</td>
                  <td>${m.name}</td>
                  <td>${m.gender}</td>
                  <td>${m.phone}</td>
                  <td>${m.email}</td>
                  <td>${m.type}</td>
                  <td>${formatDate(m.joinDate)}</td>
                  <td><span class="badge badge-${m.status === 'æ­£å¸¸' ? 'success' : 'warning'}">${m.status}</span></td>
                  <td>
                      <button class="btn btn-sm btn-info" onclick="editMember('${m.id}')">ç·¨è¼¯</button>
                      <button class="btn btn-sm btn-warning" onclick="suspendMember('${m.id}')">æš«åœ</button>
                      <button class="btn btn-sm btn-danger" onclick="deleteMember('${m.id}')">åˆªé™¤</button>
                  </td>
              </tr>
          `).join('');
          
          updatePagination('member', members.length);
      }

      // æ›´æ–°æœƒå“¡æ•¸é‡
      function updateMemberCount() {
          document.getElementById('memberCount').textContent = `å…± ${allData.members.length} ç­†è¨˜éŒ„`;
      }

      // æœå°‹æœƒå“¡
      function searchMembers() {
          const searchTerm = document.getElementById('memberSearch').value.toLowerCase();
          const typeFilter = document.getElementById('memberType').value;
          const statusFilter = document.getElementById('memberStatus').value;
          
          let filteredMembers = allData.members.filter(m => {
              const matchesSearch = !searchTerm || 
                  m.memberNumber.toLowerCase().includes(searchTerm) ||
                  m.name.toLowerCase().includes(searchTerm) ||
                  m.phone.includes(searchTerm);
              
              const matchesType = !typeFilter || m.type === typeFilter;
              const matchesStatus = !statusFilter || m.status === statusFilter;
              
              return matchesSearch && matchesType && matchesStatus;
          });
          
          currentPage.member = 1;
          displayMembers(filteredMembers);
          document.getElementById('memberCount').textContent = `å…± ${filteredMembers.length} ç­†è¨˜éŒ„`;
      }

      // è¼‰å…¥æ†‘è­‰è³‡æ–™
      function loadVouchers() {
          displayVouchers(allData.vouchers);
          updateVoucherCount();
      }

      // é¡¯ç¤ºæ†‘è­‰è³‡æ–™
      function displayVouchers(vouchers) {
          const tbody = document.querySelector('#voucherTable tbody');
          
          if (vouchers.length === 0) {
              tbody.innerHTML = `
                  <tr>
                      <td colspan="9" class="empty-state">
                          <div class="empty-state-icon">ğŸ“‹</div>
                          <div class="empty-state-title">æš«ç„¡æ†‘è­‰è¨˜éŒ„</div>
                          <div class="empty-state-description">é»æ“Šã€Œç”³è«‹æ†‘è­‰ã€é–‹å§‹ç”³è«‹æ‚¨çš„ç¬¬ä¸€å¼µæ†‘è­‰</div>
                      </td>
                  </tr>
              `;
              return;
          }
          
          tbody.innerHTML = vouchers.map(v => `
              <tr>
                  <td>${formatDate(v.date)}</td>
                  <td>${v.voucherNumber}</td>
                  <td>${v.applicant}</td>
                  <td>${v.category}</td>
                  <td>${formatCurrency(v.amount)}</td>
                  <td>${v.purpose}</td>
                  <td><span class="badge badge-${getStatusBadgeClass(v.status)}">${v.status}</span></td>
                  <td>${v.hasAttachment ? 'ğŸ“' : '-'}</td>
                  <td>
                      <button class="btn btn-sm btn-info" onclick="viewVoucher('${v.id}')">æŸ¥çœ‹</button>
                      <button class="btn btn-sm btn-success" onclick="approveVoucher('${v.id}')">æ ¸å‡†</button>
                      <button class="btn btn-sm btn-danger" onclick="rejectVoucher('${v.id}')">é§å›</button>
                  </td>
              </tr>
          `).join('');
      }

      // å–å¾—ç‹€æ…‹å¾½ç« æ¨£å¼
      function getStatusBadgeClass(status) {
          switch(status) {
              case 'å¾…å¯©æ ¸': return 'warning';
              case 'å·²æ ¸å‡†': return 'success';
              case 'å·²é§å›': return 'danger';
              case 'å·²æ”¯ä»˜': return 'info';
              default: return 'secondary';
          }
      }

      // æ›´æ–°æ†‘è­‰æ•¸é‡
      function updateVoucherCount() {
          document.getElementById('voucherCount').textContent = `å…± ${allData.vouchers.length} ç­†è¨˜éŒ„`;
      }

      // æœå°‹æ†‘è­‰
      function searchVouchers() {
          const searchTerm = document.getElementById('voucherSearch').value.toLowerCase();
          const categoryFilter = document.getElementById('voucherCategory').value;
          const statusFilter = document.getElementById('voucherStatus').value;
          
          let filteredVouchers = allData.vouchers.filter(v => {
              const matchesSearch = !searchTerm || 
                  v.voucherNumber.toLowerCase().includes(searchTerm) ||
                  v.applicant.toLowerCase().includes(searchTerm);
              
              const matchesCategory = !categoryFilter || v.category === categoryFilter;
              const matchesStatus = !statusFilter || v.status === statusFilter;
              
              return matchesSearch && matchesCategory && matchesStatus;
          });
          
          currentPage.voucher = 1;
          displayVouchers(filteredVouchers);
          document.getElementById('voucherCount').textContent = `å…± ${filteredVouchers.length} ç­†è¨˜éŒ„`;
      }

      // è¼‰å…¥å ±è¡¨
      function loadReports() {
          // å ±è¡¨åŠŸèƒ½åˆå§‹åŒ–
      }

      // è¼‰å…¥è¨­å®š
      function loadSettings() {
          loadOrganizationSettings();
          loadEmailSettings();
          loadSystemInfo();
          loadBackupSettings();
      }

      // è¼‰å…¥çµ„ç¹”è¨­å®š
      function loadOrganizationSettings() {
          // è¼‰å…¥å„²å­˜çš„çµ„ç¹”è¨­å®š
          const orgSettings = getStoredSettings('organization');
          if (orgSettings) {
              document.getElementById('orgName').value = orgSettings.name || 'å°ç£å¸•é‡‘æ£®ç—…å‹æ¬Šç›Šä¿ƒé€²æœƒ';
              document.getElementById('taxId').value = orgSettings.taxId || '';
              document.getElementById('orgAddress').value = orgSettings.address || '';
              document.getElementById('orgPhone').value = orgSettings.phone || '';
              document.getElementById('orgEmail').value = orgSettings.email || '';
              document.getElementById('orgWebsite').value = orgSettings.website || '';
          }
      }

      // è¼‰å…¥éƒµä»¶è¨­å®š
      function loadEmailSettings() {
          const emailSettings = getStoredSettings('email');
          if (emailSettings) {
              document.getElementById('smtpHost').value = emailSettings.host || '';
              document.getElementById('smtpPort').value = emailSettings.port || '587';
              document.getElementById('smtpUser').value = emailSettings.user || '';
              document.getElementById('emailFrom').value = emailSettings.from || '';
              document.getElementById('autoSendReceipt').checked = emailSettings.autoSend || false;
          }
      }

      // è¼‰å…¥ç³»çµ±è³‡è¨Š
      function loadSystemInfo() {
          document.getElementById('systemVersion').textContent = 'v1.0.0';
          document.getElementById('dataCount').textContent = 
              allData.transactions.length + allData.receipts.length + 
              allData.members.length + allData.vouchers.length;
          document.getElementById('lastBackup').textContent = '2024-06-27 10:30';
          document.getElementById('systemHealth').textContent = 'å¥åº·';
      }

      // è¼‰å…¥å‚™ä»½è¨­å®š
      function loadBackupSettings() {
          const backupSettings = getStoredSettings('backup');
          if (backupSettings) {
              document.getElementById('autoBackup').checked = backupSettings.autoBackup !== false;
              document.getElementById('backupFrequency').value = backupSettings.frequency || 'weekly';
              document.getElementById('backupRetention').value = backupSettings.retention || 30;
          }
      }

      // æ›´æ–°åˆ†é 
      function updatePagination(type, totalItems) {
          const totalPages = Math.ceil(totalItems / itemsPerPage);
          const currentPageNum = currentPage[type];
          
          document.getElementById(`${type}PageInfo`).textContent = 
              `ç¬¬ ${currentPageNum} é ï¼Œå…± ${totalPages} é `;
          
          document.getElementById(`${type}PrevBtn`).disabled = currentPageNum <= 1;
          document.getElementById(`${type}NextBtn`).disabled = currentPageNum >= totalPages;
      }

      // ä¸Šä¸€é 
      function previousPage(type) {
          if (currentPage[type] > 1) {
              currentPage[type]--;
              switch(type) {
                  case 'transaction':
                      loadTransactions();
                      break;
                  case 'receipt':
                      loadReceipts();
                      break;
                  case 'member':
                      loadMembers();
                      break;
                  case 'voucher':
                      loadVouchers();
                      break;
              }
          }
      }

      // ä¸‹ä¸€é 
      function nextPage(type) {
          const totalItems = allData[type + 's'].length;
          const totalPages = Math.ceil(totalItems / itemsPerPage);
          
          if (currentPage[type] < totalPages) {
              currentPage[type]++;
              switch(type) {
                  case 'transaction':
                      loadTransactions();
                      break;
                  case 'receipt':
                      loadReceipts();
                      break;
                  case 'member':
                      loadMembers();
                      break;
                  case 'voucher':
                      loadVouchers();
                      break;
              }
          }
      }

      // æ ¼å¼åŒ–æ—¥æœŸ
      function formatDate(dateString) {
          return new Date(dateString).toLocaleDateString('zh-TW');
      }

      // é¡¯ç¤ºè¼‰å…¥å‹•ç•«
      function showLoading() {
          document.getElementById('loading').style.display = 'flex';
      }

      // éš±è—è¼‰å…¥å‹•ç•«
      function hideLoading() {
          document.getElementById('loading').style.display = 'none';
      }

      // é¡¯ç¤ºè­¦å‘Šè¨Šæ¯
      function showAlert(message, type = 'info') {
          const alert = document.getElementById('systemAlert');
          const messageElement = document.getElementById('alertMessage');
          
          alert.className = `alert alert-${type} show`;
          messageElement.textContent = message;
          
          setTimeout(() => {
              alert.classList.remove('show');
          }, 5000);
      }

      // é¡¯ç¤ºæ¨¡æ…‹æ¡†
      function showModal(modalId) {
          document.getElementById(modalId).classList.add('show');
      }

      // é—œé–‰æ¨¡æ…‹æ¡†
      function closeModal(modalId) {
          document.getElementById(modalId).classList.remove('show');
      }

      // é¡¯ç¤ºæ–°å¢äº¤æ˜“æ¨¡æ…‹æ¡†
      function showAddTransactionModal() {
          document.getElementById('addTransactionForm').reset();
          setDefaultDates();
          updateTransactionCategories();
          showModal('addTransactionModal');
      }

      // é¡¯ç¤ºæ–°å¢æ”¶æ“šæ¨¡æ…‹æ¡†
      function showAddReceiptModal() {
          document.getElementById('addReceiptForm').reset();
          setDefaultDates();
          showModal('addReceiptModal');
      }

      // é¡¯ç¤ºæ–°å¢æœƒå“¡æ¨¡æ…‹æ¡†
      function showAddMemberModal() {
          document.getElementById('addMemberForm').reset();
          setDefaultDates();
          showModal('addMemberModal');
      }

      // é¡¯ç¤ºæ–°å¢æ†‘è­‰æ¨¡æ…‹æ¡†
      function showAddVoucherModal() {
          // é€™å€‹å‡½æ•¸åœ¨HTMLä¸­è¢«å¼•ç”¨ä½†æ²’æœ‰å°æ‡‰çš„æ¨¡æ…‹æ¡†
          showAlert('æ†‘è­‰ç”³è«‹åŠŸèƒ½é–‹ç™¼ä¸­', 'info');
      }

      // è™•ç†æ–°å¢äº¤æ˜“
      function handleAddTransaction(e) {
          e.preventDefault();
          
          const formData = new FormData(e.target);
          const transaction = {
              id: `T${String(allData.transactions.length + 1).padStart(4, '0')}`,
              date: document.getElementById('transactionDate').value,
              type: document.getElementById('transactionTypeModal').value,
              category: document.getElementById('transactionCategoryModal').value,
              amount: parseInt(document.getElementById('transactionAmount').value),
              name: document.getElementById('transactionName').value,
              account: document.getElementById('transactionAccount').value,
              description: document.getElementById('transactionDescription').value,
              status: 'å·²ç¢ºèª'
          };
          
          allData.transactions.unshift(transaction);
          
          // å¦‚æœå‹¾é¸è‡ªå‹•ç”¢ç”Ÿæ”¶æ“š
          if (document.getElementById('generateReceipt').checked && transaction.type === 'æ”¶å…¥') {
              const receipt = {
                  id: `R${String(allData.receipts.length + 1).padStart(4, '0')}`,
                  date: transaction.date,
                  receiptNumber: `${new Date().getFullYear()}${String(allData.receipts.length + 1).padStart(4, '0')}`,
                  payer: transaction.name,
                  identity: 'å€‹äºº',
                  phone: '',
                  category: transaction.category === 'æœƒè²»' ? 'æœƒè²»' : 'ææ¬¾',
                  amount: transaction.amount,
                  status: 'å·²é–‹ç«‹'
              };
              allData.receipts.unshift(receipt);
          }
          
          updateStatistics();
          if (currentTab === 'transactions') {
              loadTransactions();
          }
          
          closeModal('addTransactionModal');
          showAlert('äº¤æ˜“æ–°å¢æˆåŠŸ', 'success');
      }

      // è™•ç†æ–°å¢æ”¶æ“š
      function handleAddReceipt(e) {
          e.preventDefault();
          
          const receipt = {
              id: `R${String(allData.receipts.length + 1).padStart(4, '0')}`,
              date: document.getElementById('receiptDate').value,
              receiptNumber: `${new Date().getFullYear()}${String(allData.receipts.length + 1).padStart(4, '0')}`,
              payer: document.getElementById('receiptPayer').value,
              identity: document.getElementById('receiptIdentity').value,
              phone: document.getElementById('receiptPhone').value,
              category: document.getElementById('receiptCategoryModal').value,
              amount: parseInt(document.getElementById('receiptAmount').value),
              status: 'å·²é–‹ç«‹'
          };
          
          allData.receipts.unshift(receipt);
          
          // åŒæ™‚æ–°å¢å°æ‡‰çš„æ”¶å…¥äº¤æ˜“
          const transaction = {
              id: `T${String(allData.transactions.length + 1).padStart(4, '0')}`,
              date: receipt.date,
              type: 'æ”¶å…¥',
              category: receipt.category,
              amount: receipt.amount,
              name: receipt.payer,
              account: 'ç¾é‡‘',
              description: `æ”¶æ“š ${receipt.receiptNumber}`,
              status: 'å·²ç¢ºèª'
          };
          
          allData.transactions.unshift(transaction);
          
          updateStatistics();
          if (currentTab === 'receipts') {
              loadReceipts();
          }
          
          closeModal('addReceiptModal');
          showAlert('æ”¶æ“šé–‹ç«‹æˆåŠŸ', 'success');
          
          // å¦‚æœå‹¾é¸è‡ªå‹•å¯„é€
          if (document.getElementById('autoSendReceiptModal').checked) {
              setTimeout(() => {
                  showAlert('æ”¶æ“šå·²è‡ªå‹•å¯„é€', 'info');
              }, 1000);
          }
      }

      // è™•ç†æ–°å¢æœƒå“¡
      function handleAddMember(e) {
          e.preventDefault();
          
          const member = {
              id: `M${String(allData.members.length + 1).padStart(4, '0')}`,
              memberNumber: `${new Date().getFullYear()}${String(allData.members.length + 1).padStart(3, '0')}`,
              name: document.getElementById('memberName').value,
              gender: document.getElementById('memberGender').value,
              phone: document.getElementById('memberPhone').value,
              email: document.getElementById('memberEmailModal').value,
              type: document.getElementById('memberTypeModal').value,
              joinDate: document.getElementById('memberJoinDate').value,
              status: 'æ­£å¸¸'
          };
          
          allData.members.unshift(member);
          
          updateStatistics();
          if (currentTab === 'members') {
              loadMembers();
          }
          
          closeModal('addMemberModal');
          showAlert('æœƒå“¡æ–°å¢æˆåŠŸ', 'success');
      }

      // è™•ç†çµ„ç¹”è¨­å®š
      function handleOrgSettings(e) {
          e.preventDefault();
          
          const settings = {
              name: document.getElementById('orgName').value,
              taxId: document.getElementById('taxId').value,
              address: document.getElementById('orgAddress').value,
              phone: document.getElementById('orgPhone').value,
              email: document.getElementById('orgEmail').value,
              website: document.getElementById('orgWebsite').value
          };
          
          saveSettings('organization', settings);
          showAlert('çµ„ç¹”è¨­å®šå·²å„²å­˜', 'success');
      }

      // è™•ç†éƒµä»¶è¨­å®š
      function handleEmailSettings(e) {
          e.preventDefault();
          
          const settings = {
              host: document.getElementById('smtpHost').value,
              port: document.getElementById('smtpPort').value,
              user: document.getElementById('smtpUser').value,
              from: document.getElementById('emailFrom').value,
              autoSend: document.getElementById('autoSendReceipt').checked
          };
          
          saveSettings('email', settings);
          showAlert('éƒµä»¶è¨­å®šå·²å„²å­˜', 'success');
      }

      // è™•ç†å‚™ä»½è¨­å®š
      function handleBackupSettings(e) {
          e.preventDefault();
          
          const settings = {
              autoBackup: document.getElementById('autoBackup').checked,
              frequency: document.getElementById('backupFrequency').value,
              retention: document.getElementById('backupRetention').value
          };
          
          saveSettings('backup', settings);
          showAlert('å‚™ä»½è¨­å®šå·²å„²å­˜', 'success');
      }

      // å„²å­˜è¨­å®š
      function saveSettings(key, settings) {
          localStorage.setItem(`accountingSystem_${key}`, JSON.stringify(settings));
      }

      // å–å¾—å„²å­˜çš„è¨­å®š
      function getStoredSettings(key) {
          const stored = localStorage.getItem(`accountingSystem_${key}`);
          return stored ? JSON.parse(stored) : null;
      }

      // åŒ¯å‡ºåŠŸèƒ½
      function exportTransactions() {
          exportToCSV(allData.transactions, 'transactions.csv');
      }

      function exportReceipts() {
          exportToCSV(allData.receipts, 'receipts.csv');
      }

      function exportMembers() {
          exportToCSV(allData.members, 'members.csv');
      }

      function exportVouchers() {
          exportToCSV(allData.vouchers, 'vouchers.csv');
      }

      // åŒ¯å‡ºç‚ºCSV
      function exportToCSV(data, filename) {
          if (data.length === 0) {
              showAlert('æ²’æœ‰è³‡æ–™å¯åŒ¯å‡º', 'warning');
              return;
          }
          
          const headers = Object.keys(data[0]);
          const csvContent = [
              headers.join(','),
              ...data.map(row => headers.map(header => `"${row[header] || ''}"`).join(','))
          ].join('\n');
          
          const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
          const link = document.createElement('a');
          const url = URL.createObjectURL(blob);
          
          link.setAttribute('href', url);
          link.setAttribute('download', filename);
          link.style.visibility = 'hidden';
          
          document.body.appendChild(link);
          link.click();
          document.body.removeChild(link);
          
          showAlert('è³‡æ–™åŒ¯å‡ºæˆåŠŸ', 'success');
      }

      // ç·¨è¼¯åŠŸèƒ½
      function editTransaction(id) {
          showAlert('ç·¨è¼¯åŠŸèƒ½é–‹ç™¼ä¸­', 'info');
      }

      function editMember(id) {
          showAlert('ç·¨è¼¯åŠŸèƒ½é–‹ç™¼ä¸­', 'info');
      }

      // åˆªé™¤åŠŸèƒ½
      function deleteTransaction(id) {
          if (confirm('ç¢ºå®šè¦åˆªé™¤æ­¤äº¤æ˜“è¨˜éŒ„å—ï¼Ÿ')) {
              allData.transactions = allData.transactions.filter(t => t.id !== id);
              loadTransactions();
              updateStatistics();
              showAlert('äº¤æ˜“è¨˜éŒ„å·²åˆªé™¤', 'success');
          }
      }

      function deleteMember(id) {
          if (confirm('ç¢ºå®šè¦åˆªé™¤æ­¤æœƒå“¡å—ï¼Ÿ')) {
              allData.members = allData.members.filter(m => m.id !== id);
              loadMembers();
              updateStatistics();
              showAlert('æœƒå“¡å·²åˆªé™¤', 'success');
          }
      }

      // æ”¶æ“šæ“ä½œ
      function printReceipt(id) {
          showAlert('åˆ—å°åŠŸèƒ½é–‹ç™¼ä¸­', 'info');
      }

      function emailReceipt(id) {
          showAlert('éƒµä»¶å¯„é€åŠŸèƒ½é–‹ç™¼ä¸­', 'info');
      }

      function voidReceipt(id) {
          if (confirm('ç¢ºå®šè¦ä½œå»¢æ­¤æ”¶æ“šå—ï¼Ÿ')) {
              const receipt = allData.receipts.find(r => r.id === id);
              if (receipt) {
                  receipt.status = 'å·²ä½œå»¢';
                  loadReceipts();
                  showAlert('æ”¶æ“šå·²ä½œå»¢', 'success');
              }
          }
      }

      // æ†‘è­‰æ“ä½œ
      function viewVoucher(id) {
          showAlert('æŸ¥çœ‹åŠŸèƒ½é–‹ç™¼ä¸­', 'info');
      }

      function approveVoucher(id) {
          const voucher = allData.vouchers.find(v => v.id === id);
          if (voucher) {
              voucher.status = 'å·²æ ¸å‡†';
              loadVouchers();
              showAlert('æ†‘è­‰å·²æ ¸å‡†', 'success');
          }
      }

      function rejectVoucher(id) {
          const voucher = allData.vouchers.find(v => v.id === id);
          if (voucher) {
              voucher.status = 'å·²é§å›';
              loadVouchers();
              showAlert('æ†‘è­‰å·²é§å›', 'warning');
          }
      }

      // æœƒå“¡æ“ä½œ
      function suspendMember(id) {
          const member = allData.members.find(m => m.id === id);
          if (member) {
              member.status = member.status === 'æ­£å¸¸' ? 'æš«åœ' : 'æ­£å¸¸';
              loadMembers();
              updateStatistics();
              showAlert(`æœƒå“¡å·²${member.status === 'æš«åœ' ? 'æš«åœ' : 'æ¢å¾©'}`, 'success');
          }
      }

      // å ±è¡¨åŠŸèƒ½
      function generateReport() {
          const reportType = document.getElementById('reportType').value;
          const reportYear = document.getElementById('reportYear').value;
          const reportMonth = document.getElementById('reportMonth').value;
          
          showAlert('å ±è¡¨ç”¢ç”ŸåŠŸèƒ½é–‹ç™¼ä¸­', 'info');
          document.getElementById('reportToolbar').style.display = 'flex';
      }

      function exportReport() {
          showAlert('å ±è¡¨åŒ¯å‡ºåŠŸèƒ½é–‹ç™¼ä¸­', 'info');
      }

      function printReport() {
          showAlert('å ±è¡¨åˆ—å°åŠŸèƒ½é–‹ç™¼ä¸­', 'info');
      }

      function emailReport() {
          showAlert('å ±è¡¨éƒµä»¶åŠŸèƒ½é–‹ç™¼ä¸­', 'info');
      }

      // ç³»çµ±ç¶­è­·åŠŸèƒ½
      function performSystemCheck() {
          showAlert('æ­£åœ¨åŸ·è¡Œç³»çµ±æª¢æŸ¥...', 'info');
          setTimeout(() => {
              showAlert('ç³»çµ±æª¢æŸ¥å®Œæˆï¼Œä¸€åˆ‡æ­£å¸¸', 'success');
          }, 2000);
      }

      function cleanupSystem() {
          if (confirm('ç¢ºå®šè¦æ¸…ç†ç³»çµ±å—ï¼Ÿé€™å°‡æ¸…é™¤è‡¨æ™‚æª”æ¡ˆã€‚')) {
              showAlert('ç³»çµ±æ¸…ç†å®Œæˆ', 'success');
          }
      }

      function viewSystemLogs() {
          showAlert('ç³»çµ±æ—¥èªŒåŠŸèƒ½é–‹ç™¼ä¸­', 'info');
      }

      function createBackup() {
          showAlert('æ­£åœ¨å»ºç«‹å‚™ä»½...', 'info');
          setTimeout(() => {
              showAlert('å‚™ä»½å»ºç«‹æˆåŠŸ', 'success');
              document.getElementById('lastBackup').textContent = new Date().toLocaleString('zh-TW');
          }, 2000);
      }

      function createManualBackup() {
          createBackup();
      }

      function viewBackupHistory() {
          showAlert('å‚™ä»½è¨˜éŒ„åŠŸèƒ½é–‹ç™¼ä¸­', 'info');
      }

      // æ¸¬è©¦éƒµä»¶è¨­å®š
      function testEmailSettings() {
          showAlert('æ­£åœ¨æ¸¬è©¦éƒµä»¶è¨­å®š...', 'info');
          setTimeout(() => {
              showAlert('éƒµä»¶æ¸¬è©¦æˆåŠŸ', 'success');
          }, 2000);
      }

      // é‡è¨­è¡¨å–®
      function resetOrgForm() {
          if (confirm('ç¢ºå®šè¦é‡è¨­çµ„ç¹”è¨­å®šå—ï¼Ÿ')) {
              document.getElementById('organizationForm').reset();
          }
      }

      function resetEmailForm() {
          if (confirm('ç¢ºå®šè¦é‡è¨­éƒµä»¶è¨­å®šå—ï¼Ÿ')) {
              document.getElementById('emailForm').reset();
          }
      }

      // åŒ¯å…¥æœƒå“¡
      function importMembers() {
          showAlert('æœƒå“¡åŒ¯å…¥åŠŸèƒ½é–‹ç™¼ä¸­', 'info');
      }

      // ç•¶å‰ä½¿ç”¨è€…è³‡è¨Š
      document.getElementById('currentUser').textContent = 'ç³»çµ±ç®¡ç†å“¡';

      // ç³»çµ±ç‹€æ…‹æª¢æŸ¥
      setInterval(() => {
          // æ¨¡æ“¬ç³»çµ±ç‹€æ…‹æª¢æŸ¥
          const status = Math.random() > 0.1 ? 'ç³»çµ±æ­£å¸¸' : 'ç³»çµ±è­¦å‘Š';
          const statusElement = document.getElementById('systemStatus');
          statusElement.textContent = status;
          statusElement.className = `badge badge-${status === 'ç³»çµ±æ­£å¸¸' ? 'success' : 'warning'}`;
      }, 30000); // æ¯30ç§’æª¢æŸ¥ä¸€æ¬¡

      console.log('å°ç£å¸•é‡‘æ£®ç—…å‹æ¬Šç›Šä¿ƒé€²æœƒ - æœƒè¨ˆç®¡ç†ç³»çµ±è¼‰å…¥å®Œæˆ');
  </script>
</body>
</html>
