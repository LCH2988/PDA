
<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <title>三鐵協會 - 首頁</title>
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <style>
    body { font-family: Arial, sans-serif; background: linear-gradient(135deg,#667eea,#764ba2); margin:0; min-height:100vh; color:#333; }
    .container { max-width: 1100px; margin: 0 auto; padding: 30px; }
    header { background: rgba(255,255,255,.95); padding: 1rem 2rem; border-radius: 12px; box-shadow:0 4px 18px rgba(0,0,0,.1); display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap; }
    h1 { margin:0; font-size:1.8rem; color:#667eea; }
    .hero { margin-top:40px; background:rgba(255,255,255,.95); padding:2rem; border-radius:18px; box-shadow:0 8px 28px rgba(0,0,0,.15); display:grid; gap:2rem; grid-template-columns:repeat(auto-fit,minmax(300px,1fr)); }
    .panel { background:#f8f9ff; border:2px solid #e3e7ff; border-radius:14px; padding:1.5rem; position:relative; }
    .panel h2 { margin-top:0; color:#4b5ed7; font-size:1.2rem; }
    label { display:block; font-weight:bold; margin-top:10px; font-size:.85rem; }
    input { width:100%; padding:10px 12px; border:2px solid #d4daf5; border-radius:8px; margin-top:4px; font-size:.9rem; }
    input:focus { outline:none; border-color:#667eea; box-shadow:0 0 0 2px rgba(102,126,234,.25); }
    .btn { background:linear-gradient(45deg,#667eea,#764ba2); color:#fff; padding:12px 18px; border:none; border-radius:30px; cursor:pointer; font-weight:bold; width:100%; margin-top:16px; font-size:.95rem; box-shadow:0 6px 20px -5px rgba(102,126,234,.5); transition:.3s; }
    .btn:hover { transform:translateY(-3px); box-shadow:0 10px 28px -6px rgba(102,126,234,.55); }
    .link-btn { background:transparent; border:2px solid #667eea; color:#667eea; }
    .message { margin-top:12px; font-size:.8rem; min-height:20px; }
    .success { color:#1e7e34; }
    .error { color:#c0392b; }
    footer { text-align:center; color:#eef; margin-top:50px; font-size:.75rem; }
    .nav-links a { color:#667eea; text-decoration:none; font-weight:bold; margin-left:12px; font-size:.85rem; background:#fff; padding:6px 14px; border-radius:20px; box-shadow:0 2px 6px rgba(0,0,0,.1); }
    .nav-links a:hover { background:#667eea; color:#fff; }
    ul.features { padding-left:20px; margin-top:8px; font-size:.8rem; line-height:1.4; }
    .badge { display:inline-block; background:#ffd75d; color:#664400; padding:4px 10px; border-radius:20px; font-size:.7rem; font-weight:bold; margin-bottom:8px; }
    @media (max-width:700px){ header { flex-direction:column; align-items:flex-start; } .nav-links { margin-top:10px; } }
  </style>
</head>
<body>
  <header>
    <h1>🏊‍♂️🚴‍♂️🏃‍♂️ 三鐵協會</h1>
    <div class="nav-links">
      <a href="member.html">會員專區</a>
      <a href="admin.html">管理後台</a>
    </div>
  </header>
  <div class="container">
    <section class="hero">
      <div class="panel">
        <span class="badge">快速註冊</span>
        <h2>加入會員</h2>
        <form id="registerForm">
          <label>姓名 *</label>
          <input name="name" required />
          <label>Email *</label>
          <input name="email" type="email" required />
          <label>密碼 *</label>
          <input name="password" type="password" minlength="6" required />
          <label>電話</label>
          <input name="phone" />
          <label>性別</label>
          <input name="gender" placeholder="男 / 女 / 其他" />
          <button class="btn" type="submit">註冊</button>
          <div id="registerMessage" class="message"></div>
        </form>
      </div>
      <div class="panel">
        <span class="badge" style="background:#7ddc82;color:#145d1f;">會員登入</span>
        <h2>登入系統</h2>
        <form id="loginForm">
          <label>Email *</label>
          <input name="email" type="email" required />
          <label>密碼 *</label>
          <input name="password" type="password" required />
          <button class="btn" type="submit">登入</button>
          <div id="loginMessage" class="message"></div>
        </form>
        <hr style="margin:25px 0;border:none;border-top:1px dashed #ccd;">
        <h3 style="margin:0;font-size:1rem;color:#4b5ed7;">系統特色</h3>
        <ul class="features">
          <li>線上活動報名與即時名額控管</li>
          <li>會員專區查看 / 取消報名</li>
          <li>管理後台活動與統計圖卡</li>
          <li>可擴充：成績上傳 / 分組 / 支付整合</li>
        </ul>
      </div>
    </section>
    <footer>
      Triathlon Association System © 2025 - Built for demonstration
    </footer>
  </div>
  <script>
    const API_URL = 'https://script.google.com/macros/s/AKfycbxf3ZQ-egGXbxH8ujY6YUOj3kSY5kraOTzTy14qeXTW8Vc_bUt4Wmyd7u56EGoffdU/exec'; // <-- 替換

    function setMessage(id, msg, ok) {
      const el = document.getElementById(id);
      el.className = 'message ' + (ok ? 'success' : 'error');
      el.textContent = msg;
    }

    document.getElementById('registerForm').addEventListener('submit', async e => {
      e.preventDefault();
      const fd = new FormData(e.target);
      setMessage('registerMessage','處理中...', true);
      try {
        const res = await fetch(API_URL, {
          method:'POST',
          headers:{'Content-Type':'application/json'},
          body: JSON.stringify({
            action:'register',
            name: fd.get('name'),
            email: fd.get('email'),
            password: fd.get('password'),
            phone: fd.get('phone'),
            gender: fd.get('gender')
          })
        });
        const json = await res.json();
          if (json.success) {
            setMessage('registerMessage','註冊成功，請直接登入。', true);
            e.target.reset();
          } else setMessage('registerMessage', json.message, false);
      } catch(err) {
        setMessage('registerMessage','發生錯誤：'+err, false);
      }
    });

    document.getElementById('loginForm').addEventListener('submit', async e => {
      e.preventDefault();
      const fd = new FormData(e.target);
      setMessage('loginMessage','登入中...', true);
      try {
        const res = await fetch(API_URL, {
          method:'POST',
          headers:{'Content-Type':'application/json'},
          body: JSON.stringify({
            action:'login',
            email: fd.get('email'),
            password: fd.get('password')
          })
        });
        const json = await res.json();
        if (json.success) {
          localStorage.setItem('memberInfo', JSON.stringify(json.member));
          localStorage.setItem('sessionToken', json.sessionToken);
          setMessage('loginMessage','登入成功，前往會員專區...', true);
          setTimeout(()=>location.href='member.html',800);
        } else {
          setMessage('loginMessage', json.message, false);
        }
      } catch(err) {
        setMessage('loginMessage','發生錯誤：'+err, false);
      }
    });
  </script>
</body>
</html>
