<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å¸•é‡‘æ£®ç—…å‹æœƒç®¡ç†ç³»çµ±</title>
  <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAEAIABoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAQAABILAAASCwAAAAAAAAAAAAD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A4CAg/+AgIP/gICD/4CAg/+AgIP/gICD/4CAg/+AgIP/gICD/4CAg/////wD///8A////AP///wD///8A4CAg/+AgIP/gICD/4CAg/+AgIP/gICD/4CAg/+AgIP/gICD/4CAg/+AgIP/gICD/////AP///wD///8A4CAg/+AgIP/gICD/4CAg/+AgIP/gICD/4CAg/+AgIP/gICD/4CAg/+AgIP/gICD/4CAg/////wD///8A4CAg/+AgIP/gICD/4CAg/+AgIP/gICD/4CAg/+AgIP/gICD/4CAg/+AgIP/gICD/4CAg/+AgIP////8A////AOAgIP/gICD/4CAg/+AgIP/gICD/4CAg/+AgIP/gICD/4CAg/+AgIP/gICD/4CAg/+AgIP/gICD/////AP///wDgICD/4CAg/+AgIP/gICD/4CAg/+AgIP/gICD/4CAg/+AgIP/gICD/4CAg/+AgIP/gICD/4CAg/////wD///8A4CAg/+AgIP/gICD/4CAg/+AgIP/gICD/4CAg/+AgIP/gICD/4CAg/+AgIP/gICD/4CAg/+AgIP////8A////AOAgIP/gICD/4CAg/+AgIP/gICD/4CAg/+AgIP/gICD/4CAg/+AgIP/gICD/4CAg/+AgIP/gICD/////AP///wDgICD/4CAg/+AgIP/gICD/4CAg/+AgIP/gICD/4CAg/+AgIP/gICD/4CAg/+AgIP/gICD/4CAg/////wD///8A4CAg/+AgIP/gICD/4CAg/+AgIP/gICD/4CAg/+AgIP/gICD/4CAg/+AgIP/gICD/4CAg/+AgIP////8A////AP///wDgICD/4CAg/+AgIP/gICD/4CAg/+AgIP/gICD/4CAg/+AgIP/gICD/4CAg/+AgIP////8A////AP///wD///8A4CAg/+AgIP/gICD/4CAg/+AgIP/gICD/4CAg/+AgIP/gICD/4CAg/+AgIP////8A////AP///wD///8A////AOAgIP/gICD/4CAg/+AgIP/gICD/4CAg/+AgIP/gICD/4CAg/+AgIP////8A////AP///wD///8A////AP///wDgICD/4CAg/+AgIP/gICD/4CAg/+AgIP/gICD/4CAg/+AgIP////8A////AP///wD///8A////AP///wD///8A4CAg/+AgIP/gICD/4CAg/+AgIP/gICD/4CAg/+AgIP////8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A////AP///wD///8A">
  <style>
      * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
      }

      body {
          font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          min-height: 100vh;
          padding: 20px;
      }

      .container {
          max-width: 1200px;
          margin: 0 auto;
          background: white;
          border-radius: 15px;
          box-shadow: 0 10px 30px rgba(0,0,0,0.2);
          overflow: hidden;
      }

      .header {
          background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
          color: white;
          padding: 30px;
          text-align: center;
      }

      .header h1 {
          font-size: 2.5em;
          margin-bottom: 10px;
      }

      .header p {
          font-size: 1.2em;
          opacity: 0.9;
      }

      .nav-tabs {
          display: flex;
          background: #f8f9fa;
          border-bottom: 1px solid #dee2e6;
          flex-wrap: wrap;
      }

      .nav-tab {
          flex: 1;
          min-width: 120px;
          padding: 15px 10px;
          background: none;
          border: none;
          cursor: pointer;
          font-size: 14px;
          font-weight: 500;
          color: #6c757d;
          transition: all 0.3s ease;
          text-align: center;
      }

      .nav-tab:hover {
          background: #e9ecef;
          color: #495057;
      }

      .nav-tab.active {
          background: white;
          color: #4CAF50;
          border-bottom: 3px solid #4CAF50;
      }

      .tab-content {
          display: none;
          padding: 30px;
      }

      .tab-content.active {
          display: block;
      }

      .form-group {
          margin-bottom: 20px;
      }

      .form-group label {
          display: block;
          margin-bottom: 8px;
          font-weight: 600;
          color: #333;
      }

      .form-group input,
      .form-group select,
      .form-group textarea {
          width: 100%;
          padding: 12px 15px;
          border: 2px solid #e1e5e9;
          border-radius: 8px;
          font-size: 16px;
          transition: border-color 0.3s ease;
      }

      .form-group input:focus,
      .form-group select:focus,
      .form-group textarea:focus {
          outline: none;
          border-color: #4CAF50;
      }

      .btn {
          padding: 12px 30px;
          border: none;
          border-radius: 8px;
          font-size: 16px;
          font-weight: 600;
          cursor: pointer;
          transition: all 0.3s ease;
          margin-right: 10px;
          margin-bottom: 10px;
      }

      .btn-primary {
          background: #4CAF50;
          color: white;
      }

      .btn-primary:hover {
          background: #45a049;
          transform: translateY(-2px);
      }

      .btn-secondary {
          background: #6c757d;
          color: white;
      }

      .btn-secondary:hover {
          background: #5a6268;
      }

      .btn-danger {
          background: #dc3545;
          color: white;
      }

      .btn-danger:hover {
          background: #c82333;
      }

      .alert {
          padding: 15px;
          margin-bottom: 20px;
          border-radius: 8px;
          font-weight: 500;
      }

      .alert-success {
          background: #d4edda;
          color: #155724;
          border: 1px solid #c3e6cb;
      }

      .alert-error {
          background: #f8d7da;
          color: #721c24;
          border: 1px solid #f5c6cb;
      }

      .alert-info {
          background: #d1ecf1;
          color: #0c5460;
          border: 1px solid #bee5eb;
      }

      .card {
          background: white;
          border-radius: 10px;
          padding: 20px;
          margin-bottom: 20px;
          box-shadow: 0 2px 10px rgba(0,0,0,0.1);
          border-left: 4px solid #4CAF50;
      }

      .card h3 {
          color: #333;
          margin-bottom: 15px;
          font-size: 1.3em;
      }

      .card p {
          color: #666;
          line-height: 1.6;
          margin-bottom: 10px;
      }

      .activity-list {
          display: grid;
          gap: 20px;
      }

      .activity-item {
          background: #f8f9fa;
          padding: 20px;
          border-radius: 10px;
          border-left: 4px solid #4CAF50;
      }

      .activity-item h4 {
          color: #333;
          margin-bottom: 10px;
      }

      .activity-item .meta {
          color: #666;
          font-size: 14px;
          margin-bottom: 10px;
      }

      .activity-item .description {
          color: #555;
          margin-bottom: 15px;
          line-height: 1.5;
      }

      .loading {
          text-align: center;
          padding: 40px;
          color: #666;
      }

      .spinner {
          border: 4px solid #f3f3f3;
          border-top: 4px solid #4CAF50;
          border-radius: 50%;
          width: 40px;
          height: 40px;
          animation: spin 1s linear infinite;
          margin: 0 auto 20px;
      }

      @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
      }

      .form-row {
          display: flex;
          gap: 20px;
      }

      .form-row .form-group {
          flex: 1;
      }

      .status-badge {
          display: inline-block;
          padding: 4px 12px;
          border-radius: 20px;
          font-size: 12px;
          font-weight: 600;
          text-transform: uppercase;
      }

      .status-active {
          background: #d4edda;
          color: #155724;
      }

      .status-pending {
          background: #fff3cd;
          color: #856404;
      }

      .status-inactive {
          background: #f8d7da;
          color: #721c24;
      }

      .demo-notice {
          background: #fff3cd;
          color: #856404;
          padding: 15px;
          border-radius: 8px;
          margin-bottom: 20px;
          border: 1px solid #ffeaa7;
      }

      @media (max-width: 768px) {
          .container {
              margin: 10px;
              border-radius: 10px;
          }

          .header {
              padding: 20px;
          }

          .header h1 {
              font-size: 2em;
          }

          .nav-tabs {
              flex-direction: column;
          }

          .nav-tab {
              flex: none;
              width: 100%;
          }

          .tab-content {
              padding: 20px;
          }

          .form-row {
              flex-direction: column;
              gap: 0;
          }
      }
  </style>
</head>
<body>
  <div class="container">
      <div class="header">
          <h1>ğŸŒŸ å¸•é‡‘æ£®ç—…å‹æœƒç®¡ç†ç³»çµ±</h1>
          <p>é—œæ‡·ã€æ”¯æŒã€å…±åŒæˆé•·</p>
      </div>

      <div class="demo-notice">
          <strong>ğŸ“¢ ç³»çµ±èªªæ˜ï¼š</strong>é€™æ˜¯ç¤ºç¯„ç‰ˆæœ¬ï¼Œå¯¦éš›åŠŸèƒ½éœ€è¦é€£æ¥ Google Apps Script å¾Œç«¯ã€‚è«‹åƒè€ƒéƒ¨ç½²èªªæ˜æ–‡ä»¶é€²è¡Œå®Œæ•´è¨­å®šã€‚
      </div>

      <div class="nav-tabs">
          <button class="nav-tab active" onclick="showTab('register')">æœƒå“¡è¨»å†Š</button>
          <button class="nav-tab" onclick="showTab('profile')">å€‹äººè³‡æ–™</button>
          <button class="nav-tab" onclick="showTab('activities')">æ´»å‹•å ±å</button>
          <button class="nav-tab" onclick="showTab('volunteer')">å¿—å·¥æœå‹™</button>
          <button class="nav-tab" onclick="showTab('donation')">æ„›å¿ƒææ¬¾</button>
          <button class="nav-tab" onclick="showTab('admin')">ç®¡ç†åŠŸèƒ½</button>
      </div>

      <!-- æœƒå“¡è¨»å†Š -->
      <div id="register" class="tab-content active">
          <div class="card">
              <h3>ğŸ¯ æœƒå“¡è¨»å†Š</h3>
              <p>æ­¡è¿åŠ å…¥å¸•é‡‘æ£®ç—…å‹æœƒï¼è«‹å¡«å¯«ä»¥ä¸‹è³‡æ–™å®Œæˆè¨»å†Šã€‚</p>
          </div>

          <form id="registerForm">
              <div class="form-row">
                  <div class="form-group">
                      <label for="lineId">LINE ID *</label>
                      <input type="text" id="lineId" name="lineId" required placeholder="è«‹è¼¸å…¥æ‚¨çš„LINE ID">
                  </div>
                  <div class="form-group">
                      <label for="lineName">LINE æš±ç¨±</label>
                      <input type="text" id="lineName" name="lineName" placeholder="æ‚¨çš„LINEé¡¯ç¤ºåç¨±">
                  </div>
              </div>

              <div class="form-row">
                  <div class="form-group">
                      <label for="realName">çœŸå¯¦å§“å *</label>
                      <input type="text" id="realName" name="realName" required placeholder="è«‹è¼¸å…¥çœŸå¯¦å§“å">
                  </div>
                  <div class="form-group">
                      <label for="memberType">æœƒå“¡é¡åˆ¥ *</label>
                      <select id="memberType" name="memberType" required>
                          <option value="">è«‹é¸æ“‡</option>
                          <option value="ç—…å‹">ç—…å‹</option>
                          <option value="å®¶å±¬">å®¶å±¬</option>
                          <option value="å¿—å·¥">å¿—å·¥</option>
                          <option value="é†«è­·">é†«è­·äººå“¡</option>
                          <option value="æ”¯æŒè€…">æ”¯æŒè€…</option>
                      </select>
                  </div>
              </div>

              <div class="form-row">
                  <div class="form-group">
                      <label for="phone">è¯çµ¡é›»è©±</label>
                      <input type="tel" id="phone" name="phone" placeholder="09XX-XXX-XXX">
                  </div>
                  <div class="form-group">
                      <label for="email">é›»å­éƒµä»¶</label>
                      <input type="email" id="email" name="email" placeholder="example@email.com">
                  </div>
              </div>

              <div class="form-row">
                  <div class="form-group">
                      <label for="birthday">ç”Ÿæ—¥</label>
                      <input type="date" id="birthday" name="birthday">
                  </div>
                  <div class="form-group">
                      <label for="address">é€šè¨Šåœ°å€</label>
                      <input type="text" id="address" name="address" placeholder="å®Œæ•´åœ°å€">
                  </div>
              </div>

              <button type="submit" class="btn btn-primary">æäº¤è¨»å†Š</button>
              <button type="reset" class="btn btn-secondary">é‡ç½®è¡¨å–®</button>
          </form>
      </div>

      <!-- å€‹äººè³‡æ–™ -->
      <div id="profile" class="tab-content">
          <div class="card">
              <h3>ğŸ‘¤ å€‹äººè³‡æ–™ç®¡ç†</h3>
              <p>æŸ¥çœ‹å’Œæ›´æ–°æ‚¨çš„å€‹äººè³‡æ–™ã€‚</p>
          </div>

          <div class="alert alert-info">
              <strong>ç¤ºç¯„æ¨¡å¼ï¼š</strong>è«‹å…ˆå®Œæˆå¾Œç«¯è¨­å®šä»¥ä½¿ç”¨æ­¤åŠŸèƒ½ã€‚
          </div>
      </div>

      <!-- æ´»å‹•å ±å -->
      <div id="activities" class="tab-content">
          <div class="card">
              <h3>ğŸª æ´»å‹•å ±å</h3>
              <p>åƒèˆ‡æˆ‘å€‘ç²¾å¿ƒå®‰æ’çš„å„ç¨®æ´»å‹•ï¼Œèˆ‡ç—…å‹å€‘ä¸€èµ·å­¸ç¿’æˆé•·ã€‚</p>
          </div>

          <div class="activity-list">
              <div class="activity-item">
                  <h4>ğŸ¥ å¥åº·è¬›åº§ï¼šå¸•é‡‘æ£®ç—…çš„æ—¥å¸¸ç…§è­·</h4>
                  <div class="meta">ğŸ“… 2024-12-01 14:00-16:00 | ğŸ“ å°åŒ—å¸‚ç«‹é†«é™¢ | ğŸ’° å…è²» | ğŸ‘¥ 25/30</div>
                  <div class="description">é‚€è«‹å°ˆæ¥­é†«å¸«åˆ†äº«å¸•é‡‘æ£®ç—…çš„æ—¥å¸¸ç…§è­·æŠ€å·§ï¼ŒåŒ…å«é‹å‹•å¾©å¥ã€é£²é£Ÿç‡Ÿé¤Šç­‰é‡è¦çŸ¥è­˜ã€‚</div>
                  <span class="status-badge status-active">é–‹æ”¾å ±å</span>
                  <button onclick="demoAlert()" class="btn btn-primary">ç«‹å³å ±å</button>
              </div>
              
              <div class="activity-item">
                  <h4>ğŸµ éŸ³æ¨‚æ²»ç™‚é«”é©—èª²ç¨‹</h4>
                  <div class="meta">ğŸ“… 2024-12-08 10:00-12:00 | ğŸ“ ç¤¾å€æ´»å‹•ä¸­å¿ƒ | ğŸ’° $200 | ğŸ‘¥ 18/20</div>
                  <div class="description">é€ééŸ³æ¨‚ç¯€æ‹å’Œæ­Œå”±æ´»å‹•ï¼Œæ”¹å–„å‹•ä½œå”èª¿èƒ½åŠ›ï¼Œæå‡ç”Ÿæ´»å“è³ªã€‚</div>
                  <span class="status-badge status-active">é–‹æ”¾å ±å</span>
                  <button onclick="demoAlert()" class="btn btn-primary">ç«‹å³å ±å</button>
              </div>

              <div class="activity-item">
                  <h4>ğŸ³ ç‡Ÿé¤Šæ–™ç†å·¥ä½œåŠ</h4>
                  <div class="meta">ğŸ“… 2024-12-15 13:30-16:30 | ğŸ“ çƒ¹é£ªæ•™å®¤ | ğŸ’° $500 | ğŸ‘¥ 12/15</div>
                  <div class="description">å­¸ç¿’è£½ä½œé©åˆå¸•é‡‘æ£®ç—…å‹çš„ç‡Ÿé¤Šé¤é»ï¼Œç”±ç‡Ÿé¤Šå¸«è¦ªè‡ªæŒ‡å°ã€‚</div>
                  <span class="status-badge status-active">é–‹æ”¾å ±å</span>
                  <button onclick="demoAlert()" class="btn btn-primary">ç«‹å³å ±å</button>
              </div>
          </div>
      </div>

      <!-- å¿—å·¥æœå‹™ -->
      <div id="volunteer" class="tab-content">
          <div class="card">
              <h3>ğŸ¤ å¿—å·¥æœå‹™</h3>
              <p>åŠ å…¥æˆ‘å€‘çš„å¿—å·¥è¡Œåˆ—ï¼Œç”¨æ„›å¿ƒå’Œè¡Œå‹•å¹«åŠ©æ›´å¤šéœ€è¦çš„äººã€‚</p>
          </div>

          <div class="activity-list">
              <div class="activity-item">
                  <h4>ğŸ¤ æ´»å‹•å”åŠ©å¿—å·¥</h4>
                  <div class="meta">ğŸ“… 2024-12-01 13:00-17:00 | ğŸ‘¥ éœ€è¦ 5 äºº</div>
                  <div class="description">å”åŠ©å¥åº·è¬›åº§çš„ç°½åˆ°ã€æœƒå ´æ•´ç†åŠæ´»å‹•é€²è¡Œ</div>
                  <span class="status-badge status-active">é–‹æ”¾å ±å</span>
                  <button onclick="demoAlert()" class="btn btn-primary">ç”³è«‹æœå‹™</button>
              </div>
              
              <div class="activity-item">
                  <h4>ğŸ’ é™ªä¼´æœå‹™å¿—å·¥</h4>
                  <div class="meta">ğŸ“… 2024-12-08 09:30-12:30 | ğŸ‘¥ éœ€è¦ 3 äºº</div>
                  <div class="description">é™ªä¼´ç—…å‹åƒèˆ‡å¾©å¥èª²ç¨‹ï¼Œæä¾›æƒ…æ„Ÿæ”¯æŒ</div>
                  <span class="status-badge status-active">é–‹æ”¾å ±å</span>
                  <button onclick="demoAlert()" class="btn btn-primary">ç”³è«‹æœå‹™</button>
              </div>
          </div>
      </div>

      <!-- æ„›å¿ƒææ¬¾ -->
      <div id="donation" class="tab-content">
          <div class="card">
              <h3>ğŸ’ æ„›å¿ƒææ¬¾</h3>
              <p>æ‚¨çš„æ¯ä¸€ä»½æ„›å¿ƒéƒ½å°‡ç”¨æ–¼æ”¯æŒç—…å‹æœƒçš„å„é …æœå‹™å’Œæ´»å‹•ã€‚</p>
          </div>

          <form id="donationForm">
              <div class="form-row">
                  <div class="form-group">
                      <label for="donationAmount">ææ¬¾é‡‘é¡ *</label>
                      <input type="number" id="donationAmount" name="amount" required min="1" placeholder="è«‹è¼¸å…¥ææ¬¾é‡‘é¡">
                  </div>
                  <div class="form-group">
                      <label for="donationCategory">ææ¬¾é¡åˆ¥</label>
                      <select id="donationCategory" name="category">
                          <option value="ä¸€èˆ¬ææ¬¾">ä¸€èˆ¬ææ¬¾</option>
                          <option value="æ´»å‹•è´ŠåŠ©">æ´»å‹•è´ŠåŠ©</option>
                          <option value="è¨­å‚™è³¼ç½®">è¨­å‚™è³¼ç½®</option>
                          <option value="å…¶ä»–">å…¶ä»–</option>
                      </select>
                  </div>
              </div>

              <div class="form-group">
                  <label for="donationDescription">ææ¬¾èªªæ˜</label>
                  <textarea id="donationDescription" name="description" rows="3" placeholder="è«‹æè¿°æ‚¨çš„ææ¬¾ç”¨é€”æˆ–ç•™è¨€"></textarea>
              </div>

              <div class="form-group">
                  <label>
                      <input type="checkbox" id="needReceipt" name="needReceipt" value="TRUE">
                      éœ€è¦ææ¬¾æ”¶æ“šï¼ˆå¯ç”¨æ–¼å ±ç¨…ï¼‰
                  </label>
              </div>

              <button type="submit" class="btn btn-primary">ç¢ºèªææ¬¾</button>
          </form>
      </div>

      <!-- ç®¡ç†åŠŸèƒ½ -->
      <div id="admin" class="tab-content">
          <div class="card">
              <h3>âš™ï¸ ç®¡ç†åŠŸèƒ½</h3>
              <p>ç®¡ç†å“¡å°ˆç”¨åŠŸèƒ½ï¼ŒåŒ…å«æœƒå“¡å¯©æ ¸ã€æ´»å‹•ç®¡ç†ç­‰ã€‚</p>
          </div>

          <div class="alert alert-info">
              <strong>ç¤ºç¯„æ¨¡å¼ï¼š</strong>ç®¡ç†åŠŸèƒ½éœ€è¦å®Œæ•´çš„å¾Œç«¯è¨­å®šæ‰èƒ½ä½¿ç”¨ã€‚
          </div>
      </div>
  </div>

  <script>
      // ç¤ºç¯„ç”¨çš„ API URLï¼ˆéœ€è¦æ›¿æ›ç‚ºå¯¦éš›çš„ GAS Web App URLï¼‰
      const API_URL = 'https://script.google.com/macros/s/AKfycbww3oJgQTkUU94Gc12TJPSmIHw9LjdNVjlmIJUUPXQU2FCYFGs5cj4rnbf3cXwHMgElbQ/exec';
      let currentUser = null;
      let isAdmin = false;

      // é é¢è¼‰å…¥å®Œæˆå¾ŒåŸ·è¡Œ
      document.addEventListener('DOMContentLoaded', function() {
          bindFormEvents();
          initializePage();
      });

      // ç¶å®šè¡¨å–®äº‹ä»¶
      function bindFormEvents() {
          document.getElementById('registerForm').addEventListener('submit', handleRegister);
          document.getElementById('donationForm').addEventListener('submit', handleDonation);
      }

      // åˆ‡æ›æ¨™ç±¤é 
      function showTab(tabName) {
          // éš±è—æ‰€æœ‰æ¨™ç±¤å…§å®¹
          const tabs = document.querySelectorAll('.tab-content');
          tabs.forEach(tab => tab.classList.remove('active'));
          
          // ç§»é™¤æ‰€æœ‰æ¨™ç±¤æŒ‰éˆ•çš„æ´»å‹•ç‹€æ…‹
          const navTabs = document.querySelectorAll('.nav-tab');
          navTabs.forEach(tab => tab.classList.remove('active'));
          
          // é¡¯ç¤ºé¸ä¸­çš„æ¨™ç±¤å…§å®¹
          document.getElementById(tabName).classList.add('active');
          
          // è¨­ç½®å°æ‡‰æŒ‰éˆ•ç‚ºæ´»å‹•ç‹€æ…‹
          event.target.classList.add('active');
      }

      // é¡¯ç¤ºè¨Šæ¯
      function showMessage(message, type = 'info') {
          const alertDiv = document.createElement('div');
          alertDiv.className = `alert alert-${type}`;
          alertDiv.textContent = message;
          
          // æ’å…¥åˆ°ç•¶å‰æ´»å‹•æ¨™ç±¤çš„é–‹é ­
          const activeTab = document.querySelector('.tab-content.active');
          activeTab.insertBefore(alertDiv, activeTab.firstChild);
          
          // 3ç§’å¾Œè‡ªå‹•ç§»é™¤
          setTimeout(() => {
              if (alertDiv.parentNode) {
                  alertDiv.parentNode.removeChild(alertDiv);
              }
          }, 3000);
      }

      // ç¤ºç¯„è­¦å‘Š
      function demoAlert() {
          showMessage('é€™æ˜¯ç¤ºç¯„ç‰ˆæœ¬ï¼Œè«‹å®Œæˆå¾Œç«¯è¨­å®šä»¥ä½¿ç”¨å®Œæ•´åŠŸèƒ½ã€‚', 'info');
      }

      // è™•ç†æœƒå“¡è¨»å†Šï¼ˆç¤ºç¯„ç‰ˆï¼‰
      function handleRegister(event) {
          event.preventDefault();
          
          const formData = new FormData(event.target);
          const userData = Object.fromEntries(formData.entries());
          
          // ç°¡å–®é©—è­‰
          if (!userData.lineId || !userData.realName || !userData.memberType) {
              showMessage('è«‹å¡«å¯«å¿…å¡«æ¬„ä½', 'error');
              return;
          }
          
          // ç¤ºç¯„æˆåŠŸè¨Šæ¯
          showMessage('è¨»å†Šè³‡æ–™å·²æäº¤ï¼åœ¨å¯¦éš›ç’°å¢ƒä¸­ï¼Œè³‡æ–™æœƒå„²å­˜åˆ° Google Sheetsã€‚', 'success');
          event.target.reset();
          
          // å„²å­˜åˆ°æœ¬åœ°å­˜å„²ï¼ˆç¤ºç¯„ç”¨ï¼‰
          localStorage.setItem('demoUser', JSON.stringify(userData));
      }

      // è™•ç†ææ¬¾ï¼ˆç¤ºç¯„ç‰ˆï¼‰
      function handleDonation(event) {
          event.preventDefault();
          
          const formData = new FormData(event.target);
          const donationData = Object.fromEntries(formData.entries());
          
          if (!donationData.amount || donationData.amount <= 0) {
              showMessage('è«‹è¼¸å…¥æœ‰æ•ˆçš„ææ¬¾é‡‘é¡', 'error');
              return;
          }
          
          showMessage(`æ„Ÿè¬æ‚¨çš„ $${donationData.amount} å…ƒææ¬¾ï¼åœ¨å¯¦éš›ç’°å¢ƒä¸­ï¼Œæœƒç”¢ç”Ÿææ¬¾è¨˜éŒ„ã€‚`, 'success');
          event.target.reset();
      }

      // åˆå§‹åŒ–é é¢
      function initializePage() {
          // è¨­å®šç•¶å‰æ—¥æœŸç‚ºæ´»å‹•æ—¥æœŸçš„æœ€å°å€¼
          const today = new Date().toISOString().split('T')[0];
          const dateInputs = document.querySelectorAll('input[type="date"]');
          dateInputs.forEach(input => {
              if (!input.value) {
                  input.min = today;
              }
          });

          // è¼‰å…¥ç¤ºç¯„ç”¨æˆ¶è³‡æ–™
          const demoUser = localStorage.getItem('demoUser');
          if (demoUser) {
              const userData = JSON.parse(demoUser);
              document.getElementById('lineId').value = userData.lineId || '';
          }
      }

      // é˜²æ­¢ JSON è§£æéŒ¯èª¤
      window.addEventListener('error', function(e) {
          if (e.message.includes('JSON')) {
              console.log('JSON è§£æéŒ¯èª¤å·²è¢«å¿½ç•¥ï¼ˆå¯èƒ½ä¾†è‡ªç€è¦½å™¨æ“´å……åŠŸèƒ½ï¼‰');
              e.preventDefault();
          }
      });
  </script>
</body>
</html>
