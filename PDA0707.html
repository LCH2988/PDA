<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å°ç£å¸•é‡‘æ£®ç—…å‹æ¬Šç›Šä¿ƒé€²æœƒ - æœƒè¨ˆç®¡ç†ç³»çµ± v5.1</title>
  
  <style>
    /* åŸºç¤æ¨£å¼é‡ç½® */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --primary-color: #4e73df;
      --primary-gradient: linear-gradient(135deg, #4e73df 0%, #6f42c1 100%);
      --secondary-color: #6c757d;
      --success-color: #1cc88a;
      --danger-color: #e74a3b;
      --warning-color: #f6c23e;
      --info-color: #36b9cc;
      --light-color: #f8f9fc;
      --dark-color: #5a5c69;
      --border-color: #e3e6f0;
      --shadow-sm: 0 .125rem .25rem rgba(0,0,0,.075);
      --shadow: 0 .5rem 1rem rgba(0,0,0,.15);
      --shadow-lg: 0 1rem 3rem rgba(0,0,0,.175);
      --font-family: 'Nunito', 'Microsoft JhengHei', sans-serif;
      --transition: all 0.3s ease;
      --border-radius: 0.35rem;
    }

    body {
      font-family: var(--font-family);
      line-height: 1.6;
      color: #333;
      background-color: #f8f9fc;
    }

    /* é ‚éƒ¨å°èˆª */
    .navbar {
      background: var(--primary-gradient);
      color: white;
      padding: 1rem 0;
      box-shadow: var(--shadow);
      position: sticky;
      top: 0;
      z-index: 1000;
    }

    .navbar .container {
      max-width: 1280px;
      margin: 0 auto;
      padding: 0 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .navbar h1 {
      font-size: 1.5rem;
      font-weight: 700;
    }

    .navbar .nav-info {
      display: flex;
      align-items: center;
      gap: 20px;
      font-size: 0.9rem;
    }

    /* ä¸»è¦å®¹å™¨ */
    .container {
      max-width: 1280px;
      margin: 0 auto;
      padding: 20px;
    }

    /* è¼‰å…¥å‹•ç•« */
    .loading {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(255, 255, 255, 0.9);
      z-index: 9999;
      justify-content: center;
      align-items: center;
      flex-direction: column;
    }

    .loading.show {
      display: flex;
    }

    .spinner {
      width: 50px;
      height: 50px;
      border: 4px solid #f3f3f3;
      border-top: 4px solid var(--primary-color);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    .loading p {
      margin-top: 10px;
      font-weight: 500;
      color: var(--primary-color);
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* æ¨™ç±¤é å°èˆª */
    .tab-nav {
      display: flex;
      background: white;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow-sm);
      margin-bottom: 20px;
      overflow: hidden;
      flex-wrap: wrap;
    }

    .tab-nav button {
      flex: 1;
      min-width: 120px;
      padding: 15px 20px;
      border: none;
      background: white;
      color: var(--secondary-color);
      cursor: pointer;
      transition: var(--transition);
      font-size: 1rem;
      font-weight: 500;
    }

    .tab-nav button:hover {
      background: #f8f9fa;
      color: var(--primary-color);
    }

    .tab-nav button.active {
      background: var(--primary-gradient);
      color: white;
    }

    /* æ¨™ç±¤é å…§å®¹ */
    .tab-content {
      display: none;
      background: white;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow-sm);
      padding: 30px;
      margin-bottom: 20px;
    }

    .tab-content.active {
      display: block;
      animation: fadeIn 0.3s ease-in;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* è¡¨å–®æ¨£å¼ */
    .form-group {
      margin-bottom: 20px;
    }

    .form-row {
      display: flex;
      gap: 20px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .form-row .form-group {
      flex: 1;
      min-width: 200px;
      margin-bottom: 0;
    }

    label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      color: var(--dark-color);
    }

    input, select, textarea {
      width: 100%;
      padding: 12px 15px;
      border: 2px solid var(--border-color);
      border-radius: var(--border-radius);
      font-size: 1rem;
      transition: var(--transition);
      background: white;
      font-family: var(--font-family);
    }

    input:focus, select:focus, textarea:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(78, 115, 223, 0.1);
    }

    textarea {
      resize: vertical;
      min-height: 100px;
    }

    /* æŒ‰éˆ•æ¨£å¼ */
    .btn {
      padding: 12px 24px;
      border: none;
      border-radius: var(--border-radius);
      font-size: 1rem;
      font-weight: 500;
      cursor: pointer;
      transition: var(--transition);
      text-decoration: none;
      display: inline-block;
      text-align: center;
      line-height: 1.4;
    }

    .btn-primary {
      background: var(--primary-gradient);
      color: white;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow);
    }

    .btn-secondary {
      background: var(--secondary-color);
      color: white;
    }

    .btn-secondary:hover {
      background: #5a6268;
      transform: translateY(-2px);
    }

    .btn-success {
      background: var(--success-color);
      color: white;
    }

    .btn-success:hover {
      background: #17a673;
      transform: translateY(-2px);
    }

    .btn-danger {
      background: var(--danger-color);
      color: white;
    }

    .btn-danger:hover {
      background: #d52a1a;
      transform: translateY(-2px);
    }

    .btn-warning {
      background: var(--warning-color);
      color: #212529;
    }

    .btn-warning:hover {
      background: #f4b619;
      transform: translateY(-2px);
    }

    .btn-info {
      background: var(--info-color);
      color: white;
    }

    .btn-info:hover {
      background: #2ca0b9;
      transform: translateY(-2px);
    }

    .btn-group {
      display: flex;
      gap: 10px;
      margin-top: 20px;
      flex-wrap: wrap;
    }

    .btn-sm {
      padding: 8px 16px;
      font-size: 0.875rem;
    }

    .btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none !important;
    }

    /* è¡¨æ ¼æ¨£å¼ */
    .table-container {
      overflow-x: auto;
      margin: 20px 0;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow-sm);
    }

    table {
      width: 100%;
      border-collapse: collapse;
      background: white;
    }

    th, td {
      padding: 15px;
      text-align: left;
      border-bottom: 1px solid var(--border-color);
    }

    th {
      background: #f8f9fc;
      font-weight: 600;
      color: var(--dark-color);
      position: sticky;
      top: 0;
      z-index: 10;
    }

    tr:hover {
      background: #f8f9fa;
    }

    tr:last-child td {
      border-bottom: none;
    }

    .table-actions {
      display: flex;
      gap: 5px;
      flex-wrap: wrap;
    }

    /* å¡ç‰‡æ¨£å¼ */
    .card {
      background: white;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow-sm);
      padding: 25px;
      margin-bottom: 20px;
      transition: var(--transition);
    }

    .card:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow);
    }

    .card-header {
      border-bottom: 2px solid var(--border-color);
      padding-bottom: 15px;
      margin-bottom: 20px;
    }

    .card-title {
      font-size: 1.25rem;
      font-weight: 600;
      color: var(--dark-color);
      margin: 0;
    }

    .card-subtitle {
      font-size: 0.9rem;
      color: var(--secondary-color);
      margin: 5px 0 0 0;
    }

    /* çµ±è¨ˆå¡ç‰‡ */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .stat-card {
      background: white;
      border-radius: var(--border-radius);
      padding: 25px;
      box-shadow: var(--shadow-sm);
      text-align: center;
      transition: var(--transition);
      position: relative;
      overflow: hidden;
    }

    .stat-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: var(--primary-gradient);
    }

    .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: var(--shadow);
    }

    .stat-number {
      font-size: 2.5rem;
      font-weight: 700;
      color: var(--dark-color);
      margin-bottom: 10px;
    }

    .stat-label {
      font-size: 1rem;
      color: var(--secondary-color);
      font-weight: 500;
    }

    .stat-change {
      font-size: 0.875rem;
      margin-top: 8px;
    }

    .stat-change.positive {
      color: var(--success-color);
    }

    .stat-change.negative {
      color: var(--danger-color);
    }

    /* è­¦å‘Šå’Œé€šçŸ¥ */
    .alert {
      padding: 15px 20px;
      border-radius: var(--border-radius);
      margin-bottom: 20px;
      border-left: 4px solid;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .alert-success {
      background: #d4edda;
      color: #155724;
      border-color: var(--success-color);
    }

    .alert-error {
      background: #f8d7da;
      color: #721c24;
      border-color: var(--danger-color);
    }

    .alert-warning {
      background: #fff3cd;
      color: #856404;
      border-color: var(--warning-color);
    }

    .alert-info {
      background: #d1ecf1;
      color: #0c5460;
      border-color: var(--info-color);
    }

    .alert .close {
      margin-left: auto;
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      opacity: 0.7;
    }

    .alert .close:hover {
      opacity: 1;
    }

    /* æœå°‹å’Œç¯©é¸ */
    .search-filters {
      background: white;
      border-radius: var(--border-radius);
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: var(--shadow-sm);
    }

    .search-row {
      display: flex;
      gap: 15px;
      align-items: end;
      flex-wrap: wrap;
    }

    .search-group {
      flex: 1;
      min-width: 200px;
    }

    .search-group label {
      margin-bottom: 5px;
      font-size: 0.9rem;
    }

    /* åˆ†é  */
    .pagination {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 10px;
      margin: 20px 0;
      flex-wrap: wrap;
    }

    .pagination button {
      padding: 8px 12px;
      border: 1px solid var(--border-color);
      background: white;
      color: var(--dark-color);
      border-radius: var(--border-radius);
      cursor: pointer;
      transition: var(--transition);
    }

    .pagination button:hover {
      background: #e9ecef;
    }

    .pagination button.active {
      background: var(--primary-color);
      color: white;
      border-color: var(--primary-color);
    }

    .pagination button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    /* æ¨¡æ…‹æ¡† */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      z-index: 10000;
      justify-content: center;
      align-items: center;
    }

    .modal.show {
      display: flex;
    }

    .modal-content {
      background: white;
      border-radius: var(--border-radius);
      padding: 30px;
      max-width: 600px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
      position: relative;
      box-shadow: var(--shadow-lg);
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 15px;
      border-bottom: 2px solid var(--border-color);
    }

    .modal-title {
      font-size: 1.5rem;
      font-weight: 600;
      color: var(--dark-color);
    }

    .modal-close {
      background: none;
      border: none;
      font-size: 2rem;
      cursor: pointer;
      color: #999;
      line-height: 1;
    }

    .modal-close:hover {
      color: #333;
    }

    /* è©³æƒ…é¡¯ç¤ºæ¨£å¼ */
    .detail-content {
      max-width: 100%;
    }

    .detail-row {
      display: flex;
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 1px solid #f0f0f0;
    }

    .detail-row:last-child {
      border-bottom: none;
      margin-bottom: 0;
    }

    .detail-label {
      font-weight: 600;
      color: var(--dark-color);
      min-width: 120px;
      flex-shrink: 0;
    }

    .detail-value {
      color: #333;
      flex: 1;
    }

    /* ç³»çµ±ç‹€æ…‹æ¨£å¼ */
    .system-status-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
    }

    .status-item {
      padding: 15px;
      background: #f8f9fa;
      border-radius: var(--border-radius);
      text-align: center;
    }

    .status-item h5 {
      margin-bottom: 10px;
      color: var(--secondary-color);
      font-size: 0.9rem;
    }

    .status-item p {
      margin: 0;
      font-size: 1.1rem;
      font-weight: 600;
    }

    /* å ±è¡¨å…§å®¹æ¨£å¼ */
    .report-content {
      background: white;
      border-radius: var(--border-radius);
      padding: 20px;
    }

    .report-summary {
      margin-bottom: 30px;
    }

    .report-summary h4 {
      color: var(--dark-color);
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 2px solid var(--border-color);
    }

    .report-details {
      margin-top: 30px;
    }

    .report-details h4 {
      color: var(--dark-color);
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 2px solid var(--border-color);
    }

    /* ç©ºç‹€æ…‹ */
    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: #999;
    }

    .empty-state h3 {
      font-size: 1.5rem;
      margin-bottom: 10px;
      color: #666;
    }

    .empty-state p {
      font-size: 1rem;
      margin-bottom: 20px;
    }

    /* ç¶²è·¯ç‹€æ…‹æŒ‡ç¤ºå™¨ */
    .network-status {
      position: fixed;
      top: 10px;
      right: 10px;
      padding: 8px 15px;
      border-radius: 20px;
      font-size: 0.875rem;
      font-weight: 600;
      z-index: 9999;
      transition: var(--transition);
    }

    .network-status.online {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }

    .network-status.offline {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }

    /* æ‡‰ç”¨ç¨‹å¼é è…³ */
    .app-footer {
      margin-top: 50px;
      padding: 20px 0;
      text-align: center;
      color: var(--secondary-color);
      font-size: 0.875rem;
      border-top: 1px solid var(--border-color);
    }

    .app-footer a {
      color: var(--primary-color);
      text-decoration: none;
    }

    .app-footer a:hover {
      text-decoration: underline;
    }

    /* éŸ¿æ‡‰å¼è¨­è¨ˆ */
    @media (max-width: 768px) {
      .container {
        padding: 10px;
      }

      .form-row {
        flex-direction: column;
        gap: 0;
      }

      .search-row {
        flex-direction: column;
        align-items: stretch;
      }

      .search-group {
        min-width: auto;
      }

      .btn-group {
        flex-direction: column;
      }

      .stats-grid {
        grid-template-columns: 1fr;
      }

      .navbar .container {
        flex-direction: column;
        gap: 10px;
        text-align: center;
      }

      .navbar .nav-info {
        justify-content: center;
      }

      .table-container {
        font-size: 0.875rem;
      }

      th, td {
        padding: 10px 8px;
      }
    }

    /* æ·±è‰²ä¸»é¡Œæ”¯æ´ */
    @media (prefers-color-scheme: dark) {
      body {
        background-color: #1a1a1a;
        color: #e0e0e0;
      }

      .card, .tab-content, .search-filters {
        background: #2d2d2d;
        color: #e0e0e0;
      }

      input, select, textarea {
        background: #3d3d3d;
        color: #e0e0e0;
        border-color: #555;
      }

      table {
        background: #2d2d2d;
      }

      th {
        background: #3d3d3d;
        color: #e0e0e0;
      }

      tr:hover {
        background: #3d3d3d;
      }
    }

    /* åˆ—å°æ¨£å¼ */
    @media print {
      .navbar, .tab-nav, .btn, .search-filters {
        display: none !important;
      }

      .container {
        max-width: none;
        padding: 0;
      }

      .card, .tab-content {
        box-shadow: none;
        border: 1px solid #ddd;
      }
    }

    /* è¼”åŠ©é¡åˆ¥ */
    .text-success { color: var(--success-color) !important; }
    .text-danger { color: var(--danger-color) !important; }
    .text-warning { color: var(--warning-color) !important; }
    .text-info { color: var(--info-color) !important; }

    .mt-0 { margin-top: 0 !important; }
    .mt-1 { margin-top: 0.25rem !important; }
    .mt-2 { margin-top: 0.5rem !important; }
    .mt-3 { margin-top: 1rem !important; }
    .mt-4 { margin-top: 1.5rem !important; }
    .mt-5 { margin-top: 3rem !important; }

    .mb-0 { margin-bottom: 0 !important; }
    .mb-1 { margin-bottom: 0.25rem !important; }
    .mb-2 { margin-bottom: 0.5rem !important; }
    .mb-3 { margin-bottom: 1rem !important; }
    .mb-4 { margin-bottom: 1.5rem !important; }
    .mb-5 { margin-bottom: 3rem !important; }

    .p-0 { padding: 0 !important; }
    .p-1 { padding: 0.25rem !important; }
    .p-2 { padding: 0.5rem !important; }
    .p-3 { padding: 1rem !important; }
    .p-4 { padding: 1.5rem !important; }
    .p-5 { padding: 3rem !important; }

    .d-none { display: none !important; }
    .d-block { display: block !important; }
    .d-flex { display: flex !important; }
    .text-center { text-align: center !important; }
  </style>
  
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>

<body>
  <!-- ç¶²è·¯ç‹€æ…‹æŒ‡ç¤ºå™¨ -->
  <div id="networkStatus" class="network-status online">
    <span id="networkStatusText">ç·šä¸Š</span>
  </div>

  <!-- è¼‰å…¥å‹•ç•« -->
  <div id="loading" class="loading">
    <div class="spinner"></div>
    <p>è¼‰å…¥ä¸­...</p>
  </div>

  <!-- é ‚éƒ¨å°èˆª -->
  <nav class="navbar">
    <div class="container">
      <h1>å°ç£å¸•é‡‘æ£®ç—…å‹æ¬Šç›Šä¿ƒé€²æœƒ - æœƒè¨ˆç®¡ç†ç³»çµ±</h1>
      <div class="nav-info">
        <span id="currentTime"></span>
        <span>v5.1</span>
      </div>
    </div>
  </nav>

  <!-- ä¸»è¦å…§å®¹ -->
  <div class="container">
    <!-- è­¦å‘Šè¨Šæ¯å€åŸŸ -->
    <div id="alertContainer"></div>

    <!-- æ¨™ç±¤é å°èˆª -->
    <div class="tab-nav">
      <button class="tab-btn active" data-tab="dashboard">ğŸ“Š å„€è¡¨æ¿</button>
      <button class="tab-btn" data-tab="transactions">ğŸ’° äº¤æ˜“è¨˜éŒ„</button>
      <button class="tab-btn" data-tab="receipts">ğŸ§¾ æ”¶æ“šç®¡ç†</button>
      <button class="tab-btn" data-tab="vouchers">ğŸ“‹ æ”¯å‡ºæ†‘è­‰</button>
      <button class="tab-btn" data-tab="members">ğŸ‘¥ æœƒå“¡ç®¡ç†</button>
      <button class="tab-btn" data-tab="reports">ğŸ“ˆ å ±è¡¨åˆ†æ</button>
      <button class="tab-btn" data-tab="settings">âš™ï¸ ç³»çµ±è¨­å®š</button>
    </div>

    <!-- å„€è¡¨æ¿ -->
    <div id="dashboard" class="tab-content active">
      <div class="card-header">
        <h2 class="card-title">è²¡å‹™æ¦‚è¦½</h2>
        <p class="card-subtitle">æœ¬æœˆè²¡å‹™ç‹€æ³çµ±è¨ˆ</p>
      </div>

      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-number" id="totalIncome">$0</div>
          <div class="stat-label">æœ¬æœˆæ”¶å…¥</div>
          <div class="stat-change positive" id="incomeChange">+0%</div>
        </div>
        <div class="stat-card">
          <div class="stat-number" id="totalExpense">$0</div>
          <div class="stat-label">æœ¬æœˆæ”¯å‡º</div>
          <div class="stat-change negative" id="expenseChange">+0%</div>
        </div>
        <div class="stat-card">
          <div class="stat-number" id="receiptCount">0</div>
          <div class="stat-label">æœ¬æœˆæ”¶æ“š</div>
          <div class="stat-change positive" id="receiptChange">+0</div>
        </div>
        <div class="stat-card">
          <div class="stat-number" id="memberCount">0</div>
          <div class="stat-label">æœƒå“¡ç¸½æ•¸</div>
          <div class="stat-change positive" id="memberChange">+0</div>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <h3 class="card-title">æœ€è¿‘æ´»å‹•</h3>
        </div>
        <div id="recentActivities">
          <div class="empty-state">
            <h3>è¼‰å…¥ä¸­...</h3>
            <p>æ­£åœ¨å–å¾—æœ€æ–°æ´»å‹•è¨˜éŒ„</p>
          </div>
        </div>
      </div>
    </div>

    <!-- äº¤æ˜“è¨˜éŒ„ -->
    <div id="transactions" class="tab-content">
      <div class="card-header">
        <h2 class="card-title">äº¤æ˜“è¨˜éŒ„ç®¡ç†</h2>
        <p class="card-subtitle">è¨˜éŒ„å’Œç®¡ç†æ‰€æœ‰æ”¶æ”¯äº¤æ˜“</p>
      </div>

      <!-- æ–°å¢äº¤æ˜“è¡¨å–® -->
      <div class="card">
        <div class="card-header">
          <h3 class="card-title">æ–°å¢äº¤æ˜“è¨˜éŒ„</h3>
        </div>
        <form id="transactionForm">
          <div class="form-row">
            <div class="form-group">
              <label for="transactionDate">äº¤æ˜“æ—¥æœŸ *</label>
              <input type="date" id="transactionDate" name="date" required>
            </div>
            <div class="form-group">
              <label for="transactionType">æ”¶æ”¯é¡å‹ *</label>
              <select id="transactionType" name="type" required>
                <option value="">è«‹é¸æ“‡</option>
                <option value="æ”¶å…¥">æ”¶å…¥</option>
                <option value="æ”¯å‡º">æ”¯å‡º</option>
              </select>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="transactionCategory">é¡åˆ¥ *</label>
              <select id="transactionCategory" name="category" required>
                <option value="">è«‹é¸æ“‡</option>
                <option value="ææ¬¾">ææ¬¾</option>
                <option value="æœƒè²»">æœƒè²»</option>
                <option value="æ´»å‹•æ”¶å…¥">æ´»å‹•æ”¶å…¥</option>
                <option value="è£œåŠ©æ¬¾">è£œåŠ©æ¬¾</option>
                <option value="è¾¦å…¬è²»ç”¨">è¾¦å…¬è²»ç”¨</option>
                <option value="æ´»å‹•æ”¯å‡º">æ´»å‹•æ”¯å‡º</option>
                <option value="äº¤é€šè²»">äº¤é€šè²»</option>
                <option value="å…¶ä»–">å…¶ä»–</option>
              </select>
            </div>
            <div class="form-group">
              <label for="transactionAmount">é‡‘é¡ *</label>
              <input type="number" id="transactionAmount" name="amount" min="0" step="1" required>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="transactionName">äº¤æ˜“å°è±¡ *</label>
              <input type="text" id="transactionName" name="name" required>
            </div>
            <div class="form-group">
              <label for="transactionAccount">å¸³æˆ¶</label>
              <select id="transactionAccount" name="account">
                <option value="">è«‹é¸æ“‡</option>
                <option value="ç¾é‡‘">ç¾é‡‘</option>
                <option value="éŠ€è¡Œå¸³æˆ¶">éŠ€è¡Œå¸³æˆ¶</option>
                <option value="éƒµå±€å¸³æˆ¶">éƒµå±€å¸³æˆ¶</option>
              </select>
            </div>
          </div>

          <div class="form-group">
            <label for="transactionDescription">èªªæ˜</label>
            <textarea id="transactionDescription" name="description" placeholder="è«‹è¼¸å…¥äº¤æ˜“èªªæ˜..."></textarea>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>
                <input type="checkbox" id="generateReceipt" name="generateReceipt" value="true">
                è‡ªå‹•ç”¢ç”Ÿæ”¶æ“šï¼ˆåƒ…é™æ”¶å…¥ï¼‰
              </label>
            </div>
            <div class="form-group">
              <label>
                <input type="checkbox" id="generateVoucher" name="generateVoucher" value="true">
                è‡ªå‹•ç”¢ç”Ÿæ†‘è­‰ï¼ˆåƒ…é™æ”¯å‡ºï¼‰
              </label>
            </div>
          </div>

          <div class="btn-group">
            <button type="submit" class="btn btn-primary">å„²å­˜äº¤æ˜“è¨˜éŒ„</button>
            <button type="reset" class="btn btn-secondary">æ¸…é™¤è¡¨å–®</button>
          </div>
        </form>
      </div>

      <!-- äº¤æ˜“è¨˜éŒ„æœå°‹ -->
      <div class="search-filters">
        <div class="search-row">
          <div class="search-group">
            <label for="transactionSearch">æœå°‹</label>
            <input type="text" id="transactionSearch" placeholder="æœå°‹äº¤æ˜“å°è±¡ã€èªªæ˜...">
          </div>
          <div class="search-group">
            <label for="transactionTypeFilter">é¡å‹</label>
            <select id="transactionTypeFilter">
              <option value="">å…¨éƒ¨</option>
              <option value="æ”¶å…¥">æ”¶å…¥</option>
              <option value="æ”¯å‡º">æ”¯å‡º</option>
            </select>
          </div>
          <div class="search-group">
            <label for="transactionDateFrom">é–‹å§‹æ—¥æœŸ</label>
            <input type="date" id="transactionDateFrom">
          </div>
          <div class="search-group">
            <label for="transactionDateTo">çµæŸæ—¥æœŸ</label>
            <input type="date" id="transactionDateTo">
          </div>
          <div class="search-group">
            <label>&nbsp;</label>
            <button type="button" class="btn btn-primary" onclick="searchTransactions()">æœå°‹</button>
          </div>
        </div>
      </div>

      <!-- äº¤æ˜“è¨˜éŒ„åˆ—è¡¨ -->
      <div class="card">
        <div class="card-header">
          <h3 class="card-title">äº¤æ˜“è¨˜éŒ„åˆ—è¡¨</h3>
        </div>
        <div class="table-container">
          <table id="transactionsTable">
            <thead>
              <tr>
                <th>æ—¥æœŸ</th>
                <th>é¡å‹</th>
                <th>é¡åˆ¥</th>
                <th>äº¤æ˜“å°è±¡</th>
                <th>é‡‘é¡</th>
                <th>å¸³æˆ¶</th>
                <th>ç‹€æ…‹</th>
                <th>æ“ä½œ</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="8" class="empty-state">
                  <h3>è¼‰å…¥ä¸­...</h3>
                  <p>æ­£åœ¨å–å¾—äº¤æ˜“è¨˜éŒ„</p>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <div id="transactionsPagination" class="pagination"></div>
      </div>
    </div>

    <!-- æ”¶æ“šç®¡ç† -->
    <div id="receipts" class="tab-content">
      <div class="card-header">
        <h2 class="card-title">æ”¶æ“šç®¡ç†</h2>
        <p class="card-subtitle">é–‹ç«‹å’Œç®¡ç†ææ¬¾æ”¶æ“š</p>
      </div>

      <!-- é–‹ç«‹æ”¶æ“šè¡¨å–® -->
      <div class="card">
        <div class="card-header">
          <h3 class="card-title">é–‹ç«‹æ–°æ”¶æ“š</h3>
        </div>
        <form id="receiptForm">
          <div class="form-row">
            <div class="form-group">
              <label for="receiptDate">æ”¶æ“šæ—¥æœŸ *</label>
              <input type="date" id="receiptDate" name="date" required>
            </div>
            <div class="form-group">
              <label for="receiptPayer">ä»˜æ¬¾äºº *</label>
              <input type="text" id="receiptPayer" name="payer" required>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="receiptIdentity">èº«ä»½é¡åˆ¥</label>
              <select id="receiptIdentity" name="identity">
                <option value="ä¸€èˆ¬æ°‘çœ¾">ä¸€èˆ¬æ°‘çœ¾</option>
                <option value="æœƒå“¡">æœƒå“¡</option>
                <option value="ä¼æ¥­">ä¼æ¥­</option>
                <option value="åœ˜é«”">åœ˜é«”</option>
              </select>
            </div>
            <div class="form-group">
              <label for="receiptPhone">è¯çµ¡é›»è©±</label>
              <input type="tel" id="receiptPhone" name="phone">
            </div>
          </div>

          <div class="form-group">
            <label for="receiptEmail">é›»å­éƒµä»¶</label>
            <input type="email" id="receiptEmail" name="email" placeholder="ç”¨æ–¼è‡ªå‹•å¯„é€æ”¶æ“š">
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="receiptCategory">æ”¶æ“šé¡åˆ¥ *</label>
              <select id="receiptCategory" name="category" required>
                <option value="">è«‹é¸æ“‡</option>
                <option value="ä¸€èˆ¬ææ¬¾">ä¸€èˆ¬ææ¬¾</option>
                <option value="æŒ‡å®šç”¨é€”ææ¬¾">æŒ‡å®šç”¨é€”ææ¬¾</option>
                <option value="æœƒè²»">æœƒè²»</option>
                <option value="æ´»å‹•è²»ç”¨">æ´»å‹•è²»ç”¨</option>
              </select>
            </div>
            <div class="form-group">
              <label for="receiptAmount">é‡‘é¡ *</label>
              <input type="number" id="receiptAmount" name="amount" min="0" step="1" required>
            </div>
          </div>

          <div class="form-group">
            <label for="receiptPurpose">ç”¨é€”èªªæ˜</label>
            <textarea id="receiptPurpose" name="purpose" placeholder="è«‹è¼¸å…¥ææ¬¾ç”¨é€”..."></textarea>
          </div>

          <div class="form-group">
            <label>
              <input type="checkbox" id="autoSendReceipt" name="autoSend" value="true">
              è‡ªå‹•å¯„é€æ”¶æ“šè‡³é›»å­éƒµä»¶
            </label>
          </div>

          <div class="btn-group">
            <button type="submit" class="btn btn-primary">é–‹ç«‹æ”¶æ“š</button>
            <button type="reset" class="btn btn-secondary">æ¸…é™¤è¡¨å–®</button>
          </div>
        </form>
      </div>

      <!-- æ”¶æ“šè¨˜éŒ„æœå°‹ -->
      <div class="search-filters">
        <div class="search-row">
          <div class="search-group">
            <label for="receiptSearch">æœå°‹</label>
            <input type="text" id="receiptSearch" placeholder="æœå°‹æ”¶æ“šç·¨è™Ÿã€ä»˜æ¬¾äºº...">
          </div>
          <div class="search-group">
            <label for="receiptStatusFilter">ç‹€æ…‹</label>
            <select id="receiptStatusFilter">
              <option value="">å…¨éƒ¨</option>
              <option value="å·²é–‹ç«‹">å·²é–‹ç«‹</option>
              <option value="å·²å¯„é€">å·²å¯„é€</option>
              <option value="å·²ä½œå»¢">å·²ä½œå»¢</option>
            </select>
          </div>
          <div class="search-group">
            <label>&nbsp;</label>
            <button type="button" class="btn btn-primary" onclick="searchReceipts()">æœå°‹</button>
          </div>
        </div>
      </div>

      <!-- æ”¶æ“šè¨˜éŒ„åˆ—è¡¨ -->
      <div class="card">
        <div class="card-header">
          <h3 class="card-title">æ”¶æ“šè¨˜éŒ„åˆ—è¡¨</h3>
        </div>
        <div class="table-container">
          <table id="receiptsTable">
            <thead>
              <tr>
                <th>æ”¶æ“šç·¨è™Ÿ</th>
                <th>æ—¥æœŸ</th>
                <th>ä»˜æ¬¾äºº</th>
                <th>é¡åˆ¥</th>
                <th>é‡‘é¡</th>
                <th>ç‹€æ…‹</th>
                <th>æ“ä½œ</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="7" class="empty-state">
                  <h3>è¼‰å…¥ä¸­...</h3>
                  <p>æ­£åœ¨å–å¾—æ”¶æ“šè¨˜éŒ„</p>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <div id="receiptsPagination" class="pagination"></div>
      </div>
    </div>

    <!-- æ”¯å‡ºæ†‘è­‰ -->
    <div id="vouchers" class="tab-content">
      <div class="card-header">
        <h2 class="card-title">æ”¯å‡ºæ†‘è­‰ç®¡ç†</h2>
        <p class="card-subtitle">ç”³è«‹å’Œç®¡ç†æ”¯å‡ºæ†‘è­‰</p>
      </div>

      <!-- ç”³è«‹æ†‘è­‰è¡¨å–® -->
      <div class="card">
        <div class="card-header">
          <h3 class="card-title">ç”³è«‹æ”¯å‡ºæ†‘è­‰</h3>
        </div>
        <form id="voucherForm">
          <div class="form-row">
            <div class="form-group">
              <label for="voucherDate">ç”³è«‹æ—¥æœŸ *</label>
              <input type="date" id="voucherDate" name="date" required>
            </div>
            <div class="form-group">
              <label for="voucherApplicant">ç”³è«‹äºº *</label>
              <input type="text" id="voucherApplicant" name="applicant" required>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="voucherCategory">æ”¯å‡ºé¡åˆ¥ *</label>
              <select id="voucherCategory" name="category" required>
                <option value="">è«‹é¸æ“‡</option>
                <option value="è¾¦å…¬è²»ç”¨">è¾¦å…¬è²»ç”¨</option>
                <option value="äº¤é€šè²»">äº¤é€šè²»</option>
                <option value="æ´»å‹•æ”¯å‡º">æ´»å‹•æ”¯å‡º</option>
                <option value="è¨­å‚™æ¡è³¼">è¨­å‚™æ¡è³¼</option>
                <option value="å…¶ä»–">å…¶ä»–</option>
              </select>
            </div>
            <div class="form-group">
              <label for="voucherAmount">ç”³è«‹é‡‘é¡ *</label>
              <input type="number" id="voucherAmount" name="amount" min="0" step="1" required>
            </div>
          </div>

          <div class="form-group">
            <label for="voucherPurpose">ç”¨é€”èªªæ˜ *</label>
            <textarea id="voucherPurpose" name="purpose" required placeholder="è«‹è©³ç´°èªªæ˜æ”¯å‡ºç”¨é€”..."></textarea>
          </div>

          <div class="form-group">
            <label for="voucherAttachment">é™„ä»¶æ•¸é‡</label>
            <input type="number" id="voucherAttachment" name="attachmentCount" min="0" value="0">
            <small>è«‹è¨»æ˜ç›¸é—œæ”¶æ“šæˆ–ç™¼ç¥¨æ•¸é‡</small>
          </div>

          <div class="btn-group">
            <button type="submit" class="btn btn-primary">æäº¤ç”³è«‹</button>
            <button type="reset" class="btn btn-secondary">æ¸…é™¤è¡¨å–®</button>
          </div>
        </form>
      </div>

      <!-- æ†‘è­‰è¨˜éŒ„åˆ—è¡¨ -->
      <div class="card">
        <div class="card-header">
          <h3 class="card-title">æ†‘è­‰è¨˜éŒ„åˆ—è¡¨</h3>
        </div>
        <div class="table-container">
          <table id="vouchersTable">
            <thead>
              <tr>
                <th>æ†‘è­‰ç·¨è™Ÿ</th>
                <th>ç”³è«‹æ—¥æœŸ</th>
                <th>ç”³è«‹äºº</th>
                <th>é¡åˆ¥</th>
                <th>é‡‘é¡</th>
                <th>ç‹€æ…‹</th>
                <th>æ“ä½œ</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="7" class="empty-state">
                  <h3>è¼‰å…¥ä¸­...</h3>
                  <p>æ­£åœ¨å–å¾—æ†‘è­‰è¨˜éŒ„</p>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <div id="vouchersPagination" class="pagination"></div>
      </div>
    </div>

    <!-- æœƒå“¡ç®¡ç† -->
    <div id="members" class="tab-content">
      <div class="card-header">
        <h2 class="card-title">æœƒå“¡ç®¡ç†</h2>
        <p class="card-subtitle">ç®¡ç†æœƒå“¡è³‡æ–™å’Œæœƒç±ç‹€æ…‹</p>
      </div>

      <!-- æ–°å¢æœƒå“¡è¡¨å–® -->
      <div class="card">
        <div class="card-header">
          <h3 class="card-title">æ–°å¢æœƒå“¡</h3>
        </div>
        <form id="memberForm">
          <div class="form-row">
            <div class="form-group">
              <label for="memberName">å§“å *</label>
              <input type="text" id="memberName" name="name" required>
            </div>
            <div class="form-group">
              <label for="memberGender">æ€§åˆ¥</label>
              <select id="memberGender" name="gender">
                <option value="">è«‹é¸æ“‡</option>
                <option value="ç”·">ç”·</option>
                <option value="å¥³">å¥³</option>
              </select>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="memberBirthDate">å‡ºç”Ÿæ—¥æœŸ</label>
              <input type="date" id="memberBirthDate" name="birthDate">
            </div>
            <div class="form-group">
              <label for="memberIdNumber">èº«ä»½è­‰å­—è™Ÿ</label>
              <input type="text" id="memberIdNumber" name="idNumber" pattern="[A-Z][0-9]{9}">
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="memberPhone">è¯çµ¡é›»è©± *</label>
              <input type="tel" id="memberPhone" name="phone" required>
            </div>
            <div class="form-group">
              <label for="memberEmail">é›»å­éƒµä»¶</label>
              <input type="email" id="memberEmail" name="email">
            </div>
          </div>

          <div class="form-group">
            <label for="memberAddress">è¯çµ¡åœ°å€</label>
            <textarea id="memberAddress" name="address" rows="3"></textarea>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="memberType">æœƒå“¡é¡å‹ *</label>
              <select id="memberType" name="type" required>
                <option value="">è«‹é¸æ“‡</option>
                <option value="ä¸€èˆ¬æœƒå“¡">ä¸€èˆ¬æœƒå“¡</option>
                <option value="æ°¸ä¹…æœƒå“¡">æ°¸ä¹…æœƒå“¡</option>
                <option value="æ¦®è­½æœƒå“¡">æ¦®è­½æœƒå“¡</option>
                <option value="è´ŠåŠ©æœƒå“¡">è´ŠåŠ©æœƒå“¡</option>
              </select>
            </div>
            <div class="form-group">
              <label for="memberJoinDate">åŠ å…¥æ—¥æœŸ *</label>
              <input type="date" id="memberJoinDate" name="joinDate" required>
            </div>
          </div>

          <div class="form-group">
            <label for="memberNotes">å‚™è¨»</label>
            <textarea id="memberNotes" name="notes" rows="3"></textarea>
          </div>

          <div class="btn-group">
            <button type="submit" class="btn btn-primary">æ–°å¢æœƒå“¡</button>
            <button type="reset" class="btn btn-secondary">æ¸…é™¤è¡¨å–®</button>
          </div>
        </form>
      </div>

      <!-- æœƒå“¡æœå°‹ -->
      <div class="search-filters">
        <div class="search-row">
          <div class="search-group">
            <label for="memberSearch">æœå°‹</label>
            <input type="text" id="memberSearch" placeholder="æœå°‹å§“åã€é›»è©±...">
          </div>
          <div class="search-group">
            <label for="memberTypeFilter">æœƒå“¡é¡å‹</label>
            <select id="memberTypeFilter">
              <option value="">å…¨éƒ¨</option>
              <option value="ä¸€èˆ¬æœƒå“¡">ä¸€èˆ¬æœƒå“¡</option>
              <option value="æ°¸ä¹…æœƒå“¡">æ°¸ä¹…æœƒå“¡</option>
              <option value="æ¦®è­½æœƒå“¡">æ¦®è­½æœƒå“¡</option>
              <option value="è´ŠåŠ©æœƒå“¡">è´ŠåŠ©æœƒå“¡</option>
            </select>
          </div>
          <div class="search-group">
            <label>&nbsp;</label>
            <button type="button" class="btn btn-primary" onclick="searchMembers()">æœå°‹</button>
          </div>
        </div>
      </div>

      <!-- æœƒå“¡åˆ—è¡¨ -->
      <div class="card">
        <div class="card-header">
          <h3 class="card-title">æœƒå“¡åˆ—è¡¨</h3>
        </div>
        <div class="table-container">
          <table id="membersTable">
            <thead>
              <tr>
                <th>æœƒå“¡ç·¨è™Ÿ</th>
                <th>å§“å</th>
                <th>é›»è©±</th>
                <th>æœƒå“¡é¡å‹</th>
                <th>åŠ å…¥æ—¥æœŸ</th>
                <th>ç‹€æ…‹</th>
                <th>æ“ä½œ</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="7" class="empty-state">
                  <h3>è¼‰å…¥ä¸­...</h3>
                  <p>æ­£åœ¨å–å¾—æœƒå“¡è¨˜éŒ„</p>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <div id="membersPagination" class="pagination"></div>
      </div>
    </div>

    <!-- å ±è¡¨åˆ†æ -->
    <div id="reports" class="tab-content">
      <div class="card-header">
        <h2 class="card-title">å ±è¡¨åˆ†æ</h2>
        <p class="card-subtitle">ç”¢ç”Ÿå„ç¨®è²¡å‹™å’Œçµ±è¨ˆå ±è¡¨</p>
      </div>

      <!-- å ±è¡¨é¸é … -->
      <div class="card">
        <div class="card-header">
          <h3 class="card-title">å ±è¡¨ç”¢ç”Ÿ</h3>
        </div>
        <form id="reportForm">
          <div class="form-row">
            <div class="form-group">
              <label for="reportType">å ±è¡¨é¡å‹ *</label>
              <select id="reportType" name="type" required>
                <option value="">è«‹é¸æ“‡</option>
                <option value="monthly">æœˆåº¦è²¡å‹™å ±è¡¨</option>
                <option value="yearly">å¹´åº¦è²¡å‹™å ±è¡¨</option>
                <option value="category">é¡åˆ¥çµ±è¨ˆå ±è¡¨</option>
                <option value="member">æœƒå“¡çµ±è¨ˆå ±è¡¨</option>
                <option value="donation">ææ¬¾çµ±è¨ˆå ±è¡¨</option>
              </select>
            </div>
            <div class="form-group">
              <label for="reportYear">å¹´ä»½ *</label>
              <select id="reportYear" name="year" required>
                <option value="">è«‹é¸æ“‡</option>
              </select>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="reportMonth">æœˆä»½</label>
              <select id="reportMonth" name="month">
                <option value="">å…¨å¹´</option>
                <option value="1">1æœˆ</option>
                <option value="2">2æœˆ</option>
                <option value="3">3æœˆ</option>
                <option value="4">4æœˆ</option>
                <option value="5">5æœˆ</option>
                <option value="6">6æœˆ</option>
                <option value="7">7æœˆ</option>
                <option value="8">8æœˆ</option>
                <option value="9">9æœˆ</option>
                <option value="10">10æœˆ</option>
                <option value="11">11æœˆ</option>
                <option value="12">12æœˆ</option>
              </select>
            </div>
            <div class="form-group">
              <label for="reportFormat">åŒ¯å‡ºæ ¼å¼</label>
              <select id="reportFormat" name="format">
                <option value="excel">Excel (.xlsx)</option>
                <option value="pdf">PDF</option>
              </select>
            </div>
          </div>

          <div class="btn-group">
            <button type="button" class="btn btn-primary" onclick="generateReport()">ç”¢ç”Ÿå ±è¡¨</button>
            <button type="button" class="btn btn-success" onclick="exportReport()">åŒ¯å‡ºå ±è¡¨</button>
          </div>
        </form>
      </div>

      <!-- å ±è¡¨é è¦½ -->
      <div class="card">
        <div class="card-header">
          <h3 class="card-title">å ±è¡¨é è¦½</h3>
        </div>
        <div id="reportPreview">
          <div class="empty-state">
            <h3>è«‹é¸æ“‡å ±è¡¨é¡å‹</h3>
            <p>é¸æ“‡å ±è¡¨é¡å‹å’Œæ™‚é–“ç¯„åœå¾Œï¼Œé»æ“Šã€Œç”¢ç”Ÿå ±è¡¨ã€æŸ¥çœ‹é è¦½</p>
          </div>
        </div>
      </div>
    </div>

    <!-- ç³»çµ±è¨­å®š -->
    <div id="settings" class="tab-content">
      <div class="card-header">
        <h2 class="card-title">ç³»çµ±è¨­å®š</h2>
        <p class="card-subtitle">ç®¡ç†ç³»çµ±é…ç½®å’Œçµ„ç¹”è³‡è¨Š</p>
      </div>

      <!-- çµ„ç¹”è³‡è¨Šè¨­å®š -->
      <div class="card">
        <div class="card-header">
          <h3 class="card-title">çµ„ç¹”è³‡è¨Š</h3>
        </div>
        <form id="organizationForm">
          <div class="form-row">
            <div class="form-group">
              <label for="orgName">çµ„ç¹”åç¨± *</label>
              <input type="text" id="orgName" name="name" required>
            </div>
            <div class="form-group">
              <label for="orgTaxId">çµ±ä¸€ç·¨è™Ÿ</label>
              <input type="text" id="orgTaxId" name="taxId">
            </div>
          </div>

          <div class="form-group">
            <label for="orgAddress">åœ°å€</label>
            <textarea id="orgAddress" name="address" rows="3"></textarea>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="orgPhone">é›»è©±</label>
              <input type="tel" id="orgPhone" name="phone">
            </div>
            <div class="form-group">
              <label for="orgEmail">é›»å­éƒµä»¶</label>
              <input type="email" id="orgEmail" name="email">
            </div>
          </div>

          <div class="form-group">
            <label for="orgWebsite">ç¶²ç«™</label>
            <input type="url" id="orgWebsite" name="website">
          </div>

          <div class="btn-group">
            <button type="submit" class="btn btn-primary">å„²å­˜è¨­å®š</button>
          </div>
        </form>
      </div>

      <!-- ç³»çµ±ç®¡ç† -->
      <div class="card">
        <div class="card-header">
          <h3 class="card-title">ç³»çµ±ç®¡ç†</h3>
        </div>
        <div class="btn-group">
          <button type="button" class="btn btn-info" onclick="performSystemCheck()">ç³»çµ±æª¢æŸ¥</button>
          <button type="button" class="btn btn-warning" onclick="createBackup()">å»ºç«‹å‚™ä»½</button>
          <button type="button" class="btn btn-secondary" onclick="cleanupSystem()">æ¸…ç†ç³»çµ±</button>
        </div>

        <div id="systemStatus" class="card" style="margin-top: 20px; display: none;">
          <div class="card-header">
            <h4 class="card-title">ç³»çµ±ç‹€æ…‹</h4>
          </div>
          <div id="systemStatusContent"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- æ‡‰ç”¨ç¨‹å¼é è…³ -->
  <footer class="app-footer">
    <div class="container">
      <p>&copy; 2025 å°ç£å¸•é‡‘æ£®ç—…å‹æ¬Šç›Šä¿ƒé€²æœƒ. ç‰ˆæ¬Šæ‰€æœ‰ | 
         <a href="#" onclick="showModal('é—œæ–¼ç³»çµ±', getAboutContent())">é—œæ–¼ç³»çµ±</a> | 
         <a href="#" onclick="showModal('ä½¿ç”¨èªªæ˜', getHelpContent())">ä½¿ç”¨èªªæ˜</a> | 
         <a href="#" onclick="showModal('è¯çµ¡æˆ‘å€‘', getContactContent())">è¯çµ¡æˆ‘å€‘</a>
      </p>
      <p>ç³»çµ±ç‰ˆæœ¬ï¼šv5.1 | æœ€å¾Œæ›´æ–°ï¼š2025å¹´7æœˆ</p>
    </div>
  </footer>

  <!-- æ¨¡æ…‹æ¡† -->
  <div id="modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title" id="modalTitle">æ¨™é¡Œ</h3>
        <button class="modal-close" onclick="closeModal()" aria-label="é—œé–‰">&times;</button>
      </div>
      <div id="modalBody">
        å…§å®¹
      </div>
      <div class="btn-group" style="margin-top: 20px;">
        <button type="button" class="btn btn-secondary" onclick="closeModal()">é—œé–‰</button>
      </div>
    </div>
  </div>

  <script>
    // å…¨åŸŸè®Šæ•¸
    let currentTab = 'dashboard';
    let currentPage = 1;
    let itemsPerPage = 10;

    // ç³»çµ±é…ç½®
    const API_BASE_URL = 'https://script.google.com/macros/s/AKfycbxwy35kgzSeiiPLebpQqiaLkOeaEenphL7jmTNYJZrhT5LWl_47uwl432uBjPWmZ9yH/exec';
    const SYSTEM_VERSION = 'v5.1';

    // åˆå§‹åŒ–
    document.addEventListener('DOMContentLoaded', function() {
      initializeApp();
      updateCurrentTime();
      setInterval(updateCurrentTime, 1000);
      
      // ç›£è½ç¶²è·¯ç‹€æ…‹
      updateNetworkStatus();
      window.addEventListener('online', updateNetworkStatus);
      window.addEventListener('offline', updateNetworkStatus);
    });

    function initializeApp() {
      console.log('åˆå§‹åŒ–æ‡‰ç”¨ç¨‹å¼...');
      
      // é¡¯ç¤ºè¼‰å…¥å‹•ç•«
      showLoading();
      
      // è¨­å®šé è¨­æ—¥æœŸ
      const today = new Date().toISOString().split('T')[0];
      document.getElementById('transactionDate').value = today;
      document.getElementById('receiptDate').value = today;
      document.getElementById('voucherDate').value = today;
      document.getElementById('memberJoinDate').value = today;

      // åˆå§‹åŒ–å¹´ä»½é¸é …
      initializeYearOptions();

      // è¨­å®šäº‹ä»¶ç›£è½å™¨
      setupEventListeners();

      // è¼‰å…¥å„€è¡¨æ¿æ•¸æ“š
      loadDashboard().finally(() => {
        // éš±è—è¼‰å…¥å‹•ç•«
        setTimeout(hideLoading, 500);
      });
      
      // è‡ªå‹•è¼‰å…¥çµ„ç¹”è³‡è¨Š
      loadOrganizationInfo();
    }

    function setupEventListeners() {
      // æ¨™ç±¤é åˆ‡æ›
      document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.addEventListener('click', function() {
          switchTab(this.dataset.tab);
        });
      });

      // è¡¨å–®æäº¤
      document.getElementById('transactionForm').addEventListener('submit', handleTransactionSubmit);
      document.getElementById('receiptForm').addEventListener('submit', handleReceiptSubmit);
      document.getElementById('voucherForm').addEventListener('submit', handleVoucherSubmit);
      document.getElementById('memberForm').addEventListener('submit', handleMemberSubmit);
      document.getElementById('organizationForm').addEventListener('submit', handleOrganizationSubmit);

      // äº¤æ˜“é¡å‹è®Šæ›´æ™‚æ›´æ–°é¡åˆ¥é¸é …
      document.getElementById('transactionType').addEventListener('change', updateCategoryOptions);
      
      // è‡ªå‹•å„²å­˜è‰ç¨¿
      setupFormAutosave();
      
      // æ¨¡æ…‹æ¡†é—œé–‰
      document.getElementById('modal').addEventListener('click', function(e) {
        if (e.target === this) {
          closeModal();
        }
      });
      
      // éµç›¤å¿«æ·éµ
      document.addEventListener('keydown', function(e) {
        // ESC é—œé–‰æ¨¡æ…‹æ¡†
        if (e.key === 'Escape') {
          closeModal();
        }
      });
    }

    function updateCurrentTime() {
      const now = new Date();
      const timeString = now.toLocaleString('zh-TW', {
        year: 'numeric',
        month: '2-digit',
        day: '2-digit',
        hour: '2-digit',
        minute: '2-digit',
        second: '2-digit'
      });
      document.getElementById('currentTime').textContent = timeString;
    }

    function initializeYearOptions() {
      const currentYear = new Date().getFullYear();
      const yearSelect = document.getElementById('reportYear');
      
      // æ¸…ç©ºç¾æœ‰é¸é …
      yearSelect.innerHTML = '<option value="">è«‹é¸æ“‡</option>';
      
      // æ–°å¢å¹´ä»½é¸é … (ç•¶å¹´ + å‰5å¹´)
      for (let year = currentYear; year >= currentYear - 5; year--) {
        const option = document.createElement('option');
        option.value = year;
        option.textContent = year + 'å¹´';
        yearSelect.appendChild(option);
      }
    }

    // ç¶²è·¯ç‹€æ…‹ç›£æ§
    function updateNetworkStatus() {
      const statusEl = document.getElementById('networkStatus');
      const textEl = document.getElementById('networkStatusText');
      
      if (navigator.onLine) {
        statusEl.className = 'network-status online';
        textEl.textContent = 'ç·šä¸Š';
        setTimeout(() => { statusEl.style.display = 'none'; }, 3000);
      } else {
        statusEl.className = 'network-status offline';
        textEl.textContent = 'é›¢ç·š';
        statusEl.style.display = 'block';
      }
    }

    // æ¨™ç±¤é åˆ‡æ›
    function switchTab(tabName) {
      // éš±è—æ‰€æœ‰æ¨™ç±¤é å…§å®¹
      document.querySelectorAll('.tab-content').forEach(content => {
        content.classList.remove('active');
      });

      // ç§»é™¤æ‰€æœ‰æŒ‰éˆ•çš„activeé¡åˆ¥
      document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.classList.remove('active');
      });

      // é¡¯ç¤ºé¸ä¸­çš„æ¨™ç±¤é 
      document.getElementById(tabName).classList.add('active');
      document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');

      currentTab = tabName;
      currentPage = 1; // é‡ç½®é ç¢¼

      // è¼‰å…¥å°æ‡‰æ•¸æ“š
      switch (tabName) {
        case 'dashboard':
          loadDashboard();
          break;
        case 'transactions':
          loadTransactions();
          break;
        case 'receipts':
          loadReceipts();
          break;
        case 'vouchers':
          loadVouchers();
          break;
        case 'members':
          loadMembers();
          break;
        case 'reports':
          // ä¸éœ€è¦ç«‹å³è¼‰å…¥æ•¸æ“š
          break;
        case 'settings':
          loadOrganizationInfo();
          break;
      }
    }

    // æ›´æ–°äº¤æ˜“é¡åˆ¥é¸é …
    function updateCategoryOptions() {
      const typeSelect = document.getElementById('transactionType');
      const categorySelect = document.getElementById('transactionCategory');
      const selectedType = typeSelect.value;
      
      // æ¸…ç©ºç¾æœ‰é¸é …
      categorySelect.innerHTML = '<option value="">è«‹é¸æ“‡</option>';
      
      // æ ¹æ“šé¡å‹æ–°å¢å°æ‡‰é¸é …
      if (selectedType === 'æ”¶å…¥') {
        const incomeCategories = ['ææ¬¾', 'æœƒè²»', 'æ´»å‹•æ”¶å…¥', 'è£œåŠ©æ¬¾', 'å…¶ä»–æ”¶å…¥'];
        incomeCategories.forEach(category => {
          const option = document.createElement('option');
          option.value = category;
          option.textContent = category;
          categorySelect.appendChild(option);
        });
      } else if (selectedType === 'æ”¯å‡º') {
        const expenseCategories = ['è¾¦å…¬è²»ç”¨', 'æ´»å‹•æ”¯å‡º', 'äº¤é€šè²»', 'è¨­å‚™æ¡è³¼', 'äººäº‹è²»ç”¨', 'å…¶ä»–æ”¯å‡º'];
        expenseCategories.forEach(category => {
          const option = document.createElement('option');
          option.value = category;
          option.textContent = category;
          categorySelect.appendChild(option);
        });
      }
    }

    // API å‘¼å«å‡½æ•¸
    async function callAPI(action, data = {}) {
      showLoading();
      
      try {
        const formData = new FormData();
        formData.append('action', action);
        formData.append('data', JSON.stringify(data));

        const response = await fetch(API_BASE_URL, {
          method: 'POST',
          body: formData
        });

        if (!response.ok) {
          throw new Error(`HTTPéŒ¯èª¤ï¼š${response.status}`);
        }

        const result = await response.json();
        
        if (result.success) {
          return result;
        } else {
          throw new Error(result.error || 'æ“ä½œå¤±æ•—');
        }
      } catch (error) {
        console.error('APIå‘¼å«å¤±æ•—:', error);
        showAlert('error', 'æ“ä½œå¤±æ•—ï¼š' + error.message);
        return { success: false, error: error.message };
      } finally {
        hideLoading();
      }
    }

    // è¼‰å…¥å„€è¡¨æ¿
    async function loadDashboard() {
      try {
        const result = await callAPI('getDashboardStats');
        if (result.success) {
          updateDashboardStats(result.data);
          
          // è¼‰å…¥æœ€è¿‘æ´»å‹•
          const activities = await callAPI('getRecentActivities');
          if (activities.success) {
            displayRecentActivities(activities.data);
          }
        }
      } catch (error) {
        console.error('è¼‰å…¥å„€è¡¨æ¿å¤±æ•—:', error);
        showAlert('error', 'è¼‰å…¥å„€è¡¨æ¿å¤±æ•—');
      }
    }

    function updateDashboardStats(data) {
      document.getElementById('totalIncome').textContent = '$' + formatNumber(data.totalIncome || 0);
      document.getElementById('totalExpense').textContent = '$' + formatNumber(data.totalExpense || 0);
      document.getElementById('receiptCount').textContent = data.receiptCount || 0;
      document.getElementById('memberCount').textContent = data.memberCount || 0;

      // æ›´æ–°è®ŠåŒ–ç™¾åˆ†æ¯”
      const incomeChange = document.getElementById('incomeChange');
      incomeChange.textContent = (data.incomeChange > 0 ? '+' : '') + data.incomeChange + '%';
      incomeChange.className = data.incomeChange >= 0 ? 'stat-change positive' : 'stat-change negative';
      
      const expenseChange = document.getElementById('expenseChange');
      expenseChange.textContent = (data.expenseChange > 0 ? '+' : '') + data.expenseChange + '%';
      expenseChange.className = data.expenseChange <= 0 ? 'stat-change positive' : 'stat-change negative';
      
      const receiptChange = document.getElementById('receiptChange');
      receiptChange.textContent = (data.receiptChange > 0 ? '+' : '') + data.receiptChange;
      receiptChange.className = data.receiptChange >= 0 ? 'stat-change positive' : 'stat-change negative';
      
      const memberChange = document.getElementById('memberChange');
      memberChange.textContent = (data.memberChange > 0 ? '+' : '') + data.memberChange;
      memberChange.className = data.memberChange >= 0 ? 'stat-change positive' : 'stat-change negative';
    }

    function displayRecentActivities(activities) {
      const container = document.getElementById('recentActivities');
      
      if (!activities || activities.length === 0) {
        container.innerHTML = `
          <div class="empty-state">
            <h3>å°šç„¡æ´»å‹•è¨˜éŒ„</h3>
            <p>ç³»çµ±å°‡è‡ªå‹•è¨˜éŒ„æ‰€æœ‰æ“ä½œæ´»å‹•</p>
          </div>
        `;
        return;
      }
      
      let html = `<div class="table-container">
        <table>
          <thead>
            <tr>
              <th>æ™‚é–“</th>
              <th>é¡å‹</th>
              <th>æ´»å‹•å…§å®¹</th>
            </tr>
          </thead>
          <tbody>
      `;
      
      activities.forEach(activity => {
        const activityDate = new Date(activity.time);
        
        html += `
          <tr>
            <td>${formatDateTime(activityDate)}</td>
            <td>${getActivityTypeLabel(activity.type)}</td>
            <td>${activity.message}</td>
          </tr>
        `;
      });
      
      html += `
          </tbody>
        </table>
      </div>`;
      
      container.innerHTML = html;
    }

    function getActivityTypeLabel(type) {
      const types = {
        'TRANSACTION': '<span class="badge badge-primary">äº¤æ˜“</span>',
        'RECEIPT': '<span class="badge badge-success">æ”¶æ“š</span>',
        'VOUCHER': '<span class="badge badge-warning">æ†‘è­‰</span>',
        'MEMBER': '<span class="badge badge-info">æœƒå“¡</span>',
        'SYSTEM': '<span class="badge badge-secondary">ç³»çµ±</span>',
        'ERROR': '<span class="badge badge-danger">éŒ¯èª¤</span>',
        'BACKUP': '<span class="badge badge-secondary">å‚™ä»½</span>',
        'LOGIN': '<span class="badge badge-info">ç™»å…¥</span>'
      };
      
      return types[type] || `<span class="badge badge-secondary">${type}</span>`;
    }

    // è¡¨å–®è™•ç†å‡½æ•¸
    async function handleTransactionSubmit(e) {
      e.preventDefault();
      
      try {
        const formData = new FormData(e.target);
        const data = Object.fromEntries(formData.entries());
        
        // è¡¨å–®é©—è­‰
        if (!data.date || !data.type || !data.category || !data.name || !data.amount) {
          showAlert('warning', 'è«‹å¡«å¯«æ‰€æœ‰å¿…å¡«æ¬„ä½');
          return;
        }
        
        // é‡‘é¡å¿…é ˆå¤§æ–¼0
        if (parseFloat(data.amount) <= 0) {
          showAlert('warning', 'é‡‘é¡å¿…é ˆå¤§æ–¼0');
          return;
        }
        
        const result = await callAPI('saveTransaction', data);
        
        if (result.success) {
          showAlert('success', 'äº¤æ˜“è¨˜éŒ„å·²æˆåŠŸæ–°å¢');
          e.target.reset();
          document.getElementById('transactionDate').value = new Date().toISOString().split('T')[0];
          clearFormDraft('transactionForm');
          loadTransactions();
        }
      } catch (error) {
        console.error('è™•ç†äº¤æ˜“è¡¨å–®å¤±æ•—:', error);
        showAlert('error', 'è™•ç†äº¤æ˜“è¡¨å–®å¤±æ•—');
      }
    }

    async function handleReceiptSubmit(e) {
      e.preventDefault();
      
      try {
        const formData = new FormData(e.target);
        const data = Object.fromEntries(formData.entries());
        
        // è¡¨å–®é©—è­‰
        if (!data.date || !data.payer || !data.category || !data.amount) {
          showAlert('warning', 'è«‹å¡«å¯«æ‰€æœ‰å¿…å¡«æ¬„ä½');
          return;
        }
        
        // é‡‘é¡å¿…é ˆå¤§æ–¼0
        if (parseFloat(data.amount) <= 0) {
          showAlert('warning', 'é‡‘é¡å¿…é ˆå¤§æ–¼0');
          return;
        }
        
        const result = await callAPI('issueReceipt', data);
        
        if (result.success) {
          showAlert('success', 'æ”¶æ“šå·²æˆåŠŸé–‹ç«‹ï¼Œç·¨è™Ÿï¼š' + result.receiptNumber);
          e.target.reset();
          document.getElementById('receiptDate').value = new Date().toISOString().split('T')[0];
          clearFormDraft('receiptForm');
          loadReceipts();
        }
      } catch (error) {
        console.error('è™•ç†æ”¶æ“šè¡¨å–®å¤±æ•—:', error);
        showAlert('error', 'è™•ç†æ”¶æ“šè¡¨å–®å¤±æ•—');
      }
    }

    async function handleVoucherSubmit(e) {
      e.preventDefault();
      
      try {
        const formData = new FormData(e.target);
        const data = Object.fromEntries(formData.entries());
        
        // è¡¨å–®é©—è­‰
        if (!data.date || !data.applicant || !data.category || !data.amount || !data.purpose) {
          showAlert('warning', 'è«‹å¡«å¯«æ‰€æœ‰å¿…å¡«æ¬„ä½');
          return;
        }
        
        // é‡‘é¡å¿…é ˆå¤§æ–¼0
        if (parseFloat(data.amount) <= 0) {
          showAlert('warning', 'é‡‘é¡å¿…é ˆå¤§æ–¼0');
          return;
        }
        
        const result = await callAPI('submitVoucher', data);
        
        if (result.success) {
          showAlert('success', 'æ†‘è­‰ç”³è«‹å·²æäº¤ï¼Œç·¨è™Ÿï¼š' + result.voucherNumber);
          e.target.reset();
          document.getElementById('voucherDate').value = new Date().toISOString().split('T')[0];
          clearFormDraft('voucherForm');
          loadVouchers();
        }
      } catch (error) {
        console.error('è™•ç†æ†‘è­‰è¡¨å–®å¤±æ•—:', error);
        showAlert('error', 'è™•ç†æ†‘è­‰è¡¨å–®å¤±æ•—');
      }
    }

    async function handleMemberSubmit(e) {
      e.preventDefault();
      
      try {
        const formData = new FormData(e.target);
        const data = Object.fromEntries(formData.entries());
        
        // è¡¨å–®é©—è­‰
        if (!data.name || !data.phone || !data.type || !data.joinDate) {
          showAlert('warning', 'è«‹å¡«å¯«æ‰€æœ‰å¿…å¡«æ¬„ä½');
          return;
        }
        
        const result = await callAPI('saveMember', data);
        
        if (result.success) {
          showAlert('success', 'æœƒå“¡å·²æˆåŠŸ' + (data.id ? 'æ›´æ–°' : 'æ–°å¢') + (result.memberNumber ? 'ï¼Œç·¨è™Ÿï¼š' + result.memberNumber : ''));
          e.target.reset();
          document.getElementById('memberJoinDate').value = new Date().toISOString().split('T')[0];
          clearFormDraft('memberForm');
          loadMembers();
        }
      } catch (error) {
        console.error('è™•ç†æœƒå“¡è¡¨å–®å¤±æ•—:', error);
        showAlert('error', 'è™•ç†æœƒå“¡è¡¨å–®å¤±æ•—');
      }
    }

    async function handleOrganizationSubmit(e) {
      e.preventDefault();
      
      try {
        const formData = new FormData(e.target);
        const data = Object.fromEntries(formData.entries());
        
        // è¡¨å–®é©—è­‰
        if (!data.name) {
          showAlert('warning', 'è«‹å¡«å¯«çµ„ç¹”åç¨±');
          return;
        }
        
        const result = await callAPI('saveOrganizationInfo', data);
        
        if (result.success) {
          showAlert('success', 'çµ„ç¹”è³‡è¨Šå·²æˆåŠŸå„²å­˜');
        }
      } catch (error) {
        console.error('å„²å­˜çµ„ç¹”è³‡è¨Šå¤±æ•—:', error);
        showAlert('error', 'å„²å­˜çµ„ç¹”è³‡è¨Šå¤±æ•—');
      }
    }

    // è¼‰å…¥æ•¸æ“šå‡½æ•¸
    async function loadTransactions(filters = {}) {
      try {
        const params = {
          page: currentPage,
          limit: itemsPerPage,
          ...filters
        };
        
        // æ›´æ–°è¡¨æ ¼ç‚ºè¼‰å…¥ç‹€æ…‹
        document.querySelector('#transactionsTable tbody').innerHTML = `
          <tr>
            <td colspan="8" class="empty-state">
              <h3>è¼‰å…¥ä¸­...</h3>
              <p>æ­£åœ¨å–å¾—äº¤æ˜“è¨˜éŒ„</p>
            </td>
          </tr>
        `;
        
        const result = await callAPI('getTransactions', params);
        
        if (result.success) {
          displayTransactions(result.data.items);
          
          // æ›´æ–°åˆ†é 
          if (result.data.pagination) {
            renderPagination('transactionsPagination', result.data.pagination, loadTransactions);
          }
        }
      } catch (error) {
        console.error('è¼‰å…¥äº¤æ˜“è¨˜éŒ„å¤±æ•—:', error);
        showAlert('error', 'è¼‰å…¥äº¤æ˜“è¨˜éŒ„å¤±æ•—');
      }
    }

    async function loadReceipts(filters = {}) {
      try {
        const params = {
          page: currentPage,
          limit: itemsPerPage,
          ...filters
        };
        
        // æ›´æ–°è¡¨æ ¼ç‚ºè¼‰å…¥ç‹€æ…‹
        document.querySelector('#receiptsTable tbody').innerHTML = `
          <tr>
            <td colspan="7" class="empty-state">
              <h3>è¼‰å…¥ä¸­...</h3>
              <p>æ­£åœ¨å–å¾—æ”¶æ“šè¨˜éŒ„</p>
            </td>
          </tr>
        `;
        
        const result = await callAPI('getReceipts', params);
        
        if (result.success) {
          displayReceipts(result.data.items);
          
          // æ›´æ–°åˆ†é 
          if (result.data.pagination) {
            renderPagination('receiptsPagination', result.data.pagination, loadReceipts);
          }
        }
      } catch (error) {
        console.error('è¼‰å…¥æ”¶æ“šè¨˜éŒ„å¤±æ•—:', error);
        showAlert('error', 'è¼‰å…¥æ”¶æ“šè¨˜éŒ„å¤±æ•—');
      }
    }

    async function loadVouchers(filters = {}) {
      try {
        const params = {
          page: currentPage,
          limit: itemsPerPage,
          ...filters
        };
        
        // æ›´æ–°è¡¨æ ¼ç‚ºè¼‰å…¥ç‹€æ…‹
        document.querySelector('#vouchersTable tbody').innerHTML = `
          <tr>
            <td colspan="7" class="empty-state">
              <h3>è¼‰å…¥ä¸­...</h3>
              <p>æ­£åœ¨å–å¾—æ†‘è­‰è¨˜éŒ„</p>
            </td>
          </tr>
        `;
        
        const result = await callAPI('getVouchers', params);
        
        if (result.success) {
          displayVouchers(result.data.items);
          
          // æ›´æ–°åˆ†é 
          if (result.data.pagination) {
            renderPagination('vouchersPagination', result.data.pagination, loadVouchers);
          }
        }
      } catch (error) {
        console.error('è¼‰å…¥æ†‘è­‰è¨˜éŒ„å¤±æ•—:', error);
        showAlert('error', 'è¼‰å…¥æ†‘è­‰è¨˜éŒ„å¤±æ•—');
      }
    }

    async function loadMembers(filters = {}) {
      try {
        const params = {
          page: currentPage,
          limit: itemsPerPage,
          ...filters
        };
        
        // æ›´æ–°è¡¨æ ¼ç‚ºè¼‰å…¥ç‹€æ…‹
        document.querySelector('#membersTable tbody').innerHTML = `
          <tr>
            <td colspan="7" class="empty-state">
              <h3>è¼‰å…¥ä¸­...</h3>
              <p>æ­£åœ¨å–å¾—æœƒå“¡è¨˜éŒ„</p>
            </td>
          </tr>
        `;
        
        const result = await callAPI('getMembers', params);
        
        if (result.success) {
          displayMembers(result.data.items);
          
          // æ›´æ–°åˆ†é 
          if (result.data.pagination) {
            renderPagination('membersPagination', result.data.pagination, loadMembers);
          }
        }
      } catch (error) {
        console.error('è¼‰å…¥æœƒå“¡è¨˜éŒ„å¤±æ•—:', error);
        showAlert('error', 'è¼‰å…¥æœƒå“¡è¨˜éŒ„å¤±æ•—');
      }
    }

    async function loadOrganizationInfo() {
      try {
        const result = await callAPI('getOrganizationInfo');
        
        if (result.success && result.data) {
          document.getElementById('orgName').value = result.data.name || '';
          document.getElementById('orgTaxId').value = result.data.taxId || '';
          document.getElementById('orgAddress').value = result.data.address || '';
          document.getElementById('orgPhone').value = result.data.phone || '';
          document.getElementById('orgEmail').value = result.data.email || '';
          document.getElementById('orgWebsite').value = result.data.website || '';
        }
      } catch (error) {
        console.error('è¼‰å…¥çµ„ç¹”è³‡è¨Šå¤±æ•—:', error);
      }
    }

    // é¡¯ç¤ºæ•¸æ“šå‡½æ•¸
    function displayTransactions(transactions) {
      const tbody = document.querySelector('#transactionsTable tbody');
      
      if (!transactions || transactions.length === 0) {
        tbody.innerHTML = `
          <tr>
            <td colspan="8" class="empty-state">
              <h3>å°šç„¡äº¤æ˜“è¨˜éŒ„</h3>
              <p>è«‹æ–°å¢ç¬¬ä¸€ç­†äº¤æ˜“è¨˜éŒ„</p>
            </td>
          </tr>
        `;
        return;
      }

      tbody.innerHTML = transactions.map(transaction => `
        <tr>
          <td>${formatDate(transaction.date)}</td>
          <td><span class="badge badge-${transaction.type === 'æ”¶å…¥' ? 'success' : 'danger'}">${transaction.type}</span></td>
          <td>${transaction.category}</td>
          <td>${transaction.name}</td>
          <td>$${formatNumber(transaction.amount)}</td>
          <td>${transaction.account || '-'}</td>
          <td><span class="badge badge-${getStatusBadgeClass(transaction.status)}">${transaction.status || 'æ­£å¸¸'}</span></td>
          <td class="table-actions">
            <button class="btn btn-sm btn-info" onclick="viewTransaction('${transaction.id}')">æŸ¥çœ‹</button>
            <button class="btn btn-sm btn-warning" onclick="editTransaction('${transaction.id}')">ç·¨è¼¯</button>
          </td>
        </tr>
      `).join('');
    }

    function displayReceipts(receipts) {
      const tbody = document.querySelector('#receiptsTable tbody');
      
      if (!receipts || receipts.length === 0) {
        tbody.innerHTML = `
          <tr>
            <td colspan="7" class="empty-state">
              <h3>å°šç„¡æ”¶æ“šè¨˜éŒ„</h3>
              <p>è«‹é–‹ç«‹ç¬¬ä¸€å¼µæ”¶æ“š</p>
            </td>
          </tr>
        `;
        return;
      }

      tbody.innerHTML = receipts.map(receipt => `
        <tr>
          <td>${receipt.receiptNumber}</td>
          <td>${formatDate(receipt.date)}</td>
          <td>${receipt.payer}</td>
          <td>${receipt.category}</td>
          <td>$${formatNumber(receipt.amount)}</td>
          <td><span class="badge badge-${getStatusBadgeClass(receipt.status)}">${receipt.status || 'å·²é–‹ç«‹'}</span></td>
          <td class="table-actions">
            <button class="btn btn-sm btn-info" onclick="viewReceipt('${receipt.receiptNumber}')">æŸ¥çœ‹</button>
            <button class="btn btn-sm btn-primary" onclick="printReceipt('${receipt.receiptNumber}')">åˆ—å°</button>
            ${receipt.email ? `<button class="btn btn-sm btn-secondary" onclick="emailReceipt('${receipt.receiptNumber}', '${receipt.email}')">å¯„é€</button>` : ''}
          </td>
        </tr>
      `).join('');
    }

    function displayVouchers(vouchers) {
      const tbody = document.querySelector('#vouchersTable tbody');
      
      if (!vouchers || vouchers.length === 0) {
        tbody.innerHTML = `
          <tr>
            <td colspan="7" class="empty-state">
              <h3>å°šç„¡æ†‘è­‰è¨˜éŒ„</h3>
              <p>è«‹æäº¤ç¬¬ä¸€ç­†æ†‘è­‰ç”³è«‹</p>
            </td>
          </tr>
        `;
        return;
      }

      tbody.innerHTML = vouchers.map(voucher => `
        <tr>
          <td>${voucher.voucherNumber}</td>
          <td>${formatDate(voucher.date)}</td>
          <td>${voucher.applicant}</td>
          <td>${voucher.category}</td>
          <td>$${formatNumber(voucher.amount)}</td>
          <td><span class="badge badge-${getStatusBadgeClass(voucher.status)}">${voucher.status || 'å¾…å¯©æ ¸'}</span></td>
          <td class="table-actions">
            <button class="btn btn-sm btn-info" onclick="viewVoucher('${voucher.voucherNumber}')">æŸ¥çœ‹</button>
            ${voucher.status === 'å¾…å¯©æ ¸' ? `
              <button class="btn btn-sm btn-success" onclick="approveVoucher('${voucher.voucherNumber}')">æ ¸å‡†</button>
              <button class="btn btn-sm btn-danger" onclick="rejectVoucher('${voucher.voucherNumber}')">é§å›</button>
            ` : ''}
          </td>
        </tr>
      `).join('');
    }

    function displayMembers(members) {
      const tbody = document.querySelector('#membersTable tbody');
      
      if (!members || members.length === 0) {
        tbody.innerHTML = `
          <tr>
            <td colspan="7" class="empty-state">
              <h3>å°šç„¡æœƒå“¡è¨˜éŒ„</h3>
              <p>è«‹æ–°å¢ç¬¬ä¸€ä½æœƒå“¡</p>
            </td>
          </tr>
        `;
        return;
      }

      tbody.innerHTML = members.map(member => `
        <tr>
          <td>${member.memberNumber}</td>
          <td>${member.name}</td>
          <td>${member.phone}</td>
          <td>${member.type}</td>
          <td>${formatDate(member.joinDate)}</td>
          <td><span class="badge badge-${getStatusBadgeClass(member.status)}">${member.status || 'æ­£å¸¸'}</span></td>
          <td class="table-actions">
            <button class="btn btn-sm btn-info" onclick="viewMember('${member.memberNumber}')">æŸ¥çœ‹</button>
            <button class="btn btn-sm btn-warning" onclick="editMember('${member.memberNumber}')">ç·¨è¼¯</button>
          </td>
        </tr>
      `).join('');
    }

    function renderPagination(containerId, pagination, loadFunction) {
      const container = document.getElementById(containerId);
      
      if (!pagination || pagination.totalPages <= 1) {
        container.innerHTML = '';
        return;
      }
      
      let html = '';
      
      // ä¸Šä¸€é æŒ‰éˆ•
      html += `<button ${pagination.currentPage <= 1 ? 'disabled' : ''} onclick="changePage(${pagination.currentPage - 1}, ${loadFunction.name})">ä¸Šä¸€é </button>`;
      
      // é ç¢¼æŒ‰éˆ•
      const startPage = Math.max(1, pagination.currentPage - 2);
      const endPage = Math.min(pagination.totalPages, pagination.currentPage + 2);
      
      if (startPage > 1) {
        html += `<button onclick="changePage(1, ${loadFunction.name})">1</button>`;
        if (startPage > 2) {
          html += `<span>...</span>`;
        }
      }
      
      for (let i = startPage; i <= endPage; i++) {
        html += `<button class="${i === pagination.currentPage ? 'active' : ''}" onclick="changePage(${i}, ${loadFunction.name})">${i}</button>`;
      }
      
      if (endPage < pagination.totalPages) {
        if (endPage < pagination.totalPages - 1) {
          html += `<span>...</span>`;
        }
        html += `<button onclick="changePage(${pagination.totalPages}, ${loadFunction.name})">${pagination.totalPages}</button>`;
      }
      
      // ä¸‹ä¸€é æŒ‰éˆ•
      html += `<button ${pagination.currentPage >= pagination.totalPages ? 'disabled' : ''} onclick="changePage(${pagination.currentPage + 1}, ${loadFunction.name})">ä¸‹ä¸€é </button>`;
      
      container.innerHTML = html;
    }

    function changePage(page, loadFunction) {
      currentPage = page;
      loadFunction();
    }

    // æœå°‹å‡½æ•¸
    function searchTransactions() {
      const filters = {
        search: document.getElementById('transactionSearch').value,
        type: document.getElementById('transactionTypeFilter').value,
        dateFrom: document.getElementById('transactionDateFrom').value,
        dateTo: document.getElementById('transactionDateTo').value
      };
      
      currentPage = 1; // é‡ç½®é ç¢¼
      loadTransactions(filters);
    }

    function searchReceipts() {
      const filters = {
        search: document.getElementById('receiptSearch').value,
        status: document.getElementById('receiptStatusFilter').value
      };
      
      currentPage = 1; // é‡ç½®é ç¢¼
      loadReceipts(filters);
    }

    function searchMembers() {
      const filters = {
        search: document.getElementById('memberSearch').value,
        type: document.getElementById('memberTypeFilter').value
      };
      
      currentPage = 1; // é‡ç½®é ç¢¼
      loadMembers(filters);
    }

    // è©³ç´°æ“ä½œå‡½æ•¸
    async function viewTransaction(id) {
      try {
        const result = await callAPI('getTransactionDetails', { id });
        
        if (result.success && result.data) {
          const transaction = result.data;
          
          let content = `
            <div class="detail-content">
              <div class="detail-row">
                <div class="detail-label">äº¤æ˜“æ—¥æœŸï¼š</div>
                <div class="detail-value">${formatDate(transaction.date)}</div>
              </div>
              <div class="detail-row">
                <div class="detail-label">æ”¶æ”¯é¡å‹ï¼š</div>
                <div class="detail-value">${transaction.type}</div>
              </div>
              <div class="detail-row">
                <div class="detail-label">é¡åˆ¥ï¼š</div>
                <div class="detail-value">${transaction.category}</div>
              </div>
              <div class="detail-row">
                <div class="detail-label">äº¤æ˜“å°è±¡ï¼š</div>
                <div class="detail-value">${transaction.name}</div>
              </div>
              <div class="detail-row">
                <div class="detail-label">é‡‘é¡ï¼š</div>
                <div class="detail-value">$${formatNumber(transaction.amount)}</div>
              </div>
              <div class="detail-row">
                <div class="detail-label">å¸³æˆ¶ï¼š</div>
                <div class="detail-value">${transaction.account || '-'}</div>
              </div>
              <div class="detail-row">
                <div class="detail-label">èªªæ˜ï¼š</div>
                <div class="detail-value">${transaction.description || '-'}</div>
              </div>
              <div class="detail-row">
                <div class="detail-label">ç‹€æ…‹ï¼š</div>
                <div class="detail-value">${transaction.status || 'æ­£å¸¸'}</div>
              </div>
              <div class="detail-row">
                <div class="detail-label">å»ºç«‹æ™‚é–“ï¼š</div>
                <div class="detail-value">${formatDateTime(transaction.createdAt)}</div>
              </div>
              <div class="detail-row">
                <div class="detail-label">æœ€å¾Œæ›´æ–°ï¼š</div>
                <div class="detail-value">${formatDateTime(transaction.updatedAt)}</div>
              </div>
            </div>
            <div class="btn-group mt-3">
              <button type="button" class="btn btn-warning" onclick="editTransaction('${transaction.id}')">ç·¨è¼¯</button>
              <button type="button" class="btn btn-danger" onclick="deleteTransaction('${transaction.id}')">åˆªé™¤</button>
            </div>
          `;
          
          showModal('äº¤æ˜“è¨˜éŒ„è©³æƒ…', content);
        }
      } catch (error) {
        console.error('è¼‰å…¥äº¤æ˜“è©³æƒ…å¤±æ•—:', error);
        showAlert('error', 'è¼‰å…¥äº¤æ˜“è©³æƒ…å¤±æ•—');
      }
    }

    async function viewReceipt(receiptNumber) {
      try {
        const result = await callAPI('getReceiptDetails', { receiptNumber });
        
        if (result.success && result.data) {
          const receipt = result.data;
          
          let content = `
            <div class="detail-content">
              <div class="detail-row">
                <div class="detail-label">æ”¶æ“šç·¨è™Ÿï¼š</div>
                <div class="detail-value">${receipt.receiptNumber}</div>
              </div>
              <div class="detail-row">
                <div class="detail-label">æ”¶æ“šæ—¥æœŸï¼š</div>
                <div class="detail-value">${formatDate(receipt.date)}</div>
              </div>
              <div class="detail-row">
                <div class="detail-label">ä»˜æ¬¾äººï¼š</div>
                <div class="detail-value">${receipt.payer}</div>
              </div>
              <div class="detail-row">
                <div class="detail-label">èº«ä»½é¡åˆ¥ï¼š</div>
                <div class="detail-value">${receipt.identity || '-'}</div>
              </div>
              <div class="detail-row">
                <div class="detail-label">è¯çµ¡é›»è©±ï¼š</div>
                <div class="detail-value">${receipt.phone || '-'}</div>
              </div>
              <div class="detail-row">
                <div class="detail-label">é›»å­éƒµä»¶ï¼š</div>
                <div class="detail-value">${receipt.email || '-'}</div>
              </div>
              <div class="detail-row">
                <div class="detail-label">æ”¶æ“šé¡åˆ¥ï¼š</div>
                <div class="detail-value">${receipt.category}</div>
              </div>
              <div class="detail-row">
                <div class="detail-label">é‡‘é¡ï¼š</div>
                <div class="detail-value">$${formatNumber(receipt.amount)}</div>
              </div>
              <div class="detail-row">
                <div class="detail-label">ç”¨é€”èªªæ˜ï¼š</div>
                <div class="detail-value">${receipt.purpose || '-'}</div>
              </div>
              <div class="detail-row">
                <div class="detail-label">ç‹€æ…‹ï¼š</div>
                <div class="detail-value">${receipt.status || 'å·²é–‹ç«‹'}</div>
              </div>
              <div class="detail-row">
                <div class="detail-label">å»ºç«‹æ™‚é–“ï¼š</div>
                <div class="detail-value">${formatDateTime(receipt.createdAt)}</div>
              </div>
            </div>
            <div class="btn-group mt-3">
              <button type="button" class="btn btn-primary" onclick="printReceipt('${receipt.receiptNumber}')">åˆ—å°æ”¶æ“š</button>
              ${receipt.email ? `<button type="button" class="btn btn-secondary" onclick="emailReceipt('${receipt.receiptNumber}', '${receipt.email}')">å¯„é€æ”¶æ“š</button>` : ''}
              ${receipt.status !== 'å·²ä½œå»¢' ? `<button type="button" class="btn btn-danger" onclick="voidReceipt('${receipt.receiptNumber}')">ä½œå»¢æ”¶æ“š</button>` : ''}
            </div>
          `;
          
          showModal('æ”¶æ“šè©³æƒ…', content);
        }
      } catch (error) {
        console.error('è¼‰å…¥æ”¶æ“šè©³æƒ…å¤±æ•—:', error);
        showAlert('error', 'è¼‰å…¥æ”¶æ“šè©³æƒ…å¤±æ•—');
      }
    }

    async function viewVoucher(voucherNumber) {
      try {
        const result = await callAPI('getVoucherDetails', { voucherNumber });
        
        if (result.success && result.data) {
          const voucher = result.data;
          
          let content = `
            <div class="detail-content">
              <div class="detail-row">
                <div class="detail-label">æ†‘è­‰ç·¨è™Ÿï¼š</div>
                <div class="detail-value">${voucher.voucherNumber}</div>
              </div>
              <div class="detail-row">
                <div class="detail-label">ç”³è«‹æ—¥æœŸï¼š</div>
                <div class="detail-value">${formatDate(voucher.date)}</div>
              </div>
              <div class="detail-row">
                <div class="detail-label">ç”³è«‹äººï¼š</div>
                <div class="detail-value">${voucher.applicant}</div>
              </div>
              <div class="detail-row">
                <div class="detail-label">æ”¯å‡ºé¡åˆ¥ï¼š</div>
                <div class="detail-value">${voucher.category}</div>
              </div>
              <div class="detail-row">
                <div class="detail-label">ç”³è«‹é‡‘é¡ï¼š</div>
                <div class="detail-value">$${formatNumber(voucher.amount)}</div>
              </div>
              <div class="detail-row">
                <div class="detail-label">ç”¨é€”èªªæ˜ï¼š</div>
                <div class="detail-value">${voucher.purpose}</div>
              </div>
              <div class="detail-row">
                <div class="detail-label">é™„ä»¶æ•¸é‡ï¼š</div>
                <div class="detail-value">${voucher.attachmentCount || '0'}</div>
              </div>
              <div class="detail-row">
                <div class="detail-label">ç‹€æ…‹ï¼š</div>
                <div class="detail-value">${voucher.status || 'å¾…å¯©æ ¸'}</div>
              </div>
              <div class="detail-row">
                <div class="detail-label">å»ºç«‹æ™‚é–“ï¼š</div>
                <div class="detail-value">${formatDateTime(voucher.createdAt)}</div>
              </div>
              ${voucher.reviewedBy ? `
                <div class="detail-row">
                  <div class="detail-label">å¯©æ ¸äººï¼š</div>
                  <div class="detail-value">${voucher.reviewedBy}</div>
                </div>
                <div class="detail-row">
                  <div class="detail-label">å¯©æ ¸æ™‚é–“ï¼š</div>
                  <div class="detail-value">${formatDateTime(voucher.reviewedAt)}</div>
                </div>
                <div class="detail-row">
                  <div class="detail-label">å¯©æ ¸å‚™è¨»ï¼š</div>
                  <div class="detail-value">${voucher.reviewNote || '-'}</div>
                </div>
              ` : ''}
            </div>
            <div class="btn-group mt-3">
              <button type="button" class="btn btn-primary" onclick="printVoucher('${voucher.voucherNumber}')">åˆ—å°æ†‘è­‰</button>
              ${voucher.status === 'å¾…å¯©æ ¸' ? `
                <button type="button" class="btn btn-success" onclick="approveVoucher('${voucher.voucherNumber}')">æ ¸å‡†</button>
                <button type="button" class="btn btn-danger" onclick="rejectVoucher('${voucher.voucherNumber}')">é§å›</button>
              ` : ''}
            </div>
          `;
          
          showModal('æ†‘è­‰è©³æƒ…', content);
        }
      } catch (error) {
        console.error('è¼‰å…¥æ†‘è­‰è©³æƒ…å¤±æ•—:', error);
        showAlert('error', 'è¼‰å…¥æ†‘è­‰è©³æƒ…å¤±æ•—');
      }
    }

    async function viewMember(memberNumber) {
      try {
        const result = await callAPI('getMemberDetails', { memberNumber });
        
        if (result.success && result.data) {
          const member = result.data;
          
          let content = `
            <div class="detail-content">
              <div class="detail-row">
                <div class="detail-label">æœƒå“¡ç·¨è™Ÿï¼š</div>
                <div class="detail-value">${member.memberNumber}</div>
              </div>
              <div class="detail-row">
                <div class="detail-label">å§“åï¼š</div>
                <div class="detail-value">${member.name}</div>
              </div>
              <div class="detail-row">
                <div class="detail-label">æ€§åˆ¥ï¼š</div>
                <div class="detail-value">${member.gender || '-'}</div>
              </div>
              <div class="detail-row">
                <div class="detail-label">å‡ºç”Ÿæ—¥æœŸï¼š</div>
                <div class="detail-value">${member.birthDate ? formatDate(member.birthDate) : '-'}</div>
              </div>
              <div class="detail-row">
                <div class="detail-label">èº«ä»½è­‰å­—è™Ÿï¼š</div>
                <div class="detail-value">${member.idNumber || '-'}</div>
              </div>
              <div class="detail-row">
                <div class="detail-label">è¯çµ¡é›»è©±ï¼š</div>
                <div class="detail-value">${member.phone}</div>
              </div>
              <div class="detail-row">
                <div class="detail-label">é›»å­éƒµä»¶ï¼š</div>
                <div class="detail-value">${member.email || '-'}</div>
              </div>
              <div class="detail-row">
                <div class="detail-label">è¯çµ¡åœ°å€ï¼š</div>
                <div class="detail-value">${member.address || '-'}</div>
              </div>
              <div class="detail-row">
                <div class="detail-label">æœƒå“¡é¡å‹ï¼š</div>
                <div class="detail-value">${member.type}</div>
              </div>
              <div class="detail-row">
                <div class="detail-label">åŠ å…¥æ—¥æœŸï¼š</div>
                <div class="detail-value">${formatDate(member.joinDate)}</div>
              </div>
              <div class="detail-row">
                <div class="detail-label">ç‹€æ…‹ï¼š</div>
                <div class="detail-value">${member.status || 'æ­£å¸¸'}</div>
              </div>
              <div class="detail-row">
                <div class="detail-label">å‚™è¨»ï¼š</div>
                <div class="detail-value">${member.notes || '-'}</div>
              </div>
            </div>
            <div class="btn-group mt-3">
              <button type="button" class="btn btn-warning" onclick="editMember('${member.memberNumber}')">ç·¨è¼¯</button>
              ${member.status === 'æ­£å¸¸' ? `
                <button type="button" class="btn btn-danger" onclick="deactivateMember('${member.memberNumber}')">åœç”¨</button>
              ` : `
                <button type="button" class="btn btn-success" onclick="activateMember('${member.memberNumber}')">å•Ÿç”¨</button>
              `}
            </div>
          `;
          
          showModal('æœƒå“¡è©³æƒ…', content);
        }
      } catch (error) {
        console.error('è¼‰å…¥æœƒå“¡è©³æƒ…å¤±æ•—:', error);
        showAlert('error', 'è¼‰å…¥æœƒå“¡è©³æƒ…å¤±æ•—');
      }
    }

    async function editTransaction(id) {
      try {
        const result = await callAPI('getTransactionDetails', { id });
        
        if (result.success && result.data) {
          const transaction = result.data;
          
          document.getElementById('transactionDate').value = transaction.date;
          document.getElementById('transactionType').value = transaction.type;
          updateCategoryOptions(); // æ›´æ–°é¡åˆ¥é¸é …
          setTimeout(() => {
            document.getElementById('transactionCategory').value = transaction.category;
          }, 100);
          document.getElementById('transactionAmount').value = transaction.amount;
          document.getElementById('transactionName').value = transaction.name;
          document.getElementById('transactionAccount').value = transaction.account || '';
          document.getElementById('transactionDescription').value = transaction.description || '';
          
          // åˆ‡æ›åˆ°äº¤æ˜“æ¨™ç±¤é 
          switchTab('transactions');
          
          // æ»¾å‹•åˆ°è¡¨å–®
          document.getElementById('transactionForm').scrollIntoView({ behavior: 'smooth' });
          
          // æ›´æ–°è¡¨å–®æ¨™é¡Œ
          document.querySelector('#transactions .card-header .card-title').textContent = 'ç·¨è¼¯äº¤æ˜“è¨˜éŒ„';
          
          // æ–°å¢éš±è—æ¬„ä½å„²å­˜ID
          let idField = document.getElementById('transactionId');
          if (!idField) {
            idField = document.createElement('input');
            idField.type = 'hidden';
            idField.id = 'transactionId';
            idField.name = 'id';
            document.getElementById('transactionForm').appendChild(idField);
          }
          idField.value = id;
          
          showAlert('info', 'æ­£åœ¨ç·¨è¼¯äº¤æ˜“è¨˜éŒ„ï¼Œè«‹ä¿®æ”¹å¾Œå„²å­˜');
        }
      } catch (error) {
        console.error('è¼‰å…¥äº¤æ˜“è©³æƒ…å¤±æ•—:', error);
        showAlert('error', 'è¼‰å…¥äº¤æ˜“è©³æƒ…å¤±æ•—');
      }
    }

    async function editMember(memberNumber) {
      try {
        const result = await callAPI('getMemberDetails', { memberNumber });
        
        if (result.success && result.data) {
          const member = result.data;
          
          document.getElementById('memberName').value = member.name;
          document.getElementById('memberGender').value = member.gender || '';
          document.getElementById('memberBirthDate').value = member.birthDate || '';
          document.getElementById('memberIdNumber').value = member.idNumber || '';
          document.getElementById('memberPhone').value = member.phone;
          document.getElementById('memberEmail').value = member.email || '';
          document.getElementById('memberAddress').value = member.address || '';
          document.getElementById('memberType').value = member.type;
          document.getElementById('memberJoinDate').value = member.joinDate;
          document.getElementById('memberNotes').value = member.notes || '';
          
          // åˆ‡æ›åˆ°æœƒå“¡æ¨™ç±¤é 
          switchTab('members');
          
          // æ»¾å‹•åˆ°è¡¨å–®
          document.getElementById('memberForm').scrollIntoView({ behavior: 'smooth' });
          
          // æ›´æ–°è¡¨å–®æ¨™é¡Œ
          document.querySelector('#members .card-header .card-title').textContent = 'ç·¨è¼¯æœƒå“¡è³‡æ–™';
          
          // æ–°å¢éš±è—æ¬„ä½å„²å­˜æœƒå“¡ç·¨è™Ÿ
          let idField = document.getElementById('memberId');
          if (!idField) {
            idField = document.createElement('input');
            idField.type = 'hidden';
            idField.id = 'memberId';
            idField.name = 'id';
            document.getElementById('memberForm').appendChild(idField);
          }
          idField.value = memberNumber;
          
          showAlert('info', 'æ­£åœ¨ç·¨è¼¯æœƒå“¡è³‡æ–™ï¼Œè«‹ä¿®æ”¹å¾Œå„²å­˜');
        }
      } catch (error) {
        console.error('è¼‰å…¥æœƒå“¡è©³æƒ…å¤±æ•—:', error);
        showAlert('error', 'è¼‰å…¥æœƒå“¡è©³æƒ…å¤±æ•—');
      }
    }

    async function deleteTransaction(id) {
      if (!confirm('ç¢ºå®šè¦åˆªé™¤æ­¤äº¤æ˜“è¨˜éŒ„å—ï¼Ÿæ­¤æ“ä½œç„¡æ³•å¾©åŸã€‚')) {
        return;
      }
      
      try {
        const result = await callAPI('deleteTransaction', { id });
        
        if (result.success) {
          showAlert('success', 'äº¤æ˜“è¨˜éŒ„å·²æˆåŠŸåˆªé™¤');
          closeModal();
          loadTransactions();
        }
      } catch (error) {
        console.error('åˆªé™¤äº¤æ˜“è¨˜éŒ„å¤±æ•—:', error);
        showAlert('error', 'åˆªé™¤äº¤æ˜“è¨˜éŒ„å¤±æ•—');
      }
    }

    async function voidReceipt(receiptNumber) {
      if (!confirm('ç¢ºå®šè¦ä½œå»¢æ­¤æ”¶æ“šå—ï¼Ÿæ­¤æ“ä½œç„¡æ³•å¾©åŸã€‚')) {
        return;
      }
      
      try {
        const result = await callAPI('voidReceipt', { receiptNumber });
        
        if (result.success) {
          showAlert('success', 'æ”¶æ“šå·²æˆåŠŸä½œå»¢');
          closeModal();
          loadReceipts();
        }
      } catch (error) {
        console.error('ä½œå»¢æ”¶æ“šå¤±æ•—:', error);
        showAlert('error', 'ä½œå»¢æ”¶æ“šå¤±æ•—');
      }
    }

    async function approveVoucher(voucherNumber) {
      const note = prompt('è«‹è¼¸å…¥æ ¸å‡†å‚™è¨»ï¼ˆå¯é¸ï¼‰ï¼š');
      
      try {
        const result = await callAPI('approveVoucher', { 
          voucherNumber, 
          note 
        });
        
        if (result.success) {
          showAlert('success', 'æ†‘è­‰å·²æˆåŠŸæ ¸å‡†');
          closeModal();
          loadVouchers();
        }
      } catch (error) {
        console.error('æ ¸å‡†æ†‘è­‰å¤±æ•—:', error);
        showAlert('error', 'æ ¸å‡†æ†‘è­‰å¤±æ•—');
      }
    }

    async function rejectVoucher(voucherNumber) {
      const note = prompt('è«‹è¼¸å…¥é§å›åŸå› ï¼ˆå¿…å¡«ï¼‰ï¼š');
      
      if (!note) {
        showAlert('warning', 'è«‹è¼¸å…¥é§å›åŸå› ');
        return;
      }
      
      try {
        const result = await callAPI('rejectVoucher', { 
          voucherNumber, 
          note 
        });
        
        if (result.success) {
          showAlert('success', 'æ†‘è­‰å·²é§å›');
          closeModal();
          loadVouchers();
        }
      } catch (error) {
        console.error('é§å›æ†‘è­‰å¤±æ•—:', error);
        showAlert('error', 'é§å›æ†‘è­‰å¤±æ•—');
      }
    }

    async function activateMember(memberNumber) {
      try {
        const result = await callAPI('updateMemberStatus', { 
          memberNumber, 
          status: 'æ­£å¸¸' 
        });
        
        if (result.success) {
          showAlert('success', 'æœƒå“¡å·²æˆåŠŸå•Ÿç”¨');
          closeModal();
          loadMembers();
        }
      } catch (error) {
        console.error('å•Ÿç”¨æœƒå“¡å¤±æ•—:', error);
        showAlert('error', 'å•Ÿç”¨æœƒå“¡å¤±æ•—');
      }
    }

    async function deactivateMember(memberNumber) {
      const reason = prompt('è«‹è¼¸å…¥åœç”¨åŸå› ï¼ˆå¯é¸ï¼‰ï¼š');
      
      try {
        const result = await callAPI('updateMemberStatus', { 
          memberNumber, 
          status: 'åœç”¨', 
          reason 
        });
        
        if (result.success) {
          showAlert('success', 'æœƒå“¡å·²æˆåŠŸåœç”¨');
          closeModal();
          loadMembers();
        }
      } catch (error) {
        console.error('åœç”¨æœƒå“¡å¤±æ•—:', error);
        showAlert('error', 'åœç”¨æœƒå“¡å¤±æ•—');
      }
    }

    async function printReceipt(receiptNumber) {
      try {
        const result = await callAPI('generateReceiptPdf', { receiptNumber });
        
        if (result.success && result.pdfUrl) {
          window.open(result.pdfUrl, '_blank');
        } else {
          throw new Error('ç„¡æ³•ç”¢ç”Ÿæ”¶æ“šPDF');
        }
      } catch (error) {
        console.error('åˆ—å°æ”¶æ“šå¤±æ•—:', error);
        showAlert('error', 'åˆ—å°æ”¶æ“šå¤±æ•—');
      }
    }

    async function emailReceipt(receiptNumber, email) {
      try {
        const result = await callAPI('emailReceipt', { 
          receiptNumber, 
          email 
        });
        
        if (result.success) {
          showAlert('success', 'æ”¶æ“šå·²æˆåŠŸå¯„é€è‡³ ' + email);
        }
      } catch (error) {
        console.error('å¯„é€æ”¶æ“šå¤±æ•—:', error);
        showAlert('error', 'å¯„é€æ”¶æ“šå¤±æ•—');
      }
    }

    async function printVoucher(voucherNumber) {
      try {
        const result = await callAPI('generateVoucherPdf', { voucherNumber });
        
        if (result.success && result.pdfUrl) {
          window.open(result.pdfUrl, '_blank');
        } else {
          throw new Error('ç„¡æ³•ç”¢ç”Ÿæ†‘è­‰PDF');
        }
      } catch (error) {
        console.error('åˆ—å°æ†‘è­‰å¤±æ•—:', error);
        showAlert('error', 'åˆ—å°æ†‘è­‰å¤±æ•—');
      }
    }

    async function generateReport() {
      const type = document.getElementById('reportType').value;
      const year = document.getElementById('reportYear').value;
      const month = document.getElementById('reportMonth').value;
      
      if (!type || !year) {
        showAlert('warning', 'è«‹é¸æ“‡å ±è¡¨é¡å‹å’Œå¹´ä»½');
        return;
      }
      
      try {
        showLoading();
        
        const result = await callAPI('generateReport', { 
          type, 
          year, 
          month 
        });
        
        if (result.success && result.data) {
          displayReportPreview(result.data);
        }
      } catch (error) {
        console.error('ç”¢ç”Ÿå ±è¡¨å¤±æ•—:', error);
        showAlert('error', 'ç”¢ç”Ÿå ±è¡¨å¤±æ•—');
      } finally {
        hideLoading();
      }
    }

    async function exportReport() {
      const type = document.getElementById('reportType').value;
      const year = document.getElementById('reportYear').value;
      const month = document.getElementById('reportMonth').value;
      const format = document.getElementById('reportFormat').value;
      
      if (!type || !year) {
        showAlert('warning', 'è«‹é¸æ“‡å ±è¡¨é¡å‹å’Œå¹´ä»½');
        return;
      }
      
      try {
        showLoading();
        
        const result = await callAPI('exportReport', { 
          type, 
          year, 
          month, 
          format 
        });
        
        if (result.success && result.fileUrl) {
          window.open(result.fileUrl, '_blank');
        } else {
          throw new Error('ç„¡æ³•åŒ¯å‡ºå ±è¡¨');
        }
      } catch (error) {
        console.error('åŒ¯å‡ºå ±è¡¨å¤±æ•—:', error);
        showAlert('error', 'åŒ¯å‡ºå ±è¡¨å¤±æ•—');
      } finally {
        hideLoading();
      }
    }

    function displayReportPreview(data) {
      const container = document.getElementById('reportPreview');
      let html = '';
      
      if (data.title) {
        html += `<h3 class="text-center mb-4">${data.title}</h3>`;
      }
      
      if (data.summary) {
        html += `
          <div class="report-summary">
            <h4>å ±è¡¨æ‘˜è¦</h4>
            <div class="stats-grid">
        `;
        
        for (const key in data.summary) {
          html += `
            <div class="stat-card">
              <div class="stat-number">${data.summary[key].value}</div>
              <div class="stat-label">${data.summary[key].label}</div>
            </div>
          `;
        }
        
        html += `
            </div>
          </div>
        `;
      }
      
      if (data.chart) {
        html += `
          <div class="report-chart">
            <img src="${data.chart}" alt="å ±è¡¨åœ–è¡¨" style="max-width: 100%; height: auto;">
          </div>
        `;
      }
      
      if (data.details && data.details.length > 0) {
        html += `
          <div class="report-details">
            <h4>è©³ç´°è³‡æ–™</h4>
            <div class="table-container">
              <table>
                <thead>
                  <tr>
        `;
        
        // è¡¨é ­
        for (const key in data.details[0]) {
          html += `<th>${getColumnLabel(key)}</th>`;
        }
        
        html += `
                  </tr>
                </thead>
                <tbody>
        `;
        
        // è³‡æ–™è¡Œ
        data.details.forEach(row => {
          html += `<tr>`;
          for (const key in row) {
            let value = row[key];
            
            // æ ¼å¼åŒ–æ•¸å€¼
            if (typeof value === 'number') {
              if (key.includes('amount') || key.includes('total') || key.includes('balance')) {
                value = '$' + formatNumber(value);
              }
            } else if (key.includes('date')) {
              value = formatDate(value);
            }
            
            html += `<td>${value}</td>`;
          }
          html += `</tr>`;
        });
        
        html += `
                </tbody>
              </table>
            </div>
          </div>
        `;
      }
      
      if (data.notes) {
        html += `
          <div class="report-notes mt-4">
            <h4>å‚™è¨»</h4>
            <p>${data.notes}</p>
          </div>
        `;
      }
      
      container.innerHTML = html;
    }

    function getColumnLabel(key) {
      const labels = {
        'date': 'æ—¥æœŸ',
        'type': 'é¡å‹',
        'category': 'é¡åˆ¥',
        'name': 'åç¨±',
        'amount': 'é‡‘é¡',
        'total': 'ç¸½è¨ˆ',
        'balance': 'é¤˜é¡',
        'count': 'æ•¸é‡',
        'payer': 'ä»˜æ¬¾äºº',
        'applicant': 'ç”³è«‹äºº',
        'status': 'ç‹€æ…‹',
        'memberType': 'æœƒå“¡é¡å‹',
        'donationType': 'ææ¬¾é¡å‹',
        'month': 'æœˆä»½',
        'quarter': 'å­£åº¦',
        'year': 'å¹´åº¦'
      };
      
      return labels[key] || key;
    }

    async function performSystemCheck() {
      try {
        showLoading();
        
        const result = await callAPI('performSystemCheck');
        
        if (result.success && result.status) {
          const statusEl = document.getElementById('systemStatus');
          const contentEl = document.getElementById('systemStatusContent');
          
          let html = `
            <div class="system-status-grid">
              <div class="status-item">
                <h5>è³‡æ–™åº«ç‹€æ…‹</h5>
                <p class="${result.status.database ? 'text-success' : 'text-danger'}">
                  ${result.status.database ? 'æ­£å¸¸' : 'ç•°å¸¸'}
                </p>
              </div>
              <div class="status-item">
                <h5>æœ€å¾Œå‚™ä»½</h5>
                <p>${result.status.lastBackup ? formatDateTime(result.status.lastBackup) : 'ç„¡'}</p>
              </div>
              <div class="status-item">
                <h5>ç³»çµ±ç‰ˆæœ¬</h5>
                <p>${result.status.version || SYSTEM_VERSION}</p>
              </div>
              <div class="status-item">
                <h5>å„²å­˜ç©ºé–“</h5>
                <p>${result.status.storage ? formatNumber(result.status.storage) + ' MB' : 'æœªçŸ¥'}</p>
              </div>
            </div>
            
            <div class="mt-4">
              <h5>ç³»çµ±æª¢æŸ¥çµæœ</h5>
              <ul>
          `;
          
          result.status.checks.forEach(check => {
            html += `<li class="${check.status ? 'text-success' : 'text-danger'}">${check.message}</li>`;
          });
          
          html += `
              </ul>
            </div>
          `;
          
          contentEl.innerHTML = html;
          statusEl.style.display = 'block';
          
          showAlert('info', 'ç³»çµ±æª¢æŸ¥å®Œæˆ');
        }
      } catch (error) {
        console.error('ç³»çµ±æª¢æŸ¥å¤±æ•—:', error);
        showAlert('error', 'ç³»çµ±æª¢æŸ¥å¤±æ•—');
      } finally {
        hideLoading();
      }
    }

    async function createBackup() {
      try {
        showLoading();
        
        const result = await callAPI('createBackup');
        
        if (result.success) {
          showAlert('success', 'å‚™ä»½å·²æˆåŠŸå»ºç«‹ï¼Œæª”æ¡ˆåç¨±ï¼š' + result.filename);
        }
      } catch (error) {
        console.error('å»ºç«‹å‚™ä»½å¤±æ•—:', error);
        showAlert('error', 'å»ºç«‹å‚™ä»½å¤±æ•—');
      } finally {
        hideLoading();
      }
    }

    async function cleanupSystem() {
      if (!confirm('ç¢ºå®šè¦åŸ·è¡Œç³»çµ±æ¸…ç†å—ï¼Ÿé€™å°‡åˆªé™¤æš«å­˜æª”æ¡ˆå’Œå„ªåŒ–è³‡æ–™åº«ã€‚')) {
        return;
      }
      
      try {
        showLoading();
        
        const result = await callAPI('cleanupSystem');
        
        if (result.success) {
          showAlert('success', 'ç³»çµ±æ¸…ç†å®Œæˆï¼Œå·²é‡‹æ”¾ ' + result.freedSpace + ' MB ç©ºé–“');
        }
      } catch (error) {
        console.error('ç³»çµ±æ¸…ç†å¤±æ•—:', error);
        showAlert('error', 'ç³»çµ±æ¸…ç†å¤±æ•—');
      } finally {
        hideLoading();
      }
    }

    // è¡¨å–®è‡ªå‹•å„²å­˜
    function setupFormAutosave() {
      const forms = ['transactionForm', 'receiptForm', 'voucherForm', 'memberForm'];
      
      forms.forEach(formId => {
        const form = document.getElementById(formId);
        
        if (form) {
          // è¼‰å…¥è‰ç¨¿
          loadFormDraft(formId);
          
          // è¨­å®šè¼¸å…¥äº‹ä»¶ç›£è½
          form.querySelectorAll('input, select, textarea').forEach(input => {
            input.addEventListener('change', () => {
              saveFormDraft(formId);
            });
          });
        }
      });
    }

    function saveFormDraft(formId) {
      const form = document.getElementById(formId);
      const formData = new FormData(form);
      const data = Object.fromEntries(formData.entries());
      
      try {
        localStorage.setItem(`draft_${formId}`, JSON.stringify(data));
      } catch (error) {
        console.warn('ç„¡æ³•å„²å­˜è¡¨å–®è‰ç¨¿:', error);
      }
    }

    function loadFormDraft(formId) {
      try {
        const savedData = localStorage.getItem(`draft_${formId}`);
        
        if (savedData) {
          const data = JSON.parse(savedData);
          const form = document.getElementById(formId);
          
          // å¡«å…¥è¡¨å–®æ¬„ä½
          for (const key in data) {
            const input = form.querySelector(`[name="${key}"]`);
            if (input) {
              input.value = data[key];
            }
          }
        }
      } catch (error) {
        console.warn('ç„¡æ³•è¼‰å…¥è¡¨å–®è‰ç¨¿:', error);
      }
    }

    function clearFormDraft(formId) {
      try {
        localStorage.removeItem(`draft_${formId}`);
      } catch (error) {
        console.warn('ç„¡æ³•æ¸…é™¤è¡¨å–®è‰ç¨¿:', error);
      }
    }

    // è¼”åŠ©å‡½æ•¸
    function showLoading() {
      document.getElementById('loading').classList.add('show');
    }

    function hideLoading() {
      document.getElementById('loading').classList.remove('show');
    }

    function showAlert(type, message) {
      const container = document.getElementById('alertContainer');
      const alertId = 'alert-' + Date.now();
      
      const alertHtml = `
        <div id="${alertId}" class="alert alert-${type}">
          ${message}
          <button type="button" class="close" onclick="closeAlert('${alertId}')">&times;</button>
        </div>
      `;
      
      container.insertAdjacentHTML('beforeend', alertHtml);
      
      // è‡ªå‹•é—œé–‰
      setTimeout(() => {
        closeAlert(alertId);
      }, 5000);
    }

    function closeAlert(alertId) {
      const alert = document.getElementById(alertId);
      if (alert) {
        alert.style.opacity = '0';
        setTimeout(() => {
          alert.remove();
        }, 300);
      }
    }

    function showModal(title, content) {
      document.getElementById('modalTitle').textContent = title;
      document.getElementById('modalBody').innerHTML = content;
      document.getElementById('modal').classList.add('show');
    }

    function closeModal() {
      document.getElementById('modal').classList.remove('show');
    }

    function formatDate(dateString) {
      if (!dateString) return '-';
      
      const date = new Date(dateString);
      return date.toLocaleDateString('zh-TW');
    }

    function formatDateTime(dateString) {
      if (!dateString) return '-';
      
      const date = new Date(dateString);
      return date.toLocaleString('zh-TW');
    }

    function formatNumber(number) {
      return Number(number).toLocaleString('zh-TW');
    }

    function getStatusBadgeClass(status) {
      const statusClasses = {
        'æ­£å¸¸': 'success',
        'å·²é–‹ç«‹': 'success',
        'å·²å¯„é€': 'info',
        'å·²ä½œå»¢': 'danger',
        'å¾…å¯©æ ¸': 'warning',
        'å·²æ ¸å‡†': 'success',
        'å·²é§å›': 'danger',
        'åœç”¨': 'danger'
      };
      
      return statusClasses[status] || 'secondary';
    }

    function getAboutContent() {
      return `
        <div>
          <h4>å°ç£å¸•é‡‘æ£®ç—…å‹æ¬Šç›Šä¿ƒé€²æœƒ - æœƒè¨ˆç®¡ç†ç³»çµ±</h4>
          <p>ç‰ˆæœ¬ï¼š${SYSTEM_VERSION}</p>
          <p>æœ€å¾Œæ›´æ–°ï¼š2025å¹´7æœˆ</p>
          <p>æœ¬ç³»çµ±å°ˆç‚ºå°ç£å¸•é‡‘æ£®ç—…å‹æ¬Šç›Šä¿ƒé€²æœƒé–‹ç™¼ï¼Œç”¨æ–¼ç®¡ç†æœƒè¨ˆã€æ”¶æ“šã€æ†‘è­‰å’Œæœƒå“¡è³‡æ–™ã€‚</p>
          <h5>ç³»çµ±åŠŸèƒ½ï¼š</h5>
          <ul>
            <li>äº¤æ˜“è¨˜éŒ„ç®¡ç†</li>
            <li>æ”¶æ“šé–‹ç«‹èˆ‡ç®¡ç†</li>
            <li>æ”¯å‡ºæ†‘è­‰ç”³è«‹èˆ‡å¯©æ ¸</li>
            <li>æœƒå“¡è³‡æ–™ç®¡ç†</li>
            <li>è²¡å‹™å ±è¡¨ç”¢ç”Ÿ</li>
            <li>ç³»çµ±è¨­å®šèˆ‡ç¶­è­·</li>
          </ul>
          <p>å¦‚æœ‰ä»»ä½•å•é¡Œæˆ–å»ºè­°ï¼Œè«‹è¯çµ¡ç³»çµ±ç®¡ç†å“¡ã€‚</p>
        </div>
      `;
    }

    function getHelpContent() {
      return `
        <div>
          <h4>ä½¿ç”¨èªªæ˜</h4>
          <h5>1. äº¤æ˜“è¨˜éŒ„ç®¡ç†</h5>
          <p>åœ¨ã€Œäº¤æ˜“è¨˜éŒ„ã€é é¢ï¼Œæ‚¨å¯ä»¥æ–°å¢ã€ç·¨è¼¯å’ŒæŸ¥çœ‹æ‰€æœ‰æ”¶æ”¯äº¤æ˜“ã€‚å¡«å¯«å¿…è¦æ¬„ä½å¾Œé»æ“Šã€Œå„²å­˜äº¤æ˜“è¨˜éŒ„ã€æŒ‰éˆ•å³å¯æ–°å¢äº¤æ˜“ã€‚</p>
          
          <h5>2. æ”¶æ“šç®¡ç†</h5>
          <p>åœ¨ã€Œæ”¶æ“šç®¡ç†ã€é é¢ï¼Œæ‚¨å¯ä»¥é–‹ç«‹ææ¬¾æˆ–æœƒè²»æ”¶æ“šã€‚ç³»çµ±æœƒè‡ªå‹•ç”¢ç”Ÿæ”¶æ“šç·¨è™Ÿï¼Œä¸¦å¯é¸æ“‡è‡ªå‹•å¯„é€é›»å­æ”¶æ“šçµ¦ææ¬¾äººã€‚</p>
          
          <h5>3. æ”¯å‡ºæ†‘è­‰</h5>
          <p>åœ¨ã€Œæ”¯å‡ºæ†‘è­‰ã€é é¢ï¼Œæ‚¨å¯ä»¥ç”³è«‹æ”¯å‡ºæ†‘è­‰ï¼Œä¸¦ç”±ç®¡ç†å“¡é€²è¡Œå¯©æ ¸ã€‚æ ¸å‡†å¾Œçš„æ†‘è­‰å¯ç”¨æ–¼å ±éŠ·æˆ–è¨˜å¸³ã€‚</p>
          
          <h5>4. æœƒå“¡ç®¡ç†</h5>
          <p>åœ¨ã€Œæœƒå“¡ç®¡ç†ã€é é¢ï¼Œæ‚¨å¯ä»¥æ–°å¢ã€ç·¨è¼¯å’ŒæŸ¥çœ‹æœƒå“¡è³‡æ–™ï¼ŒåŒ…æ‹¬è¯çµ¡è³‡è¨Šå’Œæœƒç±ç‹€æ…‹ã€‚</p>
          
          <h5>5. å ±è¡¨åˆ†æ</h5>
          <p>åœ¨ã€Œå ±è¡¨åˆ†æã€é é¢ï¼Œæ‚¨å¯ä»¥ç”¢ç”Ÿå„ç¨®è²¡å‹™å’Œçµ±è¨ˆå ±è¡¨ï¼ŒåŒ…æ‹¬æœˆåº¦è²¡å‹™å ±è¡¨ã€å¹´åº¦è²¡å‹™å ±è¡¨ã€é¡åˆ¥çµ±è¨ˆå ±è¡¨ç­‰ã€‚</p>
          
          <h5>6. ç³»çµ±è¨­å®š</h5>
          <p>åœ¨ã€Œç³»çµ±è¨­å®šã€é é¢ï¼Œæ‚¨å¯ä»¥ç®¡ç†çµ„ç¹”è³‡è¨Šå’ŒåŸ·è¡Œç³»çµ±ç¶­è­·ä»»å‹™ï¼Œå¦‚å»ºç«‹å‚™ä»½å’Œç³»çµ±æª¢æŸ¥ã€‚</p>
          
          <h5>å¿«æ·éµ</h5>
          <ul>
            <li>ESCï¼šé—œé–‰æ¨¡æ…‹æ¡†</li>
          </ul>
        </div>
      `;
    }

    function getContactContent() {
      return `
        <div>
          <h4>è¯çµ¡æˆ‘å€‘</h4>
          <p>å¦‚æœ‰ä»»ä½•ç³»çµ±å•é¡Œæˆ–å»ºè­°ï¼Œè«‹è¯çµ¡ï¼š</p>
          <p>ç³»çµ±ç®¡ç†å“¡ï¼š<a href="mailto:admin@pdtaiwan.org">admin@pdtaiwan.org</a></p>
          <p>æŠ€è¡“æ”¯æ´ï¼š<a href="mailto:support@pdtaiwan.org">support@pdtaiwan.org</a></p>
          <p>é›»è©±ï¼š(02) 1234-5678</p>
          <p>è¾¦å…¬æ™‚é–“ï¼šé€±ä¸€è‡³é€±äº” 9:00-17:00</p>
        </div>
      `;
    }
  </script>
</body>
</html>



              
