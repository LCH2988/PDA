<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é›»å­å°ç« ç”Ÿæˆç³»çµ±</title>
  <style>
      * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
      }

      body {
          font-family: 'Segoe UI', 'Microsoft JhengHei', sans-serif;
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          min-height: 100vh;
          padding: 20px;
      }

      .container {
          max-width: 1200px;
          margin: 0 auto;
          background: white;
          border-radius: 20px;
          box-shadow: 0 20px 40px rgba(0,0,0,0.1);
          overflow: hidden;
      }

      .header {
          background: linear-gradient(45deg, #C00000, #B50000);
          color: white;
          padding: 30px;
          text-align: center;
      }

      .header h1 {
          font-size: 2.5em;
          margin-bottom: 10px;
          text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
      }

      .header p {
          font-size: 1.1em;
          opacity: 0.9;
      }

      .main-content {
          padding: 40px;
      }

      .tab-container {
          margin-bottom: 30px;
      }

      .tab-buttons {
          display: flex;
          border-bottom: 3px solid #f0f0f0;
          margin-bottom: 30px;
      }

      .tab-button {
          flex: 1;
          padding: 15px 20px;
          background: none;
          border: none;
          font-size: 1.1em;
          font-weight: 600;
          cursor: pointer;
          transition: all 0.3s ease;
          position: relative;
      }

      .tab-button.active {
          color: #C00000;
      }

      .tab-button.active::after {
          content: '';
          position: absolute;
          bottom: -3px;
          left: 0;
          right: 0;
          height: 3px;
          background: #C00000;
      }

      .tab-button:hover {
          background: #f8f9fa;
      }

      .tab-content {
          display: none;
      }

      .tab-content.active {
          display: block;
      }

      .form-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
          gap: 30px;
          margin-bottom: 30px;
      }

      .form-section {
          background: #f8f9fa;
          padding: 25px;
          border-radius: 15px;
          border-left: 5px solid #C00000;
      }

      .form-section h3 {
          color: #333;
          margin-bottom: 20px;
          font-size: 1.3em;
      }

      .form-group {
          margin-bottom: 20px;
      }

      .form-group label {
          display: block;
          margin-bottom: 8px;
          font-weight: 600;
          color: #555;
      }

      .form-group input,
      .form-group select {
          width: 100%;
          padding: 12px 15px;
          border: 2px solid #e0e0e0;
          border-radius: 8px;
          font-size: 1em;
          transition: border-color 0.3s ease;
      }

      .form-group input:focus,
      .form-group select:focus {
          outline: none;
          border-color: #C00000;
          box-shadow: 0 0 0 3px rgba(192, 0, 0, 0.1);
      }

      .btn {
          padding: 12px 30px;
          border: none;
          border-radius: 8px;
          font-size: 1em;
          font-weight: 600;
          cursor: pointer;
          transition: all 0.3s ease;
          margin-right: 10px;
          margin-bottom: 10px;
      }

      .btn-primary {
          background: linear-gradient(45deg, #C00000, #B50000);
          color: white;
      }

      .btn-primary:hover {
          transform: translateY(-2px);
          box-shadow: 0 5px 15px rgba(192, 0, 0, 0.3);
      }

      .btn-secondary {
          background: #6c757d;
          color: white;
      }

      .btn-secondary:hover {
          background: #5a6268;
      }

      .btn-success {
          background: #28a745;
          color: white;
      }

      .btn-info {
          background: #17a2b8;
          color: white;
      }

      .result-area {
          margin-top: 30px;
          padding: 20px;
          background: #f8f9fa;
          border-radius: 10px;
          border-left: 5px solid #28a745;
          display: none;
      }

      .result-area.show {
          display: block;
      }

      .result-area h4 {
          color: #155724;
          margin-bottom: 15px;
      }

      .result-item {
          margin-bottom: 10px;
          padding: 10px;
          background: white;
          border-radius: 5px;
          border: 1px solid #d4edda;
      }

      .preview-area {
          text-align: center;
          padding: 30px;
          background: #f8f9fa;
          border-radius: 15px;
          margin-top: 20px;
      }

      .seal-preview {
          max-width: 300px;
          margin: 0 auto;
          border: 3px solid #C00000;
          border-radius: 50%;
          padding: 20px;
          background: white;
      }

      .loading {
          display: none;
          text-align: center;
          padding: 20px;
      }

      .loading.show {
          display: block;
      }

      .spinner {
          border: 4px solid #f3f3f3;
          border-top: 4px solid #C00000;
          border-radius: 50%;
          width: 50px;
          height: 50px;
          animation: spin 1s linear infinite;
          margin: 0 auto 15px;
      }

      @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
      }

      .error-message {
          background: #f8d7da;
          color: #721c24;
          padding: 15px;
          border-radius: 8px;
          border-left: 5px solid #dc3545;
          margin-top: 15px;
          display: none;
      }

      .success-message {
          background: #d4edda;
          color: #155724;
          padding: 15px;
          border-radius: 8px;
          border-left: 5px solid #28a745;
          margin-top: 15px;
          display: none;
      }

      .batch-section {
          margin-top: 30px;
      }

      .employee-row {
          display: grid;
          grid-template-columns: 1fr 1fr 1fr 1fr auto;
          gap: 15px;
          align-items: end;
          margin-bottom: 15px;
          padding: 15px;
          background: white;
          border-radius: 8px;
          border: 2px solid #e0e0e0;
      }

      .verify-section {
          background: #e3f2fd;
          padding: 25px;
          border-radius: 15px;
          border-left: 5px solid #2196f3;
      }

      .status-indicator {
          display: inline-block;
          width: 12px;
          height: 12px;
          border-radius: 50%;
          margin-right: 8px;
      }

      .status-success { background: #28a745; }
      .status-error { background: #dc3545; }
      .status-warning { background: #ffc107; }

      @media (max-width: 768px) {
          .form-grid {
              grid-template-columns: 1fr;
          }
          
          .employee-row {
              grid-template-columns: 1fr;
          }
          
          .tab-buttons {
              flex-direction: column;
          }
      }
  </style>
</head>
<body>
  <div class="container">
      <div class="header">
          <h1>ğŸ”´ é›»å­å°ç« ç”Ÿæˆç³»çµ±</h1>
          <p>å°ç£å¸•é‡‘æ£®ç—…å‹æ¬Šç›Šä¿ƒé€²æœƒ - æ•¸ä½å°ç« ç®¡ç†å¹³å°</p>
      </div>

      <div class="main-content">
          <div class="tab-container">
              <div class="tab-buttons">
                  <button class="tab-button active" onclick="switchTab('personal')">å€‹äººå°ç« </button>
                  <button class="tab-button" onclick="switchTab('association')">å”æœƒå¤§ç« </button>
                  <button class="tab-button" onclick="switchTab('batch')">æ‰¹é‡å»ºç«‹</button>
                  <button class="tab-button" onclick="switchTab('verify')">å°ç« é©—è­‰</button>
                  <button class="tab-button" onclick="switchTab('manage')">å°ç« ç®¡ç†</button>
              </div>

              <!-- å€‹äººå°ç« é é¢ -->
              <div id="personal" class="tab-content active">
                  <div class="form-grid">
                      <div class="form-section">
                          <h3>ğŸ“ å€‹äººè³‡è¨Š</h3>
                          <div class="form-group">
                              <label for="personal-name">å§“å *</label>
                              <input type="text" id="personal-name" placeholder="è«‹è¼¸å…¥å§“å" required>
                          </div>
                          <div class="form-group">
                              <label for="personal-title">è·ç¨± *</label>
                              <select id="personal-title" required>
                                  <option value="">è«‹é¸æ“‡è·ç¨±</option>
                                  <option value="ç†äº‹é•·">ç†äº‹é•·</option>
                                  <option value="å‰¯ç†äº‹é•·">å‰¯ç†äº‹é•·</option>
                                  <option value="ç§˜æ›¸é•·">ç§˜æ›¸é•·</option>
                                  <option value="ç†äº‹">ç†äº‹</option>
                                  <option value="ç›£äº‹">ç›£äº‹</option>
                                  <option value="ç¶“ç†">ç¶“ç†</option>
                                  <option value="ä¸»ä»»">ä¸»ä»»</option>
                                  <option value="çµ„é•·">çµ„é•·</option>
                                  <option value="å°ˆå“¡">å°ˆå“¡</option>
                                  <option value="å…¶ä»–">å…¶ä»–</option>
                              </select>
                          </div>
                          <div class="form-group">
                              <label for="personal-department">éƒ¨é–€</label>
                              <input type="text" id="personal-department" placeholder="å°ç£å¸•é‡‘æ£®ç—…å‹æ¬Šç›Šä¿ƒé€²æœƒ" value="å°ç£å¸•é‡‘æ£®ç—…å‹æ¬Šç›Šä¿ƒé€²æœƒ">
                          </div>
                          <div class="form-group">
                              <label for="personal-id">å“¡å·¥ç·¨è™Ÿ</label>
                              <input type="text" id="personal-id" placeholder="ä¾‹ï¼šEMP001">
                          </div>
                      </div>

                      <div class="form-section">
                          <h3>âš™ï¸ å°ç« è¨­å®š</h3>
                          <div class="form-group">
                              <label for="personal-color">å°ç« é¡è‰²</label>
                              <select id="personal-color">
                                  <option value="#C00000">å‚³çµ±ç´…è‰²</option>
                                  <option value="#B50000">æ·±ç´…è‰²</option>
                                  <option value="#003366">è—è‰²</option>
                              </select>
                          </div>
                          <div class="form-group">
                              <label>
                                  <input type="checkbox" id="personal-qr" checked> åŒ…å« QR ç¢¼é©—è­‰
                              </label>
                          </div>
                          <div class="form-group">
                              <label>
                                  <input type="checkbox" id="personal-watermark" checked> é˜²å½æµ®æ°´å°
                              </label>
                          </div>
                          <button class="btn btn-primary" onclick="generatePersonalSeal()">ğŸ¯ ç”Ÿæˆå€‹äººå°ç« </button>
                          <button class="btn btn-secondary" onclick="previewPersonalSeal()">ğŸ‘ï¸ é è¦½</button>
                      </div>
                  </div>

                  <div class="preview-area" id="personal-preview" style="display: none;">
                      <h4>å°ç« é è¦½</h4>
                      <div class="seal-preview" id="personal-seal-display"></div>
                  </div>

                  <div class="loading" id="personal-loading">
                      <div class="spinner"></div>
                      <p>æ­£åœ¨ç”Ÿæˆå°ç« ...</p>
                  </div>

                  <div class="result-area" id="personal-result">
                      <h4>âœ… å°ç« ç”ŸæˆæˆåŠŸ</h4>
                      <div id="personal-result-content"></div>
                  </div>

                  <div class="error-message" id="personal-error"></div>
                  <div class="success-message" id="personal-success"></div>
              </div>

              <!-- å”æœƒå¤§ç« é é¢ -->
              <div id="association" class="tab-content">
                  <div class="form-grid">
                      <div class="form-section">
                          <h3>ğŸ¢ çµ„ç¹”è³‡è¨Š</h3>
                          <div class="form-group">
                              <label for="org-name">çµ„ç¹”åç¨± *</label>
                              <input type="text" id="org-name" placeholder="å°ç£å¸•é‡‘æ£®ç—…å‹æ¬Šç›Šä¿ƒé€²æœƒ" value="å°ç£å¸•é‡‘æ£®ç—…å‹æ¬Šç›Šä¿ƒé€²æœƒ" required>
                          </div>
                          <div class="form-group">
                              <label for="org-taxid">çµ±ä¸€ç·¨è™Ÿ *</label>
                              <input type="text" id="org-taxid" placeholder="85202581" value="85202581" required>
                          </div>
                          <div class="form-group">
                              <label for="org-type">å°ç« é¡å‹</label>
                              <select id="org-type">
                                  <option value="å”æœƒå¤§ç« ">å”æœƒå¤§ç« </option>
                                  <option value="ç†äº‹æœƒç« ">ç†äº‹æœƒç« </option>
                                  <option value="è²¡å‹™å°ˆç”¨ç« ">è²¡å‹™å°ˆç”¨ç« </option>
                                  <option value="æ¥­å‹™å°ˆç”¨ç« ">æ¥­å‹™å°ˆç”¨ç« </option>
                              </select>
                          </div>
                          <div class="form-group">
                              <label for="org-authorizer">æˆæ¬Šäºº</label>
                              <input type="text" id="org-authorizer" placeholder="ç†äº‹é•·" value="ç†äº‹é•·">
                          </div>
                      </div>

                      <div class="form-section">
                          <h3>ğŸ¨ è¨­è¨ˆé¸é …</h3>
                          <div class="form-group">
                              <label for="org-color">å°ç« é¡è‰²</label>
                              <select id="org-color">
                                  <option value="#C00000">å‚³çµ±ç´…è‰²</option>
                                  <option value="#B50000">æ·±ç´…è‰²</option>
                                  <option value="#003366">è—è‰²</option>
                              </select>
                          </div>
                          <div class="form-group">
                              <label>
                                  <input type="checkbox" id="org-guilloche" checked> Guilloche é˜²å½è£é£¾
                              </label>
                          </div>
                          <div class="form-group">
                              <label>
                                  <input type="checkbox" id="org-timestamp" checked> æ™‚é–“æˆ³è¨˜
                              </label>
                          </div>
                          <button class="btn btn-primary" onclick="generateAssociationSeal()">ğŸ›ï¸ ç”Ÿæˆå”æœƒå¤§ç« </button>
                          <button class="btn btn-secondary" onclick="previewAssociationSeal()">ğŸ‘ï¸ é è¦½</button>
                      </div>
                  </div>

                  <div class="preview-area" id="association-preview" style="display: none;">
                      <h4>å°ç« é è¦½</h4>
                      <div class="seal-preview" id="association-seal-display"></div>
                  </div>

                  <div class="loading" id="association-loading">
                      <div class="spinner"></div>
                      <p>æ­£åœ¨ç”Ÿæˆå°ç« ...</p>
                  </div>

                  <div class="result-area" id="association-result">
                      <h4>âœ… å°ç« ç”ŸæˆæˆåŠŸ</h4>
                      <div id="association-result-content"></div>
                  </div>

                  <div class="error-message" id="association-error"></div>
                  <div class="success-message" id="association-success"></div>
              </div>

              <!-- æ‰¹é‡å»ºç«‹é é¢ -->
              <div id="batch" class="tab-content">
                  <div class="form-section">
                      <h3>ğŸ“‹ æ‰¹é‡å»ºç«‹å°ç« </h3>
                      <p style="margin-bottom: 20px; color: #666;">ä¸€æ¬¡å»ºç«‹å¤šå€‹å“¡å·¥çš„å€‹äººå°ç« </p>
                      
                      <div class="batch-section">
                          <div class="form-group">
                              <button class="btn btn-info" onclick="addEmployeeRow()">â• æ–°å¢å“¡å·¥</button>
                              <button class="btn btn-secondary" onclick="importFromCSV()">ğŸ“ å¾ CSV åŒ¯å…¥</button>
                              <button class="btn btn-success" onclick="generateBatchSeals()">ğŸš€ æ‰¹é‡ç”Ÿæˆ</button>
                          </div>

                          <div id="employee-list">
                              <div class="employee-row">
                                  <div class="form-group">
                                      <label>å§“å</label>
                                      <input type="text" placeholder="ç‹å°æ˜" class="employee-name">
                                  </div>
                                  <div class="form-group">
                                      <label>è·ç¨±</label>
                                      <select class="employee-title">
                                          <option value="ç†äº‹é•·">ç†äº‹é•·</option>
                                          <option value="å‰¯ç†äº‹é•·">å‰¯ç†äº‹é•·</option>
                                          <option value="ç§˜æ›¸é•·">ç§˜æ›¸é•·</option>
                                          <option value="ç†äº‹">ç†äº‹</option>
                                          <option value="ç›£äº‹">ç›£äº‹</option>
                                          <option value="ç¶“ç†">ç¶“ç†</option>
                                          <option value="ä¸»ä»»">ä¸»ä»»</option>
                                          <option value="çµ„é•·">çµ„é•·</option>
                                          <option value="å°ˆå“¡">å°ˆå“¡</option>
                                      </select>
                                  </div>
                                  <div class="form-group">
                                      <label>éƒ¨é–€</label>
                                      <input type="text" placeholder="å°ç£å¸•é‡‘æ£®ç—…å‹æ¬Šç›Šä¿ƒé€²æœƒ" class="employee-department" value="å°ç£å¸•é‡‘æ£®ç—…å‹æ¬Šç›Šä¿ƒé€²æœƒ">
                                  </div>
                                  <div class="form-group">
                                      <label>å“¡å·¥ç·¨è™Ÿ</label>
                                      <input type="text" placeholder="EMP001" class="employee-id">
                                  </div>
                                  <div class="form-group">
                                      <button class="btn btn-secondary" onclick="removeEmployeeRow(this)">âŒ</button>
                                  </div>
                              </div>
                          </div>
                      </div>

                      <div class="loading" id="batch-loading">
                          <div class="spinner"></div>
                          <p>æ­£åœ¨æ‰¹é‡ç”Ÿæˆå°ç« ...</p>
                      </div>

                      <div class="result-area" id="batch-result">
                          <h4>âœ… æ‰¹é‡ç”Ÿæˆå®Œæˆ</h4>
                          <div id="batch-result-content"></div>
                      </div>

                      <div class="error-message" id="batch-error"></div>
                      <div class="success-message" id="batch-success"></div>
                  </div>
              </div>

              <!-- å°ç« é©—è­‰é é¢ -->
              <div id="verify" class="tab-content">
                  <div class="verify-section">
                      <h3>ğŸ” å°ç« çœŸå½é©—è­‰</h3>
                      <p style="margin-bottom: 20px; color: #666;">è¼¸å…¥å°ç«  Hash æˆ– ID ä¾†é©—è­‰å°ç« çš„çœŸå¯¦æ€§</p>

                      <div class="form-grid">
                          <div class="form-group">
                              <label for="verify-hash">å°ç«  Hash</label>
                              <input type="text" id="verify-hash" placeholder="è«‹è¼¸å…¥å°ç«  Hash å€¼">
                          </div>
                          <div class="form-group">
                              <label for="verify-id">å°ç«  ID</label>
                              <input type="text" id="verify-id" placeholder="è«‹è¼¸å…¥å°ç«  ID">
                          </div>
                      </div>

                      <button class="btn btn-primary" onclick="verifySeal()">ğŸ” é©—è­‰å°ç« </button>
                      <button class="btn btn-info" onclick="scanQRCode()">ğŸ“± æƒæ QR ç¢¼</button>

                      <div class="loading" id="verify-loading">
                          <div class="spinner"></div>
                          <p>æ­£åœ¨é©—è­‰å°ç« ...</p>
                      </div>

                      <div class="result-area" id="verify-result">
                          <h4 id="verify-result-title">é©—è­‰çµæœ</h4>
                          <div id="verify-result-content"></div>
                      </div>

                      <div class="error-message" id="verify-error"></div>
                      <div class="success-message" id="verify-success"></div>
                  </div>
              </div>

              <!-- å°ç« ç®¡ç†é é¢ -->
              <div id="manage" class="tab-content">
                  <div class="form-section">
                      <h3>ğŸ“Š å°ç« ç®¡ç†</h3>
                      
                      <div class="form-group">
                          <button class="btn btn-info" onclick="loadSealList()">ğŸ“‹ è¼‰å…¥å°ç« æ¸…å–®</button>
                          <button class="btn btn-secondary" onclick="exportSealData()">ğŸ’¾ åŒ¯å‡ºè³‡æ–™</button>
                          <button class="btn btn-success" onclick="viewUsageLog()">ğŸ“ˆ ä½¿ç”¨è¨˜éŒ„</button>
                      </div>

                      <div class="result-area" id="manage-result">
                          <h4>å°ç« æ¸…å–®</h4>
                          <div id="manage-result-content">
                              <p>é»æ“Šã€Œè¼‰å…¥å°ç« æ¸…å–®ã€ä¾†æŸ¥çœ‹æ‰€æœ‰å°ç« </p>
                          </div>
                      </div>

                      <div class="loading" id="manage-loading">
                          <div class="spinner"></div>
                          <p>æ­£åœ¨è¼‰å…¥è³‡æ–™...</p>
                      </div>

                      <div class="error-message" id="manage-error"></div>
                      <div class="success-message" id="manage-success"></div>
                  </div>
              </div>
          </div>
      </div>
  </div>

  <script>
      // å…¨åŸŸè®Šæ•¸
      let currentTab = 'personal';

      // é ç±¤åˆ‡æ›
      function switchTab(tabName) {
          document.querySelectorAll('.tab-content').forEach(content => {
              content.classList.remove('active');
          });
          
          document.querySelectorAll('.tab-button').forEach(button => {
              button.classList.remove('active');
          });
          
          document.getElementById(tabName).classList.add('active');
          event.target.classList.add('active');
          
          currentTab = tabName;
      }

      // é¡¯ç¤ºè¼‰å…¥å‹•ç•«
      function showLoading(type) {
          document.getElementById(`${type}-loading`).classList.add('show');
          hideMessages(type);
      }

      // éš±è—è¼‰å…¥å‹•ç•«
      function hideLoading(type) {
          document.getElementById(`${type}-loading`).classList.remove('show');
      }

      // é¡¯ç¤ºçµæœ
      function showResult(type, content) {
          const resultArea = document.getElementById(`${type}-result`);
          const resultContent = document.getElementById(`${type}-result-content`);
          resultContent.innerHTML = content;
          resultArea.classList.add('show');
      }

      // é¡¯ç¤ºéŒ¯èª¤è¨Šæ¯
      function showError(type, message) {
          const errorElement = document.getElementById(`${type}-error`);
          errorElement.textContent = message;
          errorElement.style.display = 'block';
      }

      // é¡¯ç¤ºæˆåŠŸè¨Šæ¯
      function showSuccess(type, message) {
          const successElement = document.getElementById(`${type}-success`);
          successElement.textContent = message;
          successElement.style.display = 'block';
      }

      // éš±è—æ‰€æœ‰è¨Šæ¯
      function hideMessages(type) {
          document.getElementById(`${type}-error`).style.display = 'none';
          document.getElementById(`${type}-success`).style.display = 'none';
          document.getElementById(`${type}-result`).classList.remove('show');
      }

      // ç”Ÿæˆå€‹äººå°ç« 
      async function generatePersonalSeal() {
          const name = document.getElementById('personal-name').value;
          const title = document.getElementById('personal-title').value;
          const department = document.getElementById('personal-department').value;
          const employeeId = document.getElementById('personal-id').value;

          if (!name || !title) {
              showError('personal', 'è«‹å¡«å¯«å¿…è¦æ¬„ä½ï¼šå§“åå’Œè·ç¨±');
              return;
          }

          showLoading('personal');

          try {
              // æ¨¡æ“¬ Google Apps Script å‘¼å«
              const response = await fetch('https://script.google.com/macros/s/AKfycbw-3K2hr2Qc88XSejYG1txWUPXIOsHtpHmJID44iO2cgYhe26eEErOPhO6BKuZvSgYR/exec', {
                  method: 'POST',
                  headers: {
                      'Content-Type': 'application/json',
                  },
                  body: JSON.stringify({
                      action: 'createPersonal',
                      name: name,
                      title: title,
                      department: department,
                      employeeId: employeeId
                  })
              });

              const result = await response.json();
              hideLoading('personal');

              if (result.success) {
                  const resultHTML = `
                      <div class="result-item">
                          <strong>å°ç«  IDï¼š</strong>${result.sealId}
                      </div>
                      <div class="result-item">
                          <strong>Hash å€¼ï¼š</strong>${result.hash}
                      </div>
                      <div class="result-item">
                          <strong>SVG æª”æ¡ˆ IDï¼š</strong>${result.files.svgFileId}
                      </div>
                      <div class="result-item">
                          <strong>Metadata æª”æ¡ˆ IDï¼š</strong>${result.files.metadataFileId}
                      </div>
                      <div class="result-item">
                          <button class="btn btn-info" onclick="downloadSeal('${result.files.svgFileId}')">ä¸‹è¼‰ SVG</button>
                          <button class="btn btn-secondary" onclick="downloadMetadata('${result.files.metadataFileId}')">ä¸‹è¼‰ Metadata</button>
                      </div>
                  `;
                  
                  showResult('personal', resultHTML);
                  showSuccess('personal', `${name} çš„å€‹äººå°ç« å·²æˆåŠŸç”Ÿæˆï¼`);
              } else {
                  showError('personal', result.error || 'ç”Ÿæˆå°ç« å¤±æ•—');
              }
              
          } catch (error) {
              hideLoading('personal');
              showError('personal', 'é€£æ¥æœå‹™å™¨å¤±æ•—ï¼š' + error.message);
          }
      }

      // é è¦½å€‹äººå°ç« 
      function previewPersonalSeal() {
          const name = document.getElementById('personal-name').value || 'é è¦½å§“å';
          const title = document.getElementById('personal-title').value || 'é è¦½è·ç¨±';
          
          const previewHTML = `
              <div style="width: 200px; height: 200px; border: 3px solid #C00000; border-radius: 50%; 
                         display: flex; flex-direction: column; justify-content: center; align-items: center;
                         background: white; margin: 0 auto; position: relative;">
                  <div style="font-size: 12px; color: #C00000; position: absolute; top: 20px;">å°ç£å¸•é‡‘æ£®ç—…å‹æ¬Šç›Šä¿ƒé€²æœƒ</div>
                  <div style="font-size: 24px; font-weight: bold; color: #C00000; margin: 10px 0;">${name}</div>
                  <div style="font-size: 12px; color: #C00000; position: absolute; bottom: 30px;">${title} å°ˆ ç”¨ ç« </div>
                  <div style="position: absolute; bottom: 10px; font-size: 8px; color: #C00000;">EMP001</div>
              </div>
          `;
          
          document.getElementById('personal-seal-display').innerHTML = previewHTML;
          document.getElementById('personal-preview').style.display = 'block';
      }

        // ç”Ÿæˆå”æœƒå¤§ç« 
        async function generateAssociationSeal() {
            const orgName = document.getElementById('org-name').value;
            const taxId = document.getElementById('org-taxid').value;
            const sealType = document.getElementById('org-type').value;
            const authorizer = document.getElementById('org-authorizer').value;

            if (!orgName || !taxId) {
                showError('association', 'è«‹å¡«å¯«å¿…è¦æ¬„ä½ï¼šçµ„ç¹”åç¨±å’Œçµ±ä¸€ç·¨è™Ÿ');
                return;
            }

            showLoading('association');

            try {
                const response = await fetch('https://script.google.com/macros/s/AKfycbw-3K2hr2Qc88XSejYG1txWUPXIOsHtpHmJID44iO2cgYhe26eEErOPhO6BKuZvSgYR/exec', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        action: 'createAssociation',
                        orgName: orgName,
                        taxId: taxId,
                        sealType: sealType,
                        authorizer: authorizer
                    })
                });

                const result = await response.json();
                hideLoading('association');

                if (result.success) {
                    const resultHTML = `
                        <div class="result-item">
                            <strong>å°ç«  IDï¼š</strong>${result.sealId}
                        </div>
                        <div class="result-item">
                            <strong>Hash å€¼ï¼š</strong>${result.hash}
                        </div>
                        <div class="result-item">
                            <strong>SVG æª”æ¡ˆ IDï¼š</strong>${result.files.svgFileId}
                        </div>
                        <div class="result-item">
                            <button class="btn btn-info" onclick="downloadSeal('${result.files.svgFileId}')">ä¸‹è¼‰ SVG</button>
                            <button class="btn btn-secondary" onclick="downloadMetadata('${result.files.metadataFileId}')">ä¸‹è¼‰ Metadata</button>
                        </div>
                    `;
                    
                    showResult('association', resultHTML);
                    showSuccess('association', `${orgName} çš„å”æœƒå¤§ç« å·²æˆåŠŸç”Ÿæˆï¼`);
                } else {
                    showError('association', result.error || 'ç”Ÿæˆå°ç« å¤±æ•—');
                }
                
            } catch (error) {
                hideLoading('association');
                showError('association', 'é€£æ¥æœå‹™å™¨å¤±æ•—ï¼š' + error.message);
            }
        }

        // é è¦½å”æœƒå¤§ç« 
        function previewAssociationSeal() {
            const orgName = document.getElementById('org-name').value || 'é è¦½çµ„ç¹”';
            const taxId = document.getElementById('org-taxid').value || '12345678';
            const sealType = document.getElementById('org-type').value || 'å”æœƒå¤§ç« ';
            
            const previewHTML = `
                <div style="width: 250px; height: 250px; border: 4px solid #C00000; border-radius: 50%; 
                           display: flex; flex-direction: column; justify-content: center; align-items: center;
                           background: white; margin: 0 auto; position: relative;">
                    <div style="font-size: 14px; color: #C00000; position: absolute; top: 25px; text-align: center; width: 200px;">${orgName}</div>
                    <div style="font-size: 16px; color: #C00000; margin-bottom: 5px;">çµ±ä¸€ç·¨è™Ÿ</div>
                    <div style="font-size: 20px; font-weight: bold; color: #C00000; margin-bottom: 10px;">${taxId}</div>
                    <div style="font-size: 12px; color: #C00000; position: absolute; bottom: 25px;">${sealType}</div>
                </div>
            `;
            
            document.getElementById('association-seal-display').innerHTML = previewHTML;
            document.getElementById('association-preview').style.display = 'block';
        }

        // æ–°å¢å“¡å·¥è¡Œ
        function addEmployeeRow() {
            const employeeList = document.getElementById('employee-list');
            const newRow = document.createElement('div');
            newRow.className = 'employee-row';
            newRow.innerHTML = `
                <div class="form-group">
                    <label>å§“å</label>
                    <input type="text" placeholder="è«‹è¼¸å…¥å§“å" class="employee-name">
                </div>
                <div class="form-group">
                    <label>è·ç¨±</label>
                    <select class="employee-title">
                        <option value="ç†äº‹é•·">ç†äº‹é•·</option>
                        <option value="å‰¯ç†äº‹é•·">å‰¯ç†äº‹é•·</option>
                        <option value="ç§˜æ›¸é•·">ç§˜æ›¸é•·</option>
                        <option value="ç†äº‹">ç†äº‹</option>
                        <option value="ç›£äº‹">ç›£äº‹</option>
                        <option value="ç¶“ç†">ç¶“ç†</option>
                        <option value="ä¸»ä»»">ä¸»ä»»</option>
                        <option value="çµ„é•·">çµ„é•·</option>
                        <option value="å°ˆå“¡">å°ˆå“¡</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>éƒ¨é–€</label>
                    <input type="text" placeholder="å°ç£å¸•é‡‘æ£®ç—…å‹æ¬Šç›Šä¿ƒé€²æœƒ" class="employee-department" value="å°ç£å¸•é‡‘æ£®ç—…å‹æ¬Šç›Šä¿ƒé€²æœƒ">
                </div>
                <div class="form-group">
                    <label>å“¡å·¥ç·¨è™Ÿ</label>
                    <input type="text" placeholder="EMP002" class="employee-id">
                </div>
                <div class="form-group">
                    <button class="btn btn-secondary" onclick="removeEmployeeRow(this)">âŒ</button>
                </div>
            `;
            employeeList.appendChild(newRow);
        }

        // ç§»é™¤å“¡å·¥è¡Œ
        function removeEmployeeRow(button) {
            button.closest('.employee-row').remove();
        }

        // å¾ CSV åŒ¯å…¥
        function importFromCSV() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.csv';
            input.onchange = function(event) {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const csv = e.target.result;
                        const lines = csv.split('\n');
                        const employeeList = document.getElementById('employee-list');
                        
                        // æ¸…ç©ºç¾æœ‰åˆ—è¡¨
                        employeeList.innerHTML = '';
                        
                        // è§£æ CSV (å‡è¨­æ ¼å¼ï¼šå§“å,è·ç¨±,éƒ¨é–€,å“¡å·¥ç·¨è™Ÿ)
                        for (let i = 1; i < lines.length; i++) { // è·³éæ¨™é¡Œè¡Œ
                            const data = lines[i].split(',');
                            if (data.length >= 4 && data[0].trim()) {
                                const newRow = document.createElement('div');
                                newRow.className = 'employee-row';
                                newRow.innerHTML = `
                                    <div class="form-group">
                                        <label>å§“å</label>
                                        <input type="text" value="${data[0].trim()}" class="employee-name">
                                    </div>
                                    <div class="form-group">
                                        <label>è·ç¨±</label>
                                        <select class="employee-title">
                                            <option value="ç†äº‹é•·" ${data[1].trim() === 'ç†äº‹é•·' ? 'selected' : ''}>ç†äº‹é•·</option>
                                            <option value="å‰¯ç†äº‹é•·" ${data[1].trim() === 'å‰¯ç†äº‹é•·' ? 'selected' : ''}>å‰¯ç†äº‹é•·</option>
                                            <option value="ç§˜æ›¸é•·" ${data[1].trim() === 'ç§˜æ›¸é•·' ? 'selected' : ''}>ç§˜æ›¸é•·</option>
                                            <option value="ç†äº‹" ${data[1].trim() === 'ç†äº‹' ? 'selected' : ''}>ç†äº‹</option>
                                            <option value="ç›£äº‹" ${data[1].trim() === 'ç›£äº‹' ? 'selected' : ''}>ç›£äº‹</option>
                                            <option value="ç¶“ç†" ${data[1].trim() === 'ç¶“ç†' ? 'selected' : ''}>ç¶“ç†</option>
                                            <option value="ä¸»ä»»" ${data[1].trim() === 'ä¸»ä»»' ? 'selected' : ''}>ä¸»ä»»</option>
                                            <option value="çµ„é•·" ${data[1].trim() === 'çµ„é•·' ? 'selected' : ''}>çµ„é•·</option>
                                            <option value="å°ˆå“¡" ${data[1].trim() === 'å°ˆå“¡' ? 'selected' : ''}>å°ˆå“¡</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label>éƒ¨é–€</label>
                                        <input type="text" value="${data[2].trim()}" class="employee-department">
                                    </div>
                                    <div class="form-group">
                                        <label>å“¡å·¥ç·¨è™Ÿ</label>
                                        <input type="text" value="${data[3].trim()}" class="employee-id">
                                    </div>
                                    <div class="form-group">
                                        <button class="btn btn-secondary" onclick="removeEmployeeRow(this)">âŒ</button>
                                    </div>
                                `;
                                employeeList.appendChild(newRow);
                            }
                        }
                        
                        showSuccess('batch', `æˆåŠŸåŒ¯å…¥ ${employeeList.children.length} ç­†å“¡å·¥è³‡æ–™`);
                    };
                    reader.readAsText(file);
                }
            };
            input.click();
        }

        // æ‰¹é‡ç”Ÿæˆå°ç« 
        async function generateBatchSeals() {
            const employeeRows = document.querySelectorAll('.employee-row');
            const employees = [];
            
            employeeRows.forEach(row => {
                const name = row.querySelector('.employee-name').value;
                const title = row.querySelector('.employee-title').value;
                const department = row.querySelector('.employee-department').value;
                const employeeId = row.querySelector('.employee-id').value;
                
                if (name && title) {
                    employees.push({ name, title, department, employeeId });
                }
            });
            
            if (employees.length === 0) {
                showError('batch', 'è«‹è‡³å°‘æ–°å¢ä¸€ä½å“¡å·¥è³‡æ–™');
                return;
            }
            
            showLoading('batch');
            
            try {
                const results = [];
                
                for (let i = 0; i < employees.length; i++) {
                    const emp = employees[i];
                    const response = await fetch('https://script.google.com/macros/s/AKfycbw-3K2hr2Qc88XSejYG1txWUPXIOsHtpHmJID44iO2cgYhe26eEErOPhO6BKuZvSgYR/exec', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            action: 'createPersonal',
                            name: emp.name,
                            title: emp.title,
                            department: emp.department,
                            employeeId: emp.employeeId
                        })
                    });
                    
                    const result = await response.json();
                    results.push({
                        employee: emp,
                        result: result
                    });
                    
                    // é¿å… API é™åˆ¶
                    await new Promise(resolve => setTimeout(resolve, 1000));
                }
                
                hideLoading('batch');
                
                let resultHTML = '<table style="width: 100%; border-collapse: collapse;">';
                resultHTML += '<tr style="background: #f8f9fa;"><th style="padding: 10px; border: 1px solid #ddd;">å§“å</th><th style="padding: 10px; border: 1px solid #ddd;">ç‹€æ…‹</th><th style="padding: 10px; border: 1px solid #ddd;">å°ç«  ID</th><th style="padding: 10px; border: 1px solid #ddd;">æ“ä½œ</th></tr>';
                
                results.forEach(item => {
                    const status = item.result.success ? 
                        '<span class="status-indicator status-success"></span>æˆåŠŸ' : 
                        '<span class="status-indicator status-error"></span>å¤±æ•—';
                    
                    resultHTML += `
                        <tr>
                            <td style="padding: 10px; border: 1px solid #ddd;">${item.employee.name}</td>
                            <td style="padding: 10px; border: 1px solid #ddd;">${status}</td>
                            <td style="padding: 10px; border: 1px solid #ddd;">${item.result.sealId || 'N/A'}</td>
                            <td style="padding: 10px; border: 1px solid #ddd;">
                                ${item.result.success ? 
                                    `<button class="btn btn-info" onclick="downloadSeal('${item.result.files.svgFileId}')">ä¸‹è¼‰</button>` : 
                                    'ç„¡æ³•ä¸‹è¼‰'
                                }
                            </td>
                        </tr>
                    `;
                });
                
                resultHTML += '</table>';
                
                showResult('batch', resultHTML);
                showSuccess('batch', `æ‰¹é‡ç”Ÿæˆå®Œæˆï¼æˆåŠŸï¼š${results.filter(r => r.result.success).length} å€‹ï¼Œå¤±æ•—ï¼š${results.filter(r => !r.result.success).length} å€‹`);
                
            } catch (error) {
                hideLoading('batch');
                showError('batch', 'æ‰¹é‡ç”Ÿæˆå¤±æ•—ï¼š' + error.message);
            }
        }

        // é©—è­‰å°ç« 
        async function verifySeal() {
            const hash = document.getElementById('verify-hash').value;
            const sealId = document.getElementById('verify-id').value;
            
            if (!hash && !sealId) {
                showError('verify', 'è«‹è¼¸å…¥å°ç«  Hash æˆ– ID');
                return;
            }
            
            showLoading('verify');
            
            try {
                const response = await fetch('https://script.google.com/macros/s/AKfycbw-3K2hr2Qc88XSejYG1txWUPXIOsHtpHmJID44iO2cgYhe26eEErOPhO6BKuZvSgYR/exec', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        action: 'verify',
                        hash: hash,
                        sealId: sealId
                    })
                });
                
                const result = await response.json();
                hideLoading('verify');
                
                if (result.valid) {
                    document.getElementById('verify-result-title').innerHTML = 'âœ… é©—è­‰æˆåŠŸ';
                    document.getElementById('verify-result-title').style.color = '#155724';
                    
                    const resultHTML = `
                        <div class="result-item">
                            <strong>å°ç« é¡å‹ï¼š</strong>${result.sealType}
                        </div>
                        <div class="result-item">
                            <strong>ä½¿ç”¨è€…ï¼š</strong>${result.user}
                        </div>
                        <div class="result-item">
                            <strong>æ–‡ä»¶åç¨±ï¼š</strong>${result.documentName}
                        </div>
                        <div class="result-item">
                            <strong>å»ºç«‹æ™‚é–“ï¼š</strong>${new Date(result.timestamp).toLocaleString('zh-TW')}
                        </div>
                    `;
                    
                    showResult('verify', resultHTML);
                    showSuccess('verify', 'å°ç« é©—è­‰é€šéï¼Œæ­¤ç‚ºæœ‰æ•ˆå°ç« ï¼');
                } else {
                    document.getElementById('verify-result-title').innerHTML = 'âŒ é©—è­‰å¤±æ•—';
                    document.getElementById('verify-result-title').style.color = '#721c24';
                    
                    showResult('verify', `<div class="result-item" style="color: #721c24;">${result.message}</div>`);
                    showError('verify', 'å°ç« é©—è­‰å¤±æ•—ï¼Œå¯èƒ½ç‚ºå½é€ å°ç« ï¼');
                }
                
            } catch (error) {
                hideLoading('verify');
                showError('verify', 'é©—è­‰éç¨‹ç™¼ç”ŸéŒ¯èª¤ï¼š' + error.message);
            }
        }

        // æƒæ QR ç¢¼
        function scanQRCode() {
            alert('QR ç¢¼æƒæåŠŸèƒ½éœ€è¦æ”åƒé ­æ¬Šé™ï¼Œè«‹ä½¿ç”¨æ‰‹æ©Ÿæƒæ QR ç¢¼å¾Œæ‰‹å‹•è¼¸å…¥è³‡è¨Š');
        }

        // è¼‰å…¥å°ç« æ¸…å–®
        async function loadSealList() {
            showLoading('manage');
            
            try {
                // æ¨¡æ“¬è¼‰å…¥å°ç« æ¸…å–®
                await new Promise(resolve => setTimeout(resolve, 1500));
                
                const mockData = [
                    { name: 'ç‹å°æ˜', type: 'å€‹äººç« ', sealId: 'PERSONAL-20241201-1430-ABC', status: 'æœ‰æ•ˆ', createTime: '2024-12-01 14:30:00' },
                    { name: 'æå°è¯', type: 'å€‹äººç« ', sealId: 'PERSONAL-20241201-1435-DEF', status: 'æœ‰æ•ˆ', createTime: '2024-12-01 14:35:00' },
                    { name: 'å°ç£å¸•é‡‘æ£®ç—…å‹æ¬Šç›Šä¿ƒé€²æœƒ', type: 'å”æœƒå¤§ç« ', sealId: 'ASSOCIATION-20241201-1440-GHI', status: 'æœ‰æ•ˆ', createTime: '2024-12-01 14:40:00' }
                ];
                
                hideLoading('manage');
                
                let resultHTML = '<table style="width: 100%; border-collapse: collapse;">';
                resultHTML += '<tr style="background: #f8f9fa;"><th style="padding: 10px; border: 1px solid #ddd;">åç¨±</th><th style="padding: 10px; border: 1px solid #ddd;">é¡å‹</th><th style="padding: 10px; border: 1px solid #ddd;">å°ç«  ID</th><th style="padding: 10px; border: 1px solid #ddd;">ç‹€æ…‹</th><th style="padding: 10px; border: 1px solid #ddd;">å»ºç«‹æ™‚é–“</th></tr>';
                
                mockData.forEach(item => {
                    resultHTML += `
                        <tr>
                            <td style="padding: 10px; border: 1px solid #ddd;">${item.name}</td>
                            <td style="padding: 10px; border: 1px solid #ddd;">${item.type}</td>
                            <td style="padding: 10px; border: 1px solid #ddd;">${item.sealId}</td>
                            <td style="padding: 10px; border: 1px solid #ddd;"><span class="status-indicator status-success"></span>${item.status}</td>
                            <td style="padding: 10px; border: 1px solid #ddd;">${item.createTime}</td>
                        </tr>
                    `;
                });
                
                resultHTML += '</table>';
                
                showResult('manage', resultHTML);
                showSuccess('manage', `è¼‰å…¥å®Œæˆï¼å…±æ‰¾åˆ° ${mockData.length} å€‹å°ç« `);
                
            } catch (error) {
                hideLoading('manage');
                showError('manage', 'è¼‰å…¥å°ç« æ¸…å–®å¤±æ•—ï¼š' + error.message);
            }
        }

        // åŒ¯å‡ºå°ç« è³‡æ–™
        function exportSealData() {
            const csvContent = "data:text/csv;charset=utf-8," + 
                "åç¨±,é¡å‹,å°ç« ID,ç‹€æ…‹,å»ºç«‹æ™‚é–“\n" +
                "ç‹å°æ˜,å€‹äººç« ,PERSONAL-20241201-1430-ABC,æœ‰æ•ˆ,2024-12-01 14:30:00\n" +
                "æå°è¯,å€‹äººç« ,PERSONAL-20241201-1435-DEF,æœ‰æ•ˆ,2024-12-01 14:35:00\n" +
                "å°ç£å¸•é‡‘æ£®ç—…å‹æ¬Šç›Šä¿ƒé€²æœƒ,å”æœƒå¤§ç« ,ASSOCIATION-20241201-1440-GHI,æœ‰æ•ˆ,2024-12-01 14:40:00";
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "å°ç« æ¸…å–®_" + new Date().toISOString().substring(0,10) + ".csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showSuccess('manage', 'CSV æª”æ¡ˆå·²ä¸‹è¼‰å®Œæˆï¼');
        }

        // æŸ¥çœ‹ä½¿ç”¨è¨˜éŒ„
        async function viewUsageLog() {
            showLoading('manage');
            
            try {
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                const logData = [
                    { time: '2024-12-01 14:30:15', type: 'å€‹äººç« ', user: 'ç‹å°æ˜', document: 'å€‹äººç« _ç‹å°æ˜_PERSONAL-20241201-1430-ABC', ip: '192.168.1.100' },
                    { time: '2024-12-01 14:35:22', type: 'å€‹äººç« ', user: 'æå°è¯', document: 'å€‹äººç« _æå°è¯_PERSONAL-20241201-1435-DEF', ip: '192.168.1.101' },
                    { time: '2024-12-01 14:40:33', type: 'å”æœƒå¤§ç« ', user: 'ç†äº‹é•·', document: 'å”æœƒç« _å°ç£å¸•é‡‘æ£®ç—…å‹æ¬Šç›Šä¿ƒé€²æœƒ_ASSOCIATION-20241201-1440-GHI', ip: '192.168.1.102' }
                ];
                
                hideLoading('manage');
                
                let resultHTML = '<h4>ğŸ“ˆ å°ç« ä½¿ç”¨è¨˜éŒ„</h4>';
                resultHTML += '<table style="width: 100%; border-collapse: collapse;">';
                resultHTML += '<tr style="background: #f8f9fa;"><th style="padding: 10px; border: 1px solid #ddd;">æ™‚é–“</th><th style="padding: 10px; border: 1px solid #ddd;">é¡å‹</th><th style="padding: 10px; border: 1px solid #ddd;">ä½¿ç”¨è€…</th><th style="padding: 10px; border: 1px solid #ddd;">æ–‡ä»¶åç¨±</th><th style="padding: 10px; border: 1px solid #ddd;">IPä½å€</th></tr>';
                
                logData.forEach(log => {
                    resultHTML += `
                        <tr>
                            <td style="padding: 10px; border: 1px solid #ddd;">${log.time}</td>
                            <td style="padding: 10px; border: 1px solid #ddd;">${log.type}</td>
                            <td style="padding: 10px; border: 1px solid #ddd;">${log.user}</td>
                            <td style="padding: 10px; border: 1px solid #ddd;">${log.document}</td>
                            <td style="padding: 10px; border: 1px solid #ddd;">${log.ip}</td>
                        </tr>
                    `;
                });
                
                resultHTML += '</table>';
                
                showResult('manage', resultHTML);
                showSuccess('manage', `è¼‰å…¥å®Œæˆï¼å…± ${logData.length} ç­†ä½¿ç”¨è¨˜éŒ„`);
                
            } catch (error) {
                hideLoading('manage');
                showError('manage', 'è¼‰å…¥ä½¿ç”¨è¨˜éŒ„å¤±æ•—ï¼š' + error.message);
            }
        }

        // ä¸‹è¼‰å°ç« æª”æ¡ˆ
        function downloadSeal(fileId) {
            const downloadUrl = `https://drive.google.com/uc?export=download&id=${fileId}`;
            window.open(downloadUrl, '_blank');
        }

        // ä¸‹è¼‰ Metadata
        function downloadMetadata(fileId) {
            const downloadUrl = `https://drive.google.com/uc?export=download&id=${fileId}`;
            window.open(downloadUrl, '_blank');
        }

        // é é¢è¼‰å…¥å®Œæˆå¾Œçš„åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            console.log('é›»å­å°ç« ç”Ÿæˆç³»çµ±å·²è¼‰å…¥');
            
            // è¨­å®šé è¨­å€¼
            document.getElementById('personal-department').value = 'å°ç£å¸•é‡‘æ£®ç—…å‹æ¬Šç›Šä¿ƒé€²æœƒ';
            document.getElementById('org-name').value = 'å°ç£å¸•é‡‘æ£®ç—…å‹æ¬Šç›Šä¿ƒé€²æœƒ';
            document.getElementById('org-taxid').value = '85202581';
            document.getElementById('org-authorizer').value = 'ç†äº‹é•·';
        });
    </script>
</body>
</html>
