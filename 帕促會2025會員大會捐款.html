<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="theme-color" content="#667eea">
<title>å¸•ä¿ƒæœƒå¹´æœƒå ±åç³»çµ±</title>
<style>
  * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
  }
  
  :root {
      --primary-color: #667eea;
      --secondary-color: #764ba2;
      --success-color: #4caf50;
      --error-color: #f44336;
      --donation-color: #ff6b6b;
      --text-dark: #222;
      --text-light: #555;
      --bg-light: #f8f9ff;
      --border-color: #d0d0d0;
  }
  
  body {
      font-family: -apple-system, BlinkMacSystemFont, 'Microsoft JhengHei', 'Segoe UI', 'Arial', sans-serif;
      background: #f5f5f5;
      color: var(--text-dark);
      overflow-x: hidden;
      -webkit-font-smoothing: antialiased;
      font-size: 18px;
      line-height: 1.8;
  }
  
  .app-header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 60px;
      background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0 20px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.15);
      z-index: 1000;
  }
  
  .app-title {
      font-size: 22px;
      font-weight: bold;
      letter-spacing: 1px;
  }
  
  .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      height: 75px;
      background: white;
      display: flex;
      justify-content: space-around;
      align-items: center;
      box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
      z-index: 1000;
      padding-bottom: env(safe-area-inset-bottom);
  }
  
  .nav-item {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 8px;
      cursor: pointer;
      transition: all 0.3s;
      color: #999;
  }
  
  .nav-item.active {
      color: var(--primary-color);
  }
  
  .nav-item.donation-nav.active {
      color: var(--donation-color);
  }
  
  .nav-icon {
      font-size: 28px;
      margin-bottom: 4px;
  }
  
  .nav-label {
      font-size: 15px;
      font-weight: 600;
  }
  
  .app-content {
      margin-top: 60px;
      padding-bottom: 90px;
      min-height: calc(100vh - 135px);
  }
  
  .page {
      display: none;
      animation: fadeIn 0.3s ease-in-out;
  }
  
  .page.active {
      display: block;
  }
  
  @keyframes fadeIn {
      from {
          opacity: 0;
          transform: translateY(10px);
      }
      to {
          opacity: 1;
          transform: translateY(0);
      }
  }
  
  .event-banner {
      background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
      color: white;
      padding: 40px 24px;
      text-align: center;
  }
  
  .event-banner h1 {
      font-size: 32px;
      margin-bottom: 12px;
      line-height: 1.4;
      font-weight: bold;
  }
  
  .event-banner .subtitle {
      font-size: 19px;
      opacity: 0.95;
      line-height: 1.6;
  }
  
  /* ææ¬¾é é¢å°ˆç”¨ Banner */
  .donation-banner {
      background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
      color: white;
      padding: 40px 24px;
      text-align: center;
  }
  
  .donation-banner h1 {
      font-size: 32px;
      margin-bottom: 12px;
      line-height: 1.4;
      font-weight: bold;
  }
  
  .donation-banner .subtitle {
      font-size: 19px;
      opacity: 0.95;
      line-height: 1.6;
  }
  
  .event-date {
      background: white;
      margin: -25px 20px 0;
      padding: 28px;
      border-radius: 16px;
      box-shadow: 0 4px 16px rgba(0,0,0,0.12);
      text-align: center;
  }
  
  .event-date .year {
      color: var(--text-light);
      font-size: 18px;
      margin-bottom: 8px;
      font-weight: 600;
  }
  
  .event-date .date {
      color: var(--primary-color);
      font-size: 38px;
      font-weight: bold;
      letter-spacing: 2px;
  }
  
  .info-card {
      background: white;
      margin: 20px;
      padding: 28px;
      border-radius: 16px;
      box-shadow: 0 2px 12px rgba(0,0,0,0.08);
  }
  
  .info-card-title {
      font-size: 24px;
      font-weight: bold;
      color: var(--primary-color);
      margin-bottom: 24px;
      display: flex;
      align-items: center;
      gap: 10px;
      line-height: 1.4;
  }
  
  .info-item {
      padding: 18px 0;
      border-bottom: 2px solid var(--border-color);
  }
  
  .info-item:last-child {
      border-bottom: none;
  }
  
  .info-label {
      font-size: 17px;
      color: var(--text-light);
      margin-bottom: 8px;
      font-weight: 600;
  }
  
  .info-value {
      font-size: 20px;
      font-weight: 700;
      color: var(--text-dark);
      line-height: 1.6;
  }
  
  .fee-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 18px 0;
      border-bottom: 2px solid var(--border-color);
  }
  
  .fee-item:last-child {
      border-bottom: none;
  }
  
  .fee-label {
      font-size: 19px;
      color: var(--text-dark);
      font-weight: 600;
      line-height: 1.5;
  }
  
  .fee-amount {
      font-size: 21px;
      font-weight: bold;
      color: var(--primary-color);
      white-space: nowrap;
      margin-left: 16px;
  }
  
  .bank-info {
      background: var(--bg-light);
      padding: 24px;
      border-radius: 12px;
      margin-top: 16px;
      border: 2px solid var(--primary-color);
  }
  
  .bank-row {
      display: flex;
      margin-bottom: 16px;
      line-height: 1.6;
  }
  
  .bank-row:last-child {
      margin-bottom: 0;
  }
  
  .bank-label {
      width: 100px;
      color: var(--text-light);
      font-size: 18px;
      font-weight: 600;
      flex-shrink: 0;
  }
  
  .bank-value {
      flex: 1;
      font-weight: 700;
      font-size: 18px;
      color: var(--text-dark);
  }
  
  .account-number {
      color: var(--primary-color);
      font-size: 24px;
      letter-spacing: 2px;
      font-weight: bold;
  }
  
  .link-button {
      display: block;
      background: var(--primary-color);
      color: white;
      padding: 18px;
      border-radius: 12px;
      text-align: center;
      text-decoration: none;
      font-weight: bold;
      font-size: 19px;
      margin-top: 16px;
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
      transition: transform 0.2s;
  }
  
  .link-button:active {
      transform: scale(0.98);
  }
  
  .form-container {
      padding: 20px;
  }
  
  .form-card {
      background: white;
      padding: 28px;
      border-radius: 16px;
      box-shadow: 0 2px 12px rgba(0,0,0,0.08);
      margin-bottom: 20px;
  }
  
  .form-group {
      margin-bottom: 28px;
  }
  
  .form-group:last-child {
      margin-bottom: 0;
  }
  
  .form-group label {
      display: block;
      font-size: 20px;
      font-weight: bold;
      color: var(--text-dark);
      margin-bottom: 12px;
      line-height: 1.5;
  }
  
  .required {
      color: var(--error-color);
      font-size: 22px;
  }
  
  .form-control {
      width: 100%;
      padding: 18px;
      font-size: 20px;
      border: 3px solid var(--border-color);
      border-radius: 12px;
      font-family: inherit;
      transition: border-color 0.3s;
      background: white;
      font-weight: 500;
  }
  
  .form-control:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
  }
  
  .form-control::placeholder {
      color: #aaa;
      font-size: 18px;
  }
  
  textarea.form-control {
      resize: vertical;
      min-height: 120px;
      line-height: 1.6;
  }
  
  .radio-group {
      display: flex;
      flex-direction: column;
      gap: 14px;
  }
  
  .radio-option {
      position: relative;
      display: flex;
      align-items: center;
      padding: 22px 20px;
      background: var(--bg-light);
      border: 3px solid transparent;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s;
  }
  
  .radio-option:active {
      transform: scale(0.98);
  }
  
  .radio-option input[type="radio"] {
      position: absolute;
      opacity: 0;
  }
  
  .radio-option.checked {
      background: white;
      border-color: var(--primary-color);
      box-shadow: 0 2px 8px rgba(102, 126, 234, 0.2);
  }
  
  .radio-label {
      flex: 1;
      font-size: 19px;
      color: var(--text-dark);
      padding-left: 16px;
      line-height: 1.6;
      font-weight: 600;
  }
  
  .radio-label small {
      display: block;
      font-size: 16px;
      color: var(--text-light);
      margin-top: 4px;
      font-weight: 500;
  }
  
  .radio-check {
      width: 28px;
      height: 28px;
      border: 3px solid var(--border-color);
      border-radius: 50%;
      position: relative;
      transition: all 0.3s;
      flex-shrink: 0;
  }
  
  .radio-check::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(0);
      width: 12px;
      height: 12px;
      background: white;
      border-radius: 50%;
      opacity: 0;
      transition: all 0.3s;
  }
  
  .radio-option.checked .radio-check {
      background: var(--primary-color);
      border-color: var(--primary-color);
  }
  
  .radio-option.checked .radio-check::after {
      opacity: 1;
      transform: translate(-50%, -50%) scale(1);
  }
  
  .attend-meal-group {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 14px;
  }
  
  .attend-meal-option {
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 24px 16px;
      background: var(--bg-light);
      border: 3px solid transparent;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s;
      min-height: 120px;
  }
  
  .attend-meal-option:active {
      transform: scale(0.98);
  }
  
  .attend-meal-option input[type="radio"] {
      position: absolute;
      opacity: 0;
  }
  
  .attend-meal-option.checked {
      background: white;
      border-color: var(--primary-color);
      box-shadow: 0 2px 8px rgba(102, 126, 234, 0.2);
  }
  
  .attend-meal-icon {
      font-size: 40px;
      margin-bottom: 12px;
  }
  
  .attend-meal-label {
      font-size: 20px;
      font-weight: bold;
      color: var(--text-dark);
  }
  
  .diet-group {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 14px;
  }
  
  .diet-option {
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 24px 16px;
      background: var(--bg-light);
      border: 3px solid transparent;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s;
      min-height: 120px;
  }
  
  .diet-option:active {
      transform: scale(0.98);
  }
  
  .diet-option input[type="radio"] {
      position: absolute;
      opacity: 0;
  }
  
  .diet-option.checked {
      background: white;
      border-color: var(--primary-color);
      box-shadow: 0 2px 8px rgba(102, 126, 234, 0.2);
  }
  
  .diet-option.disabled {
      opacity: 0.5;
      cursor: not-allowed;
      pointer-events: none;
  }
  
  .diet-icon {
      font-size: 40px;
      margin-bottom: 12px;
  }
  
  .diet-label {
      font-size: 20px;
      font-weight: bold;
      color: var(--text-dark);
  }
  
  .payment-group {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 14px;
  }
  
  .payment-option {
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 24px 16px;
      background: var(--bg-light);
      border: 3px solid transparent;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s;
      min-height: 120px;
  }
  
  .payment-option:active {
      transform: scale(0.98);
  }
  
  .payment-option input[type="radio"] {
      position: absolute;
      opacity: 0;
  }
  
  .payment-option.checked {
      background: white;
      border-color: var(--primary-color);
      box-shadow: 0 2px 8px rgba(102, 126, 234, 0.2);
  }
  
  .payment-icon {
      font-size: 40px;
      margin-bottom: 12px;
  }
  
  .payment-label {
      font-size: 20px;
      font-weight: bold;
      color: var(--text-dark);
  }
  
  .transfer-code-group {
      display: none;
      margin-top: 16px;
      padding: 20px;
      background: #fff8e1;
      border-radius: 12px;
      border: 2px solid #ffc107;
  }
  
  .transfer-code-group.show {
      display: block;
      animation: slideDown 0.3s ease-out;
  }
  
  @keyframes slideDown {
      from {
          opacity: 0;
          transform: translateY(-10px);
      }
      to {
          opacity: 1;
          transform: translateY(0);
      }
  }
  
  .transfer-hint {
      font-size: 17px;
      color: #f57c00;
      margin-bottom: 12px;
      font-weight: 600;
      line-height: 1.6;
  }
  
  .donation-group {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 14px;
      margin-bottom: 16px;
  }
  
  .donation-option {
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
      background: var(--bg-light);
      border: 3px solid transparent;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s;
      min-height: 80px;
  }
  
  .donation-option:active {
      transform: scale(0.98);
  }
  
  .donation-option input[type="radio"] {
      position: absolute;
      opacity: 0;
  }
  
  .donation-option.checked {
      background: white;
      border-color: var(--primary-color);
      box-shadow: 0 2px 8px rgba(102, 126, 234, 0.2);
  }
  
  .donation-label {
      font-size: 24px;
      font-weight: bold;
      color: var(--primary-color);
  }
  
  .custom-donation-group {
      display: none;
      margin-top: 16px;
      padding: 20px;
      background: #e8f5e9;
      border-radius: 12px;
      border: 2px solid #4caf50;
  }
  
  .custom-donation-group.show {
      display: block;
      animation: slideDown 0.3s ease-out;
  }
  
  .custom-hint {
      font-size: 17px;
      color: #2e7d32;
      margin-bottom: 12px;
      font-weight: 600;
      line-height: 1.6;
  }
  
  .fee-display {
      background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
      color: white;
      padding: 32px;
      border-radius: 16px;
      text-align: center;
      margin: 24px 0;
      box-shadow: 0 4px 16px rgba(102, 126, 234, 0.3);
  }
  
  .fee-display.donation-display {
      background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
  }
  
  .fee-display .label {
      font-size: 19px;
      opacity: 0.95;
      margin-bottom: 12px;
      font-weight: 600;
  }
  
  .fee-display .amount {
      font-size: 48px;
      font-weight: bold;
      letter-spacing: 2px;
  }
  
  .fee-display .detail {
      font-size: 16px;
      opacity: 0.9;
      margin-top: 12px;
      line-height: 1.5;
      white-space: pre-line;
  }
  
  .submit-btn {
      width: 100%;
      padding: 22px;
      font-size: 22px;
      font-weight: bold;
      color: white;
      background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
      border: none;
      border-radius: 16px;
      cursor: pointer;
      transition: all 0.3s;
      box-shadow: 0 6px 16px rgba(102, 126, 234, 0.4);
      letter-spacing: 2px;
  }
  
  .submit-btn.donation-btn {
      background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
      box-shadow: 0 6px 16px rgba(255, 107, 107, 0.4);
  }
  
  .submit-btn:active {
      transform: scale(0.98);
  }
  
  .submit-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
  }
  
  .stats-container {
      padding: 20px;
  }
  
  .stats-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 16px;
      margin-bottom: 20px;
  }
  
  .stat-card {
      background: white;
      padding: 28px 20px;
      border-radius: 16px;
      text-align: center;
      box-shadow: 0 2px 12px rgba(0,0,0,0.08);
  }
  
  .stat-icon {
      font-size: 42px;
      margin-bottom: 12px;
  }
  
  .stat-label {
      font-size: 17px;
      color: var(--text-light);
      margin-bottom: 12px;
      font-weight: 600;
  }
  
  .stat-number {
      font-size: 42px;
      font-weight: bold;
      color: var(--primary-color);
  }
  
  .stat-detail {
      font-size: 15px;
      color: var(--text-light);
      margin-top: 8px;
      font-weight: 500;
  }
  
  .registration-list {
      background: white;
      border-radius: 16px;
      padding: 24px;
      box-shadow: 0 2px 12px rgba(0,0,0,0.08);
  }
  
  .list-title {
      font-size: 24px;
      font-weight: bold;
      color: var(--text-dark);
      margin-bottom: 20px;
  }
  
  .registration-item {
      background: var(--bg-light);
      padding: 22px;
      border-radius: 12px;
      margin-bottom: 16px;
      border-left: 5px solid var(--primary-color);
  }
  
  .registration-item.donation-item {
      border-left-color: var(--donation-color);
  }
  
  .registration-item:last-child {
      margin-bottom: 0;
  }
  
  .item-name {
      font-size: 22px;
      font-weight: bold;
      color: var(--text-dark);
      margin-bottom: 12px;
  }
  
  .item-details {
      font-size: 18px;
      color: var(--text-light);
      line-height: 1.8;
      font-weight: 500;
  }
  
  .item-fee {
      font-size: 20px;
      font-weight: bold;
      color: var(--primary-color);
      margin-top: 12px;
  }
  
  .empty-state {
      text-align: center;
      padding: 80px 20px;
      color: var(--text-light);
  }
  
  .empty-icon {
      font-size: 80px;
      margin-bottom: 20px;
      opacity: 0.5;
  }
  
  .empty-text {
      font-size: 20px;
      font-weight: 600;
  }
  
  .toast {
      position: fixed;
      top: 75px;
      left: 20px;
      right: 20px;
      padding: 22px 24px;
      border-radius: 12px;
      color: white;
      font-weight: bold;
      font-size: 19px;
      text-align: center;
      z-index: 2000;
      transform: translateY(-150px);
      opacity: 0;
      transition: all 0.3s;
      box-shadow: 0 6px 20px rgba(0,0,0,0.25);
      line-height: 1.5;
  }
  
  .toast.show {
      transform: translateY(0);
      opacity: 1;
  }
  
  .toast.success {
      background: var(--success-color);
  }
  
  .toast.error {
      background: var(--error-color);
  }
  
  .loading-spinner {
      display: inline-block;
      width: 24px;
      height: 24px;
      border: 4px solid rgba(255,255,255,.3);
      border-radius: 50%;
      border-top-color: #fff;
      animation: spin 0.8s linear infinite;
      margin-right: 10px;
      vertical-align: middle;
  }
  
  @keyframes spin {
      to { transform: rotate(360deg); }
  }
  
  /* ææ¬¾é‡‘é¡é¸é …æ¨£å¼ */
  .donation-amount-group {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 14px;
      margin-bottom: 16px;
  }
  
  .donation-amount-option {
      position: relative;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 24px;
      background: #fff5f5;
      border: 3px solid transparent;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s;
      min-height: 90px;
  }
  
  .donation-amount-option:active {
      transform: scale(0.98);
  }
  
  .donation-amount-option input[type="radio"] {
      position: absolute;
      opacity: 0;
  }
  
  .donation-amount-option.checked {
      background: white;
      border-color: var(--donation-color);
      box-shadow: 0 2px 8px rgba(255, 107, 107, 0.3);
  }
  
  .donation-amount-label {
      font-size: 28px;
      font-weight: bold;
      color: var(--donation-color);
  }
  
  @media (min-width: 768px) {
      .app-content {
          max-width: 600px;
          margin-left: auto;
          margin-right: auto;
      }
      
      .app-header {
          max-width: 600px;
          left: 50%;
          transform: translateX(-50%);
      }
      
      .bottom-nav {
          max-width: 600px;
          left: 50%;
          transform: translateX(-50%);
      }
      
      .toast {
          max-width: 560px;
          left: 50%;
          transform: translateX(-50%) translateY(-150px);
      }
      
      .toast.show {
          transform: translateX(-50%) translateY(0);
      }
  }
</style>
</head>
<body>
<header class="app-header">
  <div class="app-title">ğŸ‰ å¸•ä¿ƒæœƒå¹´æœƒå ±å</div>
</header>

<div class="toast" id="toast"></div>

<main class="app-content">
  <!-- ==================== æ´»å‹•è³‡è¨Šé é¢ ==================== -->
  <div class="page active" id="infoPage">
      <div class="event-banner">
          <h1>ç¬¬å››å±†ç¬¬äºŒæ¬¡<br>æœƒå“¡å¤§æœƒ</h1>
          <div class="subtitle">å°ç£å¸•é‡‘æ£®ç—…å‹<br>æ¬Šç›Šä¿ƒé€²æœƒ</div>
      </div>

      <div class="event-date">
          <div class="year">2025å¹´</div>
          <div class="date">12æœˆ20æ—¥ï¼ˆå…­ï¼‰<br>æ—©ä¸Š10:00 ~ 12:00</div>
      </div>

      <div class="info-card">
          <div class="info-card-title">ğŸ“ æ´»å‹•åœ°é»</div>
          <div class="info-item">
              <div class="info-label">å ´åœ°åç¨±</div>
              <div class="info-value">æœæš®è‰¯è¾°å©šå®´æœƒé¤¨<br>ã€é¤å»³åŸåç¨±:å¥³å…’ç´…ã€‘<br>ã€åœ°é»åŒå»å¹´2024æœƒå“¡å¤§æœƒã€‘</div>
          </div>
          <div class="info-item">
              <div class="info-label">åœ°å€</div>
              <div class="info-value">å°ä¸­å¸‚å—å±¯å€<br>æ–‡å¿ƒå—è·¯99è™Ÿ</div>
          </div>
          <div class="info-item">
              <div class="info-label">äº¤é€šè³‡è¨Š</div>
              <div class="info-value">ğŸš‡ æ·é‹è±æ¨‚å…¬åœ’ç«™</div>
          </div>
          <div class="info-item">
              <div class="info-label">è¯çµ¡é›»è©±</div>
              <div class="info-value">ğŸ“ (04) 3600-6000</div>
          </div>
          <a href="https://www.yourhomewedding.com/archive/images/editor/faq/10dd58e528ba79f1.jpg" target="_blank" class="link-button">
              ğŸš— æŸ¥çœ‹åœè»Šå ´ä½ç½®åœ–
          </a>
      </div>

      <div class="info-card">
          <div class="info-card-title">ğŸ’° è²»ç”¨èªªæ˜</div>
          <div class="fee-item">
              <div class="fee-label">èˆŠæœƒå“¡<br><small>ï¼ˆç¹³äº¤2026å¹´æœƒè²»,å…é¤è²»ï¼‰</small></div>
              <div class="fee-amount">1,000å…ƒ</div>
          </div>
          <div class="fee-item">
              <div class="fee-label">èˆŠæœƒå“¡+é™ªä¼´è€…<br><small>ï¼ˆæœƒè²»+é™ªä¼´è€…1åï¼‰</small></div>
              <div class="fee-amount">1,500å…ƒ</div>
          </div>
          <div class="fee-item">
              <div class="fee-label">æ–°æœƒå“¡<br><small>ï¼ˆæœƒè²»+é¤è²»å„ªæƒ ï¼‰</small></div>
              <div class="fee-amount">1,500å…ƒ</div>
          </div>
      </div>

      <div class="info-card">
          <div class="info-card-title">ğŸ¦ åŒ¯æ¬¾è³‡è¨Š</div>
          <div class="bank-info">
              <div class="bank-row">
                  <div class="bank-label">æˆ¶å</div>
                  <div class="bank-value">ç¤¾åœ˜æ³•äººå°ç£<br>å¸•é‡‘æ£®ç—…å‹<br>æ¬Šç›Šä¿ƒé€²æœƒ</div>
              </div>
              <div class="bank-row">
                  <div class="bank-label">éŠ€è¡Œ</div>
                  <div class="bank-value">ç¬¬ä¸€éŠ€è¡Œ<br>ä¸‰é‡åŸ”åˆ†è¡Œ</div>
              </div>
              <div class="bank-row">
                  <div class="bank-label">éŠ€è¡Œä»£è™Ÿ</div>
                  <div class="bank-value">007</div>
              </div>
              <div class="bank-row">
                  <div class="bank-label">å¸³è™Ÿ</div>
                  <div class="bank-value account-number">211-1015-0402</div>
              </div>
          </div>
      </div>
  </div>

  <!-- ==================== å ±åè¡¨å–®é é¢ ==================== -->
  <div class="page" id="formPage">
      <div class="form-container">
          <form id="registrationForm">
              <div class="form-card">
                  <div class="form-group">
                      <label for="name">å§“å <span class="required">*</span></label>
                      <input type="text" id="name" name="name" class="form-control" placeholder="è«‹è¼¸å…¥æ‚¨çš„å§“å" required>
                  </div>

                  <div class="form-group">
                      <label for="phone">è¯çµ¡é›»è©± <span class="required">*</span></label>
                      <input type="tel" id="phone" name="phone" class="form-control" placeholder="0912-345-678" required>
                  </div>

                  <div class="form-group">
                      <label for="email">é›»å­éƒµä»¶</label>
                      <input type="email" id="email" name="email" class="form-control" placeholder="example@email.com">
                  </div>
              </div>

            <div class="form-card">
                <div class="form-group">
                    <label>å ±åé¡å‹ <span class="required">*</span></label>
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="type" value="member" data-fee="1000" data-detail="2026å¹´æœƒè²» $1,000ï¼ˆå…é¤è²»ï¼‰" required>
                            <div class="radio-check"></div>
                            <span class="radio-label">èˆŠæœƒå“¡<br><small>ç¹³äº¤2026å¹´æœƒè²»1,000å…ƒï¼ˆå…é¤è²»ï¼‰</small></span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="type" value="member-caregiver" data-fee="1500" data-detail="2026å¹´æœƒè²» $1,000 + ç…§é¡§é™ªä¼´è€… $500 = $1,500">
                            <div class="radio-check"></div>
                            <span class="radio-label">èˆŠæœƒå“¡+ç…§é¡§é™ªä¼´è€…<br><small>æœƒè²»1,000å…ƒ+é™ªä¼´è€…1å500å…ƒ=1,500å…ƒ</small></span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="type" value="new-member" data-fee="1500" data-detail="2026å¹´æœƒè²» $1,000 + é¤è²»å„ªæƒ åƒ¹ $500 = $1,500">
                            <div class="radio-check"></div>
                            <span class="radio-label">æ–°æœƒå“¡<br><small>æœƒè²»1,000å…ƒ+é¤è²»å„ªæƒ åƒ¹500å…ƒ=1,500å…ƒ</small></span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="type" value="member-no-attend" data-fee="1000" data-detail="2026å¹´æœƒè²» $1,000ï¼ˆä¸å‡ºå¸­ï¼‰">
                            <div class="radio-check"></div>
                            <span class="radio-label">ç¹³2026å¸¸å¹´æœƒè²»ï¼Œä¸å‡ºå¸­<br><small>æœƒè²»1,000å…ƒï¼ˆä¸åƒåŠ æ´»å‹•ï¼‰</small></span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="type" value="new-member-no-attend" data-fee="1000" data-detail="2026å¹´æœƒè²» $1,000ï¼ˆä¸å‡ºå¸­ï¼‰">
                            <div class="radio-check"></div>
                            <span class="radio-label">åŠ å…¥æœƒå“¡2026ï¼Œä¸å‡ºå¸­<br><small>æœƒè²»1,000å…ƒï¼ˆä¸åƒåŠ æ´»å‹•ï¼‰</small></span>
                        </label>
                    </div>
                </div>

                  <div class="form-group">
                      <label>æ˜¯å¦åƒåŠ ç”¨é¤ <span class="required">*</span></label>
                      <div class="attend-meal-group">
                          <label class="attend-meal-option">
                              <input type="radio" name="attendMeal" value="yes" required>
                              <div class="attend-meal-icon">âœ…</div>
                              <div class="attend-meal-label">åƒåŠ ç”¨é¤</div>
                          </label>
                          <label class="attend-meal-option">
                              <input type="radio" name="attendMeal" value="no">
                              <div class="attend-meal-icon">âŒ</div>
                              <div class="attend-meal-label">ä¸ç”¨é¤</div>
                          </label>
                      </div>
                  </div>

                  <div class="form-group" id="dietGroupWrapper">
                      <label>é£²é£Ÿç¿’æ…£ <span class="required">*</span></label>
                      <div class="diet-group">
                          <label class="diet-option">
                              <input type="radio" name="diet" value="meat" required>
                              <div class="diet-icon">ğŸ–</div>
                              <div class="diet-label">è‘·é£Ÿ</div>
                          </label>
                          <label class="diet-option">
                              <input type="radio" name="diet" value="vegetarian">
                              <div class="diet-icon">ğŸ¥—</div>
                              <div class="diet-label">ç´ é£Ÿ</div>
                          </label>
                      </div>
                  </div>

                  <div class="form-group">
                      <label>é¡å¤–ææ¬¾ï¼ˆé¸å¡«ï¼‰</label>
                      <div class="donation-group">
                          <label class="donation-option">
                              <input type="radio" name="donation" value="0" checked>
                              <span class="donation-label">ä¸ææ¬¾</span>
                          </label>
                          <label class="donation-option">
                              <input type="radio" name="donation" value="500">
                              <span class="donation-label">$500</span>
                          </label>
                          <label class="donation-option">
                              <input type="radio" name="donation" value="1000">
                              <span class="donation-label">$1,000</span>
                          </label>
                          <label class="donation-option">
                              <input type="radio" name="donation" value="2000">
                              <span class="donation-label">$2,000</span>
                          </label>
                          <label class="donation-option">
                              <input type="radio" name="donation" value="5000">
                              <span class="donation-label">$5,000</span>
                          </label>
                          <label class="donation-option">
                              <input type="radio" name="donation" value="custom">
                              <span class="donation-label">è‡ªè¨‚é‡‘é¡</span>
                          </label>
                      </div>
                      <div class="custom-donation-group" id="customDonationGroup">
                          <div class="custom-hint">ğŸ’š è«‹è¼¸å…¥ææ¬¾é‡‘é¡</div>
                          <input type="number" id="customDonation" name="customDonation" class="form-control" placeholder="è«‹è¼¸å…¥é‡‘é¡" min="1" step="1">
                      </div>
                  </div>

                  <div class="form-group">
                      <label>ç¹³è²»æ–¹å¼ <span class="required">*</span></label>
                      <div class="payment-group">
                          <label class="payment-option">
                              <input type="radio" name="payment" value="transfer" required>
                              <div class="payment-icon">ğŸ¦</div>
                              <div class="payment-label">è½‰å¸³</div>
                          </label>
                          <label class="payment-option">
                              <input type="radio" name="payment" value="cash">
                              <div class="payment-icon">ğŸ’µ</div>
                              <div class="payment-label">ç¾é‡‘</div>
                          </label>
                      </div>
                      <div class="transfer-code-group" id="transferCodeGroup">
                          <div class="transfer-hint">ğŸ’¡ è«‹è¼¸å…¥è½‰å¸³å¸³è™Ÿå¾Œ5ç¢¼</div>
                          <input type="text" id="transferCode" name="transferCode" class="form-control" placeholder="ä¾‹å¦‚:12345" maxlength="5" pattern="[0-9]{5}">
                      </div>
                  </div>

                  <div class="form-group">
                      <label for="notes">å‚™è¨»</label>
                      <textarea id="notes" name="notes" class="form-control" placeholder="ç‰¹æ®Šéœ€æ±‚æˆ–å…¶ä»–èªªæ˜"></textarea>
                  </div>
              </div>

              <div class="fee-display">
                  <div class="label">æ‡‰ç¹³ç¸½è²»ç”¨</div>
                  <div class="amount" id="totalFee">NT$ 0</div>
                  <div class="detail" id="feeDetail"></div>
              </div>

              <button type="submit" class="submit-btn" id="submitBtn">
                  ç¢ºèªå ±å
              </button>
          </form>
      </div>
  </div>

  <!-- ==================== æˆ‘è¦ææ¬¾é é¢ ==================== -->
  <div class="page" id="donationPage">
      <div class="donation-banner">
          <h1>ğŸ’ æˆ‘è¦ææ¬¾</h1>
          <div class="subtitle">æ”¯æŒå¸•é‡‘æ£®ç—…å‹<br>æ¬Šç›Šä¿ƒé€²æœƒ</div>
      </div>

      <div class="form-container">
          <form id="donationForm">
              <div class="form-card">
                  <div class="form-group">
                      <label for="donorName">å§“å <span class="required">*</span></label>
                      <input type="text" id="donorName" name="donorName" class="form-control" placeholder="è«‹è¼¸å…¥æ‚¨çš„å§“å" required>
                  </div>

                  <div class="form-group">
                      <label for="donorPhone">è¯çµ¡é›»è©± <span class="required">*</span></label>
                      <input type="tel" id="donorPhone" name="donorPhone" class="form-control" placeholder="0912-345-678" required>
                  </div>

                  <div class="form-group">
                      <label for="donorEmail">é›»å­éƒµä»¶ï¼ˆé¸å¡«ï¼‰</label>
                      <input type="email" id="donorEmail" name="donorEmail" class="form-control" placeholder="example@email.com">
                  </div>
              </div>

              <div class="form-card">
                  <div class="form-group">
                      <label>ææ¬¾é‡‘é¡ <span class="required">*</span></label>
                      <div class="donation-amount-group">
                          <label class="donation-amount-option">
                              <input type="radio" name="donationAmount" value="500" required>
                              <span class="donation-amount-label">$500</span>
                          </label>
                          <label class="donation-amount-option">
                              <input type="radio" name="donationAmount" value="1000">
                              <span class="donation-amount-label">$1,000</span>
                          </label>
                          <label class="donation-amount-option">
                              <input type="radio" name="donationAmount" value="2000">
                              <span class="donation-amount-label">$2,000</span>
                          </label>
                          <label class="donation-amount-option">
                              <input type="radio" name="donationAmount" value="3000">
                              <span class="donation-amount-label">$3,000</span>
                          </label>
                          <label class="donation-amount-option">
                              <input type="radio" name="donationAmount" value="5000">
                              <span class="donation-amount-label">$5,000</span>
                          </label>
                          <label class="donation-amount-option">
                              <input type="radio" name="donationAmount" value="custom">
                              <span class="donation-amount-label">è‡ªè¨‚é‡‘é¡</span>
                          </label>
                      </div>
                      <div class="custom-donation-group" id="customDonationAmountGroup">
                          <div class="custom-hint">ğŸ’š è«‹è¼¸å…¥ææ¬¾é‡‘é¡</div>
                          <input type="number" id="customDonationAmount" name="customDonationAmount" class="form-control" placeholder="è«‹è¼¸å…¥é‡‘é¡" min="1" step="1">
                      </div>
                  </div>

                  <div class="form-group">
                      <label>ç¹³è²»æ–¹å¼ <span class="required">*</span></label>
                      <div class="payment-group">
                          <label class="payment-option">
                              <input type="radio" name="donorPayment" value="transfer" required>
                              <div class="payment-icon">ğŸ¦</div>
                              <div class="payment-label">è½‰å¸³</div>
                          </label>
                          <label class="payment-option">
                              <input type="radio" name="donorPayment" value="cash">
                              <div class="payment-icon">ğŸ’µ</div>
                              <div class="payment-label">ç¾é‡‘</div>
                          </label>
                      </div>
                      <div class="transfer-code-group" id="donorTransferCodeGroup">
                          <div class="transfer-hint">ğŸ’¡ è«‹è¼¸å…¥è½‰å¸³å¸³è™Ÿå¾Œ5ç¢¼</div>
                          <input type="text" id="donorTransferCode" name="donorTransferCode" class="form-control" placeholder="ä¾‹å¦‚:12345" maxlength="5" pattern="[0-9]{5}">
                      </div>
                  </div>

                  <div class="form-group">
                      <label for="donorNotes">å‚™è¨»</label>
                      <textarea id="donorNotes" name="donorNotes" class="form-control" placeholder="ç•™è¨€æˆ–å…¶ä»–èªªæ˜"></textarea>
                  </div>
              </div>

              <div class="fee-display donation-display">
                  <div class="label">ææ¬¾é‡‘é¡</div>
                  <div class="amount" id="donationTotal">NT$ 0</div>
                  <div class="detail">æ„Ÿè¬æ‚¨çš„æ„›å¿ƒæ”¯æŒ ğŸ’</div>
              </div>

              <button type="submit" class="submit-btn donation-btn" id="donationSubmitBtn">
                  ç¢ºèªææ¬¾
              </button>
          </form>
      </div>

      <div class="info-card">
          <div class="info-card-title">ğŸ¦ åŒ¯æ¬¾è³‡è¨Š</div>
          <div class="bank-info">
              <div class="bank-row">
                  <div class="bank-label">æˆ¶å</div>
                  <div class="bank-value">ç¤¾åœ˜æ³•äººå°ç£<br>å¸•é‡‘æ£®ç—…å‹<br>æ¬Šç›Šä¿ƒé€²æœƒ</div>
              </div>
              <div class="bank-row">
                  <div class="bank-label">éŠ€è¡Œ</div>
                  <div class="bank-value">ç¬¬ä¸€éŠ€è¡Œ<br>ä¸‰é‡åŸ”åˆ†è¡Œ</div>
              </div>
              <div class="bank-row">
                  <div class="bank-label">éŠ€è¡Œä»£è™Ÿ</div>
                  <div class="bank-value">007</div>
              </div>
              <div class="bank-row">
                  <div class="bank-label">å¸³è™Ÿ</div>
                  <div class="bank-value account-number">211-1015-0402</div>
              </div>
          </div>
      </div>
  </div>

  <!-- ==================== å ±åçµ±è¨ˆé é¢ ==================== -->
  <div class="page" id="statsPage">
      <div class="stats-container">
          <div class="stats-grid">
              <div class="stat-card">
                  <div class="stat-icon">ğŸ‘¥</div>
                  <div class="stat-label">ç¸½å ±åäººæ•¸</div>
                  <div class="stat-number" id="totalCount">0</div>
              </div>
              <div class="stat-card">
                  <div class="stat-icon">ğŸ½ï¸</div>
                  <div class="stat-label">ç”¨é¤äººæ•¸</div>
                  <div class="stat-number" id="mealCount">0</div>
                  <div class="stat-detail" id="mealDetail">è‘·é£Ÿ: 0 | ç´ é£Ÿ: 0</div>
              </div>
              <div class="stat-card">
                  <div class="stat-icon">ğŸ’°</div>
                  <div class="stat-label">ç¸½é‡‘é¡ï¼ˆå«ææ¬¾ï¼‰</div>
                  <div class="stat-number" id="totalAmount">$0</div>
              </div>
              <div class="stat-card">
                  <div class="stat-icon">ğŸ’š</div>
                  <div class="stat-label">ææ¬¾ç¸½é¡</div>
                  <div class="stat-number" id="donationAmount">$0</div>
              </div>
          </div>

          <div class="registration-list">
              <div class="list-title">ğŸ“‹ æœ€æ–°å ±å</div>
              <div id="registrationList">
                  <div class="empty-state">
                      <div class="empty-icon">ğŸ“</div>
                      <div class="empty-text">å°šç„¡å ±åè³‡æ–™</div>
                  </div>
              </div>
          </div>
      </div>
  </div>
</main>

<nav class="bottom-nav">
  <div class="nav-item" data-page="info">
      <div class="nav-icon">ğŸ“‹</div>
      <div class="nav-label">æ´»å‹•è³‡è¨Š</div>
  </div>
  <div class="nav-item" data-page="form">
      <div class="nav-icon">âœï¸</div>
      <div class="nav-label">æˆ‘è¦å ±å</div>
  </div>
  <div class="nav-item donation-nav active" data-page="donation">
      <div class="nav-icon">ğŸ’</div>
      <div class="nav-label">æˆ‘è¦ææ¬¾</div>
  </div>
  <div class="nav-item" data-page="stats">
      <div class="nav-icon">ğŸ“Š</div>
      <div class="nav-label">å ±åçµ±è¨ˆ</div>
  </div>
</nav>

<script>
  // ==================== è¨­å®š API URL ====================
  // âš ï¸ è«‹æ›¿æ›æˆæ‚¨çš„ Google Apps Script éƒ¨ç½² URL
  const GAS_API_URL = 'https://script.google.com/macros/s/AKfycby9zy0f3mXr5j7OYYGXeLdDiL6N3REMZ2gpY4_zA7LE9ZhBH0apzQreSGik5uF1eDy0/exec';
  
  let registrations = [];
  let isSubmitting = false;
  let jsonpCounter = 0;
  let currentPage = 'donation';
  
  // ==================== é é¢åˆ‡æ› ====================
  
 // ==================== é é¢åˆ‡æ› ====================

const navItems = document.querySelectorAll('.nav-item');
const pages = document.querySelectorAll('.page');

navItems.forEach(item => {
    item.addEventListener('click', () => {
        const targetPage = item.dataset.page;
        switchPage(targetPage);
    });
});

function switchPage(pageName) {
    currentPage = pageName;
    
    navItems.forEach(item => {
        item.classList.toggle('active', item.dataset.page === pageName);
    });
    
    pages.forEach(page => {
        page.classList.toggle('active', page.id === pageName + 'Page');
    });
    
    if (pageName === 'stats') {
        loadRegistrations();
    }
}

  
  // ==================== JSONP è«‹æ±‚ ====================
  
  function jsonpRequest(url, callback) {
      const callbackName = 'jsonpCallback' + (jsonpCounter++);
      const script = document.createElement('script');
      
      window[callbackName] = function(data) {
          callback(data);
          document.head.removeChild(script);
          delete window[callbackName];
      };
      
      script.onerror = function() {
          console.error('âŒ JSONP è«‹æ±‚å¤±æ•—');
          callback({ success: false, message: 'ç¶²è·¯è«‹æ±‚å¤±æ•—' });
          document.head.removeChild(script);
          delete window[callbackName];
      };
      
      script.src = url + (url.indexOf('?') >= 0 ? '&' : '?') + 'callback=' + callbackName + '&_=' + Date.now();
      document.head.appendChild(script);
  }
  
  function loadFromGoogleSheets() {
      return new Promise((resolve) => {
          jsonpRequest(GAS_API_URL + '?action=getAll', (result) => {
              if (result.success && result.data) {
                  console.log('âœ… è¼‰å…¥è³‡æ–™æˆåŠŸ:', result.data.length, 'ç­†');
                  resolve(result.data);
              } else {
                  console.error('âŒ è¼‰å…¥è³‡æ–™å¤±æ•—:', result.message);
                  resolve([]);
              }
          });
      });
  }
  
  // ==================== è²»ç”¨è¨ˆç®— ====================
  
  function updateFee() {
      const typeRadios = document.querySelectorAll('input[name="type"]');
      const donationRadios = document.querySelectorAll('input[name="donation"]');
      const customDonationInput = document.getElementById('customDonation');
      
      let baseFee = 0;
      let feeDetail = '';
      let donationAmount = 0;
      
      typeRadios.forEach(radio => {
          if (radio.checked) {
              baseFee = parseInt(radio.dataset.fee);
              feeDetail = radio.dataset.detail;
          }
      });
      
      donationRadios.forEach(radio => {
          if (radio.checked) {
              if (radio.value === 'custom') {
                  donationAmount = parseInt(customDonationInput.value) || 0;
              } else {
                  donationAmount = parseInt(radio.value);
              }
          }
      });
      
      const totalFee = baseFee + donationAmount;
      
      let displayDetail = feeDetail;
      if (donationAmount > 0) {
          displayDetail += `\n+ ææ¬¾ $${donationAmount.toLocaleString()}`;
      }
      
      document.getElementById('totalFee').textContent = `NT$ ${totalFee.toLocaleString()}`;
      document.getElementById('feeDetail').textContent = displayDetail;
  }
  
  // ææ¬¾é‡‘é¡æ›´æ–°
  function updateDonationAmount() {
      const donationAmountRadios = document.querySelectorAll('input[name="donationAmount"]');
      const customDonationAmountInput = document.getElementById('customDonationAmount');
      
      let amount = 0;
      
      donationAmountRadios.forEach(radio => {
          if (radio.checked) {
              if (radio.value === 'custom') {
                  amount = parseInt(customDonationAmountInput.value) || 0;
              } else {
                  amount = parseInt(radio.value);
              }
          }
      });
      
      document.getElementById('donationTotal').textContent = `NT$ ${amount.toLocaleString()}`;
  }
  
  // ==================== çµ±è¨ˆæ›´æ–° ====================
  
  function updateRegistrationList() {
      const listContainer = document.getElementById('registrationList');
      
      if (!registrations || registrations.length === 0) {
          listContainer.innerHTML = `
              <div class="empty-state">
                  <div class="empty-icon">ğŸ“</div>
                  <div class="empty-text">å°šç„¡å ±åè³‡æ–™</div>
              </div>
          `;
          updateStatistics(0, 0, 0, 0, 0, 0);
          return;
      }
      
      // çµ±è¨ˆè³‡æ–™
      let totalPeople = registrations.length;
      let mealCount = 0;
      let meatCount = 0;
      let vegetarianCount = 0;
      let totalAmount = 0;
      let donationTotal = 0;
      
      console.log('\n========================================');
      console.log('ğŸ” é–‹å§‹çµ±è¨ˆç”¨é¤äººæ•¸');
      console.log('========================================');
      console.log('ç¸½å ±åç­†æ•¸:', totalPeople);
      console.log('');
      
      registrations.forEach((reg, index) => {
          console.log(`[${index + 1}] ${reg.name}`);
          console.log('  â”œâ”€ å ±åé¡å‹:', reg.typeLabel);
          console.log('  â”œâ”€ æ˜¯å¦ç”¨é¤:', reg.attendMeal);
          console.log('  â”œâ”€ é£²é£Ÿç¿’æ…£:', reg.diet);
          
          // çµ±è¨ˆç”¨é¤äººæ•¸ï¼ˆåªçµ±è¨ˆå ±ååƒåŠ å¹´æœƒçš„ï¼‰
          if (reg.attendMeal === 'yes') {
              const isCaregiver = reg.typeLabel && (
                  reg.typeLabel.includes('é™ªä¼´è€…') || 
                  reg.typeLabel.includes('ç…§é¡§é™ªä¼´è€…')
              );
              
              if (isCaregiver) {
                  console.log('  â”œâ”€ åˆ¤å®š: é™ªä¼´è€…é¡å‹ â†’ ç”¨é¤äººæ•¸ +2');
                  mealCount += 2;
                  
                  if (reg.diet === 'vegetarian') {
                      vegetarianCount += 2;
                      console.log('  â””â”€ ç´ é£Ÿ +2');
                  } else {
                      meatCount += 2;
                      console.log('  â””â”€ è‘·é£Ÿ +2');
                  }
              } else {
                  console.log('  â”œâ”€ åˆ¤å®š: ä¸€èˆ¬é¡å‹ â†’ ç”¨é¤äººæ•¸ +1');
                  mealCount += 1;
                  
                  if (reg.diet === 'vegetarian') {
                      vegetarianCount += 1;
                      console.log('  â””â”€ ç´ é£Ÿ +1');
                  } else {
                      meatCount += 1;
                      console.log('  â””â”€ è‘·é£Ÿ +1');
                  }
              }
          } else {
              console.log('  â””â”€ ä¸ç”¨é¤');
          }
          
          // çµ±è¨ˆé‡‘é¡
          const regTotal = parseInt(reg.totalFee) || 0;
          const regDonation = parseInt(reg.donationAmount) || 0;
          
          totalAmount += regTotal;
          donationTotal += regDonation;
          
          console.log('');
      });
      
      console.log('========================================');
      console.log('ğŸ“Š çµ±è¨ˆçµæœ');
        console.log('========================================');
        console.log('ç¸½å ±åäººæ•¸:', totalPeople);
        console.log('ç”¨é¤äººæ•¸:', mealCount);
        console.log('  â”œâ”€ è‘·é£Ÿ:', meatCount);
        console.log('  â””â”€ ç´ é£Ÿ:', vegetarianCount);
        console.log('ç¸½é‡‘é¡: $' + totalAmount.toLocaleString());
        console.log('ææ¬¾ç¸½é¡: $' + donationTotal.toLocaleString());
        console.log('========================================\n');
        
        // æ›´æ–°çµ±è¨ˆå¡ç‰‡
        updateStatistics(totalPeople, mealCount, meatCount, vegetarianCount, totalAmount, donationTotal);
        
        // æ›´æ–°å ±åæ¸…å–®
        const sortedRegs = [...registrations].reverse();
        listContainer.innerHTML = sortedRegs.slice(0, 20).map(reg => {
            // åˆ¤æ–·æ˜¯å¦ç‚ºç´”ææ¬¾
            const isDonationOnly = reg.typeLabel === 'ç´”ææ¬¾';
            
            if (isDonationOnly) {
                const paymentIcon = reg.payment === 'transfer' ? 'ğŸ¦ è½‰å¸³' : 'ğŸ’µ ç¾é‡‘';
                const transferInfo = reg.payment === 'transfer' && reg.transferCode ? 
                    `ï¼ˆå¾Œ5ç¢¼ï¼š${reg.transferCode}ï¼‰` : '';
                
                return `
                    <div class="registration-item donation-item">
                        <div class="item-name">ğŸ’ ${reg.name}</div>
                        <div class="item-details">
                            ç´”ææ¬¾<br>
                            ${paymentIcon}${transferInfo}
                            ${reg.notes ? `<br>ğŸ“ ${reg.notes}` : ''}
                        </div>
                        <div class="item-fee">ææ¬¾é‡‘é¡: NT$ ${parseInt(reg.donationAmount).toLocaleString()}</div>
                    </div>
                `;
            } else {
                const attendMealText = reg.attendMeal === 'yes' ? 'âœ… åƒåŠ ç”¨é¤' : 'âŒ ä¸ç”¨é¤';
                const dietIcon = reg.attendMeal === 'yes' ? 
                    (reg.diet === 'vegetarian' ? ' (ğŸ¥— ç´ é£Ÿ)' : ' (ğŸ– è‘·é£Ÿ)') : '';
                const paymentIcon = reg.payment === 'transfer' ? 'ğŸ¦ è½‰å¸³' : 'ğŸ’µ ç¾é‡‘';
                const transferInfo = reg.payment === 'transfer' && reg.transferCode ? 
                    `ï¼ˆå¾Œ5ç¢¼ï¼š${reg.transferCode}ï¼‰` : '';
                const donationInfo = reg.donationAmount > 0 ? 
                    `<br>ğŸ’š ææ¬¾ï¼š$${parseInt(reg.donationAmount).toLocaleString()}` : '';
                
                return `
                    <div class="registration-item">
                        <div class="item-name">${reg.name}</div>
                        <div class="item-details">
                            ${reg.typeLabel}<br>
                            ${attendMealText}${dietIcon}<br>
                            ${paymentIcon}${transferInfo}
                            ${donationInfo}
                            ${reg.notes ? `<br>ğŸ“ ${reg.notes}` : ''}
                        </div>
                        <div class="item-fee">æ‡‰ç¹³ç¸½é¡: NT$ ${parseInt(reg.totalFee).toLocaleString()}</div>
                    </div>
                `;
            }
        }).join('');
    }
    
    function updateStatistics(totalPeople, mealCount, meatCount, vegetarianCount, totalAmount, donationTotal) {
        document.getElementById('totalCount').textContent = totalPeople;
        document.getElementById('mealCount').textContent = mealCount;
        document.getElementById('mealDetail').textContent = `è‘·é£Ÿ: ${meatCount} | ç´ é£Ÿ: ${vegetarianCount}`;
        document.getElementById('totalAmount').textContent = '$' + totalAmount.toLocaleString();
        document.getElementById('donationAmount').textContent = '$' + donationTotal.toLocaleString();
    }
    
    // ==================== Toast æç¤º ====================
    
    function showToast(type, message) {
        const toast = document.getElementById('toast');
        toast.textContent = message;
        toast.className = `toast ${type} show`;
        
        setTimeout(() => {
            toast.classList.remove('show');
        }, 4000);
    }
    
    // ==================== è¡¨å–®äº’å‹• ====================
    
    // å ±åé¡å‹é¸æ“‡
    const radioOptions = document.querySelectorAll('.radio-option');
    radioOptions.forEach(option => {
        option.addEventListener('click', function() {
            const parentGroup = this.parentElement;
            parentGroup.querySelectorAll('.radio-option').forEach(opt => opt.classList.remove('checked'));
            this.classList.add('checked');
            const radio = this.querySelector('input[type="radio"]');
            radio.checked = true;
            updateFee();
        });
    });
    
    // æ˜¯å¦ç”¨é¤é¸æ“‡
    const attendMealOptions = document.querySelectorAll('.attend-meal-option');
    const dietOptions = document.querySelectorAll('.diet-option');
    const dietRadios = document.querySelectorAll('input[name="diet"]');
    
    attendMealOptions.forEach(option => {
        option.addEventListener('click', function() {
            attendMealOptions.forEach(opt => opt.classList.remove('checked'));
            this.classList.add('checked');
            const radio = this.querySelector('input[type="radio"]');
            radio.checked = true;
            
            if (radio.value === 'no') {
                dietOptions.forEach(opt => opt.classList.add('disabled'));
                dietRadios.forEach(r => {
                    r.required = false;
                    r.checked = false;
                });
                dietOptions.forEach(opt => opt.classList.remove('checked'));
            } else {
                dietOptions.forEach(opt => opt.classList.remove('disabled'));
                dietRadios.forEach(r => r.required = true);
            }
        });
    });
    
    // é£²é£Ÿç¿’æ…£é¸æ“‡
    dietOptions.forEach(option => {
        option.addEventListener('click', function() {
            if (!this.classList.contains('disabled')) {
                dietOptions.forEach(opt => opt.classList.remove('checked'));
                this.classList.add('checked');
                const radio = this.querySelector('input[type="radio"]');
                radio.checked = true;
            }
        });
    });
    
    // ææ¬¾é¸æ“‡
    const donationOptions = document.querySelectorAll('.donation-option');
    const customDonationGroup = document.getElementById('customDonationGroup');
    const customDonationInput = document.getElementById('customDonation');
    
    donationOptions.forEach(option => {
        option.addEventListener('click', function() {
            donationOptions.forEach(opt => opt.classList.remove('checked'));
            this.classList.add('checked');
            const radio = this.querySelector('input[type="radio"]');
            radio.checked = true;
            
            if (radio.value === 'custom') {
                customDonationGroup.classList.add('show');
                customDonationInput.focus();
            } else {
                customDonationGroup.classList.remove('show');
                customDonationInput.value = '';
            }
            updateFee();
        });
    });
    
    customDonationInput.addEventListener('input', updateFee);
    
    // ç¹³è²»æ–¹å¼é¸æ“‡
    const paymentOptions = document.querySelectorAll('.payment-option');
    const transferCodeGroup = document.getElementById('transferCodeGroup');
    const transferCodeInput = document.getElementById('transferCode');
    
    paymentOptions.forEach(option => {
        option.addEventListener('click', function() {
            paymentOptions.forEach(opt => opt.classList.remove('checked'));
            this.classList.add('checked');
            const radio = this.querySelector('input[type="radio"]');
            radio.checked = true;
            
            if (radio.value === 'transfer') {
                transferCodeGroup.classList.add('show');
                transferCodeInput.required = true;
            } else {
                transferCodeGroup.classList.remove('show');
                transferCodeInput.required = false;
                transferCodeInput.value = '';
            }
        });
    });
    
    // ==================== ææ¬¾é é¢äº’å‹• ====================
    
    // ææ¬¾é‡‘é¡é¸æ“‡
    const donationAmountOptions = document.querySelectorAll('.donation-amount-option');
    const customDonationAmountGroup = document.getElementById('customDonationAmountGroup');
    const customDonationAmountInput = document.getElementById('customDonationAmount');
    
    donationAmountOptions.forEach(option => {
        option.addEventListener('click', function() {
            donationAmountOptions.forEach(opt => opt.classList.remove('checked'));
            this.classList.add('checked');
            const radio = this.querySelector('input[type="radio"]');
            radio.checked = true;
            
            if (radio.value === 'custom') {
                customDonationAmountGroup.classList.add('show');
                customDonationAmountInput.focus();
            } else {
                customDonationAmountGroup.classList.remove('show');
                customDonationAmountInput.value = '';
            }
            updateDonationAmount();
        });
    });
    
    customDonationAmountInput.addEventListener('input', updateDonationAmount);
    
    // ææ¬¾ç¹³è²»æ–¹å¼é¸æ“‡
    const donorTransferCodeGroup = document.getElementById('donorTransferCodeGroup');
    const donorTransferCodeInput = document.getElementById('donorTransferCode');
    
    document.querySelectorAll('input[name="donorPayment"]').forEach(radio => {
        radio.parentElement.addEventListener('click', function() {
            document.querySelectorAll('input[name="donorPayment"]').forEach(r => {
                r.parentElement.classList.remove('checked');
            });
            this.classList.add('checked');
            radio.checked = true;
            
            if (radio.value === 'transfer') {
                donorTransferCodeGroup.classList.add('show');
                donorTransferCodeInput.required = true;
            } else {
                donorTransferCodeGroup.classList.remove('show');
                donorTransferCodeInput.required = false;
                donorTransferCodeInput.value = '';
            }
        });
    });
    
    // ==================== ææ¬¾è¡¨å–®æäº¤ ====================
    
    document.getElementById('donationForm').addEventListener('submit', async function(e) {
        e.preventDefault();
        
        if (isSubmitting) {
            showToast('error', 'â³ è«‹ç¨å€™ï¼Œæ­£åœ¨è™•ç†ä¸­...');
            return;
        }
        
        // é©—è­‰ææ¬¾é‡‘é¡
        const donationAmountRadio = document.querySelector('input[name="donationAmount"]:checked');
        let donationAmount = 0;
        
        if (donationAmountRadio.value === 'custom') {
            donationAmount = parseInt(customDonationAmountInput.value);
            if (!donationAmount || donationAmount < 1) {
                showToast('error', 'âŒ è«‹è¼¸å…¥æœ‰æ•ˆçš„ææ¬¾é‡‘é¡');
                return;
            }
        } else {
            donationAmount = parseInt(donationAmountRadio.value);
        }
        
        // é©—è­‰è½‰å¸³è³‡è¨Š
        const paymentRadio = document.querySelector('input[name="donorPayment"]:checked');
        if (paymentRadio.value === 'transfer') {
            const transferCode = donorTransferCodeInput.value.trim();
            if (!transferCode || transferCode.length !== 5 || !/^\d{5}$/.test(transferCode)) {
                showToast('error', 'âŒ è«‹è¼¸å…¥æ­£ç¢ºçš„è½‰å¸³å¸³è™Ÿå¾Œ5ç¢¼ï¼ˆ5ä½æ•¸å­—ï¼‰');
                return;
            }
        }
        
        isSubmitting = true;
        const submitBtn = document.getElementById('donationSubmitBtn');
        submitBtn.disabled = true;
        submitBtn.innerHTML = '<span class="loading-spinner"></span>é€å‡ºä¸­...';
        
        const formData = new FormData(e.target);
        
        const donation = {
            action: 'add',
            name: formData.get('donorName'),
            phone: formData.get('donorPhone'),
            email: formData.get('donorEmail') || '',
            type: 'donation-only',
            typeLabel: 'ç´”ææ¬¾',
            attendMeal: 'no',
            diet: 'none',
            payment: paymentRadio.value,
            transferCode: paymentRadio.value === 'transfer' ? formData.get('donorTransferCode') : '',
            baseFee: 0,
            donationAmount: donationAmount,
            totalFee: donationAmount,
            notes: formData.get('donorNotes') || ''
        };
        
        console.log('ğŸ“¤ é€å‡ºææ¬¾è³‡æ–™:', donation);
        
        try {
            await fetch(GAS_API_URL, {
                method: 'POST',
                mode: 'no-cors',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(donation)
            });
            
            showToast('success', 'âœ… ææ¬¾æˆåŠŸï¼æ„Ÿè¬æ‚¨çš„æ„›å¿ƒæ”¯æŒ');
            resetDonationForm();
            
            setTimeout(() => {
                loadRegistrations();
            }, 2000);
            
        } catch (error) {
            console.log('âš ï¸ Fetch éŒ¯èª¤ï¼ˆé æœŸè¡Œç‚ºï¼‰:', error);
            showToast('success', 'âœ… ææ¬¾è³‡æ–™å·²é€å‡ºï¼æ„Ÿè¬æ‚¨çš„æ”¯æŒ');
            resetDonationForm();
            
            setTimeout(() => {
                loadRegistrations();
            }, 3000);
        }
        
        isSubmitting = false;
        submitBtn.disabled = false;
        submitBtn.textContent = 'ç¢ºèªææ¬¾';
    });
    
    // é‡ç½®ææ¬¾è¡¨å–®
    function resetDonationForm() {
        document.getElementById('donationForm').reset();
        donationAmountOptions.forEach(opt => opt.classList.remove('checked'));
        document.querySelectorAll('input[name="donorPayment"]').forEach(r => {
            r.parentElement.classList.remove('checked');
        });
        customDonationAmountGroup.classList.remove('show');
        donorTransferCodeGroup.classList.remove('show');
        donorTransferCodeInput.required = false;
        updateDonationAmount();
    }
    
    // ==================== å ±åè¡¨å–®æäº¤ ====================
    
    document.getElementById('registrationForm').addEventListener('submit', async function(e) {
        e.preventDefault();
        
        if (isSubmitting) {
            showToast('error', 'â³ è«‹ç¨å€™ï¼Œæ­£åœ¨è™•ç†ä¸­...');
            return;
        }
        
        // é©—è­‰
        const attendMealRadio = document.querySelector('input[name="attendMeal"]:checked');
        if (!attendMealRadio) {
            showToast('error', 'âŒ è«‹é¸æ“‡æ˜¯å¦åƒåŠ ç”¨é¤');
            return;
        }
        
        if (attendMealRadio.value === 'yes') {
            const dietRadio = document.querySelector('input[name="diet"]:checked');
            if (!dietRadio) {
                showToast('error', 'âŒ è«‹é¸æ“‡é£²é£Ÿç¿’æ…£');
                return;
            }
        }
        
        const paymentRadio = document.querySelector('input[name="payment"]:checked');
        if (paymentRadio && paymentRadio.value === 'transfer') {
            const transferCode = transferCodeInput.value.trim();
            if (!transferCode || transferCode.length !== 5 || !/^\d{5}$/.test(transferCode)) {
                showToast('error', 'âŒ è«‹è¼¸å…¥æ­£ç¢ºçš„è½‰å¸³å¸³è™Ÿå¾Œ5ç¢¼ï¼ˆ5ä½æ•¸å­—ï¼‰');
                return;
            }
        }
        
        const donationRadio = document.querySelector('input[name="donation"]:checked');
        if (donationRadio && donationRadio.value === 'custom') {
            const customAmount = parseInt(customDonationInput.value);
            if (!customAmount || customAmount < 1) {
                showToast('error', 'âŒ è«‹è¼¸å…¥æœ‰æ•ˆçš„ææ¬¾é‡‘é¡');
                return;
            }
        }
        
        isSubmitting = true;
        const submitBtn = document.getElementById('submitBtn');
        submitBtn.disabled = true;
        submitBtn.innerHTML = '<span class="loading-spinner"></span>é€å‡ºä¸­...';
        
        const formData = new FormData(e.target);
        const typeRadio = document.querySelector('input[name="type"]:checked');
        const dietRadio = document.querySelector('input[name="diet"]:checked');
        const baseFee = parseInt(typeRadio.dataset.fee);
        let donationAmount = 0;
        
        if (donationRadio.value === 'custom') {
            donationAmount = parseInt(customDonationInput.value) || 0;
        } else {
            donationAmount = parseInt(donationRadio.value);
        }
        
        const totalFee = baseFee + donationAmount;
        
        const registration = {
            action: 'add',
            name: formData.get('name'),
            phone: formData.get('phone'),
            email: formData.get('email') || '',
            type: typeRadio.value,
            typeLabel: typeRadio.parentElement.querySelector('.radio-label').textContent.split('\n')[0],
            attendMeal: attendMealRadio.value,
            diet: dietRadio ? dietRadio.value : 'none',
            payment: paymentRadio.value,
            transferCode: paymentRadio.value === 'transfer' ? formData.get('transferCode') : '',
            baseFee: baseFee,
            donationAmount: donationAmount,
            totalFee: totalFee,
            notes: formData.get('notes') || ''
        };
        
        console.log('ğŸ“¤ é€å‡ºå ±åè³‡æ–™:', registration);
        
        try {
            await fetch(GAS_API_URL, {
                method: 'POST',
                mode: 'no-cors',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(registration)
            });
            
            showToast('success', 'âœ… å ±åæˆåŠŸï¼æ„Ÿè¬æ‚¨çš„åƒèˆ‡');
            resetForm();
            
            setTimeout(() => {
                loadRegistrations();
            }, 2000);
            
        } catch (error) {
            console.log('âš ï¸ Fetch éŒ¯èª¤ï¼ˆé æœŸè¡Œç‚ºï¼‰:', error);
            showToast('success', 'âœ… å ±åè³‡æ–™å·²é€å‡ºï¼');
            resetForm();
            
            setTimeout(() => {
                loadRegistrations();
            }, 3000);
        }
        
        isSubmitting = false;
        submitBtn.disabled = false;
        submitBtn.textContent = 'ç¢ºèªå ±å';
    });
    
    // é‡ç½®å ±åè¡¨å–®
    function resetForm() {
        document.getElementById('registrationForm').reset();
        document.querySelectorAll('.radio-option').forEach(opt => opt.classList.remove('checked'));
        attendMealOptions.forEach(opt => opt.classList.remove('checked'));
        dietOptions.forEach(opt => opt.classList.remove('checked'));
        donationOptions.forEach(opt => opt.classList.remove('checked'));
        paymentOptions.forEach(opt => opt.classList.remove('checked'));
        transferCodeGroup.classList.remove('show');
        customDonationGroup.classList.remove('show');
        transferCodeInput.required = false;
        
        dietOptions.forEach(opt => opt.classList.remove('disabled'));
        dietRadios.forEach(r => r.required = true);
        
        document.querySelector('input[name="donation"][value="0"]').checked = true;
        document.querySelector('input[name="donation"][value="0"]').parentElement.classList.add('checked');
        
        updateFee();
    }
    
    // ==================== è¼‰å…¥å ±åè³‡æ–™ ====================
    
    async function loadRegistrations() {
        try {
            console.log('ğŸ”„ é–‹å§‹è¼‰å…¥å ±åè³‡æ–™...');
            const data = await loadFromGoogleSheets();
            registrations = data;
            updateRegistrationList();
        } catch (error) {
            console.error('âŒ è¼‰å…¥å ±åè³‡æ–™å¤±æ•—:', error);
            showToast('error', 'è¼‰å…¥è³‡æ–™å¤±æ•—ï¼Œè«‹é‡æ–°æ•´ç†é é¢');
        }
    }
    
    // ==================== åˆå§‹åŒ– ====================
    
    window.addEventListener('DOMContentLoaded', function() {
        console.log('ğŸš€ ç³»çµ±åˆå§‹åŒ–...');
        
        document.querySelector('input[name="donation"][value="0"]').checked = true;
        document.querySelector('input[name="donation"][value="0"]').parentElement.classList.add('checked');
        
        updateFee();
        updateDonationAmount();
        loadRegistrations();
        
        setInterval(() => {
            if (currentPage === 'stats') {
                console.log('â° è‡ªå‹•æ›´æ–°çµ±è¨ˆè³‡æ–™...');
                loadRegistrations();
            }
        }, 30000);
        
        console.log('âœ… ç³»çµ±åˆå§‹åŒ–å®Œæˆ');
    });
    
    // é˜²æ­¢é›™æ“Šç¸®æ”¾
    let lastTouchEnd = 0;
    document.addEventListener('touchend', function(event) {
        const now = Date.now();
        if (now - lastTouchEnd <= 300) {
            event.preventDefault();
        }
        lastTouchEnd = now;
    }, false);
</script>
</body>
</html>
